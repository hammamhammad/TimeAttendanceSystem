<!-- Page Header -->
<app-page-header
  [title]="i18n.t('portal.attendance_corrections')">
  <div header-actions>
    <button
      class="btn btn-primary btn-sm me-2"
      (click)="createCorrection()"
      [disabled]="loading()"
      type="button">
      <i class="bi bi-plus me-1"></i>
      {{ i18n.t('portal.new_correction') }}
    </button>
    <button
      class="btn btn-outline-primary btn-sm"
      (click)="refresh()"
      [disabled]="loading()"
      type="button">
      <i class="bi bi-arrow-clockwise" [class.spin]="loading()"></i>
      {{ i18n.t('common.refresh') }}
    </button>
  </div>
</app-page-header>

<!-- Loading State -->
@if (loading() && corrections().length === 0) {
  <app-loading-spinner [message]="i18n.t('common.loading')"></app-loading-spinner>
}

<!-- Error State -->
@if (error() && corrections().length === 0) {
  <div class="alert alert-danger" role="alert">
    <i class="bi bi-exclamation-triangle me-2"></i>
    {{ error() }}
    <button class="btn btn-sm btn-outline-danger ms-3" (click)="refresh()" type="button">
      {{ i18n.t('common.retry') }}
    </button>
  </div>
}

<!-- Empty State -->
@if (!loading() && corrections().length === 0 && !error()) {
  <app-empty-state
    icon="bi bi-clock-history"
    [title]="i18n.t('portal.no_corrections')"
    [message]="i18n.t('portal.no_corrections_message')"
    [actionText]="i18n.t('portal.request_correction')"
    (action)="createCorrection()">
  </app-empty-state>
}

<!-- Data Table -->
@if (corrections().length > 0) {
  <div class="card">
    <div class="card-body">
      <app-data-table
        [data]="tableData()"
        [columns]="columns"
        [actions]="tableActions"
        [loading]="loading()"
        [pageSize]="10"
        [paginated]="true"
        [sortable]="true"
        [sortColumn]="sortColumn"
        [sortDirection]="sortDirection"
        (sortChange)="onSort($event)"
        (actionClick)="onActionClick($event)">
      </app-data-table>
    </div>
  </div>
}

<!-- Info Card -->
@if (corrections().length > 0) {
  <div class="card mt-3">
    <div class="card-body">
      <div class="d-flex align-items-start">
        <i class="bi bi-info-circle text-info me-3 mt-1" style="font-size: 1.5rem;"></i>
        <div>
          <h6 class="mb-2">{{ i18n.t('portal.correction_info_title') }}</h6>
          <p class="text-muted mb-0 small">
            {{ i18n.t('portal.correction_info_text') }}
          </p>
        </div>
      </div>
    </div>
  </div>
}
