<div class="app-list-page">
  <!-- Page Header -->
  <app-page-header [title]="i18n.t('employee_vacations.title')">
  </app-page-header>

  <!-- Filters Component -->
  <app-unified-filter moduleName="employee-vacations" [refreshing]="loading()" (searchChange)="onSearchChange($event)"
    (filtersChange)="onFiltersChange($event)" (add)="onAddVacation()" (refresh)="onRefreshData()">
  </app-unified-filter>

  <!-- Employee Vacations Table -->
  <app-data-table [data]="vacations() || []" [columns]="tableColumns" [actions]="tableActions()"
    [currentPage]="currentPage()" [totalPages]="totalPages()" [totalItems]="totalItems()" [pageSize]="pageSize()"
    [loading]="loading" [emptyTitle]="i18n.t('employee_vacations.no_vacations_found')"
    [emptyMessage]="i18n.t('employee_vacations.no_vacations_message')" [showPagination]="true"
    [responsiveMode]="'auto'"
    (actionClick)="onActionClick($event)" (pageChange)="onPageChange($event)"
    (pageSizeChange)="onPageSizeChange($event)">

    <!-- Custom cell template -->
    <ng-template #cellTemplate let-vacation let-column="column">
      @if (column.key === 'employee') {
      <div class="d-flex align-items-center">
        <div class="avatar-sm me-2">
          <div class="avatar-initial bg-primary text-white rounded-circle">
            {{ getInitials(vacation.employeeName) }}
          </div>
        </div>
        <div>
          <div class="fw-medium">{{ vacation.employeeName }}</div>
          <small class="text-muted">{{ vacation.employeeNumber }}</small>
        </div>
      </div>
      } @else if (column.key === 'vacationType') {
      <span class="fw-medium">{{ vacation.vacationTypeName }}</span>
      } @else if (column.key === 'startDate') {
      {{ formatDate(vacation.startDate) }}
      } @else if (column.key === 'endDate') {
      {{ formatDate(vacation.endDate) }}
      } @else if (column.key === 'totalDays') {
      <span class="badge bg-secondary">
        {{ vacation.totalDays }} {{ vacation.totalDays === 1 ? i18n.t('common.day') : i18n.t('common.days') }}
      </span>
      } @else if (column.key === 'status') {
      <app-status-badge [status]="vacation.isApproved ? 'success' : 'warning'"
        [label]="vacation.isApproved ? i18n.t('employee_vacations.approved') : i18n.t('employee_vacations.pending')">
      </app-status-badge>
      } @else if (column.key === 'currentStatus') {
      <span class="badge" [ngClass]="getCurrentStatusClass(vacation)">
        {{ getCurrentStatusLabel(vacation) }}
      </span>
      } @else if (column.key === 'notes') {
      @if (vacation.notes) {
      {{ vacation.notes }}
      } @else {
      <span class="text-muted">-</span>
      }
      } @else {
      {{ vacation[column.key] }}
      }
    </ng-template>
  </app-data-table>


  <!-- Bulk Vacation Modal Component -->
  <app-bulk-vacation-modal #bulkVacationModal (bulkVacationCreated)="onBulkVacationCreated()">
  </app-bulk-vacation-modal>
</div>