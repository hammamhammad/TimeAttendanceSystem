<div class="app-view-page">
  <!-- Standardized Page Header -->
  <app-form-header
    mode="view"
    [title]="i18n.t('settings.overtime.configurationInfo')"
    moduleName="settings"
    moduleRoute="settings/overtime"
    [entityId]="overtimeConfig()?.id"
    [loading]="loading()">
  </app-form-header>

  <!-- Loading State -->
  @if (loading()) {
    <div class="text-center py-5">
      <app-loading-spinner
        [message]="i18n.t('common.loading')"
        [variant]="'primary'"
        [centered]="true">
      </app-loading-spinner>
    </div>
  }

  <!-- Error State -->
  @if (error()) {
    <div class="alert alert-danger" role="alert">
      <i class="fas fa-exclamation-triangle me-2"></i>
      {{ error() }}
    </div>
  }

  <!-- Overtime Configuration Details -->
  @if (overtimeConfig() && !loading()) {
    <div class="app-desktop-sidebar">
      <!-- Main Content -->
      <div class="app-main-content">
        <!-- Basic Information Card -->
        <app-section-card
          [title]="i18n.t('settings.overtime.configurationInfo')"
          icon="fas fa-info-circle"
          headerClass="bg-light"
          class="mb-4">
          <app-definition-list
            [items]="basicInfoItems()"
            [labelWidth]="'4'"
            [valueWidth]="'8'">
          </app-definition-list>
        </app-section-card>

        <!-- Overtime Settings Card -->
        <app-section-card
          [title]="i18n.t('settings.overtime.calculationSettings')"
          icon="fas fa-clock"
          headerClass="bg-light"
          class="mb-4">
          <div class="row">
            <div class="col-md-6">
              <app-definition-list
                [items]="overtimeSettingsLeftItems()"
                [labelWidth]="'7'"
                [valueWidth]="'5'">
              </app-definition-list>
            </div>
            <div class="col-md-6">
              <app-definition-list
                [items]="overtimeSettingsRightItems()"
                [labelWidth]="'7'"
                [valueWidth]="'5'">
              </app-definition-list>
            </div>
          </div>
        </app-section-card>

        <!-- Overtime Rates Card -->
        <app-section-card
          [title]="i18n.t('settings.overtime.overtimeRates')"
          icon="fas fa-percentage"
          headerClass="bg-light"
          class="mb-4">
          <app-definition-list
            [items]="overtimeRatesItems()"
            [labelWidth]="'4'"
            [valueWidth]="'8'">
          </app-definition-list>
        </app-section-card>

        <!-- Policy Settings Card -->
        <app-section-card
          [title]="i18n.t('settings.overtime.additionalSettings')"
          icon="fas fa-cogs"
          headerClass="bg-light"
          class="mb-4">
          <app-definition-list
            [items]="policySettingsItems()"
            [labelWidth]="'5'"
            [valueWidth]="'7'">
          </app-definition-list>
        </app-section-card>

        <!-- Audit Information Card -->
        <app-section-card
          [title]="i18n.t('common.audit_information')"
          icon="fas fa-history"
          headerClass="bg-light"
          class="mb-4">
          <app-definition-list
            [items]="auditItems()"
            [labelWidth]="'3'"
            [valueWidth]="'9'">
          </app-definition-list>
        </app-section-card>
      </div>

      <!-- Sidebar -->
      <div class="app-sidebar-content">
        <!-- Actions Card -->
        @if (hasActiveActions()) {
          <app-section-card
            [title]="i18n.t('common.actions')"
            icon="fas fa-cogs"
            headerClass="bg-light"
            class="mb-3">
            <div class="d-grid gap-2">
              <!-- Toggle Status Action -->
              @if (canToggleStatus()) {
                <button
                  type="button"
                  class="btn"
                  [class]="overtimeConfig()?.isActive ? 'btn-warning' : 'btn-success'"
                  (click)="toggleStatus()"
                  [disabled]="processing()">
                  @if (processing()) {
                    <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                  } @else {
                    <i class="fas" [class]="overtimeConfig()?.isActive ? 'fa-pause' : 'fa-check'" [class.me-2]="true"></i>
                  }
                  {{ overtimeConfig()?.isActive ? i18n.t('common.deactivate') : i18n.t('common.activate') }}
                </button>
              }

              <!-- Delete Action -->
              @if (canDelete()) {
                <button
                  type="button"
                  class="btn btn-outline-danger"
                  (click)="deleteOvertimeConfiguration()"
                  [disabled]="processing()">
                  @if (processing()) {
                    <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                  } @else {
                    <i class="fas fa-trash me-2"></i>
                  }
                  {{ i18n.t('common.delete') }}
                </button>
              }
            </div>
          </app-section-card>
        }

        <!-- Configuration Summary -->
        <app-section-card
          [title]="i18n.t('settings.overtime.configuration')"
          icon="fas fa-chart-line"
          headerClass="bg-light"
          class="mb-3">
          <div class="config-summary">
            <!-- Pre/Post Shift Status -->
            <div class="summary-item">
              <div class="summary-label">{{ i18n.t('settings.overtime.preShift') }}</div>
              <div class="summary-value">
                <app-status-badge
                  [status]="preShiftOvertimeBadge().label"
                  [variant]="preShiftOvertimeBadge().variant">
                </app-status-badge>
              </div>
            </div>

            <div class="summary-item">
              <div class="summary-label">{{ i18n.t('settings.overtime.postShift') }}</div>
              <div class="summary-value">
                <app-status-badge
                  [status]="postShiftOvertimeBadge().label"
                  [variant]="postShiftOvertimeBadge().variant">
                </app-status-badge>
              </div>
            </div>

            <!-- Rates Summary -->
            <div class="summary-item">
              <div class="summary-label">{{ i18n.t('settings.overtime.normalDay') }}</div>
              <div class="summary-value rate-value">{{ overtimeConfig()?.normalDayRate }}x</div>
            </div>

            <div class="summary-item">
              <div class="summary-label">{{ i18n.t('settings.overtime.holiday') }}</div>
              <div class="summary-value rate-value">{{ overtimeConfig()?.publicHolidayRate }}x</div>
            </div>

            <!-- Key Settings -->
            <div class="summary-item">
              <div class="summary-label">{{ i18n.t('settings.overtime.requiresApproval') }}</div>
              <div class="summary-value">
                <app-status-badge
                  [status]="requiresApprovalBadge().label"
                  [variant]="requiresApprovalBadge().variant">
                </app-status-badge>
              </div>
            </div>
          </div>
        </app-section-card>

        <!-- Back Navigation -->
        <app-section-card
          [title]="i18n.t('common.navigation')"
          icon="fas fa-arrow-left"
          headerClass="bg-light"
          bodyClass="p-0">
          <div class="list-group list-group-flush">
            <a [routerLink]="['/settings/overtime']" class="list-group-item list-group-item-action">
              <i class="fas fa-list me-2"></i>
              {{ i18n.t('settings.overtime.title') }}
            </a>
          </div>
        </app-section-card>
      </div>
    </div>
  }
</div>
