<div class="employee-excuse-filters">
  <div class="row">
    <!-- Search Filter -->
    <div class="col-lg-4 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('common.search') }}</label>
      <div class="input-group">
        <span class="input-group-text">
          <i class="fas fa-search"></i>
        </span>
        <input
          type="text"
          class="form-control"
          [placeholder]="i18n.t('employee_excuses.search_placeholder')"
          [value]="searchTerm() || ''"
          (input)="onSearchChange($any($event.target).value)"
        />
      </div>
    </div>

    <!-- Employee Filter -->
    <div class="col-lg-2 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('employee_excuses.employee') }}</label>
      <select
        class="form-select"
        [value]="selectedEmployeeId() ?? ''"
        (change)="onEmployeeChange($any($event.target).value)">
        <option value="">{{ i18n.t('common.all') }}</option>
        @for (employee of availableEmployees(); track employee.id) {
          <option [value]="employee.id">{{ getEmployeeDisplayName(employee) }}</option>
        }
      </select>
    </div>

    <!-- Department Filter -->
    <div class="col-lg-2 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('employee_excuses.department') }}</label>
      <select
        class="form-select"
        [value]="selectedDepartmentId() ?? ''"
        (change)="onDepartmentChange($any($event.target).value)">
        <option value="">{{ i18n.t('common.all') }}</option>
        @for (department of availableDepartments(); track department.id) {
          <option [value]="department.id">{{ department.name }}</option>
        }
      </select>
    </div>

    <!-- Branch Filter -->
    <div class="col-lg-2 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('employee_excuses.branch') }}</label>
      <select
        class="form-select"
        [value]="selectedBranchId() ?? ''"
        (change)="onBranchChange($any($event.target).value)">
        <option value="">{{ i18n.t('common.all') }}</option>
        @for (branch of availableBranches(); track branch.id) {
          <option [value]="branch.id">{{ branch.name }}</option>
        }
      </select>
    </div>

    <!-- Status Filter -->
    <div class="col-lg-2 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('employee_excuses.status') }}</label>
      <select
        class="form-select"
        [value]="selectedStatus() ?? ''"
        (change)="onStatusChange($any($event.target).value)">
        <option value="">{{ i18n.t('common.all') }}</option>
        @for (status of availableStatuses(); track status) {
          <option [value]="status">{{ getStatusDisplayName(status) }}</option>
        }
      </select>
    </div>
  </div>

  <!-- Date Range and Quick Filters -->
  <div class="row">
    <!-- From Date -->
    <div class="col-lg-2 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('common.from_date') }}</label>
      <input
        type="date"
        class="form-control"
        [value]="fromDate() || ''"
        (change)="onFromDateChange($any($event.target).value)">
    </div>

    <!-- To Date -->
    <div class="col-lg-2 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('common.to_date') }}</label>
      <input
        type="date"
        class="form-control"
        [value]="toDate() || ''"
        (change)="onToDateChange($any($event.target).value)">
    </div>

    <!-- Quick Date Filters -->
    <div class="col-lg-4 col-md-6 mb-3">
      <label class="form-label">{{ i18n.t('employee_excuses.quick_filters') }}</label>
      <div class="btn-group w-100" role="group">
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="setLast7Days()">
          {{ i18n.t('employee_excuses.last_7_days') }}
        </button>
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="setLast30Days()">
          {{ i18n.t('employee_excuses.last_30_days') }}
        </button>
        <button
          type="button"
          class="btn btn-outline-secondary btn-sm"
          (click)="setThisMonth()">
          {{ i18n.t('employee_excuses.this_month') }}
        </button>
      </div>
    </div>

    <!-- Clear Filters -->
    <div class="col-lg-4 col-md-6 mb-3 d-flex align-items-end">
      <button
        type="button"
        class="btn btn-outline-danger w-100"
        (click)="onClearFilters()"
        [disabled]="!hasActiveFilters()">
        <i class="fas fa-times me-2"></i>
        {{ i18n.t('common.clear_filters') }}
        @if (hasActiveFilters()) {
          <span class="badge bg-danger ms-2">{{ getActiveFilterCount() }}</span>
        }
      </button>
    </div>
  </div>

  <!-- Active Filter Tags -->
  @if (hasActiveFilters()) {
    <div class="filter-tags">
      @if (selectedEmployeeId()) {
        <span class="filter-tag">
          <i class="fas fa-user me-1"></i>
          {{ i18n.t('employee_excuses.employee') }}:
          {{ getSelectedEmployeeName() }}
          <button type="button" class="btn-close btn-close-sm" (click)="onEmployeeChange('')"></button>
        </span>
      }
      @if (selectedDepartmentId()) {
        <span class="filter-tag">
          <i class="fas fa-building me-1"></i>
          {{ i18n.t('employee_excuses.department') }}:
          {{ getSelectedDepartmentName() }}
          <button type="button" class="btn-close btn-close-sm" (click)="onDepartmentChange('')"></button>
        </span>
      }
      @if (selectedBranchId()) {
        <span class="filter-tag">
          <i class="fas fa-map-marker-alt me-1"></i>
          {{ i18n.t('employee_excuses.branch') }}:
          {{ getSelectedBranchName() }}
          <button type="button" class="btn-close btn-close-sm" (click)="onBranchChange('')"></button>
        </span>
      }
      @if (selectedStatus()) {
        <span class="filter-tag">
          <i class="fas fa-flag me-1"></i>
          {{ i18n.t('employee_excuses.status') }}: {{ getStatusDisplayName(selectedStatus()!) }}
          <button type="button" class="btn-close btn-close-sm" (click)="onStatusChange('')"></button>
        </span>
      }
      @if (fromDate() || toDate()) {
        <span class="filter-tag">
          <i class="fas fa-calendar me-1"></i>
          {{ i18n.t('common.date_range') }}:
          {{ fromDate() || '...' }} - {{ toDate() || '...' }}
          <button type="button" class="btn-close btn-close-sm" (click)="clearDateFilters()"></button>
        </span>
      }
      @if (searchTerm()) {
        <span class="filter-tag">
          <i class="fas fa-search me-1"></i>
          {{ i18n.t('common.search') }}: "{{ searchTerm() }}"
          <button type="button" class="btn-close btn-close-sm" (click)="onSearchChange('')"></button>
        </span>
      }
    </div>
  }
</div>