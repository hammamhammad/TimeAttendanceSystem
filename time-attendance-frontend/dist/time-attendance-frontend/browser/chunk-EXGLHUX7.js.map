{
  "version": 3,
  "sources": ["src/app/core/services/shift-assignment.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../../environments/environment';\r\nimport {\r\n  ShiftAssignment,\r\n  ShiftAssignmentsResponse,\r\n  CreateShiftAssignmentRequest,\r\n  UpdateShiftAssignmentRequest,\r\n  ShiftAssignmentType,\r\n  ShiftAssignmentStatus,\r\n  ShiftAssignmentOptions\r\n} from '../../shared/models/shift.model';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ShiftAssignmentService {\r\n  private readonly apiUrl = `${environment.apiUrl}/api/v1/shift-assignments`;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  /**\r\n   * Get paginated list of shift assignments with optional filtering\r\n   */\r\n  getShiftAssignments(params?: {\r\n    page?: number;\r\n    pageSize?: number;\r\n    search?: string;\r\n    assignmentType?: ShiftAssignmentType;\r\n    employeeId?: number;\r\n    departmentId?: number;\r\n    branchId?: number;\r\n    shiftId?: number;\r\n    status?: ShiftAssignmentStatus;\r\n    effectiveFrom?: string;\r\n    effectiveTo?: string;\r\n    currentlyActive?: boolean;\r\n    minPriority?: number;\r\n    maxPriority?: number;\r\n  }): Observable<ShiftAssignmentsResponse> {\r\n    let httpParams = new HttpParams();\r\n\r\n    if (params) {\r\n      if (params.page !== undefined) {\r\n        httpParams = httpParams.set('page', params.page.toString());\r\n      }\r\n      if (params.pageSize !== undefined) {\r\n        httpParams = httpParams.set('pageSize', params.pageSize.toString());\r\n      }\r\n      if (params.search) {\r\n        httpParams = httpParams.set('search', params.search);\r\n      }\r\n      if (params.assignmentType !== undefined) {\r\n        httpParams = httpParams.set('assignmentType', params.assignmentType.toString());\r\n      }\r\n      if (params.employeeId !== undefined) {\r\n        httpParams = httpParams.set('employeeId', params.employeeId.toString());\r\n      }\r\n      if (params.departmentId !== undefined) {\r\n        httpParams = httpParams.set('departmentId', params.departmentId.toString());\r\n      }\r\n      if (params.branchId !== undefined) {\r\n        httpParams = httpParams.set('branchId', params.branchId.toString());\r\n      }\r\n      if (params.shiftId !== undefined) {\r\n        httpParams = httpParams.set('shiftId', params.shiftId.toString());\r\n      }\r\n      if (params.status !== undefined) {\r\n        httpParams = httpParams.set('status', params.status.toString());\r\n      }\r\n      if (params.effectiveFrom) {\r\n        httpParams = httpParams.set('effectiveFrom', params.effectiveFrom);\r\n      }\r\n      if (params.effectiveTo) {\r\n        httpParams = httpParams.set('effectiveTo', params.effectiveTo);\r\n      }\r\n      if (params.currentlyActive !== undefined) {\r\n        httpParams = httpParams.set('currentlyActive', params.currentlyActive.toString());\r\n      }\r\n      if (params.minPriority !== undefined) {\r\n        httpParams = httpParams.set('minPriority', params.minPriority.toString());\r\n      }\r\n      if (params.maxPriority !== undefined) {\r\n        httpParams = httpParams.set('maxPriority', params.maxPriority.toString());\r\n      }\r\n    }\r\n\r\n    return this.http.get<ShiftAssignmentsResponse>(this.apiUrl, { params: httpParams });\r\n  }\r\n\r\n  /**\r\n   * Get a specific shift assignment by ID\r\n   */\r\n  getShiftAssignmentById(id: number): Observable<ShiftAssignment> {\r\n    return this.http.get<ShiftAssignment>(`${this.apiUrl}/${id}`);\r\n  }\r\n\r\n  /**\r\n   * Create a new shift assignment\r\n   */\r\n  createShiftAssignment(request: CreateShiftAssignmentRequest): Observable<{ id: number }> {\r\n    return this.http.post<{ id: number }>(this.apiUrl, request);\r\n  }\r\n\r\n  /**\r\n   * Update an existing shift assignment\r\n   */\r\n  updateShiftAssignment(id: number, request: UpdateShiftAssignmentRequest): Observable<any> {\r\n    return this.http.put(`${this.apiUrl}/${id}`, request);\r\n  }\r\n\r\n  /**\r\n   * Delete a shift assignment\r\n   */\r\n  deleteShiftAssignment(id: number): Observable<any> {\r\n    return this.http.delete(`${this.apiUrl}/${id}`);\r\n  }\r\n\r\n  /**\r\n   * Get assignment creation options (assignment types, statuses, etc.)\r\n   */\r\n  getAssignmentOptions(): Observable<ShiftAssignmentOptions> {\r\n    return this.http.get<ShiftAssignmentOptions>(`${this.apiUrl}/options`);\r\n  }\r\n\r\n  /**\r\n   * Get display text for assignment type\r\n   */\r\n  getAssignmentTypeDisplay(type: ShiftAssignmentType): string {\r\n    switch (type) {\r\n      case ShiftAssignmentType.Employee:\r\n        return 'Employee';\r\n      case ShiftAssignmentType.Department:\r\n        return 'Department';\r\n      case ShiftAssignmentType.Branch:\r\n        return 'Branch';\r\n      default:\r\n        return 'Unknown';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get display text for assignment status\r\n   */\r\n  getStatusDisplay(status: ShiftAssignmentStatus): string {\r\n    switch (status) {\r\n      case ShiftAssignmentStatus.Pending:\r\n        return 'Pending';\r\n      case ShiftAssignmentStatus.Active:\r\n        return 'Active';\r\n      case ShiftAssignmentStatus.Inactive:\r\n        return 'Inactive';\r\n      case ShiftAssignmentStatus.Expired:\r\n        return 'Expired';\r\n      case ShiftAssignmentStatus.Cancelled:\r\n        return 'Cancelled';\r\n      default:\r\n        return 'Unknown';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get CSS class for status badge\r\n   */\r\n  getStatusBadgeClass(status: ShiftAssignmentStatus): string {\r\n    switch (status) {\r\n      case ShiftAssignmentStatus.Pending:\r\n        return 'badge-warning';\r\n      case ShiftAssignmentStatus.Active:\r\n        return 'badge-success';\r\n      case ShiftAssignmentStatus.Inactive:\r\n        return 'badge-secondary';\r\n      case ShiftAssignmentStatus.Expired:\r\n        return 'badge-danger';\r\n      case ShiftAssignmentStatus.Cancelled:\r\n        return 'badge-dark';\r\n      default:\r\n        return 'badge-light';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Format date for display\r\n   */\r\n  formatDate(dateString: string): string {\r\n    if (!dateString) return '';\r\n    const date = new Date(dateString);\r\n    return date.toLocaleDateString();\r\n  }\r\n\r\n  /**\r\n   * Check if an assignment is currently active\r\n   */\r\n  isCurrentlyActive(assignment: ShiftAssignment): boolean {\r\n    const now = new Date();\r\n    const effectiveDate = new Date(assignment.effectiveDate);\r\n    const endDate = assignment.endDate ? new Date(assignment.endDate) : null;\r\n\r\n    return assignment.status === ShiftAssignmentStatus.Active &&\r\n           effectiveDate <= now &&\r\n           (!endDate || endDate >= now);\r\n  }\r\n}"],
  "mappings": "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",
  "names": []
}
