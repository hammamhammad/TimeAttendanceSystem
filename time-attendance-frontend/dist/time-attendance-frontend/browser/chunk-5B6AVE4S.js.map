{
  "version": 3,
  "sources": ["src/app/pages/employees/employees.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable, map } from 'rxjs';\r\nimport {\r\n  EmployeeDto,\r\n  CreateEmployeeRequest,\r\n  UpdateEmployeeRequest,\r\n  EmployeesFilter,\r\n  PagedResult,\r\n  BranchDto,\r\n  DepartmentDto,\r\n  EmployeeSelectOption\r\n} from '../../shared/models/employee.model';\r\nimport { UpdateEmployeeShiftRequest } from '../../shared/models/shift.model';\r\nimport { environment } from '../../../environments/environment';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class EmployeesService {\r\n  private http = inject(HttpClient);\r\n  private baseUrl = `${environment.apiUrl}/api/v1/employees`;\r\n  private branchesUrl = `${environment.apiUrl}/api/v1/branches`;\r\n  private departmentsUrl = `${environment.apiUrl}/api/v1/departments`;\r\n  private rolesUrl = `${environment.apiUrl}/api/v1/roles`;\r\n\r\n  getEmployees(filter: EmployeesFilter = {}): Observable<PagedResult<EmployeeDto>> {\r\n    let httpParams = new HttpParams();\r\n    \r\n    if (filter.page) httpParams = httpParams.set('page', filter.page.toString());\r\n    if (filter.pageSize) httpParams = httpParams.set('pageSize', filter.pageSize.toString());\r\n    if (filter.search) httpParams = httpParams.set('search', filter.search);\r\n    if (filter.branchId) httpParams = httpParams.set('branchId', filter.branchId.toString());\r\n    if (filter.departmentId) httpParams = httpParams.set('departmentId', filter.departmentId.toString());\r\n    if (filter.managerId) httpParams = httpParams.set('managerId', filter.managerId.toString());\r\n    if (filter.isActive !== undefined) httpParams = httpParams.set('isActive', filter.isActive.toString());\r\n    if (filter.employmentStatus) httpParams = httpParams.set('employmentStatus', filter.employmentStatus);\r\n\r\n    return this.http.get<PagedResult<EmployeeDto>>(this.baseUrl, { params: httpParams });\r\n  }\r\n\r\n  getEmployeeById(id: number): Observable<EmployeeDto> {\r\n    return this.http.get<EmployeeDto>(`${this.baseUrl}/${id}`);\r\n  }\r\n\r\n  getCurrentEmployee(): Observable<EmployeeDto> {\r\n    return this.http.get<EmployeeDto>(`${this.baseUrl}/current`);\r\n  }\r\n\r\n  createEmployee(request: CreateEmployeeRequest): Observable<{ id: number }> {\r\n    return this.http.post<{ id: number }>(this.baseUrl, request);\r\n  }\r\n\r\n  updateEmployee(id: number, request: UpdateEmployeeRequest): Observable<void> {\r\n    return this.http.put<void>(`${this.baseUrl}/${id}`, request);\r\n  }\r\n\r\n  deleteEmployee(id: number): Observable<void> {\r\n    return this.http.delete<void>(`${this.baseUrl}/${id}`);\r\n  }\r\n\r\n  toggleEmployeeStatus(id: number): Observable<{ isActive: boolean; message: string }> {\r\n    return this.http.post<{ isActive: boolean; message: string }>(`${this.baseUrl}/${id}/toggle-status`, {});\r\n  }\r\n\r\n  updateEmployeeShift(employeeId: number, request: UpdateEmployeeShiftRequest): Observable<{success: boolean, message: string}> {\r\n    return this.http.post<{success: boolean, message: string}>(`${this.baseUrl}/${employeeId}/shift`, request);\r\n  }\r\n\r\n  changeEmployeeShift(shiftData: any): Observable<any> {\r\n    return this.http.post<any>(`${this.baseUrl}/${shiftData.employeeId}/change-shift`, shiftData);\r\n  }\r\n\r\n  // Helper methods for dropdowns\r\n  getBranches(): Observable<PagedResult<BranchDto>> {\r\n    let httpParams = new HttpParams()\r\n      .set('page', '1')\r\n      .set('pageSize', '100')\r\n      .set('isActive', 'true');\r\n    \r\n    return this.http.get<PagedResult<BranchDto>>(this.branchesUrl, { params: httpParams });\r\n  }\r\n\r\n  getDepartments(branchId?: number): Observable<DepartmentDto[]> {\r\n    let httpParams = new HttpParams();\r\n    if (branchId) {\r\n      httpParams = httpParams.set('branchId', branchId.toString());\r\n    }\r\n    \r\n    return this.http.get<DepartmentDto[]>(this.departmentsUrl, { params: httpParams });\r\n  }\r\n\r\n  getEmployeesForSelection(branchId?: number): Observable<EmployeeSelectOption[]> {\r\n    let httpParams = new HttpParams()\r\n      .set('page', '1')\r\n      .set('pageSize', '1000')\r\n      .set('isActive', 'true');\r\n\r\n    if (branchId) {\r\n      httpParams = httpParams.set('branchId', branchId.toString());\r\n    }\r\n\r\n    return this.http.get<PagedResult<EmployeeDto>>(this.baseUrl, { params: httpParams })\r\n      .pipe(\r\n        map(result => result.items.map(emp => ({\r\n          id: emp.id,\r\n          name: emp.fullName,\r\n          employeeNumber: emp.employeeNumber\r\n        })))\r\n      );\r\n  }\r\n\r\n  getEmployeesDropdown(): Observable<Array<{id: number, name: string, employeeNumber: string}>> {\r\n    return this.http.get<Array<{id: number, name: string, employeeNumber: string}>>(`${this.baseUrl}/dropdown`);\r\n  }\r\n\r\n  getManagers(branchId?: number): Observable<EmployeeSelectOption[]> {\r\n    let httpParams = new HttpParams()\r\n      .set('page', '1')\r\n      .set('pageSize', '1000')\r\n      .set('isActive', 'true');\r\n\r\n    if (branchId) {\r\n      httpParams = httpParams.set('branchId', branchId.toString());\r\n    }\r\n\r\n    return this.http.get<PagedResult<EmployeeDto>>(this.baseUrl, { params: httpParams })\r\n      .pipe(\r\n        map(result => result.items.map(emp => ({\r\n          id: emp.id,\r\n          name: emp.fullName,\r\n          employeeNumber: emp.employeeNumber\r\n        })))\r\n      );\r\n  }\r\n\r\n  getRoles(): Observable<{id: number, name: string}[]> {\r\n    return this.http.get<{items: {id: number, name: string}[]}>(this.rolesUrl)\r\n      .pipe(\r\n        map(result => result.items || [])\r\n      );\r\n  }\r\n}"],
  "mappings": "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",
  "names": []
}
