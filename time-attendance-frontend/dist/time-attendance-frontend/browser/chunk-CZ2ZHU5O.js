import{a as L}from"./chunk-55A7GONC.js";import"./chunk-GBFD7MFB.js";import{a as _e}from"./chunk-JG2HLXEI.js";import{a as ye}from"./chunk-FG4PW2NX.js";import{a as fe}from"./chunk-5TOXFC3K.js";import{a as be,b as ve}from"./chunk-UKXLKVX5.js";import{a as pe}from"./chunk-NTMNSCJN.js";import{a as he}from"./chunk-LNNUMUW4.js";import{a as ge}from"./chunk-GNG6SBUX.js";import{a as ue}from"./chunk-4G2EQDXN.js";import{a as me}from"./chunk-4DSP56PF.js";import{c as te,d as ne,e as ae,f as ie,i as re,m as oe,n as le,o as se,p as R,r as P,w as ce,x as N,y as de}from"./chunk-OTKBQKTN.js";import{b as F}from"./chunk-NJ656CWW.js";import{$ as o,A as j,E as i,H as C,J as k,N as M,O as V,Ra as _,Sa as W,U as x,V as D,Y as z,Ya as Z,Z as U,Za as J,_ as u,aa as r,ba as f,eb as O,ia as E,ka as b,ma as g,mb as K,oa as G,pa as q,pb as X,qa as Y,ra as Q,sa as I,t as A,u as y,v as S,va as s,vb as ee,wa as h,xa as p,ya as w,z as d}from"./chunk-6T5SYK5O.js";import{a as H,b as $,d as B}from"./chunk-DGAILPFQ.js";function Ee(c,e){if(c&1&&(o(0,"div",39),f(1,"i",40),s(2),r()),c&2){let t=g(2);i(2),p(" ",t.errorMessage()," ")}}function Me(c,e){if(c&1&&(o(0,"option",41),s(1),r()),c&2){let t=e.$implicit,n=g(2);u("value",t.id),i(),w(" ",t.name," (",n.getShiftTimeDisplay(t),") ")}}function Ie(c,e){if(c&1&&(o(0,"div",42),s(1),r()),c&2){let t=g(2);i(),p(" ",t.i18n.t("attendance.change_shift.please_select_shift")||"Please select a shift."," ")}}function Ae(c,e){if(c&1){let t=E();o(0,"div")(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18),s(5),r()(),o(6,"div")(7,"h6",19),s(8),r(),o(9,"small",20),s(10),r()()()(),o(11,"div",21)(12,"label",22),s(13),r(),o(14,"div",23)(15,"div",24)(16,"div",25)(17,"div")(18,"strong"),s(19),r(),o(20,"div",26),s(21),r()(),o(22,"span",27),s(23),r()()()()(),M(24,Ee,3,1,"div",28),o(25,"form",29),b("ngSubmit",function(){y(t);let a=g();return S(a.onSubmit())}),o(26,"div",21)(27,"label",30),s(28),r(),o(29,"select",31)(30,"option",32),s(31),r(),M(32,Me,2,3,"option",33),r(),M(33,Ie,2,1,"div",34),r(),o(34,"div",21)(35,"label",35),s(36),r(),f(37,"textarea",36),r(),o(38,"div",37),f(39,"i",38),s(40),r()()()}if(c&2){let t,n,a=g();i(5),p(" ",a.getInitials(a.attendanceRecord.employeeName)," "),i(3),h(a.attendanceRecord.employeeName),i(2),w(" ",a.attendanceRecord.employeeNumber," \u2022 ",a.formatDate(a.attendanceRecord.attendanceDate)," "),i(3),h(a.i18n.t("attendance.change_shift.current_shift")||"Current Shift"),i(6),h(a.getCurrentShiftName()),i(2),p(" ",a.getCurrentShiftTime()," "),i(2),h(a.i18n.t("attendance.change_shift.current")||"Current"),i(),u("ngIf",a.errorMessage()),i(),u("formGroup",a.changeShiftForm),i(3),p(" ",a.i18n.t("attendance.change_shift.new_shift")||"New Shift"," * "),i(),I("is-invalid",((t=a.changeShiftForm.get("shiftId"))==null?null:t.invalid)&&((t=a.changeShiftForm.get("shiftId"))==null?null:t.touched)),i(2),h(a.i18n.t("attendance.change_shift.select_shift")||"Select a shift..."),i(),u("ngForOf",a.availableShifts()),i(),u("ngIf",((n=a.changeShiftForm.get("shiftId"))==null?null:n.invalid)&&((n=a.changeShiftForm.get("shiftId"))==null?null:n.touched)),i(3),h(a.i18n.t("attendance.change_shift.notes")||"Notes"),i(),u("placeholder",a.i18n.t("attendance.change_shift.notes_placeholder")||"Optional notes about this shift change..."),i(3),p(" ",a.i18n.t("attendance.change_shift.warning")||"Changing the shift will recalculate the attendance record based on the new shift schedule."," ")}}function we(c,e){c&1&&f(0,"span",43)}function Te(c,e){c&1&&f(0,"i",44)}function ke(c,e){if(c&1){let t=E();o(0,"div",45),b("click",function(){y(t);let a=g();return S(a.onClose())}),r()}}var T=class c{fb=A(ce);shiftsService=A(fe);shiftAssignmentService=A(L);i18n=A(F);show=!1;attendanceRecord=null;close=new V;shiftChanged=new V;availableShifts=d([]);currentShiftAssignment=d(null);currentShift=d(null);submitting=d(!1);errorMessage=d(null);changeShiftForm;constructor(){this.changeShiftForm=this.fb.group({shiftId:["",ne.required],notes:[""]})}ngOnInit(){this.show&&this.loadShifts()}ngOnChanges(){this.show&&this.attendanceRecord&&(this.loadShifts(),this.loadCurrentShiftAssignment(),this.resetForm())}loadShifts(){this.shiftsService.getActiveShifts().subscribe({next:e=>{this.availableShifts.set(e.items)},error:e=>{console.error("Failed to load shifts:",e),this.errorMessage.set("Failed to load available shifts. Please try again.")}})}loadCurrentShiftAssignment(){this.attendanceRecord?.employeeId&&this.shiftAssignmentService.getShiftAssignments({employeeId:this.attendanceRecord.employeeId,assignmentType:1,status:2,currentlyActive:!0,pageSize:1}).subscribe({next:e=>{if(e.items&&e.items.length>0){let t=e.items[0];this.currentShiftAssignment.set(t),this.loadCurrentShiftDetails(t.shiftId)}else this.currentShiftAssignment.set(null),this.currentShift.set(null)},error:e=>{console.error("Failed to load current shift assignment:",e),this.currentShiftAssignment.set(null),this.currentShift.set(null)}})}loadCurrentShiftDetails(e){this.shiftsService.getShiftById(e).subscribe({next:t=>{this.currentShift.set(t)},error:t=>{console.error("Failed to load current shift details:",t),this.currentShift.set(null)}})}resetForm(){this.changeShiftForm.reset({shiftId:"",notes:""}),this.clearError()}onSubmit(){if(this.changeShiftForm.invalid||!this.attendanceRecord)return;this.clearError(),this.submitting.set(!0);let e=this.changeShiftForm.value;this.shiftChanged.emit({attendanceRecord:this.attendanceRecord,shiftId:+e.shiftId,notes:e.notes||void 0})}onClose(){this.close.emit()}getInitials(e){if(!e)return"";let t=e.trim().split(" ");return t.length===1?t[0].charAt(0).toUpperCase():(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase()}resetSubmitting(){this.submitting.set(!1)}showError(e){this.errorMessage.set(e),this.submitting.set(!1)}clearError(){this.errorMessage.set(null)}getCurrentShiftName(){let e=this.currentShift(),t=this.currentShiftAssignment();return e?e.name:t?t.shiftName||"Unknown Shift":this.i18n.t("attendance.change_shift.no_shift_assigned")||"No shift assigned"}getCurrentShiftTime(){let e=this.currentShift();if(e){if(e.shiftType===1&&e.shiftPeriods&&e.shiftPeriods.length>0){let t=e.shiftPeriods[0],n=e.shiftPeriods[e.shiftPeriods.length-1];return`${t.startTime} - ${n.endTime}`}else if(e.shiftType===2&&e.requiredHours)return`${e.requiredHours} ${this.i18n.t("shifts.hours")||"hours"} required`}return this.attendanceRecord?.scheduledStartTime&&this.attendanceRecord?.scheduledEndTime?`${this.formatTime(this.attendanceRecord.scheduledStartTime)} - ${this.formatTime(this.attendanceRecord.scheduledEndTime)}`:this.i18n.t("attendance.change_shift.time_not_specified")||"Time not specified"}getShiftTimeDisplay(e){if(e.shiftPeriods&&e.shiftPeriods.length>0){let t=e.shiftPeriods[0],n=e.shiftPeriods[e.shiftPeriods.length-1];return`${t.startTime} - ${n.endTime}`}return"Time not specified"}formatDate(e){return new Date(e).toLocaleDateString()}formatTime(e){return e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}static \u0275fac=function(t){return new(t||c)};static \u0275cmp=k({type:c,selectors:[["app-change-attendance-shift-modal"]],inputs:{show:"show",attendanceRecord:"attendanceRecord"},outputs:{close:"close",shiftChanged:"shiftChanged"},features:[j],decls:18,vars:13,consts:[["tabindex","-1","role","dialog",1,"modal","fade","show"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-clock","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-save me-2",4,"ngIf"],["class","modal-backdrop fade show",3,"click",4,"ngIf"],[1,"alert","alert-info"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-initial","bg-primary","text-white","rounded-circle"],[1,"mb-1"],[1,"text-muted"],[1,"mb-3"],[1,"form-label"],[1,"card","bg-light"],[1,"card-body","py-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"small","text-muted"],[1,"badge","bg-light","text-dark","border"],["class","alert alert-danger",4,"ngIf"],[3,"ngSubmit","formGroup"],["for","shiftId",1,"form-label"],["id","shiftId","formControlName","shiftId",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["for","notes",1,"form-label"],["id","notes","rows","3","formControlName","notes",1,"form-control",3,"placeholder"],[1,"alert","alert-warning"],[1,"fas","fa-info-circle","me-2"],[1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle","me-2"],[3,"value"],[1,"invalid-feedback"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"],[1,"modal-backdrop","fade","show",3,"click"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),f(5,"i",5),s(6),r(),o(7,"button",6),b("click",function(){return n.onClose()}),r()(),o(8,"div",7),M(9,Ae,41,19,"div",8),r(),o(10,"div",9)(11,"button",10),b("click",function(){return n.onClose()}),s(12),r(),o(13,"button",11),b("click",function(){return n.onSubmit()}),M(14,we,1,0,"span",12)(15,Te,1,0,"i",13),s(16),r()()()()(),M(17,ke,1,0,"div",14)),t&2&&(Q("display",n.show?"block":"none"),I("d-block",n.show),i(6),p(" ",n.i18n.t("attendance.change_shift.title")||"Change Attendance Shift"," "),i(3),u("ngIf",n.attendanceRecord),i(2),u("disabled",n.submitting()),i(),p(" ",n.i18n.t("app.cancel")||"Cancel"," "),i(),u("disabled",n.changeShiftForm.invalid||n.submitting()),i(),u("ngIf",n.submitting()),i(),u("ngIf",!n.submitting()),i(),p(" ",n.submitting()?n.i18n.t("attendance.change_shift.changing")||"Changing...":n.i18n.t("attendance.change_shift.change_shift")||"Change Shift"," "),i(),u("ngIf",n.show))},dependencies:[O,Z,J,N,re,R,P,te,se,ae,ie,de,oe,le],styles:[".modal[_ngcontent-%COMP%]{z-index:1055}.modal-backdrop[_ngcontent-%COMP%]{z-index:1050}.avatar-sm[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}.avatar-initial[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:1rem;font-weight:600}"]})};var Oe=(c,e)=>e.value;function Re(c,e){if(c&1){let t=E();o(0,"div",11)(1,"div",46)(2,"div")(3,"h5",47),f(4,"i",48),s(5),r(),o(6,"small",49),s(7),r()()(),o(8,"div",13)(9,"div",50)(10,"div",51)(11,"label",16),s(12),r(),o(13,"input",17),b("change",function(a){y(t);let l=g();return S(l.onManualCalculationDateChange(a))}),r()(),o(14,"div",52)(15,"div",53)(16,"button",54),b("click",function(){y(t);let a=g();return S(a.generateMissingAttendanceForDate())}),f(17,"i",55),s(18),r(),o(19,"button",56),b("click",function(){y(t);let a=g();return S(a.forceRecalculateAllForDate())}),f(20,"i",55),s(21),r()(),o(22,"small",57),s(23),r()()()()()}if(c&2){let t=g();i(5),p(" ",t.i18n.t("attendance.manual_calculation.title")," "),i(2),h(t.i18n.t("attendance.manual_calculation.subtitle")),i(5),h(t.i18n.t("attendance.manual_calculation.select_date")),i(),u("value",t.manualCalculationDate())("disabled",t.calculatingBulk()),i(3),u("disabled",t.calculatingBulk())("title",t.i18n.t("attendance.manual_calculation.generate_missing_help")),i(),I("fa-plus",!t.calculatingBulk())("fa-spinner",t.calculatingBulk())("fa-spin",t.calculatingBulk()),i(),p("",t.i18n.t("attendance.manual_calculation.generate_missing")," "),i(),u("disabled",t.calculatingBulk())("title",t.i18n.t("attendance.manual_calculation.recalculate_all_help")),i(),I("fa-calculator",!t.calculatingBulk())("fa-spinner",t.calculatingBulk())("fa-spin",t.calculatingBulk()),i(),p("",t.i18n.t("attendance.manual_calculation.recalculate_all")," "),i(2),p(" ",t.i18n.t("attendance.manual_calculation.date_info").replace("{{date}}",t.manualCalculationDate())," ")}}function Pe(c,e){if(c&1&&(o(0,"option",21),s(1),r()),c&2){let t=e.$implicit,n=g();u("value",t.value===null?"":t.value),i(),p(" ",n.i18n.t(t.label)," ")}}function Ne(c,e){if(c&1&&(o(0,"div",40)(1,"div",58)(2,"span",59),s(3),r()(),o(4,"p",60),s(5),r()()),c&2){let t=g();i(3),h(t.i18n.t("app.loading")),i(2),h(t.i18n.t("attendance.messages.loading_data"))}}function Fe(c,e){if(c&1){let t=E();o(0,"button",64),b("click",function(){y(t);let a=g(2);return S(a.clearFilters())}),f(1,"i",65),s(2),r()}if(c&2){let t=g(2);u("title",t.i18n.t("attendance.actions.try_with_filter")),i(2),p(" ",t.i18n.t("attendance.actions.add_filter")," ")}}function Le(c,e){if(c&1&&(o(0,"div",41)(1,"div",61)(2,"div"),f(3,"i",62),s(4),r(),x(5,Fe,3,2,"button",63),r()()),c&2){let t=g();i(4),p(" ",t.error()," "),i(),D(t.hasActiveFilters()?-1:5)}}function Be(c,e){if(c&1&&(o(0,"div",42),f(1,"i",66),s(2),o(3,"strong",67),s(4),r(),o(5,"div",68)(6,"small",49),s(7),r()()()),c&2){let t=g();i(2),p(" ",t.i18n.t("attendance.hints.better_performance")," "),i(2),h(t.i18n.t("attendance.hints.use_filters")),i(3),p(" ",t.i18n.t("attendance.hints.filter_help")||"Please select a Branch, Department, or Employee to view attendance records for today."," ")}}function Ve(c,e){if(c&1){let t=E();o(0,"div",43)(1,"div",69)(2,"label",16),s(3),r(),o(4,"input",70),b("input",function(a){y(t);let l=g();return S(l.onSearchChange(a))}),r()()()}if(c&2){let t=g();i(3),h(t.i18n.t("attendance.filters.search")),i(),u("placeholder",t.i18n.t("attendance.filters.search_placeholder"))("disabled",t.loading())}}function He(c,e){if(c&1&&(o(0,"div",40),f(1,"i",75),o(2,"h5",49),s(3),r(),o(4,"p",49),s(5),r()()),c&2){let t=g(2);i(3),h(t.i18n.t("attendance.no_records")),i(2),h(t.i18n.t("attendance.no_records_description"))}}function $e(c,e){if(c&1){let t=E();o(0,"div")(1,"app-data-table",76),b("sortChange",function(a){y(t);let l=g(2);return S(l.onSort(a))})("actionClick",function(a){y(t);let l=g(2);return S(l.onActionClick(a))})("pageChange",function(a){y(t);let l=g(2);return S(l.onPageChange(a))})("pageSizeChange",function(a){y(t);let l=g(2);return S(l.onPageSizeChange(a))}),r()()}if(c&2){let t=g(2);i(),u("data",t.tableData())("columns",t.tableColumns())("actions",t.tableActions())("loading",t.loading)("showPagination",!0)("currentPage",t.currentPage)("totalPages",t.tableTotalPages)("totalItems",t.tableTotalItems)("pageSize",t.pageSize)("sortColumn",t.sortColumn)("sortDirection",t.sortDirection)("responsiveMode","horizontal-scroll")("emptyMessage",t.i18n.t("attendance.daily.no_records"))}}function je(c,e){if(c&1&&(o(0,"div",44)(1,"div",71)(2,"div",3)(3,"h5",4),f(4,"i",72),s(5),r(),o(6,"span",73),s(7),r()()(),o(8,"div",74),x(9,He,6,2,"div",40),x(10,$e,2,13,"div"),r()()),c&2){let t=g();i(5),p(" ",t.i18n.t("attendance.daily_records")," "),i(2),w("",t.filteredRecords().length," ",t.i18n.t("attendance.records")),i(2),D(t.filteredRecords().length===0?9:-1),i(),D(t.filteredRecords().length>0?10:-1)}}var Se=class c{constructor(e,t,n,a,l,m,v,ze,Ue,Ge){this.attendanceService=e;this.employeesService=t;this.departmentsService=n;this.branchesService=a;this.shiftAssignmentService=l;this.i18n=m;this.notificationService=v;this.confirmationService=ze;this.router=Ue;this.route=Ge;W(()=>{this.tableTotalPages.set(this.totalPages()),this.tableTotalItems.set(this.totalItems())})}attendanceRecords=d([]);selectedDate=d(new Date().toISOString().split("T")[0]);loading=d(!0);error=d(null);searchTerm=d("");selectedStatus=d(null);selectedEmployeeId=d(null);selectedDepartmentId=d(null);selectedBranchId=d(null);calculating=d(!1);calculatingBulk=d(!1);manualCalculationDate=d(new Date().toISOString().split("T")[0]);currentPage=d(1);pageSize=d(10);sortColumn=d("");sortDirection=d("asc");tableTotalPages=d(1);tableTotalItems=d(0);availableEmployees=d([]);availableDepartments=d([]);availableBranches=d([]);loadingEmployees=d(!1);loadingDepartments=d(!1);loadingBranches=d(!1);showChangeShiftModal=d(!1);selectedAttendanceRecord=d(null);changeShiftModalComponent;filteredRecords=_(()=>{let e=this.attendanceRecords(),t=this.searchTerm().toLowerCase(),n=this.selectedStatus();return e.filter(a=>{let l=!t||a.employeeName.toLowerCase().includes(t)||a.employeeNumber.toLowerCase().includes(t),m=n===null||a.status===n;return l&&m})});sortedRecords=_(()=>{let e=[...this.filteredRecords()],t=this.sortColumn(),n=this.sortDirection();return t?e.sort((a,l)=>{let m=this.getValueForSorting(a,t),v=this.getValueForSorting(l,t);return m==null&&v==null?0:m==null?n==="asc"?1:-1:v==null||(typeof m=="string"&&(m=m.toLowerCase()),typeof v=="string"&&(v=v.toLowerCase()),m<v)?n==="asc"?-1:1:m>v?n==="asc"?1:-1:0}):e});totalItems=_(()=>this.sortedRecords().length);totalPages=_(()=>Math.ceil(this.totalItems()/this.pageSize()));paginatedRecords=_(()=>{let e=this.sortedRecords(),t=this.currentPage(),n=this.pageSize(),a=(t-1)*n,l=a+n;return e.slice(a,l)});totalEmployees=_(()=>this.filteredRecords().length);presentEmployees=_(()=>this.filteredRecords().filter(e=>e.status===1).length);absentEmployees=_(()=>this.filteredRecords().filter(e=>e.status===2).length);lateEmployees=_(()=>this.filteredRecords().filter(e=>this.calculateTotalLateMinutes(e)>0).length);employeeSelectOptions=_(()=>{let e=[{value:null,label:this.i18n.t("attendance.filters.all_employees")}];return this.availableEmployees().forEach(t=>{e.push({value:t.id,label:t.name,subLabel:t.employeeNumber})}),e});departmentSelectOptions=_(()=>{let e=[{value:null,label:this.i18n.t("attendance.filters.all_departments")}];return this.availableDepartments().forEach(t=>{e.push({value:t.id,label:t.name,subLabel:t.nameAr||""})}),e});branchSelectOptions=_(()=>{let e=[{value:null,label:this.i18n.t("attendance.filters.all_branches")}];return this.availableBranches().forEach(t=>{e.push({value:t.id,label:t.name,subLabel:t.code})}),e});AttendanceStatus=ve;availableStatuses=[{value:null,label:"attendance.filters.all_statuses"},{value:1,label:"attendance.status.present"},{value:2,label:"attendance.status.absent"},{value:3,label:"attendance.status.late"},{value:4,label:"attendance.status.early_leave"},{value:5,label:"attendance.status.on_leave"},{value:7,label:"attendance.status.overtime"}];tableColumns=_(()=>[{key:"employeeNumber",label:this.i18n.t("attendance.fields.employee_number"),sortable:!0,width:"120px",priority:"high",mobileLabel:this.i18n.t("attendance.fields.emp_no")},{key:"employeeName",label:this.i18n.t("attendance.fields.employee_name"),sortable:!0,width:"200px",priority:"high",mobileLabel:this.i18n.t("attendance.fields.name")},{key:"status",label:this.i18n.t("attendance.fields.status"),sortable:!0,width:"120px",align:"center",priority:"high",mobileLabel:this.i18n.t("attendance.fields.status"),renderHtml:!0},{key:"checkIn",label:this.i18n.t("attendance.fields.check_in"),sortable:!1,width:"100px",align:"center",priority:"medium",mobileLabel:this.i18n.t("attendance.fields.in")},{key:"checkOut",label:this.i18n.t("attendance.fields.check_out"),sortable:!1,width:"100px",align:"center",priority:"medium",mobileLabel:this.i18n.t("attendance.fields.out")},{key:"workingHours",label:this.i18n.t("attendance.fields.working_hours"),sortable:!0,width:"120px",align:"center",priority:"medium",hideOnMobile:!1,mobileLabel:this.i18n.t("attendance.fields.work_hrs")},{key:"scheduledHours",label:this.i18n.t("attendance.fields.scheduled_hours"),sortable:!0,width:"120px",align:"center",priority:"low",hideOnMobile:!0,mobileLabel:this.i18n.t("attendance.fields.sched_hrs")},{key:"overtimeHours",label:this.i18n.t("attendance.fields.overtime_hours"),sortable:!0,width:"120px",align:"center",priority:"low",hideOnMobile:!0,mobileLabel:this.i18n.t("attendance.fields.overtime")},{key:"lateMinutes",label:this.i18n.t("attendance.fields.late_minutes"),sortable:!0,width:"90px",align:"center",priority:"low",hideOnMobile:!0,mobileLabel:this.i18n.t("attendance.fields.late")},{key:"earlyLeaveMinutes",label:this.i18n.t("attendance.fields.early_leave_minutes"),sortable:!0,width:"90px",align:"center",priority:"low",hideOnMobile:!0,mobileLabel:this.i18n.t("attendance.fields.early")},{key:"totalLateMinutes",label:this.i18n.t("attendance.fields.total_late"),sortable:!0,width:"90px",align:"center",priority:"medium",hideOnMobile:!1,mobileLabel:this.i18n.t("attendance.fields.total_late")}]);tableActions=_(()=>[{key:"view",label:this.i18n.t("attendance.actions.view_details"),icon:"fa-eye",color:"primary",condition:()=>!0},{key:"edit",label:this.i18n.t("attendance.actions.edit_record"),icon:"fa-edit",color:"secondary",condition:()=>!0},{key:"change-shift",label:this.i18n.t("attendance.actions.change_shift"),icon:"fa-clock",color:"warning",condition:()=>!0},{key:"recalculate",label:this.i18n.t("attendance.actions.recalculate"),icon:"fa-calculator",color:"info",condition:()=>!0}]);getAttendanceRatePercentage(){let e=this.filteredRecords(),t=e.length;if(t===0)return 0;let n=e.filter(a=>a.status===1||a.status===3||a.status===7).length;return Math.round(n/t*100)}ngOnInit(){this.route.queryParams.subscribe(e=>{let t=e.date;t&&(this.selectedDate.set(t),this.manualCalculationDate.set(t))}),this.loadFilterOptions(),this.checkInitialLoad()}checkInitialLoad(){this.loading.set(!0),this.error.set(null);let e=this.selectedDate();console.log("=== DEBUG: Initial load attempt ==="),console.log("Date:",e),this.attendanceService.getDailyAttendance(e).subscribe({next:t=>{console.log("=== DEBUG: Initial load successful ==="),console.log("Records count:",t.length),this.attendanceRecords.set(t),this.loading.set(!1)},error:t=>{if(console.log("=== DEBUG: Initial load failed (expected if filters required) ==="),console.log("Error:",t),t?.status===400&&(t?.error?.includes?.("filter")||t?.error?.includes?.("must be specified")))this.loading.set(!1),this.error.set(null),this.attendanceRecords.set([]);else{let n=this.getDetailedErrorMessage(t);this.error.set(n),this.loading.set(!1),this.notificationService.error(n)}}})}ngOnDestroy(){}loadDailyAttendance(){this.loading.set(!0),this.error.set(null);let e=this.selectedDate(),t=this.selectedBranchId(),n=this.selectedDepartmentId(),a=this.selectedEmployeeId();console.log("=== DEBUG: Loading daily attendance ==="),console.log("Date:",e),console.log("Branch ID:",t),console.log("Department ID:",n),console.log("Employee ID:",a),console.log("Current records before loading:",this.attendanceRecords().length),this.attendanceService.getDailyAttendance(e,t||void 0,n||void 0,a||void 0).subscribe({next:l=>{if(console.log("=== DEBUG: Received attendance records ==="),console.log("Records count:",l.length),console.log("Records data:",l),l.length>0){let m=l[0];console.log("=== DEBUG: First record time fields ==="),console.log("checkInTime:",m.checkInTime),console.log("checkOutTime:",m.checkOutTime),console.log("actualCheckInTime:",m.actualCheckInTime),console.log("actualCheckOutTime:",m.actualCheckOutTime),console.log("scheduledStartTime:",m.scheduledStartTime),console.log("scheduledEndTime:",m.scheduledEndTime)}this.attendanceRecords.set(l),this.loading.set(!1),console.log("Records after setting:",this.attendanceRecords().length),console.log("Filtered records count:",this.filteredRecords().length)},error:l=>{console.error("=== DEBUG: Error loading daily attendance ==="),console.error("Error object:",l),console.error("Error status:",l?.status),console.error("Error message:",l?.message),console.error("Error error:",l?.error);let m=this.getDetailedErrorMessage(l);this.error.set(m),this.loading.set(!1),this.notificationService.error(m)}})}onDateChange(e){let t=e.target;this.selectedDate.set(t.value),this.loadDailyAttendance()}onSearchChange(e){let t=e.target;this.searchTerm.set(t.value)}onStatusChange(e){let t=e.target,n=t.value===""?null:parseInt(t.value);this.selectedStatus.set(n)}onEmployeeSelectionChange(e){this.selectedEmployeeId.set(e),this.loadDailyAttendance(),e===null&&this.selectedBranchId()&&this.loadEmployeesForBranch(this.selectedBranchId())}onDepartmentSelectionChange(e){this.selectedDepartmentId.set(e),this.loadDailyAttendance()}onBranchSelectionChange(e){this.selectedBranchId.set(e),this.loadDailyAttendance(),this.selectedEmployeeId.set(null),e?this.loadEmployeesForBranch(e):this.loadEmployeesForBranch()}loadEmployeesForBranch(e){this.loadingEmployees.set(!0),this.employeesService.getEmployeesForSelection(e).subscribe({next:t=>{this.availableEmployees.set(t),this.loadingEmployees.set(!1)},error:t=>{console.error("Error loading employees for branch:",t),this.loadingEmployees.set(!1)}})}loadFilterOptions(){this.loadingEmployees.set(!0),this.employeesService.getEmployeesForSelection().subscribe({next:e=>{this.availableEmployees.set(e),this.loadingEmployees.set(!1)},error:e=>{console.error("Error loading employees:",e),this.loadingEmployees.set(!1)}}),this.loadingDepartments.set(!0),this.departmentsService.getDepartments({}).subscribe({next:e=>{this.availableDepartments.set(e),this.loadingDepartments.set(!1)},error:e=>{console.error("Error loading departments:",e),this.loadingDepartments.set(!1)}}),this.loadingBranches.set(!0),this.branchesService.getBranches(1,1e3).subscribe({next:e=>{this.availableBranches.set(e.items),this.loadingBranches.set(!1)},error:e=>{console.error("Error loading branches:",e),this.loadingBranches.set(!1)}})}getStatusBadgeClass(e){switch(e){case 1:return"badge bg-success";case 2:return"badge bg-danger";case 3:return"badge bg-warning";case 4:return"badge bg-warning";case 5:return"badge bg-info";case 6:return"badge bg-secondary";case 7:return"badge bg-primary";case 8:return"badge bg-danger";case 9:return"badge bg-secondary";case 10:return"badge bg-warning";default:return"badge bg-secondary"}}getStatusText(e){switch(e){case 1:return"attendance.status.present";case 2:return"attendance.status.absent";case 3:return"attendance.status.late";case 4:return"attendance.status.early_leave";case 5:return"attendance.status.on_leave";case 6:return"attendance.status.day_off";case 7:return"attendance.status.overtime";case 8:return"attendance.status.incomplete";case 9:return"attendance.status.holiday";case 10:return"attendance.status.sick_leave";case 11:return"attendance.status.pending";default:return"attendance.status.pending"}}formatTime(e){if(!e)return"--:--";try{let t=e;if(e.includes("T")&&(t=e.split("T")[1].split("Z")[0]),t.includes(":")){let n=new Date(`1970-01-01T${t}`);if(!isNaN(n.getTime()))return n.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}return t}catch{return e||"--:--"}}getCheckInTime(e){return e.checkInTime||e.actualCheckInTime||null}getCheckOutTime(e){return e.checkOutTime||e.actualCheckOutTime||null}formatHours(e){if(!e||e===0)return"0h 0m";let t=Math.floor(e),n=Math.round((e-t)*60);return t===0?`${n}m`:n===0?`${t}h`:`${t}h ${n}m`}formatLateTime(e){if(!e||e===0)return"--";let t=Math.floor(e/60),n=e%60;return t===0?`${n}m`:n===0?`${t}h`:`${t}h ${n}m`}calculateTotalLateMinutes(e){let t=e.lateMinutes||0,n=e.earlyLeaveMinutes||0;return t+n}formatStatusForTable(e){let t=this.i18n.t(this.getStatusText(e));return`<span class="${this.getStatusBadgeClass(e)}">${t}</span>`}getWorkingHoursClass(e,t){return!e||!t?"text-muted":e>=t?"text-success":e>=t*.8?"text-warning":"text-danger"}getLateTimeClass(e){return!e||e===0?"text-muted":e<=15?"text-warning":"text-danger"}viewDailyAttendanceDetail(e){this.router.navigate(["/attendance/daily-detail",e,this.selectedDate()])}viewEmployeeDetail(e){this.router.navigate(["/attendance/employee",e])}editAttendanceRecord(e){this.router.navigate(["/attendance/edit",e.id],{queryParams:{returnDate:this.selectedDate()}})}onSort(e){this.sortColumn.set(e.column),this.sortDirection.set(e.direction),this.currentPage.set(1)}onPageChange(e){this.currentPage.set(e)}onPageSizeChange(e){this.pageSize.set(e),this.currentPage.set(1)}getValueForSorting(e,t){switch(t){case"employeeNumber":return e.employeeNumber;case"employeeName":return e.employeeName;case"status":return e.status||0;case"workingHours":return e.workingHours||0;case"scheduledHours":return e.scheduledHours||0;case"lateMinutes":return e.lateMinutes||0;default:return e[t]}}onActionClick(e){let{action:t,item:n}=e;switch(t){case"view":this.viewDailyAttendanceDetail(n.employeeId);break;case"edit":this.editAttendanceRecord(n);break;case"change-shift":this.openChangeShiftModal(n);break;case"recalculate":this.recalculateEmployeeAttendance(n.employeeId);break;default:console.warn("Unknown action:",t)}}tableData=_(()=>this.paginatedRecords().map(e=>$(H({},e),{status:this.formatStatusForTable(e.status),checkIn:this.formatTime(this.getCheckInTime(e)),checkOut:this.formatTime(this.getCheckOutTime(e)),workingHours:this.formatHours(e.workingHours),scheduledHours:this.formatHours(e.scheduledHours),overtimeHours:this.formatHours(e.overtimeHours),lateMinutes:this.formatLateTime(e.lateMinutes),earlyLeaveMinutes:this.formatLateTime(e.earlyLeaveMinutes),totalLateMinutes:this.formatLateTime(this.calculateTotalLateMinutes(e))})));exportData(){let e=this.filteredRecords();if(e.length===0){this.notificationService.warning("No data to export");return}let t=this.generateCSV(e);this.downloadCSV(t,`daily-attendance-${this.selectedDate()}.csv`),this.notificationService.success("Data exported successfully")}generateCSV(e){let t=["Employee Number","Employee Name","Status","Check In","Check Out","Working Hours","Scheduled Hours","Overtime Hours","Late Minutes","Early Leave Minutes","Total Late"],n=e.map(a=>[a.employeeNumber,a.employeeName,this.i18n.t(this.getStatusText(a.status)),this.formatTime(this.getCheckInTime(a)),this.formatTime(this.getCheckOutTime(a)),this.formatHours(a.workingHours),this.formatHours(a.scheduledHours),this.formatHours(a.overtimeHours),this.formatLateTime(a.lateMinutes),this.formatLateTime(a.earlyLeaveMinutes),this.formatLateTime(this.calculateTotalLateMinutes(a))]);return[t,...n].map(a=>a.map(l=>`"${l}"`).join(",")).join(`
`)}downloadCSV(e,t){let n=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(a.download!==void 0){let l=URL.createObjectURL(n);a.setAttribute("href",l),a.setAttribute("download",t),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}}onRefresh(){this.loadDailyAttendance()}trackByEmployeeId(e,t){return t.employeeId}getDetailedErrorMessage(e){return e?.status===400?e?.error&&typeof e.error=="string"?e.error.includes("At least one filter")||e.error.includes("must be specified")?"To view attendance records, please select at least one filter: Employee, Department, or Branch. You can also contact your administrator if you need access to view all records.":e.error:"Please select at least one filter (Employee, Department, or Branch) to view attendance records.":e?.status===403?"You do not have permission to view attendance records. Please contact your administrator.":e?.status===404?"No attendance records found for the selected criteria.":e?.status===500?"Server error occurred while loading attendance records. Please try again or contact support.":e?.error&&typeof e.error=="string"?e.error:e?.message?e.message:"Failed to load daily attendance records. Please try again."}hasActiveFilters(){return!!(this.selectedEmployeeId()||this.selectedDepartmentId()||this.selectedBranchId())}clearFilters(){this.selectedEmployeeId.set(null),this.selectedDepartmentId.set(null),this.selectedBranchId.set(null),this.selectedStatus.set(null),this.searchTerm.set(""),document.querySelectorAll("select").forEach(n=>n.value="");let t=document.querySelector('input[type="text"]');t&&(t.value=""),this.loadEmployeesForBranch(),this.loadDailyAttendance()}recalculateEmployeeAttendance(e){return B(this,null,function*(){let t=this.selectedDate();(yield this.confirmationService.confirm({title:this.i18n.t("attendance.actions.recalculate"),message:this.i18n.t("attendance.confirmations.recalculate_employee"),confirmText:this.i18n.t("app.confirm"),cancelText:this.i18n.t("app.cancel"),confirmButtonClass:"btn-info",icon:"fa-calculator",iconClass:"text-info"})).confirmed&&(this.calculating.set(!0),this.attendanceService.calculateAttendanceForEmployeeDate(e,t).subscribe({next:a=>{let l=this.attendanceRecords(),m=l.findIndex(v=>v.employeeId===e);if(m!==-1){let v=[...l];v[m]=a,this.attendanceRecords.set(v)}this.calculating.set(!1),this.notificationService.success(this.i18n.t("attendance.messages.recalculation_success"))},error:a=>{console.error("Error recalculating attendance:",a),this.calculating.set(!1);let l="Failed to recalculate attendance";a?.error&&typeof a.error=="string"&&(l=a.error),this.notificationService.error(l)}}))})}calculateAllEmployees(e=!1){this.calculateAllEmployeesForDate(this.selectedDate(),e)}calculateAllEmployeesForDate(e,t=!1){return B(this,null,function*(){let n=t?this.i18n.t("attendance.actions.recalculate_all"):this.i18n.t("attendance.actions.generate_missing"),a=t?this.i18n.t("attendance.confirmations.recalculate_all").replace("{{date}}",e):this.i18n.t("attendance.confirmations.generate_missing").replace("{{date}}",e);(yield this.confirmationService.confirm({title:n,message:a,confirmText:this.i18n.t("app.confirm"),cancelText:this.i18n.t("app.cancel"),confirmButtonClass:t?"btn-warning":"btn-info",icon:t?"fa-calculator":"fa-plus",iconClass:t?"text-warning":"text-info"})).confirmed&&(this.calculatingBulk.set(!0),this.attendanceService.calculateAttendanceForDate(e,t).subscribe({next:m=>{this.calculatingBulk.set(!1);let v=this.i18n.t("attendance.messages.bulk_calculation_success").replace("{{generated}}",m.recordsGenerated.toString()).replace("{{updated}}",m.recordsUpdated.toString()).replace("{{date}}",e);this.notificationService.success(v),e===this.selectedDate()&&this.loadDailyAttendance()},error:m=>{console.error("Error calculating attendance for all employees:",m),this.calculatingBulk.set(!1);let v=this.i18n.t("attendance.messages.calculation_failed");m?.error&&typeof m.error=="string"&&(v=m.error),this.notificationService.error(v)}}))})}forceRecalculateAll(){this.calculateAllEmployees(!0)}generateMissingAttendance(){this.calculateAllEmployees(!1)}generateMissingAttendanceForDate(){this.calculateAllEmployeesForDate(this.manualCalculationDate(),!1)}forceRecalculateAllForDate(){this.calculateAllEmployeesForDate(this.manualCalculationDate(),!0)}onManualCalculationDateChange(e){let t=e.target;this.manualCalculationDate.set(t.value)}canManuallyCalculate(){return!0}hasIncompleteRecords(){return this.filteredRecords().some(e=>e.status===8||e.status===11)}getMissingRecordsInfo(){let e=this.availableEmployees().length,t=this.attendanceRecords().length,n=Math.max(0,e-t);return n>0?this.i18n.t("attendance.info.missing_records").replace("{{count}}",n.toString()):""}openChangeShiftModal(e){this.selectedAttendanceRecord.set(e),this.showChangeShiftModal.set(!0)}closeChangeShiftModal(){this.showChangeShiftModal.set(!1),this.selectedAttendanceRecord.set(null)}onAttendanceShiftChanged(e){this.attendanceService.changeAttendanceShift(e.attendanceRecord.id,e.shiftId,e.notes||"Shift changed from Daily Attendance").subscribe({next:t=>{this.notificationService.success(`Shift has been successfully changed for ${e.attendanceRecord.employeeName}. Attendance has been recalculated.`);let n=this.attendanceRecords(),a=n.findIndex(l=>l.id===e.attendanceRecord.id);if(a!==-1){let l=[...n];l[a]=t,this.attendanceRecords.set(l)}this.closeChangeShiftModal()},error:t=>{console.error("Failed to change shift:",t);let n="An unexpected error occurred while changing shift";if(t.error){if(typeof t.error=="string")n=t.error;else if(t.error.message)n=t.error.message;else if(t.error.title)n=t.error.title;else if(t.error.errors){let l=Object.values(t.error.errors)[0];Array.isArray(l)&&l.length>0&&(n=l[0])}}else t.message?n=t.message:t.status===0?n="Unable to connect to the server. Please check your connection.":t.status>=500?n="A server error occurred. Please try again later.":t.status===404?n="The attendance record was not found.":t.status===403?n="You do not have permission to change shifts.":t.status===401&&(n="Your session has expired. Please log in again.");let a=this.getModalComponent();a?a.showError(n):this.notificationService.error(n)}})}getModalComponent(){return this.changeShiftModalComponent}static \u0275fac=function(t){return new(t||c)(C(be),C(pe),C(ye),C(_e),C(L),C(F),C(me),C(ue),C(X),C(K))};static \u0275cmp=k({type:c,selectors:[["app-daily-attendance"]],viewQuery:function(t,n){if(t&1&&G(T,5),t&2){let a;q(a=Y())&&(n.changeShiftModalComponent=a.first)}},decls:93,vars:51,consts:[[1,"container-fluid","p-4"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click","disabled","title"],[1,"fa-solid","fa-filter-circle-xmark","me-2"],["type","button",1,"btn","btn-outline-primary","me-2",3,"click","disabled"],[1,"fa-solid","fa-refresh","me-2"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"fa-solid","fa-download","me-2"],[1,"card","mb-4","border-info"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-2"],[1,"form-label"],["type","date",1,"form-control",3,"change","value","disabled"],[3,"selectionChange","options","loading","disabled","placeholder","clearable","value"],[3,"selectionChange","options","loading","disabled","placeholder","clearable","searchable","value"],[1,"form-select",3,"change","disabled"],[3,"value"],[1,"col-md-3","mb-3"],[1,"card","stats-card","border-start","border-primary","border-4"],[1,"card-title","text-muted","small"],[1,"text-primary","mb-0"],[1,"icon-circle","bg-primary","bg-opacity-10"],[1,"fa-solid","fa-users","text-primary"],[1,"card","stats-card","border-start","border-success","border-4"],[1,"text-success","mb-0"],[1,"icon-circle","bg-success","bg-opacity-10"],[1,"fa-solid","fa-user-check","text-success"],[1,"card","stats-card","border-start","border-danger","border-4"],[1,"text-danger","mb-0"],[1,"icon-circle","bg-danger","bg-opacity-10"],[1,"fa-solid","fa-user-times","text-danger"],[1,"card","stats-card","border-start","border-warning","border-4"],[1,"text-warning","mb-0"],[1,"icon-circle","bg-warning","bg-opacity-10"],[1,"fa-solid","fa-clock","text-warning"],[1,"text-center","py-5"],[1,"alert","alert-danger"],[1,"alert","alert-info"],[1,"row","mb-3"],[1,"card"],[3,"close","shiftChanged","show","attendanceRecord"],[1,"card-header","bg-light"],[1,"mb-1"],[1,"fa-solid","fa-calculator","me-2","text-info"],[1,"text-muted"],[1,"row","align-items-end"],[1,"col-md-3"],[1,"col-md-9"],[1,"d-flex","gap-2"],["type","button",1,"btn","btn-info",3,"click","disabled","title"],[1,"fa-solid","me-2"],["type","button",1,"btn","btn-warning",3,"click","disabled","title"],[1,"text-muted","mt-1","d-block"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2","text-muted"],[1,"d-flex","justify-content-between","align-items-start"],[1,"fa-solid","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-outline-danger","btn-sm","ms-2",3,"title"],["type","button",1,"btn","btn-outline-danger","btn-sm","ms-2",3,"click","title"],[1,"fa-solid","fa-filter","me-1"],[1,"fa-solid","fa-info-circle","me-2"],[1,"ms-1"],[1,"mt-2"],[1,"col-md-6"],["type","text",1,"form-control",3,"input","placeholder","disabled"],[1,"card-header"],[1,"fa-solid","fa-calendar-check","me-2"],[1,"badge","bg-primary"],[1,"card-body","p-0"],[1,"fa-solid","fa-calendar-xmark","fa-3x","text-muted","mb-3"],[1,"table-hover",3,"sortChange","actionClick","pageChange","pageSizeChange","data","columns","actions","loading","showPagination","currentPage","totalPages","totalItems","pageSize","sortColumn","sortDirection","responsiveMode","emptyMessage"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),s(5),r(),o(6,"div")(7,"button",5),b("click",function(){return n.clearFilters()}),f(8,"i",6),s(9),r(),o(10,"button",7),b("click",function(){return n.onRefresh()}),f(11,"i",8),s(12),r(),o(13,"button",9),b("click",function(){return n.exportData()}),f(14,"i",10),s(15),r()()()()(),x(16,Re,24,24,"div",11),o(17,"div",12)(18,"div",13)(19,"div",14)(20,"div",15)(21,"label",16),s(22),r(),o(23,"input",17),b("change",function(l){return n.onDateChange(l)}),r()(),o(24,"div",15)(25,"label",16),s(26),r(),o(27,"app-searchable-select",18),b("selectionChange",function(l){return n.onBranchSelectionChange(l)}),r()(),o(28,"div",15)(29,"label",16),s(30),r(),o(31,"app-searchable-select",18),b("selectionChange",function(l){return n.onDepartmentSelectionChange(l)}),r()(),o(32,"div",15)(33,"label",16),s(34),r(),o(35,"app-searchable-select",19),b("selectionChange",function(l){return n.onEmployeeSelectionChange(l)}),r()(),o(36,"div",15)(37,"label",16),s(38),r(),o(39,"select",20),b("change",function(l){return n.onStatusChange(l)}),z(40,Pe,2,2,"option",21,Oe),r()()()()(),o(42,"div",1)(43,"div",22)(44,"div",23)(45,"div",13)(46,"div",3)(47,"div")(48,"h6",24),s(49),r(),o(50,"h3",25),s(51),r()(),o(52,"div",26),f(53,"i",27),r()()()()(),o(54,"div",22)(55,"div",28)(56,"div",13)(57,"div",3)(58,"div")(59,"h6",24),s(60),r(),o(61,"h3",29),s(62),r()(),o(63,"div",30),f(64,"i",31),r()()()()(),o(65,"div",22)(66,"div",32)(67,"div",13)(68,"div",3)(69,"div")(70,"h6",24),s(71),r(),o(72,"h3",33),s(73),r()(),o(74,"div",34),f(75,"i",35),r()()()()(),o(76,"div",22)(77,"div",36)(78,"div",13)(79,"div",3)(80,"div")(81,"h6",24),s(82),r(),o(83,"h3",37),s(84),r()(),o(85,"div",38),f(86,"i",39),r()()()()()(),x(87,Ne,6,2,"div",40),x(88,Le,6,2,"div",41),x(89,Be,8,3,"div",42),x(90,Ve,5,3,"div",43),x(91,je,11,5,"div",44),o(92,"app-change-attendance-shift-modal",45),b("close",function(){return n.closeChangeShiftModal()})("shiftChanged",function(l){return n.onAttendanceShiftChanged(l)}),r()()),t&2&&(i(5),h(n.i18n.t("attendance.daily_view")),i(2),u("disabled",n.loading()||!n.hasActiveFilters())("title",n.i18n.t("attendance.actions.clear_filters")),i(2),p("",n.i18n.t("attendance.actions.clear_filters")," "),i(),u("disabled",n.loading()),i(2),p("",n.i18n.t("app.refresh")," "),i(),u("disabled",n.loading()||n.filteredRecords().length===0),i(2),p("",n.i18n.t("attendance.actions.export_data")," "),i(),D(n.canManuallyCalculate()?16:-1),i(6),h(n.i18n.t("attendance.filters.date")),i(),u("value",n.selectedDate())("disabled",n.loading()),i(3),h(n.i18n.t("attendance.filters.branch")),i(),u("options",n.branchSelectOptions())("loading",n.loadingBranches())("disabled",n.loading())("placeholder",n.i18n.t("attendance.filters.all_branches"))("clearable",!0)("value",n.selectedBranchId()),i(3),h(n.i18n.t("attendance.filters.department")),i(),u("options",n.departmentSelectOptions())("loading",n.loadingDepartments())("disabled",n.loading())("placeholder",n.i18n.t("attendance.filters.all_departments"))("clearable",!0)("value",n.selectedDepartmentId()),i(3),h(n.i18n.t("attendance.filters.employee")),i(),u("options",n.employeeSelectOptions())("loading",n.loadingEmployees())("disabled",n.loading())("placeholder",n.i18n.t("attendance.filters.all_employees"))("clearable",!0)("searchable",!0)("value",n.selectedEmployeeId()),i(3),h(n.i18n.t("attendance.filters.status")),i(),u("disabled",n.loading()),i(),U(n.availableStatuses),i(9),h(n.i18n.t("attendance.statistics.total_employees")),i(2),h(n.totalEmployees()),i(9),h(n.i18n.t("attendance.statistics.present_employees")),i(2),h(n.presentEmployees()),i(9),h(n.i18n.t("attendance.statistics.absent_employees")),i(2),h(n.absentEmployees()),i(9),h(n.i18n.t("attendance.statistics.late_employees")),i(2),h(n.lateEmployees()),i(3),D(n.loading()?87:-1),i(),D(n.error()?88:-1),i(),D(!n.loading()&&!n.error()&&n.filteredRecords().length===0&&!n.hasActiveFilters()?89:-1),i(),D(!n.loading()&&!n.error()?90:-1),i(),D(!n.loading()&&!n.error()?91:-1),i(),u("show",n.showChangeShiftModal())("attendanceRecord",n.selectedAttendanceRecord()))},dependencies:[O,N,R,P,ee,he,ge,T],styles:['.daily-attendance[_ngcontent-%COMP%]{padding:1.5rem;min-height:calc(100vh - 120px);background:linear-gradient(135deg,#f8f9fa,#e9ecef);font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.page-title[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600;margin-bottom:.5rem}.stats-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--bs-primary),var(--bs-info));opacity:0;transition:opacity .3s ease}.stats-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px) scale(1.02)}.stats-card[_ngcontent-%COMP%]:hover:before{opacity:1}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .3s ease;border-left:3px solid transparent}.table-hover[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#f8f9ff,#fff);border-left-color:#0d6efd;transform:translate(2px);box-shadow:0 2px 8px #0d6efd1a}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef)}.btn[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.4),transparent);transition:left .5s}.btn[_ngcontent-%COMP%]:hover:before{left:100%}.card-header[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:0;left:1.75rem;right:1.75rem;height:2px;background:linear-gradient(90deg,var(--bs-primary),var(--bs-info));border-radius:1px}.border-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1987540d,#fff)}.border-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dc35450d,#fff)}.border-warning[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fd7e140d,#fff)}.border-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0dcaf00d,#fff)}.border-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0d6efd0d,#fff)}.border-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6c757d0d,#fff)}@media (max-width: 768px){.daily-attendance[_ngcontent-%COMP%]{padding:1rem;background:linear-gradient(135deg,#f8f9fa,#fff)}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;text-align:center}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem;align-items:center}.stats-card[_ngcontent-%COMP%]   .d-flex[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:.5rem}.stats-card[_ngcontent-%COMP%]   .icon-circle[_ngcontent-%COMP%]{margin:0 auto .75rem;width:56px;height:56px}.table-responsive[_ngcontent-%COMP%]{margin:0 -.5rem}.card-header[_ngcontent-%COMP%]{padding:1rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.25rem}}']})};export{Se as DailyAttendanceComponent};
