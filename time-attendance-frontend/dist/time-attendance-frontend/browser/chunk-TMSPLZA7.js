import{a as N}from"./chunk-B7JUHE5X.js";import{a as z}from"./chunk-QIFMF2AZ.js";import{a as V}from"./chunk-NPDCAEA6.js";import{a as L}from"./chunk-H5EPUHY6.js";import"./chunk-VRETN7JA.js";import{a as E}from"./chunk-GRQ6RO47.js";import{a as I}from"./chunk-UBCI4X5Q.js";import{a as A}from"./chunk-EYAJMHM7.js";import{a as P}from"./chunk-HHXRLUSQ.js";import{b as O}from"./chunk-RUY4WPQA.js";import{g as M}from"./chunk-TWXUAMJ4.js";import{Bb as m,Cb as S,Db as f,Ea as x,Ia as w,R as d,Ub as D,W as b,X as C,Xa as p,Ya as u,Yb as T,bb as l,cb as a,da as k,db as s,eb as g,lb as h,nb as _,pb as r,ta as i,wc as W,yb as q}from"./chunk-JSQL33QG.js";import{a as v,b as R,d as y}from"./chunk-DGAILPFQ.js";function H(o,e){if(o&1&&g(0,"app-loading-spinner",7),o&2){let t=r();l("message",t.i18n.t("common.loading"))}}function j(o,e){if(o&1){let t=h();a(0,"div",8),g(1,"i",12),m(2),a(3,"button",13),_("click",function(){b(t);let c=r();return C(c.refresh())}),m(4),s()()}if(o&2){let t=r();i(2),f(" ",t.error()," "),i(2),f(" ",t.i18n.t("common.retry")," ")}}function B(o,e){if(o&1){let t=h();a(0,"app-empty-state",14),_("action",function(){b(t);let c=r();return C(c.createRequest())}),s()}if(o&2){let t=r();l("title",t.i18n.t("portal.no_remote_work"))("message",t.i18n.t("portal.no_remote_work_message"))("actionText",t.i18n.t("portal.request_remote_work"))}}function $(o,e){if(o&1){let t=h();a(0,"app-table-actions",17),_("actionClick",function(c){b(t);let F=r(2);return C(F.onActionClick(c))}),s()}if(o&2){let t=e.$implicit,n=r(2);l("actions",n.actions)("item",t)}}function Y(o,e){if(o&1&&(a(0,"div",10)(1,"div",15)(2,"app-data-table",16),w(3,$,1,2,"ng-template",null,0,D),s()()()),o&2){let t=r();i(2),l("data",t.tableData())("columns",t.columns)("loading",t.loading())("pageSize",10)}}function G(o,e){if(o&1&&(a(0,"div",11)(1,"div",15)(2,"div",18),g(3,"i",19),a(4,"div")(5,"h6",20),m(6),s(),a(7,"p",21),m(8),s()()()()()),o&2){let t=r();i(6),S(t.i18n.t("portal.remote_work_info_title")),i(2),f(" ",t.i18n.t("portal.remote_work_info_text")," ")}}var U=class o{i18n=d(O);router=d(M);notificationService=d(P);confirmationService=d(L);remoteWorkService=d(N);requests=k([]);loading=k(!1);error=k(null);columns=[{key:"startDate",label:"Start Date",sortable:!0},{key:"endDate",label:"End Date",sortable:!0},{key:"workingDaysCount",label:"Days",sortable:!0},{key:"reason",label:"Reason",sortable:!1},{key:"status",label:"Status",sortable:!0,renderHtml:!0},{key:"createdAtUtc",label:"Requested",sortable:!0},{key:"actions",label:"Actions",sortable:!1}];actions=[{id:"view",label:"View",icon:"fa-eye",variant:"primary"},{id:"cancel",label:"Cancel",icon:"fa-times",variant:"danger",visible:e=>e.status===0}];tableData=T(()=>this.requests().map(e=>R(v({},e),{startDate:this.formatDate(e.startDate),endDate:this.formatDate(e.endDate),workingDaysCount:`${e.workingDaysCount} days`,status:this.getStatusBadgeHtml(e),createdAtUtc:this.formatDateTime(e.createdAtUtc),actions:e})));ngOnInit(){this.loadRequests()}loadRequests(){this.loading.set(!0),this.error.set(null),this.remoteWorkService.getAll().subscribe({next:e=>{this.requests.set(e),this.loading.set(!1)},error:e=>{console.error("Failed to load remote work requests:",e),this.error.set("Failed to load remote work requests"),this.notificationService.error(this.i18n.t("portal.failed_to_load_remote_work")),this.loading.set(!1)}})}onActionClick(e){let t=e.item;switch(e.action.id){case"view":this.viewRequest(t);break;case"cancel":this.cancelRequest(t);break}}viewRequest(e){this.router.navigate(["/portal/remote-work-requests",e.id])}createRequest(){this.router.navigate(["/portal/remote-work-requests","new"])}cancelRequest(e){return y(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("portal.cancel_remote_work"),message:this.i18n.t("portal.cancel_remote_work_confirm"),confirmText:this.i18n.t("common.yes_cancel"),cancelText:this.i18n.t("common.no"),confirmButtonClass:"btn-danger",icon:"fa-times",iconClass:"text-danger"})).confirmed&&(this.loading.set(!0),this.remoteWorkService.cancel(e.id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("portal.remote_work_cancelled")),this.loadRequests()},error:n=>{console.error("Failed to cancel request:",n),this.notificationService.error(this.i18n.t("portal.failed_to_cancel_remote_work")),this.loading.set(!1)}}))})}refresh(){this.loadRequests()}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}formatDateTime(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}getStatusBadgeHtml(e){switch(e.status){case 0:return'<span class="badge bg-warning">Pending</span>';case 1:return'<span class="badge bg-success">Approved</span>';case 2:return'<span class="badge bg-danger">Rejected</span>';case 3:return'<span class="badge bg-secondary">Cancelled</span>';default:return`<span class="badge bg-secondary">${e.status}</span>`}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=x({type:o,selectors:[["app-remote-work-requests-list"]],decls:13,vars:12,consts:[["actionsTemplate",""],[3,"title"],["header-actions",""],["type","button",1,"btn","btn-primary","btn-sm","me-2",3,"click","disabled"],[1,"fa-solid","fa-plus","me-1"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click","disabled"],[1,"fa-solid","fa-sync-alt"],[3,"message"],["role","alert",1,"alert","alert-danger"],["icon","fa-solid fa-home",3,"title","message","actionText"],[1,"card"],[1,"card","mt-3"],[1,"fa-solid","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-3",3,"click"],["icon","fa-solid fa-home",3,"action","title","message","actionText"],[1,"card-body"],[3,"data","columns","loading","pageSize"],[3,"actionClick","actions","item"],[1,"d-flex","align-items-start"],[1,"fa-solid","fa-info-circle","text-info","me-3","mt-1",2,"font-size","1.5rem"],[1,"mb-2"],[1,"text-muted","mb-0","small"]],template:function(t,n){t&1&&(a(0,"app-page-header",1)(1,"div",2)(2,"button",3),_("click",function(){return n.createRequest()}),g(3,"i",4),m(4),s(),a(5,"button",5),_("click",function(){return n.refresh()}),g(6,"i",6),m(7),s()()(),p(8,H,1,1,"app-loading-spinner",7),p(9,j,5,2,"div",8),p(10,B,1,3,"app-empty-state",9),p(11,Y,5,4,"div",10),p(12,G,9,2,"div",11)),t&2&&(l("title",n.i18n.t("portal.remote_work_requests")),i(2),l("disabled",n.loading()),i(2),f(" ",n.i18n.t("portal.new_remote_work")," "),i(),l("disabled",n.loading()),i(),q("fa-spin",n.loading()),i(),f(" ",n.i18n.t("common.refresh")," "),i(),u(n.loading()&&n.requests().length===0?8:-1),i(),u(n.error()&&n.requests().length===0?9:-1),i(),u(!n.loading()&&n.requests().length===0&&!n.error()?10:-1),i(),u(n.requests().length>0?11:-1),i(),u(n.requests().length>0?12:-1))},dependencies:[W,V,z,E,A,I],styles:[".card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid var(--bs-border-color)}.card-body[_ngcontent-%COMP%]{padding:1.5rem}[_nghost-%COMP%]     .data-table{width:100%}[_nghost-%COMP%]     .data-table th{background-color:var(--bs-light);font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px;color:var(--bs-secondary);border-bottom:2px solid var(--bs-border-color)}[_nghost-%COMP%]     .data-table td{vertical-align:middle;font-size:.9rem}[_nghost-%COMP%]     .data-table tbody tr:hover{background-color:var(--bs-light);cursor:pointer;transition:background-color .2s ease}[_nghost-%COMP%]     .badge{font-size:.75rem;padding:.35rem .65rem;font-weight:600}.card[_ngcontent-%COMP%]   .fa-info-circle[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){[_nghost-%COMP%]     .data-table{font-size:.85rem}[_nghost-%COMP%]     .data-table th, [_nghost-%COMP%]     .data-table td{padding:.5rem}.card-body[_ngcontent-%COMP%]{padding:1rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"]})};export{U as RemoteWorkRequestsListComponent};
