import{a as re,b as se}from"./chunk-GBFD7MFB.js";import{a as ne}from"./chunk-QS4HD2YC.js";import{a as ie}from"./chunk-VVO5HLLI.js";import{a as te}from"./chunk-SRPEDAT4.js";import{a as oe}from"./chunk-6YOSOA3I.js";import"./chunk-5MHFUEKN.js";import"./chunk-Y62N6K5S.js";import{b as R,c as L,e as D,f as G,g as U,h as j,i as z,j as J,k as K,s as Q,t as X,u as Y,v as Z,x as $}from"./chunk-VRETN7JA.js";import"./chunk-O7LPL3AF.js";import{b as ee}from"./chunk-3VZ5QHEY.js";import{d as A,g as N}from"./chunk-TWXUAMJ4.js";import{$a as E,Bb as a,Cb as m,Db as y,Ea as H,Eb as V,Ib as u,Jb as p,Kb as g,Lb as k,Pb as q,R as M,W as f,X as c,Xa as x,Ya as C,Za as P,_a as I,ab as W,bb as _,cb as o,da as w,db as r,eb as F,lb as b,nb as S,nc as B,pb as l,ta as n,wc as O}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";var me=()=>({standalone:!0});function fe(h,i){if(h&1&&(o(0,"div",5)(1,"div",7)(2,"div",8)(3,"span",9),a(4),r()(),o(5,"div",10),a(6),r()()()),h&2){let e=l();n(4),m(e.t("common.loading")),n(2),m(e.t("shifts.loading.shift"))}}function ce(h,i){if(h&1){let e=b();o(0,"div",15)(1,"label",67),a(2),o(3,"span",17),a(4,"*"),r()(),o(5,"div",56)(6,"input",68),g("ngModelChange",function(t){f(e);let s=l(2);return p(s.shiftForm.requiredHours,t)||(s.shiftForm.requiredHours=t),c(t)}),r(),o(7,"span",58),a(8),r()(),o(9,"div",54),a(10),r()()}if(h&2){let e=l(2);n(2),y(" ",e.t("shifts.requiredHours")," "),n(4),u("ngModel",e.shiftForm.requiredHours),n(2),m(e.t("shifts.hours")),n(2),m(e.t("shifts.help.requiredHours"))}}function ue(h,i){if(h&1){let e=b();o(0,"button",74),S("click",function(){f(e);let t=l(3);return c(t.addShiftPeriod())}),F(1,"i",75),a(2),r()}if(h&2){let e=l(3);n(2),y("",e.t("shifts.addPeriod")," ")}}function pe(h,i){if(h&1){let e=b();o(0,"button",84),S("click",function(){f(e);let t=l().$index,s=l(3);return c(s.removeShiftPeriod(t))}),F(1,"i",85),r()}}function ge(h,i){if(h&1){let e=b();o(0,"div",71)(1,"div",76)(2,"span",28),a(3),r(),o(4,"div",77)(5,"span",78),a(6),r(),o(7,"span",79),a(8),r(),x(9,pe,2,0,"button",80),r()(),o(10,"div",81)(11,"div",2)(12,"div",24)(13,"label",82),a(14),r(),o(15,"input",83),g("ngModelChange",function(t){let s=f(e).$implicit;return p(s.startTime,t)||(s.startTime=t),c(t)}),r()(),o(16,"div",24)(17,"label",82),a(18),r(),o(19,"input",83),g("ngModelChange",function(t){let s=f(e).$implicit;return p(s.endTime,t)||(s.endTime=t),c(t)}),r()()()()()}if(h&2){let e=i.$implicit,d=i.$index,t=l(3);n(3),V("",t.t("shifts.period")," ",e.periodOrder),n(2),_("ngClass",t.isNightShift(e.startTime,e.endTime)?"bg-info":"bg-primary"),n(),y(" ",t.getPeriodTypeText(e)," "),n(2),m(t.formatHours(t.calculatePeriodHours(e.startTime,e.endTime))),n(),C(t.shiftForm.shiftPeriods.length>1?9:-1),n(5),m(t.t("shifts.startTime")),n(),u("ngModel",e.startTime),_("name","startTime_"+d),n(3),m(t.t("shifts.endTime")),n(),u("ngModel",e.endTime),_("name","endTime_"+d)}}function _e(h,i){if(h&1&&(o(0,"app-form-section",13)(1,"div",14)(2,"div",3)(3,"div",69),x(4,ue,3,1,"button",70),r(),E(5,ge,20,12,"div",71,P),o(7,"div",72),F(8,"i",73),o(9,"span"),a(10),o(11,"strong"),a(12),r()()()()()()),h&2){let e=l(2);_("title",e.t("shifts.periods")),n(4),C(e.shiftForm.shiftPeriods.length<2?4:-1),n(),W(e.shiftForm.shiftPeriods),n(5),y("",e.t("shifts.totalHours"),": "),n(2),m(e.formatHours(e.getTotalShiftHours()))}}function ye(h,i){if(h&1){let e=b();o(0,"div",15)(1,"label",86),a(2),o(3,"span",17),a(4,"*"),r()(),o(5,"input",87),g("ngModelChange",function(t){f(e);let s=l(2);return p(s.shiftForm.coreStart,t)||(s.shiftForm.coreStart=t),c(t)}),r()(),o(6,"div",15)(7,"label",88),a(8),o(9,"span",17),a(10,"*"),r()(),o(11,"input",89),g("ngModelChange",function(t){f(e);let s=l(2);return p(s.shiftForm.coreEnd,t)||(s.shiftForm.coreEnd=t),c(t)}),r()()}if(h&2){let e=l(2);n(2),y(" ",e.t("shifts.coreStart")," "),n(3),u("ngModel",e.shiftForm.coreStart),n(3),y(" ",e.t("shifts.coreEnd")," "),n(3),u("ngModel",e.shiftForm.coreEnd)}}function xe(h,i){if(h&1){let e=b();o(0,"div",15)(1,"label",94),a(2),r(),o(3,"div",56)(4,"input",95),g("ngModelChange",function(t){f(e);let s=l(3);return p(s.shiftForm.flexMinutesBefore,t)||(s.shiftForm.flexMinutesBefore=t),c(t)}),r(),o(5,"span",58),a(6),r()(),o(7,"div",54),a(8),r()(),o(9,"div",15)(10,"label",96),a(11),r(),o(12,"div",56)(13,"input",97),g("ngModelChange",function(t){f(e);let s=l(3);return p(s.shiftForm.flexMinutesAfter,t)||(s.shiftForm.flexMinutesAfter=t),c(t)}),r(),o(14,"span",58),a(15),r()(),o(16,"div",54),a(17),r()()}if(h&2){let e=l(3);n(2),m(e.t("shifts.flexMinutesBefore")),n(2),u("ngModel",e.shiftForm.flexMinutesBefore),n(2),m(e.t("common.minutes")),n(2),m(e.t("shifts.help.flexBefore")),n(3),m(e.t("shifts.flexMinutesAfter")),n(2),u("ngModel",e.shiftForm.flexMinutesAfter),n(2),m(e.t("common.minutes")),n(2),m(e.t("shifts.help.flexAfter"))}}function Ce(h,i){if(h&1){let e=b();o(0,"div",15)(1,"label",90),a(2),r(),o(3,"div",56)(4,"input",91),g("ngModelChange",function(t){f(e);let s=l(2);return p(s.shiftForm.gracePeriodMinutes,t)||(s.shiftForm.gracePeriodMinutes=t),c(t)}),S("ngModelChange",function(){f(e);let t=l(2);return c(t.onGracePeriodChange())}),r(),o(5,"span",58),a(6),r()(),o(7,"div",54),a(8),r()(),o(9,"div",21)(10,"div",51)(11,"input",92),g("ngModelChange",function(t){f(e);let s=l(2);return p(s.shiftForm.allowFlexibleHours,t)||(s.shiftForm.allowFlexibleHours=t),c(t)}),S("change",function(){f(e);let t=l(2);return c(t.onFlexibleHoursChange())}),r(),o(12,"label",93),a(13),r()(),o(14,"div",54),a(15),r()(),x(16,xe,18,8)}if(h&2){let e=l(2);n(2),m(e.t("shifts.gracePeriodMinutes")),n(2),u("ngModel",e.shiftForm.gracePeriodMinutes),n(2),m(e.t("common.minutes")),n(2),m(e.t("shifts.help.gracePeriod")),n(3),u("ngModel",e.shiftForm.allowFlexibleHours),n(2),y(" ",e.t("shifts.allowFlexibleHours")," "),n(2),m(e.t("shifts.help.flexibleHours")),n(),C(e.shiftForm.allowFlexibleHours?16:-1)}}function Se(h,i){if(h&1&&(o(0,"div",102),a(1),r()),h&2){let e=i.$implicit;n(),y("\u2022 ",e)}}function Fe(h,i){if(h&1&&(o(0,"div",14)(1,"div",3)(2,"div",98)(3,"div",99),F(4,"i",100),o(5,"div")(6,"h6",101),a(7),r(),E(8,Se,2,1,"div",102,I),r()()()()()),h&2){let e=l(2);n(7),m(e.t("common.validationErrors")),n(),W(e.getFormErrors())}}function be(h,i){if(h&1&&(F(0,"span",103),a(1)),h&2){let e=l(2);n(),y(" ",e.t("shifts.loading.updating")," ")}}function ve(h,i){if(h&1&&(F(0,"i",104),a(1)),h&2){let e=l(2);n(),y("",e.t("shifts.update")," ")}}function Me(h,i){if(h&1){let e=b();o(0,"div",6)(1,"div",11)(2,"form",12,0),S("ngSubmit",function(){f(e);let t=l();return c(t.onSubmit())}),o(4,"app-form-section",13)(5,"div",14)(6,"div",15)(7,"label",16),a(8),o(9,"span",17),a(10,"*"),r()(),o(11,"input",18),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.name,t)||(s.shiftForm.name=t),c(t)}),r()(),o(12,"div",15)(13,"label",19),a(14),r(),o(15,"app-searchable-select",20),S("selectionChange",function(t){f(e);let s=l();return c(s.onStatusSelectionChange(t))}),r()(),o(16,"div",21)(17,"label",22),a(18),r(),o(19,"textarea",23),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.description,t)||(s.shiftForm.description=t),c(t)}),r()()()(),o(20,"app-form-section",13)(21,"div",14)(22,"div",21)(23,"div",2)(24,"div",24)(25,"div",25)(26,"input",26),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.shiftType,t)||(s.shiftForm.shiftType=t),c(t)}),S("change",function(){f(e);let t=l();return c(t.onShiftTypeChange())}),r(),o(27,"label",27)(28,"div",28),a(29),r(),o(30,"small",29),a(31),r()()()(),o(32,"div",24)(33,"div",25)(34,"input",30),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.shiftType,t)||(s.shiftForm.shiftType=t),c(t)}),S("change",function(){f(e);let t=l();return c(t.onShiftTypeChange())}),r(),o(35,"label",31)(36,"div",28),a(37),r(),o(38,"small",29),a(39),r()()()()()(),x(40,ce,11,4,"div",15),r()(),o(41,"app-form-section",13)(42,"div",14)(43,"div",21)(44,"div",2)(45,"div",32)(46,"div",33)(47,"input",34),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isSunday,t)||(s.shiftForm.isSunday=t),c(t)}),r(),o(48,"label",35),a(49),r()()(),o(50,"div",32)(51,"div",33)(52,"input",36),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isMonday,t)||(s.shiftForm.isMonday=t),c(t)}),r(),o(53,"label",37),a(54),r()()(),o(55,"div",32)(56,"div",33)(57,"input",38),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isTuesday,t)||(s.shiftForm.isTuesday=t),c(t)}),r(),o(58,"label",39),a(59),r()()(),o(60,"div",32)(61,"div",33)(62,"input",40),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isWednesday,t)||(s.shiftForm.isWednesday=t),c(t)}),r(),o(63,"label",41),a(64),r()()(),o(65,"div",32)(66,"div",33)(67,"input",42),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isThursday,t)||(s.shiftForm.isThursday=t),c(t)}),r(),o(68,"label",43),a(69),r()()(),o(70,"div",32)(71,"div",33)(72,"input",44),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isFriday,t)||(s.shiftForm.isFriday=t),c(t)}),r(),o(73,"label",45),a(74),r()()(),o(75,"div",32)(76,"div",33)(77,"input",46),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isSaturday,t)||(s.shiftForm.isSaturday=t),c(t)}),r(),o(78,"label",47),a(79),r()()()(),o(80,"small",29),a(81),r()(),o(82,"div",48)(83,"div",33)(84,"input",49),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isNightShift,t)||(s.shiftForm.isNightShift=t),c(t)}),r(),o(85,"label",50),a(86),r()(),o(87,"small",29),a(88),r()()()(),x(89,_e,13,4,"app-form-section",13),o(90,"app-form-section",13)(91,"div",14)(92,"div",21)(93,"div",51)(94,"input",52),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.hasCoreHours,t)||(s.shiftForm.hasCoreHours=t),c(t)}),S("change",function(){f(e);let t=l();return c(t.onCoreHoursChange())}),r(),o(95,"label",53),a(96),r()(),o(97,"div",54),a(98),r()(),x(99,ye,12,4),r()(),o(100,"app-form-section",13)(101,"div",14)(102,"div",15)(103,"label",55),a(104),r(),o(105,"div",56)(106,"input",57),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.requiredWeeklyHours,t)||(s.shiftForm.requiredWeeklyHours=t),c(t)}),r(),o(107,"span",58),a(108),r()(),o(109,"div",54),a(110),r()(),o(111,"div",15)(112,"div",51)(113,"input",59),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isCheckInRequired,t)||(s.shiftForm.isCheckInRequired=t),c(t)}),r(),o(114,"label",60),a(115),r()(),o(116,"div",54),a(117),r()(),o(118,"div",15)(119,"div",51)(120,"input",61),g("ngModelChange",function(t){f(e);let s=l();return p(s.shiftForm.isAutoCheckOut,t)||(s.shiftForm.isAutoCheckOut=t),c(t)}),r(),o(121,"label",62),a(122),r()(),o(123,"div",54),a(124),r()(),x(125,Ce,17,8),r()(),x(126,Fe,10,1,"div",14),o(127,"div",2)(128,"div",3),F(129,"hr",63),o(130,"div",64)(131,"button",65),S("click",function(){f(e);let t=l();return c(t.onCancel())}),a(132),r(),o(133,"button",66),x(134,be,2,1)(135,ve,2,1),r()()()()()()()}if(h&2){let e=l();n(4),_("title",e.t("common.basicInformation")),n(4),y(" ",e.t("shifts.name")," "),n(3),_("placeholder",k(e.t("shifts.namePlaceholder"))),u("ngModel",e.shiftForm.name),n(3),m(e.t("shifts.fields.status")),n(),_("options",e.statusSelectOptions)("ngModel",e.shiftForm.status.toString())("ngModelOptions",q(67,me))("searchable",!1)("clearable",!1),n(3),m(e.t("shifts.description")),n(),_("placeholder",k(e.t("shifts.descriptionPlaceholder"))),u("ngModel",e.shiftForm.description),n(),_("title",e.t("shifts.type")),n(6),_("value",e.ShiftType.TimeBased),u("ngModel",e.shiftForm.shiftType),n(3),m(e.t("shifts.types.timeBased")),n(2),m(e.t("shifts.help.shiftType.timeBased")),n(3),_("value",e.ShiftType.HoursOnly),u("ngModel",e.shiftForm.shiftType),n(3),m(e.t("shifts.types.hoursOnly")),n(2),m(e.t("shifts.help.shiftType.hoursOnly")),n(),C(e.shiftForm.shiftType===e.ShiftType.HoursOnly?40:-1),n(),_("title",e.t("shifts.workingDays")),n(6),u("ngModel",e.shiftForm.isSunday),n(2),m(e.t("common.days.sunday")),n(3),u("ngModel",e.shiftForm.isMonday),n(2),m(e.t("common.days.monday")),n(3),u("ngModel",e.shiftForm.isTuesday),n(2),m(e.t("common.days.tuesday")),n(3),u("ngModel",e.shiftForm.isWednesday),n(2),m(e.t("common.days.wednesday")),n(3),u("ngModel",e.shiftForm.isThursday),n(2),m(e.t("common.days.thursday")),n(3),u("ngModel",e.shiftForm.isFriday),n(2),m(e.t("common.days.friday")),n(3),u("ngModel",e.shiftForm.isSaturday),n(2),m(e.t("common.days.saturday")),n(2),m(e.t("shifts.help.workingDays")),n(3),u("ngModel",e.shiftForm.isNightShift),n(2),y(" ",e.t("shifts.isNightShift")," "),n(2),m(e.t("shifts.help.nightShift")),n(),C(e.shiftForm.shiftType===e.ShiftType.TimeBased?89:-1),n(),_("title",e.t("shifts.coreHours")),n(4),u("ngModel",e.shiftForm.hasCoreHours),n(2),y(" ",e.t("shifts.hasCoreHours")," "),n(2),m(e.t("shifts.help.coreHours")),n(),C(e.shiftForm.hasCoreHours?99:-1),n(),_("title",e.t("shifts.advancedOptions")),n(4),m(e.t("shifts.requiredWeeklyHours")),n(2),u("ngModel",e.shiftForm.requiredWeeklyHours),n(2),m(e.t("shifts.hours")),n(2),m(e.t("shifts.help.requiredWeeklyHours")),n(3),u("ngModel",e.shiftForm.isCheckInRequired),n(2),y(" ",e.t("shifts.checkInRequired")," "),n(2),m(e.t("shifts.help.checkInRequired")),n(3),u("ngModel",e.shiftForm.isAutoCheckOut),n(2),y(" ",e.t("shifts.autoCheckOut")," "),n(2),m(e.t("shifts.help.autoCheckOut")),n(),C(e.shiftForm.shiftType===e.ShiftType.TimeBased?125:-1),n(),C(!e.isFormValid()&&e.shiftForm.name?126:-1),n(5),_("disabled",e.submitting()),n(),y(" ",e.t("common.cancel")," "),n(),_("disabled",!e.isFormValid()||e.submitting()),n(),C(e.submitting()?134:135)}}var ae=class h{shiftsService=M(oe);router=M(N);route=M(A);i18n=M(ee);ShiftType=re;ShiftStatus=se;loading=w(!1);submitting=w(!1);shiftId=w(0);originalShift=w(null);shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,requiredWeeklyHours:void 0,hasCoreHours:!1,coreStart:"",coreEnd:"",isSunday:!1,isMonday:!0,isTuesday:!0,isWednesday:!0,isThursday:!0,isFriday:!0,isSaturday:!1,isNightShift:!1,shiftPeriods:[]};ngOnInit(){let i=this.route.snapshot.paramMap.get("id");i?(this.shiftId.set(parseInt(i,10)),this.loadShift()):this.router.navigate(["/shifts"])}t(i){return this.i18n.t(i)}loadShift(){this.loading.set(!0),this.shiftsService.getShiftById(this.shiftId()).subscribe({next:i=>{console.log("\u{1F50D} DEBUG: Raw shift data from API:",i),console.log("\u{1F50D} DEBUG: Shift status value:",i.status),console.log("\u{1F50D} DEBUG: Working days:",{isSunday:i.isSunday,isMonday:i.isMonday,isTuesday:i.isTuesday,isWednesday:i.isWednesday,isThursday:i.isThursday,isFriday:i.isFriday,isSaturday:i.isSaturday}),this.originalShift.set(i),this.populateForm(i),console.log("\u{1F50D} DEBUG: Form after population:",this.shiftForm),this.loading.set(!1)},error:i=>{console.error("Failed to load shift:",i),this.loading.set(!1),this.router.navigate(["/shifts"])}})}populateForm(i){this.shiftForm.name=i.name,this.shiftForm.description=i.description||"",this.shiftForm.shiftType=i.shiftType,this.shiftForm.status=i.status,i.shiftType===1?this.shiftForm.requiredHours=void 0:this.shiftForm.requiredHours=i.requiredHours,this.shiftForm.isCheckInRequired=i.isCheckInRequired,this.shiftForm.isAutoCheckOut=i.isAutoCheckOut,this.shiftForm.allowFlexibleHours=i.allowFlexibleHours,this.shiftForm.flexMinutesBefore=i.flexMinutesBefore,this.shiftForm.flexMinutesAfter=i.flexMinutesAfter,this.shiftForm.gracePeriodMinutes=i.gracePeriodMinutes,this.shiftForm.requiredWeeklyHours=i.requiredWeeklyHours&&i.requiredWeeklyHours>0?i.requiredWeeklyHours:void 0,this.shiftForm.hasCoreHours=i.hasCoreHours,this.shiftForm.coreStart=i.coreStart||"",this.shiftForm.coreEnd=i.coreEnd||"",this.shiftForm.isSunday=i.isSunday,this.shiftForm.isMonday=i.isMonday,this.shiftForm.isTuesday=i.isTuesday,this.shiftForm.isWednesday=i.isWednesday,this.shiftForm.isThursday=i.isThursday,this.shiftForm.isFriday=i.isFriday,this.shiftForm.isSaturday=i.isSaturday,this.shiftForm.isNightShift=i.isNightShift,this.shiftForm.shiftPeriods=i.shiftType===1?i.shiftPeriods?.map(e=>({id:e.id,periodOrder:e.periodOrder,startTime:e.startTime,endTime:e.endTime}))||[]:[]}onShiftTypeChange(){this.shiftForm.shiftType===2?(this.shiftForm.allowFlexibleHours=!1,this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0,this.shiftForm.gracePeriodMinutes=void 0,this.shiftForm.shiftPeriods=[],this.shiftForm.isNightShift=!1,this.shiftForm.requiredHours||(this.shiftForm.requiredHours=8)):(this.shiftForm.requiredHours=void 0,this.shiftForm.shiftPeriods.length===0&&this.addShiftPeriod())}onCoreHoursChange(){this.shiftForm.hasCoreHours?(this.shiftForm.coreStart||(this.shiftForm.coreStart="09:00"),this.shiftForm.coreEnd||(this.shiftForm.coreEnd="15:00")):(this.shiftForm.coreStart="",this.shiftForm.coreEnd="")}onFlexibleHoursChange(){this.shiftForm.allowFlexibleHours?this.shiftForm.gracePeriodMinutes=void 0:(this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0)}onGracePeriodChange(){this.shiftForm.gracePeriodMinutes&&this.shiftForm.gracePeriodMinutes>0&&(this.shiftForm.allowFlexibleHours=!1,this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0)}onWeeklyHoursChange(){this.shiftForm.requiredWeeklyHours&&this.shiftForm.requiredWeeklyHours>0&&(this.shiftForm.hasCoreHours||(this.shiftForm.hasCoreHours=!0,this.onCoreHoursChange()))}onNightShiftChange(){this.shiftForm.isNightShift&&this.shiftForm.shiftType===2&&(this.shiftForm.isNightShift=!1)}addShiftPeriod(){if(this.shiftForm.shiftPeriods.length<2){let i=this.shiftForm.shiftPeriods.length+1;this.shiftForm.shiftPeriods.push({periodOrder:i,startTime:i===1?"08:00":"13:00",endTime:i===1?"12:00":"17:00"})}}removeShiftPeriod(i){this.shiftForm.shiftPeriods.splice(i,1),this.shiftForm.shiftPeriods.forEach((e,d)=>{e.periodOrder=d+1})}calculatePeriodHours(i,e){if(!i||!e)return 0;let d=this.parseTime(i),t=this.parseTime(e);if(t>d)return(t-d)/(1e3*60*60);if(t<d){let s=(864e5-d)/36e5,v=t/(1e3*60*60);return s+v}else return 0}isNightShift(i,e){if(!i||!e)return!1;let d=this.parseTime(i);return this.parseTime(e)<d}getTotalShiftHours(){return this.shiftForm.shiftType===2?this.shiftForm.requiredHours||0:this.shiftForm.shiftPeriods.reduce((i,e)=>i+this.calculatePeriodHours(e.startTime,e.endTime),0)}getWorkingDaysCount(){let i=0;return this.shiftForm.isSunday&&i++,this.shiftForm.isMonday&&i++,this.shiftForm.isTuesday&&i++,this.shiftForm.isWednesday&&i++,this.shiftForm.isThursday&&i++,this.shiftForm.isFriday&&i++,this.shiftForm.isSaturday&&i++,i}parseTime(i){let[e,d]=i.split(":").map(Number);return(e*60+d)*60*1e3}formatTimeWithSeconds(i){return i?i.includes(":")&&i.split(":").length===3?i:i.length===5?`${i}:00`:i:""}formatHours(i){let e=Math.floor(i),d=Math.round((i-e)*60);return d>0?`${e}h ${d}m`:`${e}h`}getPeriodTypeText(i){return this.isNightShift(i.startTime,i.endTime)?this.t("shifts.periodTypes.nightShift"):this.t("shifts.periodTypes.dayShift")}getShiftStatusText(i){switch(i){case 1:return this.t("shifts.status.active");case 2:return this.t("shifts.status.inactive");case 3:return this.t("shifts.status.draft");case 4:return this.t("shifts.status.archived");default:return this.t("shifts.status.active")}}get statusSelectOptions(){return[{value:1 .toString(),label:this.getShiftStatusText(1)},{value:2 .toString(),label:this.getShiftStatusText(2)},{value:3 .toString(),label:this.getShiftStatusText(3)},{value:4 .toString(),label:this.getShiftStatusText(4)}]}onStatusSelectionChange(i){let e=i?parseInt(i):1;this.shiftForm.status=e}validateBusinessRules(){let i=[];if(this.shiftForm.name.trim()||i.push(this.t("shifts.validation.name.required")),this.shiftForm.isSunday||this.shiftForm.isMonday||this.shiftForm.isTuesday||this.shiftForm.isWednesday||this.shiftForm.isThursday||this.shiftForm.isFriday||this.shiftForm.isSaturday||i.push(this.t("shifts.validation.workingDays.required")),this.shiftForm.hasCoreHours)if(!this.shiftForm.coreStart||!this.shiftForm.coreEnd)i.push(this.t("shifts.validation.coreHours.required"));else{let d=this.parseTime(this.shiftForm.coreStart),t=this.parseTime(this.shiftForm.coreEnd);d===t&&i.push(this.t("shifts.validation.coreHours.sameTime")),this.shiftForm.shiftType===1&&this.shiftForm.shiftPeriods.length>0&&(this.shiftForm.shiftPeriods.some(v=>this.isCoreWithinPeriod(v,this.shiftForm.coreStart,this.shiftForm.coreEnd))||i.push(this.t("shifts.validation.coreHours.outsidePeriods")))}return this.shiftForm.requiredWeeklyHours!==void 0&&this.shiftForm.requiredWeeklyHours!==null&&(this.shiftForm.requiredWeeklyHours<=0&&i.push(this.t("shifts.validation.weeklyHours.positive")),this.shiftForm.requiredWeeklyHours>168&&i.push(this.t("shifts.validation.weeklyHours.maxWeekly"))),this.shiftForm.allowFlexibleHours&&this.shiftForm.gracePeriodMinutes&&this.shiftForm.gracePeriodMinutes>0&&i.push(this.t("shifts.validation.flexible.noGracePeriod")),this.shiftForm.shiftType===1?(this.shiftForm.shiftPeriods.length===0&&i.push(this.t("shifts.validation.timeBased.periodsRequired")),this.shiftForm.requiredHours!==void 0&&i.push(this.t("shifts.validation.timeBased.noRequiredHours"))):this.shiftForm.shiftType===2&&(this.shiftForm.shiftPeriods.length>0&&i.push(this.t("shifts.validation.hoursOnly.noPeriods")),(!this.shiftForm.requiredHours||this.shiftForm.requiredHours<=0)&&i.push(this.t("shifts.validation.hoursOnly.requiredHours")),this.shiftForm.requiredHours&&this.shiftForm.requiredHours>24&&i.push(this.t("shifts.validation.hoursOnly.maxHours"))),i}isCoreWithinPeriod(i,e,d){let t=this.parseTime(i.startTime),s=this.parseTime(i.endTime),v=this.parseTime(e),T=this.parseTime(d);if(s<t){let de=v>=t&&T>=t,le=v<=s&&T<=s,he=v>=t&&T<=s;return de||le||he}else return v>=t&&T<=s}isFormValid(){return this.validateBusinessRules().length===0}getFormErrors(){return this.validateBusinessRules()}onSubmit(){if(!this.isFormValid())return;this.submitting.set(!0);let i={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,requiredWeeklyHours:this.shiftForm.requiredWeeklyHours,hasCoreHours:this.shiftForm.hasCoreHours,coreStart:this.shiftForm.hasCoreHours?this.formatTimeWithSeconds(this.shiftForm.coreStart):void 0,coreEnd:this.shiftForm.hasCoreHours?this.formatTimeWithSeconds(this.shiftForm.coreEnd):void 0,isSunday:this.shiftForm.isSunday,isMonday:this.shiftForm.isMonday,isTuesday:this.shiftForm.isTuesday,isWednesday:this.shiftForm.isWednesday,isThursday:this.shiftForm.isThursday,isFriday:this.shiftForm.isFriday,isSaturday:this.shiftForm.isSaturday,isNightShift:this.shiftForm.isNightShift,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(e=>({id:e.id,periodOrder:e.periodOrder,startTime:this.formatTimeWithSeconds(e.startTime),endTime:this.formatTimeWithSeconds(e.endTime)})):void 0};this.shiftsService.updateShift(this.shiftId(),i).subscribe({next:()=>{this.router.navigate(["/shifts"]),this.submitting.set(!1)},error:e=>{console.error("Failed to update shift:",e),this.submitting.set(!1)}})}onCancel(){this.router.navigate(["/shifts"])}static \u0275fac=function(e){return new(e||h)};static \u0275cmp=H({type:h,selectors:[["app-edit-shift"]],decls:6,vars:4,consts:[["formRef","ngForm"],[1,"container-fluid","px-4"],[1,"row"],[1,"col-12"],["mode","edit","moduleName","shifts","moduleRoute","shifts",3,"title","entityId","loading"],[1,"d-flex","justify-content-center","align-items-center",2,"height","400px"],[1,"card","border-0","shadow-sm"],[1,"text-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"card-body","p-4"],[3,"ngSubmit"],[3,"title"],[1,"row","mb-4"],[1,"col-md-6","mb-3"],["for","name",1,"form-label"],[1,"text-danger"],["type","text","id","name","name","name","required","","maxlength","200",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["for","status",1,"form-label"],[3,"selectionChange","options","ngModel","ngModelOptions","searchable","clearable"],[1,"col-12","mb-3"],["for","description",1,"form-label"],["id","description","name","description","rows","3","maxlength","1000",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"col-md-6"],[1,"form-check","p-3","border","rounded"],["type","radio","name","shiftType","id","timeBased",1,"form-check-input",3,"ngModelChange","change","value","ngModel"],["for","timeBased",1,"form-check-label","w-100"],[1,"fw-medium"],[1,"text-muted"],["type","radio","name","shiftType","id","hoursOnly",1,"form-check-input",3,"ngModelChange","change","value","ngModel"],["for","hoursOnly",1,"form-check-label","w-100"],[1,"col-md-3","col-6","mb-2"],[1,"form-check"],["type","checkbox","id","sunday","name","isSunday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","sunday",1,"form-check-label"],["type","checkbox","id","monday","name","isMonday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","monday",1,"form-check-label"],["type","checkbox","id","tuesday","name","isTuesday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","tuesday",1,"form-check-label"],["type","checkbox","id","wednesday","name","isWednesday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","wednesday",1,"form-check-label"],["type","checkbox","id","thursday","name","isThursday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","thursday",1,"form-check-label"],["type","checkbox","id","friday","name","isFriday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","friday",1,"form-check-label"],["type","checkbox","id","saturday","name","isSaturday",1,"form-check-input",3,"ngModelChange","ngModel"],["for","saturday",1,"form-check-label"],[1,"col-12","mt-3"],["type","checkbox","id","nightShift","name","isNightShift",1,"form-check-input",3,"ngModelChange","ngModel"],["for","nightShift",1,"form-check-label","fw-medium"],[1,"form-check","form-switch"],["type","checkbox","id","hasCoreHours","name","hasCoreHours",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","hasCoreHours",1,"form-check-label"],[1,"form-text"],["for","requiredWeeklyHours",1,"form-label"],[1,"input-group"],["type","number","id","requiredWeeklyHours","name","requiredWeeklyHours","step","0.5","min","0","max","168",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-text"],["type","checkbox","id","checkInRequired","name","isCheckInRequired",1,"form-check-input",3,"ngModelChange","ngModel"],["for","checkInRequired",1,"form-check-label"],["type","checkbox","id","autoCheckOut","name","isAutoCheckOut",1,"form-check-input",3,"ngModelChange","ngModel"],["for","autoCheckOut",1,"form-check-label"],[1,"mb-4"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["for","requiredHours",1,"form-label"],["type","number","id","requiredHours","name","requiredHours","step","0.5","min","0.5","max","24","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-end","mb-3"],["type","button",1,"btn","btn-outline-primary","btn-sm"],[1,"card","border","mb-3"],[1,"alert","alert-info","d-flex","align-items-center"],[1,"bi","bi-info-circle","me-2"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click"],[1,"bi","bi-plus-circle","me-1"],[1,"card-header","bg-light","d-flex","justify-content-between","align-items-center","py-2"],[1,"d-flex","align-items-center","gap-2"],[1,"badge",3,"ngClass"],[1,"text-muted","small"],["type","button",1,"btn","btn-outline-danger","btn-sm"],[1,"card-body"],[1,"form-label"],["type","time","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","button",1,"btn","btn-outline-danger","btn-sm",3,"click"],[1,"bi","bi-trash"],["for","coreStart",1,"form-label"],["type","time","id","coreStart","name","coreStart","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","coreEnd",1,"form-label"],["type","time","id","coreEnd","name","coreEnd","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","gracePeriod",1,"form-label"],["type","number","id","gracePeriod","name","gracePeriodMinutes","min","0","max","120",1,"form-control",3,"ngModelChange","ngModel"],["type","checkbox","id","flexibleHours","name","allowFlexibleHours",1,"form-check-input",3,"ngModelChange","change","ngModel"],["for","flexibleHours",1,"form-check-label"],["for","flexBefore",1,"form-label"],["type","number","id","flexBefore","name","flexMinutesBefore","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],["for","flexAfter",1,"form-label"],["type","number","id","flexAfter","name","flexMinutesAfter","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],[1,"alert","alert-danger"],[1,"d-flex","align-items-start"],[1,"bi","bi-exclamation-triangle","me-2","mt-1"],[1,"alert-heading","mb-2"],[1,"mb-1"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"bi","bi-check-circle","me-2"]],template:function(e,d){e&1&&(o(0,"div",1)(1,"div",2)(2,"div",3),F(3,"app-form-header",4),x(4,fe,7,2,"div",5)(5,Me,136,68,"div",6),r()()()),e&2&&(n(3),_("title",d.t("shifts.edit"))("entityId",d.shiftId())("loading",d.submitting()),n(),C(d.loading()?4:5))},dependencies:[O,B,$,z,L,J,R,K,D,G,Y,Z,X,Q,j,U,ie,ne,te],styles:[".form-check.p-3.border[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.form-check.p-3.border[_ngcontent-%COMP%]:hover{background-color:#007bff0d;border-color:var(--bs-primary)!important}.form-check-input[_ngcontent-%COMP%]:checked ~ .form-check-label[_ngcontent-%COMP%]{color:var(--bs-primary)}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.125)}.badge[_ngcontent-%COMP%]{font-size:.75em}.alert-info[_ngcontent-%COMP%]{background-color:#0dcaf01a;border-color:#0dcaf033;color:#055160}.form-switch[_ngcontent-%COMP%]   .form-check-input[_ngcontent-%COMP%]{cursor:pointer}.btn-outline-danger.btn-sm[_ngcontent-%COMP%]{--bs-btn-padding-y: .25rem;--bs-btn-padding-x: .5rem;--bs-btn-font-size: .875rem}.spinner-border[_ngcontent-%COMP%]{width:2rem;height:2rem}.form-control[_ngcontent-%COMP%]:invalid{border-color:#dc3545}.form-control[_ngcontent-%COMP%]:valid{border-color:#198754}@media (max-width: 768px){.container-fluid[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.card-body[_ngcontent-%COMP%]{padding:1.5rem!important}}"]})};export{ae as EditShiftComponent};
