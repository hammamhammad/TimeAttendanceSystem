import{a as U}from"./chunk-7GC64KGH.js";import{a as $}from"./chunk-RQBJFQCN.js";import{a as L}from"./chunk-NPDCAEA6.js";import"./chunk-QW24EDIR.js";import"./chunk-QXVLGI72.js";import"./chunk-HUSARQNL.js";import{a as N}from"./chunk-H5EPUHY6.js";import{a as A}from"./chunk-N7S3JMGU.js";import"./chunk-Y62N6K5S.js";import{x as k}from"./chunk-VRETN7JA.js";import"./chunk-GRQ6RO47.js";import{a as V}from"./chunk-UBCI4X5Q.js";import"./chunk-EYAJMHM7.js";import{a as R}from"./chunk-HHXRLUSQ.js";import"./chunk-UWVH5K3J.js";import{b as F}from"./chunk-RUY4WPQA.js";import{g as I}from"./chunk-TWXUAMJ4.js";import{$a as x,Bb as g,Cb as _,Db as S,Ea as M,Pb as P,R as l,Xa as p,Ya as C,Yb as v,ab as E,bb as b,cb as s,da as u,db as m,eb as O,nb as y,pb as d,ta as r,wc as w}from"./chunk-JSQL33QG.js";import{a as T,b as D,d as h}from"./chunk-DGAILPFQ.js";var B=()=>[],j=(o,e)=>e.id;function z(o,e){if(o&1&&(g(0),s(1,"strong"),g(2),m()),o&2){let i=d(2).$implicit,t=d(2);S(" ",t.t("settings.overtime.until")," "),r(2),_(t.formatDate(i.effectiveToDate))}}function Y(o,e){if(o&1&&(s(0,"div",6),O(1,"i",7),s(2,"div",8)(3,"h6",9),g(4),m(),s(5,"p",10),g(6),s(7,"strong"),g(8),m(),p(9,z,3,2),m()()()),o&2){let i=d().$implicit,t=d(2);r(4),_(t.t("settings.overtime.activePolicyInfo")),r(2),S(" ",t.t("settings.overtime.currentlyActive")," "),r(2),_(t.formatDate(i.effectiveFromDate)),r(),C(i.effectiveToDate?9:-1)}}function q(o,e){if(o&1&&p(0,Y,10,4,"div",6),o&2){let i=e.$implicit;C(i.isActive?0:-1)}}function G(o,e){if(o&1&&x(0,q,1,1,null,null,j),o&2){let i=d();E(i.configurations())}}var H=class o{overtimeService=l(U);router=l(I);notificationService=l(R);confirmationService=l(N);i18n=l(F);permissionService=l(A);PERMISSIONS={OVERTIME_CREATE:"settings.create",OVERTIME_READ:"settings.read",OVERTIME_UPDATE:"settings.update",OVERTIME_DELETE:"settings.delete",OVERTIME_ACTIVATE:"settings.configure"};loading=u(!1);configurations=u([]);searchTerm="";sortColumn=u("effectiveFromDate");sortDirection=u("desc");tableColumns=v(()=>[{key:"status",label:this.t("settings.overtime.status"),sortable:!1,width:"120px",align:"center",priority:"high",mobileLabel:this.t("settings.overtime.status"),renderHtml:!0},{key:"effectiveFromDate",label:this.t("settings.overtime.effectiveFrom"),sortable:!0,width:"150px",priority:"high",mobileLabel:this.t("settings.overtime.effectiveFrom")},{key:"effectiveToDate",label:this.t("settings.overtime.effectiveTo"),sortable:!0,width:"150px",priority:"medium",hideOnMobile:!1,mobileLabel:this.t("settings.overtime.effectiveTo")},{key:"rates",label:this.t("settings.overtime.rates"),sortable:!1,width:"200px",priority:"medium",hideOnMobile:!1,mobileLabel:this.t("settings.overtime.rates"),renderHtml:!0},{key:"settings",label:this.t("settings.overtime.configuration"),sortable:!1,width:"180px",priority:"low",hideOnMobile:!0,mobileLabel:this.t("settings.overtime.configuration"),renderHtml:!0},{key:"createdAtUtc",label:this.t("common.created"),sortable:!0,width:"150px",priority:"low",hideOnMobile:!0,mobileLabel:this.t("common.created")}]);tableActions=v(()=>[{key:"view",label:this.t("common.view"),icon:"fa-eye",color:"primary",condition:()=>this.permissionService.has(this.PERMISSIONS.OVERTIME_READ)},{key:"activate",label:this.t("settings.overtime.activate"),icon:"fa-play",color:"success",condition:e=>!e.isActive&&this.permissionService.has(this.PERMISSIONS.OVERTIME_ACTIVATE)},{key:"deactivate",label:this.t("settings.overtime.deactivate"),icon:"fa-pause",color:"warning",condition:e=>e.isActive&&this.permissionService.has(this.PERMISSIONS.OVERTIME_ACTIVATE)},{key:"edit",label:this.t("common.edit"),icon:"fa-edit",color:"secondary",condition:()=>this.permissionService.has(this.PERMISSIONS.OVERTIME_UPDATE)},{key:"delete",label:this.t("common.delete"),icon:"fa-trash",color:"danger",condition:e=>!e.isActive&&this.permissionService.has(this.PERMISSIONS.OVERTIME_DELETE)}]);tableData=v(()=>this.filteredConfigurations().map(e=>D(T({},e),{status:this.formatStatus(e),effectiveFromDate:this.formatDate(e.effectiveFromDate),effectiveToDate:e.effectiveToDate?this.formatDate(e.effectiveToDate):this.t("settings.overtime.indefinite"),rates:this.formatRates(e),settings:this.formatSettings(e),createdAtUtc:this.formatDate(e.createdAtUtc)})));ngOnInit(){this.loadConfigurations()}t(e){return this.i18n.t(e)}loadConfigurations(){this.loading.set(!0),this.overtimeService.getOvertimeConfigurations().subscribe({next:e=>{this.configurations.set(e),this.loading.set(!1)},error:e=>{console.error("Failed to load overtime configurations:",e),this.loading.set(!1),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})}formatDate(e){return new Date(e).toLocaleDateString(this.i18n.getCurrentLocale(),{year:"numeric",month:"short",day:"numeric"})}formatStatus(e){return e.isActive?`<span class="badge bg-success">${this.t("settings.overtime.active")}</span>`:`<span class="badge bg-light text-dark border">${this.t("settings.overtime.inactive")}</span>`}formatRates(e){return`<div class="small">
      <div><strong>${this.t("settings.overtime.normalDay")}:</strong> ${e.normalDayRate}x</div>
      <div><strong>${this.t("settings.overtime.holiday")}:</strong> ${e.publicHolidayRate}x</div>
      <div><strong>${this.t("settings.overtime.offDay")}:</strong> ${e.offDayRate}x</div>
    </div>`}formatSettings(e){let i=[];return e.enablePreShiftOvertime&&i.push(this.t("settings.overtime.preShift")),e.enablePostShiftOvertime&&i.push(this.t("settings.overtime.postShift")),e.considerFlexibleTime&&i.push(this.t("settings.overtime.flexibleTime")),e.requireApproval&&i.push(this.t("settings.overtime.requiresApproval")),`<div class="small">${i.join(", ")}</div>`}filteredConfigurations=v(()=>{let e=this.configurations();if(this.searchTerm?.trim()){let a=this.searchTerm.toLowerCase();e=e.filter(n=>n.policyNotes?.toLowerCase().includes(a)||n.createdBy?.toLowerCase().includes(a))}let i=this.sortColumn(),t=this.sortDirection();return e.sort((a,n)=>{let c=a[i],f=n[i];return i==="effectiveFromDate"||i==="effectiveToDate"||i==="createdAtUtc"?(c=new Date(c).getTime(),f=new Date(f).getTime()):typeof c=="string"&&(c=c.toLowerCase(),f=f.toLowerCase()),c<f?t==="asc"?-1:1:c>f?t==="asc"?1:-1:0})});onActionClick(e){let{action:i,item:t}=e;switch(i){case"view":this.onViewConfiguration(t);break;case"activate":this.onActivateConfiguration(t);break;case"deactivate":this.onDeactivateConfiguration(t);break;case"edit":this.onEditConfiguration(t);break;case"delete":this.onDeleteConfiguration(t);break;default:console.warn("Unknown action:",i)}}onSearchChange(){setTimeout(()=>{},300)}onClearFilters(){this.searchTerm=""}hasActiveFilters(){return!!this.searchTerm}onSearchTermChange(e){this.searchTerm=e}onFiltersChange(e){e.branchId,e.isActive}onRefreshData(){this.onClearFilters(),this.loadConfigurations()}onCreateConfiguration(){this.router.navigate(["/settings/overtime/create"])}onViewConfiguration(e){this.router.navigate(["/settings/overtime",e.id,"view"])}onEditConfiguration(e){this.router.navigate(["/settings/overtime/edit",e.id])}onActivateConfiguration(e){return h(this,null,function*(){(yield this.confirmationService.confirm({title:this.t("settings.overtime.activatePolicy"),message:this.t("settings.overtime.activatePolicyConfirmation"),confirmText:this.t("settings.overtime.activate"),cancelText:this.t("common.cancel"),confirmButtonClass:"btn-success",icon:"fa-play",iconClass:"text-success"})).confirmed&&this.overtimeService.activateOvertimeConfiguration(e.id).subscribe({next:()=>{this.loadConfigurations(),this.notificationService.success(this.t("app.success"),this.t("settings.overtime.policyActivatedSuccessfully"))},error:t=>{console.error("Failed to activate configuration:",t),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})})}onDeactivateConfiguration(e){return h(this,null,function*(){(yield this.confirmationService.confirm({title:this.t("settings.overtime.deactivatePolicy"),message:this.t("settings.overtime.deactivatePolicyConfirmation"),confirmText:this.t("settings.overtime.deactivate"),cancelText:this.t("common.cancel"),confirmButtonClass:"btn-warning",icon:"fa-pause",iconClass:"text-warning"})).confirmed&&this.overtimeService.deactivateOvertimeConfiguration(e.id).subscribe({next:()=>{this.loadConfigurations(),this.notificationService.success(this.t("app.success"),this.t("settings.overtime.policyDeactivatedSuccessfully"))},error:t=>{console.error("Failed to deactivate configuration:",t),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})})}onDeleteConfiguration(e){return h(this,null,function*(){(yield this.confirmationService.confirm({title:this.t("settings.overtime.deletePolicy"),message:this.t("settings.overtime.deletePolicyConfirmation"),confirmText:this.t("common.delete"),cancelText:this.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.overtimeService.deleteOvertimeConfiguration(e.id).subscribe({next:()=>{this.configurations.set(this.configurations().filter(t=>t.id!==e.id)),this.notificationService.success(this.t("app.success"),this.t("settings.overtime.policyDeletedSuccessfully"))},error:t=>{console.error("Failed to delete configuration:",t),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})})}canCreateConfigurations(){return this.permissionService.has(this.PERMISSIONS.OVERTIME_CREATE)}onSort(e){let i=this.sortColumn(),t=this.sortDirection();i===e?this.sortDirection.set(t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc"))}getSortIcon(e){let i=this.sortColumn(),t=this.sortDirection();return i!==e?"fas fa-sort text-muted":t==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}isSortable(e){return["effectiveFromDate","effectiveToDate","createdAtUtc"].includes(e)}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=M({type:o,selectors:[["app-overtime-configurations"]],decls:7,vars:11,consts:[[1,"container-fluid"],[3,"title"],["moduleName","overtime-configurations",3,"searchChange","filtersChange","add","refresh","refreshing"],[1,"card"],[1,"card-body"],[3,"actionClick","data","columns","actions","loading","emptyTitle","emptyMessage","paginated"],[1,"alert","alert-info","d-flex","align-items-center","mb-4"],[1,"fa-solid","fa-info-circle","me-3","fs-4"],[1,"flex-grow-1"],[1,"mb-1"],[1,"mb-0"]],template:function(i,t){i&1&&(s(0,"div",0),O(1,"app-page-header",1),s(2,"app-unified-filter",2),y("searchChange",function(n){return t.onSearchTermChange(n)})("filtersChange",function(n){return t.onFiltersChange(n)})("add",function(){return t.onCreateConfiguration()})("refresh",function(){return t.onRefreshData()}),m(),p(3,G,2,0),s(4,"div",3)(5,"div",4)(6,"app-data-table",5),y("actionClick",function(n){return t.onActionClick(n)}),m()()()()),i&2&&(r(),b("title",t.t("settings.overtime.title")),r(),b("refreshing",t.loading()),r(),C(!t.loading()&&t.configurations().length>0?3:-1),r(3),b("data",t.tableData()||P(10,B))("columns",t.tableColumns())("actions",t.tableActions())("loading",t.loading)("emptyTitle",t.t("settings.overtime.noConfigurationsTitle"))("emptyMessage",t.t("settings.overtime.noConfigurationsMessage"))("paginated",!0))},dependencies:[w,k,L,V,$],styles:[".card[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.125);border-radius:.5rem;box-shadow:0 .125rem .25rem #00000013;transition:all .15s ease-in-out}.card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026}.alert[_ngcontent-%COMP%]{border-radius:.5rem;border:none}.alert-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1ecf1,#bee5eb);color:#0c5460}.btn[_ngcontent-%COMP%]{border-radius:.375rem;transition:all .15s ease-in-out}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.input-group[_ngcontent-%COMP%]{border-radius:.375rem;overflow:hidden}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fa;border-color:#dee2e6}.form-control[_ngcontent-%COMP%]{border-color:#dee2e6}.form-control[_ngcontent-%COMP%]:focus{border-color:#86b7fe;box-shadow:0 0 0 .25rem #0d6efd40}.badge[_ngcontent-%COMP%]{font-size:.75em;padding:.35em .65em;border-radius:.375rem}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.display-1[_ngcontent-%COMP%]{font-size:6rem;font-weight:300;line-height:1.2}@media (max-width: 768px){.display-1[_ngcontent-%COMP%]{font-size:4rem}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.text-end[_ngcontent-%COMP%]{text-align:start!important}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.badge.bg-success[_ngcontent-%COMP%]{background-color:#198754!important}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;font-weight:600;color:#495057;background-color:#f8f9fa}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}"]})};export{H as OvertimeConfigurationsComponent};
