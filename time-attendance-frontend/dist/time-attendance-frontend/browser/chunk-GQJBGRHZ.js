import{a as H}from"./chunk-Y3B3FNFW.js";import{b as M,c as u,d as O,e as D,h as L,k as P,l as B,m as V,n as q,o as R,r as G,t as $}from"./chunk-RH4QBYEM.js";import{d as A,g as k,h as w,m as j}from"./chunk-4DYU65FO.js";import{b as z}from"./chunk-CQWUHIOF.js";import{$a as i,Ca as S,Q as E,Ta as s,Ua as c,V as I,W as g,Xa as h,Ya as b,Za as v,_a as l,ab as m,ca as y,eb as F,ec as T,gb as C,ib as p,nb as _,qb as r,ra as e,rb as d,sb as f,tb as N}from"./chunk-LHYYCVNR.js";import"./chunk-DGAILPFQ.js";var J=(o,n)=>n.id;function Q(o,n){if(o&1&&(l(0,"div",10)(1,"div",13)(2,"span",14),r(3),i()()()),o&2){let a=p();e(3),d(a.i18n.t("common.loading"))}}function U(o,n){if(o&1&&(l(0,"div",20),m(1,"i",65),r(2),i()),o&2){let a=p(2);e(2),f(" ",a.error()," ")}}function W(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("firstName"))}}function X(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("lastName"))}}function Y(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("jobTitle"))}}function Z(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("employmentStatus"))}}function ee(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("workLocationType"))}}function te(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("firstNameAr"))}}function ie(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("lastNameAr"))}}function ne(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("jobTitleAr"))}}function ae(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("email"))}}function oe(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("phone"))}}function le(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("nationalId"))}}function re(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("dateOfBirth"))}}function de(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("gender"))}}function me(o,n){if(o&1&&(l(0,"option",58),r(1),i()),o&2){let a=n.$implicit;v("value",a.id),e(),d(a.name)}}function pe(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("departmentId"))}}function se(o,n){if(o&1&&(l(0,"option",58),r(1),i()),o&2){let a=n.$implicit;v("value",a.id),e(),N("",a.name," (",a.employeeNumber,")")}}function ce(o,n){if(o&1&&(l(0,"div",31),r(1),i()),o&2){let a=p(2);e(),d(a.getFieldError("managerEmployeeId"))}}function ve(o,n){o&1&&m(0,"span",63)}function xe(o,n){o&1&&m(0,"i",64)}function _e(o,n){if(o&1){let a=F();l(0,"div",11)(1,"div",15)(2,"h5",16),m(3,"i",17),r(4),i()(),l(5,"div",18)(6,"form",19),C("ngSubmit",function(){I(a);let t=p();return g(t.onSubmit())}),s(7,U,3,1,"div",20),l(8,"div",21)(9,"h6",22),m(10,"i",23),r(11),i(),l(12,"div",24)(13,"div",25)(14,"label",26),r(15),i(),m(16,"input",27),l(17,"div",28),r(18),i()(),l(19,"div",25)(20,"label",26),r(21),i(),m(22,"input",27),l(23,"div",28),r(24),i()(),l(25,"div",25)(26,"label",26),r(27),l(28,"span",29),r(29,"*"),i()(),m(30,"input",30),s(31,W,2,1,"div",31),i(),l(32,"div",25)(33,"label",26),r(34),l(35,"span",29),r(36,"*"),i()(),m(37,"input",32),s(38,X,2,1,"div",31),i(),l(39,"div",25)(40,"label",26),r(41),l(42,"span",29),r(43,"*"),i()(),m(44,"input",33),s(45,Y,2,1,"div",31),i(),l(46,"div",25)(47,"label",26),r(48),l(49,"span",29),r(50,"*"),i()(),l(51,"select",34)(52,"option",35),r(53),i(),l(54,"option",36),r(55),i(),l(56,"option",37),r(57),i(),l(58,"option",38),r(59),i()(),s(60,Z,2,1,"div",31),i(),l(61,"div",25)(62,"label",26),r(63),l(64,"span",29),r(65,"*"),i()(),l(66,"select",39)(67,"option",40),r(68),i(),l(69,"option",41),r(70),i(),l(71,"option",42),r(72),i(),l(73,"option",43),r(74),i()(),s(75,ee,2,1,"div",31),i()()(),m(76,"hr"),l(77,"div",21)(78,"h6",44),m(79,"i",45),r(80),i(),l(81,"div",24)(82,"div",25)(83,"label",26),r(84),i(),m(85,"input",46),s(86,te,2,1,"div",31),i(),l(87,"div",25)(88,"label",26),r(89),i(),m(90,"input",47),s(91,ie,2,1,"div",31),i(),l(92,"div",25)(93,"label",26),r(94),i(),m(95,"input",48),s(96,ne,2,1,"div",31),i(),l(97,"div",25)(98,"label",26),r(99),i(),m(100,"input",49),s(101,ae,2,1,"div",31),i(),l(102,"div",25)(103,"label",26),r(104),i(),m(105,"input",50),s(106,oe,2,1,"div",31),i(),l(107,"div",25)(108,"label",26),r(109),i(),m(110,"input",51),s(111,le,2,1,"div",31),i(),l(112,"div",25)(113,"label",26),r(114),i(),m(115,"input",52),s(116,re,2,1,"div",31),i(),l(117,"div",25)(118,"label",26),r(119),i(),l(120,"select",53)(121,"option",54),r(122),i(),l(123,"option",55),r(124),i(),l(125,"option",56),r(126),i()(),s(127,de,2,1,"div",31),i(),l(128,"div",25)(129,"label",26),r(130),i(),l(131,"select",57)(132,"option",54),r(133),i(),h(134,me,2,2,"option",58,J),i(),s(136,pe,2,1,"div",31),i(),l(137,"div",25)(138,"label",26),r(139),i(),l(140,"select",59)(141,"option",54),r(142),i(),h(143,se,2,3,"option",58,J),i(),s(145,ce,2,1,"div",31),i()()(),l(146,"div",60)(147,"button",8),C("click",function(){I(a);let t=p();return g(t.onCancel())}),m(148,"i",61),r(149),i(),l(150,"button",62),s(151,ve,1,0,"span",63)(152,xe,1,0,"i",64),r(153),i()()()()()}if(o&2){let a,x,t=p();e(4),f(" ",t.i18n.t("employees.employee_information")," "),e(2),v("formGroup",t.employeeForm),e(),c(t.error()?7:-1),e(4),f(" ",t.i18n.t("employees.required_information")," "),e(4),d(t.i18n.t("employees.employee_number")),e(),v("value",(a=t.employee())==null?null:a.employeeNumber),e(2),d(t.i18n.t("employees.employee_number_readonly")),e(3),d(t.i18n.t("employees.branch")),e(),v("value",(x=t.employee())==null?null:x.branchName),e(2),d(t.i18n.t("employees.branch_readonly")),e(3),f(" ",t.i18n.t("employees.first_name")," "),e(3),_("is-invalid",t.isFieldInvalid("firstName")),v("placeholder",t.i18n.t("employees.first_name_placeholder")),e(),c(t.isFieldInvalid("firstName")?31:-1),e(3),f(" ",t.i18n.t("employees.last_name")," "),e(3),_("is-invalid",t.isFieldInvalid("lastName")),v("placeholder",t.i18n.t("employees.last_name_placeholder")),e(),c(t.isFieldInvalid("lastName")?38:-1),e(3),f(" ",t.i18n.t("employees.job_title")," "),e(3),_("is-invalid",t.isFieldInvalid("jobTitle")),v("placeholder",t.i18n.t("employees.job_title_placeholder")),e(),c(t.isFieldInvalid("jobTitle")?45:-1),e(3),f(" ",t.i18n.t("employees.employment_status.title")," "),e(3),_("is-invalid",t.isFieldInvalid("employmentStatus")),e(2),d(t.i18n.t("employees.employment_status.active")),e(2),d(t.i18n.t("employees.employment_status.inactive")),e(2),d(t.i18n.t("employees.employment_status.on_leave")),e(2),d(t.i18n.t("employees.employment_status.terminated")),e(),c(t.isFieldInvalid("employmentStatus")?60:-1),e(3),f(" ",t.i18n.t("employees.work_location.title")," "),e(3),_("is-invalid",t.isFieldInvalid("workLocationType")),e(2),d(t.i18n.t("employees.work_location.office")),e(2),d(t.i18n.t("employees.work_location.remote")),e(2),d(t.i18n.t("employees.work_location.hybrid")),e(2),d(t.i18n.t("employees.work_location.field")),e(),c(t.isFieldInvalid("workLocationType")?75:-1),e(5),f(" ",t.i18n.t("employees.additional_information")," "),e(4),d(t.i18n.t("employees.first_name_ar")),e(),_("is-invalid",t.isFieldInvalid("firstNameAr")),v("placeholder",t.i18n.t("employees.first_name_ar_placeholder")),e(),c(t.isFieldInvalid("firstNameAr")?86:-1),e(3),d(t.i18n.t("employees.last_name_ar")),e(),_("is-invalid",t.isFieldInvalid("lastNameAr")),v("placeholder",t.i18n.t("employees.last_name_ar_placeholder")),e(),c(t.isFieldInvalid("lastNameAr")?91:-1),e(3),d(t.i18n.t("employees.job_title_ar")),e(),_("is-invalid",t.isFieldInvalid("jobTitleAr")),v("placeholder",t.i18n.t("employees.job_title_ar_placeholder")),e(),c(t.isFieldInvalid("jobTitleAr")?96:-1),e(3),d(t.i18n.t("employees.email")),e(),_("is-invalid",t.isFieldInvalid("email")),v("placeholder",t.i18n.t("employees.email_placeholder")),e(),c(t.isFieldInvalid("email")?101:-1),e(3),d(t.i18n.t("employees.phone")),e(),_("is-invalid",t.isFieldInvalid("phone")),v("placeholder",t.i18n.t("employees.phone_placeholder")),e(),c(t.isFieldInvalid("phone")?106:-1),e(3),d(t.i18n.t("employees.national_id")),e(),_("is-invalid",t.isFieldInvalid("nationalId")),v("placeholder",t.i18n.t("employees.national_id_placeholder")),e(),c(t.isFieldInvalid("nationalId")?111:-1),e(3),d(t.i18n.t("employees.date_of_birth")),e(),_("is-invalid",t.isFieldInvalid("dateOfBirth")),e(),c(t.isFieldInvalid("dateOfBirth")?116:-1),e(3),d(t.i18n.t("employees.gender.title")),e(),_("is-invalid",t.isFieldInvalid("gender")),e(2),d(t.i18n.t("common.select")),e(2),d(t.i18n.t("employees.gender.male")),e(2),d(t.i18n.t("employees.gender.female")),e(),c(t.isFieldInvalid("gender")?127:-1),e(3),d(t.i18n.t("employees.department")),e(),_("is-invalid",t.isFieldInvalid("departmentId")),e(2),d(t.i18n.t("common.select_department")),e(),b(t.departments()),e(2),c(t.isFieldInvalid("departmentId")?136:-1),e(3),d(t.i18n.t("employees.manager")),e(),_("is-invalid",t.isFieldInvalid("managerEmployeeId")),e(2),d(t.i18n.t("common.select_manager")),e(),b(t.managers()),e(2),c(t.isFieldInvalid("managerEmployeeId")?145:-1),e(2),v("disabled",t.saving()),e(2),f(" ",t.i18n.t("common.cancel")," "),e(),v("disabled",t.employeeForm.invalid||t.saving()),e(),c(t.saving()?151:152),e(2),f(" ",t.saving()?t.i18n.t("common.saving"):t.i18n.t("employees.update_employee")," ")}}function fe(o,n){if(o&1&&(l(0,"div",12),m(1,"i",65),r(2),i()),o&2){let a=p();e(2),f(" ",a.error()||a.i18n.t("employees.employee_not_found")," ")}}var K=class o{route=E(A);router=E(k);employeesService=E(H);fb=E(G);i18n=E(z);employee=y(null);departments=y([]);managers=y([]);loading=y(!0);saving=y(!1);error=y("");employeeForm;ngOnInit(){this.initializeForm();let n=this.route.snapshot.paramMap.get("id");n?this.loadEmployee(n):(this.error.set("Invalid employee ID"),this.loading.set(!1))}initializeForm(){this.employeeForm=this.fb.group({firstName:["",[u.required,u.minLength(2)]],lastName:["",[u.required,u.minLength(2)]],firstNameAr:[""],lastNameAr:[""],jobTitle:["",u.required],jobTitleAr:[""],email:["",u.email],phone:[""],nationalId:[""],dateOfBirth:[""],gender:[""],employmentStatus:["Active",u.required],workLocationType:["Office",u.required],departmentId:[""],managerEmployeeId:[""]})}loadEmployee(n){this.employeesService.getEmployeeById(+n).subscribe({next:a=>{this.employee.set(a),this.populateForm(a),this.loadDepartments(a.branchId.toString()),this.loadManagers(a.branchId.toString()),this.loading.set(!1)},error:a=>{this.error.set(this.getErrorMessage(a)),this.loading.set(!1)}})}loadDepartments(n){this.departments.set([])}loadManagers(n){this.managers.set([])}populateForm(n){this.employeeForm.patchValue({firstName:n.firstName,lastName:n.lastName,firstNameAr:n.firstNameAr||"",lastNameAr:n.lastNameAr||"",jobTitle:n.jobTitle,jobTitleAr:n.jobTitleAr||"",email:n.email||"",phone:n.phone||"",nationalId:n.nationalId||"",dateOfBirth:n.dateOfBirth?new Date(n.dateOfBirth).toISOString().split("T")[0]:"",gender:n.gender||"",employmentStatus:n.employmentStatus,workLocationType:n.workLocationType,departmentId:n.departmentId||"",managerEmployeeId:n.managerEmployeeId||""})}onSubmit(){if(this.employeeForm.invalid){this.employeeForm.markAllAsTouched();return}this.saving.set(!0),this.error.set("");let n=this.employeeForm.value,a={firstName:n.firstName,lastName:n.lastName,firstNameAr:n.firstNameAr||void 0,lastNameAr:n.lastNameAr||void 0,jobTitle:n.jobTitle,jobTitleAr:n.jobTitleAr||void 0,email:n.email||void 0,phone:n.phone||void 0,nationalId:n.nationalId||void 0,dateOfBirth:n.dateOfBirth||void 0,gender:n.gender||void 0,employmentStatus:n.employmentStatus,workLocationType:n.workLocationType,departmentId:n.departmentId||void 0,managerEmployeeId:n.managerEmployeeId||void 0};this.employeesService.updateEmployee(this.employee().id,a).subscribe({next:()=>{this.saving.set(!1),this.router.navigate(["/employees",this.employee().id,"view"])},error:x=>{this.saving.set(!1),this.error.set(this.getErrorMessage(x))}})}onCancel(){this.employee()?this.router.navigate(["/employees",this.employee().id,"view"]):this.router.navigate(["/employees"])}getFieldError(n){let a=this.employeeForm.get(n);if(a?.errors&&a.touched){if(a.errors.required)return this.i18n.t("validation.required");if(a.errors.email)return this.i18n.t("validation.email");if(a.errors.minlength)return this.i18n.t("validation.minlength").replace("{{min}}",a.errors.minlength.requiredLength)}return""}isFieldInvalid(n){let a=this.employeeForm.get(n);return!!(a?.errors&&a.touched)}getErrorMessage(n){return n?.error?.error?n.error.error:this.i18n.t("errors.unknown")}static \u0275fac=function(a){return new(a||o)};static \u0275cmp=S({type:o,selectors:[["app-edit-employee"]],decls:21,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/employees"],[1,"breadcrumb-item","active"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"card"],[1,"alert","alert-danger"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fa-solid","fa-user","me-2"],[1,"card-body"],[3,"ngSubmit","formGroup"],["role","alert",1,"alert","alert-danger"],[1,"mb-4"],[1,"text-primary","mb-3"],[1,"fa-solid","fa-asterisk","me-2"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["type","text","readonly","",1,"form-control-plaintext",3,"value"],[1,"form-text"],[1,"text-danger"],["type","text","formControlName","firstName",1,"form-control",3,"placeholder"],[1,"invalid-feedback"],["type","text","formControlName","lastName",1,"form-control",3,"placeholder"],["type","text","formControlName","jobTitle",1,"form-control",3,"placeholder"],["formControlName","employmentStatus",1,"form-select"],["value","Active"],["value","Inactive"],["value","OnLeave"],["value","Terminated"],["formControlName","workLocationType",1,"form-select"],["value","Office"],["value","Remote"],["value","Hybrid"],["value","Field"],[1,"text-secondary","mb-3"],[1,"fa-solid","fa-info-circle","me-2"],["type","text","formControlName","firstNameAr",1,"form-control",3,"placeholder"],["type","text","formControlName","lastNameAr",1,"form-control",3,"placeholder"],["type","text","formControlName","jobTitleAr",1,"form-control",3,"placeholder"],["type","email","formControlName","email",1,"form-control",3,"placeholder"],["type","tel","formControlName","phone",1,"form-control",3,"placeholder"],["type","text","formControlName","nationalId",1,"form-control",3,"placeholder"],["type","date","formControlName","dateOfBirth",1,"form-control"],["formControlName","gender",1,"form-select"],["value",""],["value","Male"],["value","Female"],["formControlName","departmentId",1,"form-select"],[3,"value"],["formControlName","managerEmployeeId",1,"form-select"],[1,"d-flex","justify-content-end","gap-2","mt-4"],[1,"fa-solid","fa-times","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fa-solid","fa-save","me-2"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(a,x){a&1&&(l(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),r(4),i(),l(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),r(9),i()(),l(10,"li",4)(11,"a",6),r(12),i()(),l(13,"li",7),r(14),i()()()(),l(15,"button",8),C("click",function(){return x.onCancel()}),m(16,"i",9),r(17),i()(),s(18,Q,4,1,"div",10)(19,_e,154,98,"div",11)(20,fe,3,1,"div",12),i()),a&2&&(e(4),d(x.i18n.t("employees.edit_employee")),e(5),d(x.i18n.t("dashboard.title")),e(3),d(x.i18n.t("employees.title")),e(2),d(x.i18n.t("employees.edit_employee")),e(),v("disabled",x.saving()),e(2),f(" ",x.i18n.t("common.back")," "),e(),c(x.loading()?18:x.employee()?19:20))},dependencies:[T,j,w,$,L,q,R,M,V,O,D,P,B],encapsulation:2})};export{K as EditEmployeeComponent};
