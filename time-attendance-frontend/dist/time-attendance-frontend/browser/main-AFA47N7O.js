import{a as D}from"./chunk-75UY2FYC.js";import"./chunk-65M2O2LF.js";import{a as l}from"./chunk-KJYCFZZO.js";import{a as b,b as A,e as E,f as m,g as k,j as F,k as H,l as _}from"./chunk-4DYU65FO.js";import{b as d}from"./chunk-CQWUHIOF.js";import{Ca as T,G as C,Jb as S,L as g,Q as a,ab as w,ba as v,fa as y,k as u,lc as R,mc as I,w as f,wa as M}from"./chunk-LHYYCVNR.js";import"./chunk-DGAILPFQ.js";var t=(e,n)=>{let o=a(l),i=a(D),r=a(k);if(!o.isAuthenticated())return r.navigate(["/login"]),!1;if(o.isTokenExpired())if(o.getRefreshToken())o.refreshToken().subscribe({error:()=>{r.navigate(["/login"])}});else return r.navigate(["/login"]),!1;let p=e.data?.permission;return p&&!i.has(p)?(r.navigate(["/unauthorized"]),!1):!0};var B=[{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-ZNU3AAUN.js").then(e=>e.LoginComponent),data:{title:"auth.login"}},{path:"",loadComponent:()=>import("./chunk-HHMTEDKL.js").then(e=>e.LayoutComponent),canMatch:[t],children:[{path:"dashboard",loadComponent:()=>import("./chunk-5OCBFCLD.js").then(e=>e.DashboardComponent),data:{title:"dashboard.title"}},{path:"users",loadComponent:()=>import("./chunk-FFIJVP2P.js").then(e=>e.UsersComponent),data:{title:"users.title",permission:"user.read"},canMatch:[t]},{path:"users/create",loadComponent:()=>import("./chunk-77NJSAZF.js").then(e=>e.CreateUserPageComponent),data:{title:"users.create_user",permission:"user.create"},canMatch:[t]},{path:"users/:id/view",loadComponent:()=>import("./chunk-NXA26PTI.js").then(e=>e.ViewUserComponent),data:{title:"users.view_details",permission:"user.read"},canMatch:[t]},{path:"users/:id/edit",loadComponent:()=>import("./chunk-XKSD2FKM.js").then(e=>e.EditUserPageComponent),data:{title:"users.edit_user",permission:"user.update"},canMatch:[t]},{path:"employees",loadComponent:()=>import("./chunk-WD57SVNO.js").then(e=>e.EmployeesComponent),data:{title:"employees.title",permission:"employee.read"},canMatch:[t]},{path:"employees/create",loadComponent:()=>import("./chunk-IDKYEEAJ.js").then(e=>e.CreateEmployeeComponent),data:{title:"employees.create_employee",permission:"employee.create"},canMatch:[t]},{path:"employees/:id/view",loadComponent:()=>import("./chunk-EBLGNVTP.js").then(e=>e.ViewEmployeeComponent),data:{title:"employees.view_details",permission:"employee.read"},canMatch:[t]},{path:"employees/:id/edit",loadComponent:()=>import("./chunk-GQJBGRHZ.js").then(e=>e.EditEmployeeComponent),data:{title:"employees.edit_employee",permission:"employee.update"},canMatch:[t]},{path:"roles",loadComponent:()=>import("./chunk-USJ6BVUN.js").then(e=>e.RolesComponent),data:{title:"roles.title",permission:"role.read"},canMatch:[t]},{path:"roles/create",loadComponent:()=>import("./chunk-GX4RK6ZX.js").then(e=>e.CreateRoleComponent),data:{title:"roles.create_role",permission:"role.create"},canMatch:[t]},{path:"roles/:id/view",loadComponent:()=>import("./chunk-JYEC7XPQ.js").then(e=>e.ViewRoleComponent),data:{title:"roles.view_details",permission:"role.read"},canMatch:[t]},{path:"roles/:id/edit",loadComponent:()=>import("./chunk-USCD65NN.js").then(e=>e.EditRoleComponent),data:{title:"roles.edit_role",permission:"role.update"},canMatch:[t]},{path:"branches",loadComponent:()=>import("./chunk-EXDSBIYP.js").then(e=>e.BranchesComponent),data:{title:"branches.title",permission:"branch.read"},canMatch:[t]},{path:"branches/:id/view",loadComponent:()=>import("./chunk-275T4WT2.js").then(e=>e.ViewBranchComponent),data:{title:"branches.view_details",permission:"branch.read"},canMatch:[t]},{path:"branches/:id/edit",loadComponent:()=>import("./chunk-FRPATJZI.js").then(e=>e.EditBranchComponent),data:{title:"branches.edit_branch",permission:"branch.update"},canMatch:[t]},{path:"departments",loadComponent:()=>import("./chunk-K2J3YJBL.js").then(e=>e.DepartmentsComponent),data:{title:"departments.title",permission:"department.read"},canMatch:[t]},{path:"departments/create",loadComponent:()=>import("./chunk-XZSY25I5.js").then(e=>e.CreateDepartmentComponent),data:{title:"departments.create",permission:"department.create"},canMatch:[t]},{path:"departments/:id/view",loadComponent:()=>import("./chunk-7YSYAD3A.js").then(e=>e.ViewDepartmentComponent),data:{title:"departments.view_details",permission:"department.read"},canMatch:[t]},{path:"departments/:id/edit",loadComponent:()=>import("./chunk-ZZ5SDQCF.js").then(e=>e.EditDepartmentComponent),data:{title:"departments.edit",permission:"department.update"},canMatch:[t]},{path:"settings",loadComponent:()=>import("./chunk-5NT73LD2.js").then(e=>e.SettingsComponent),data:{title:"settings.title"}}]},{path:"unauthorized",loadComponent:()=>import("./chunk-OUT3ZVTI.js").then(e=>e.UnauthorizedComponent),data:{title:"Unauthorized Access"}},{path:"**",loadComponent:()=>import("./chunk-RW7LGK5X.js").then(e=>e.NotFoundComponent),data:{title:"Page Not Found"}}];var U=(e,n)=>{let o=a(l);if(e.url.includes("/auth/login")||e.url.includes("/auth/refresh"))return n(e);let i=o.getAccessToken(),r=e;return i&&(r=e.clone({headers:e.headers.set("Authorization",`Bearer ${i}`)})),n(r).pipe(f(p=>{if(p.status===401&&!e.url.includes("/auth/refresh")){if(o.getRefreshToken())return o.refreshToken().pipe(C(()=>{let s=o.getAccessToken(),j=e.clone({headers:e.headers.set("Authorization",`Bearer ${s}`)});return n(j)}),f(s=>(o.logout(),u(()=>s))));o.logout()}return u(()=>p)}))};var c=class e extends m{title=a(A);i18n=a(d);updateTitle(n){let o=this.buildTitle(n);if(o){let r=`${this.i18n.t(o)} | Time Attendance System`;this.title.setTitle(r)}else this.title.setTitle("Time Attendance System")}static \u0275fac=(()=>{let n;return function(i){return(n||(n=y(e)))(i||e)}})();static \u0275prov=g({token:e,factory:e.\u0275fac,providedIn:"root"})};var x={providers:[v(),S({eventCoalescing:!0}),F(B,_(),H()),R(I([U])),{provide:m,useClass:c}]};var h=class e{constructor(n){this.i18n=n}ngOnInit(){let n=localStorage.getItem("app_locale")||"en";this.i18n.setLocale(n)}static \u0275fac=function(o){return new(o||e)(M(d))};static \u0275cmp=T({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(o,i){o&1&&w(0,"router-outlet")},dependencies:[E],encapsulation:2})};b(h,x).catch(e=>console.error(e));
