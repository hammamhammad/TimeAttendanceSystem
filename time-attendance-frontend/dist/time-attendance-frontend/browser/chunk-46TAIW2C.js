import{a as he}from"./chunk-LRWEBFSR.js";import{a as fe,b as me}from"./chunk-GBFD7MFB.js";import{a as de}from"./chunk-I6EKFUOK.js";import{a as ae}from"./chunk-ZKUEJZLQ.js";import{a as le}from"./chunk-GWHM7BJD.js";import{a as re}from"./chunk-RM7DPSQZ.js";import{a as $}from"./chunk-LCQOFV6P.js";import{a as P,b as k}from"./chunk-5BLMYARA.js";import"./chunk-SZUF4QIO.js";import{b as G,c as j,e as J,f as K,g as Q,h as X,i as Y,j as Z,k as ee,s as te,t as ie,u as ne,x as se}from"./chunk-7QCK55IR.js";import{b as oe}from"./chunk-AS5QRUY4.js";import{$ as a,E as s,Ea as p,Fa as g,Ga as S,J as B,La as O,N as R,Sa as D,U as v,V as M,W as N,Y as W,Z as V,_ as c,aa as o,ba as y,fb as L,ia as x,ka as f,ma as u,qb as U,sa as E,t as w,ta as I,u as _,v as C,wa as l,xa as h,ya as m,z as b,za as z}from"./chunk-LDUBOZPL.js";import{a as A,b as q}from"./chunk-DGAILPFQ.js";var ue=()=>({standalone:!0});function pe(d,t){if(d&1){let i=x();a(0,"button",48),f("click",function(){_(i);let n=u();return C(n.onCreateShift())}),y(1,"i",49),l(2),o()}if(d&2){let i=u();s(2),m("",i.t("shifts.actions.create")," ")}}function ge(d,t){if(d&1){let i=x();a(0,"div",26)(1,"label",27),l(2),o(),a(3,"div",11)(4,"input",50),S("ngModelChange",function(n){_(i);let r=u();return g(r.shiftForm.requiredHours,n)||(r.shiftForm.requiredHours=n),C(n)}),o(),a(5,"span",51),l(6),o()()()}if(d&2){let i=u();s(2),h(i.t("shifts.fields.requiredHours")),s(2),p("ngModel",i.shiftForm.requiredHours),s(2),h(i.t("shifts.hours"))}}function Se(d,t){if(d&1){let i=x();a(0,"div",55)(1,"div",61)(2,"div",52)(3,"h6",4),l(4),o(),a(5,"button",62),f("click",function(){let n=_(i).$index,r=u(2);return C(r.removeShiftPeriod(n))}),y(6,"i",63),o()(),a(7,"div",31)(8,"div",32)(9,"label",10),l(10),o(),a(11,"input",64),S("ngModelChange",function(n){let r=_(i).$implicit;return g(r.startTime,n)||(r.startTime=n),C(n)}),o()(),a(12,"div",32)(13,"label",10),l(14),o(),a(15,"input",64),S("ngModelChange",function(n){let r=_(i).$implicit;return g(r.endTime,n)||(r.endTime=n),C(n)}),o()()()()()}if(d&2){let i=t.$implicit,e=t.$index,n=u(2);s(4),z("",n.t("shifts.period")," ",i.periodOrder),s(),c("disabled",n.shiftForm.shiftPeriods.length<=1),s(5),h(n.t("shifts.fields.startTime")),s(),p("ngModel",i.startTime),c("name","startTime"+e),s(3),h(n.t("shifts.fields.endTime")),s(),p("ngModel",i.endTime),c("name","endTime"+e)}}function be(d,t){if(d&1){let i=x();a(0,"div",31)(1,"div",32)(2,"label",10),l(3),o(),a(4,"div",11)(5,"input",65),S("ngModelChange",function(n){_(i);let r=u(2);return g(r.shiftForm.flexMinutesBefore,n)||(r.shiftForm.flexMinutesBefore=n),C(n)}),o(),a(6,"span",51),l(7),o()()(),a(8,"div",32)(9,"label",10),l(10),o(),a(11,"div",11)(12,"input",66),S("ngModelChange",function(n){_(i);let r=u(2);return g(r.shiftForm.flexMinutesAfter,n)||(r.shiftForm.flexMinutesAfter=n),C(n)}),o(),a(13,"span",51),l(14),o()()()()}if(d&2){let i=u(2);s(3),h(i.t("shifts.fields.flexMinutesBefore")),s(2),p("ngModel",i.shiftForm.flexMinutesBefore),s(2),h(i.t("common.minutes")),s(3),h(i.t("shifts.fields.flexMinutesAfter")),s(2),p("ngModel",i.shiftForm.flexMinutesAfter),s(2),h(i.t("common.minutes"))}}function _e(d,t){if(d&1&&(a(0,"small",60),y(1,"i",67),l(2),o()),d&2){let i=u(2);s(2),m("",i.t("shifts.validation.flexibleHoursAndGraceCombined")," ")}}function Ce(d,t){if(d&1){let i=x();a(0,"div")(1,"div",26)(2,"div",52)(3,"label",27),l(4),o(),a(5,"button",53),f("click",function(){_(i);let n=u();return C(n.addShiftPeriod())}),y(6,"i",54),l(7),o()(),W(8,Se,16,9,"div",55,N),o(),a(10,"div",26)(11,"div",56)(12,"input",57),S("ngModelChange",function(n){_(i);let r=u();return g(r.shiftForm.allowFlexibleHours,n)||(r.shiftForm.allowFlexibleHours=n),C(n)}),f("change",function(){_(i);let n=u();return C(n.onFlexibleHoursChange())}),o(),a(13,"label",35),l(14),o(),a(15,"small",36),l(16),o()(),v(17,be,15,6,"div",31),o(),a(18,"div",26)(19,"label",10),l(20),o(),a(21,"div",11)(22,"input",58),S("ngModelChange",function(n){_(i);let r=u();return g(r.shiftForm.gracePeriodMinutes,n)||(r.shiftForm.gracePeriodMinutes=n),C(n)}),o(),a(23,"span",51),l(24),o()(),a(25,"small",59),l(26),o(),v(27,_e,3,1,"small",60),o()()}if(d&2){let i=u();s(4),h(i.t("shifts.fields.periods")),s(),c("disabled",i.shiftForm.shiftPeriods.length>=2),s(2),m("",i.t("shifts.addPeriod")," "),s(),V(i.shiftForm.shiftPeriods),s(4),p("ngModel",i.shiftForm.allowFlexibleHours),s(2),m(" ",i.t("shifts.fields.allowFlexibleHours")," "),s(2),h(i.t("shifts.flexibleHoursDescription")),s(),M(i.shiftForm.allowFlexibleHours?17:-1),s(3),h(i.t("shifts.fields.gracePeriod")),s(2),p("ngModel",i.shiftForm.gracePeriodMinutes),s(2),h(i.t("common.minutes")),s(2),h(i.t("shifts.gracePeriodDescription")),s(),M(i.shiftForm.allowFlexibleHours&&i.shiftForm.gracePeriodMinutes?27:-1)}}function ve(d,t){d&1&&y(0,"span",43)}function Me(d,t){if(d&1&&(a(0,"p")(1,"strong"),l(2),o()()),d&2){let i,e=u();s(2),h((i=e.selectedShift())==null?null:i.name)}}function ye(d,t){d&1&&y(0,"span",43)}function Te(d,t){d&1&&y(0,"span",43)}function Fe(d,t){if(d&1){let i=x();a(0,"div",68),f("click",function(){_(i);let n=u();return C(n.onCloseModal())}),o()}}var ce=class d{shiftsService=w(he);branchesService=w(de);router=w(U);i18n=w(oe);permissionService=w($);PERMISSIONS={SHIFT_CREATE:`${k.SHIFT}.${P.CREATE}`,SHIFT_READ:`${k.SHIFT}.${P.READ}`,SHIFT_UPDATE:`${k.SHIFT}.${P.UPDATE}`,SHIFT_DELETE:`${k.SHIFT}.${P.DELETE}`,SHIFT_MANAGE:`${k.SHIFT}.${P.MANAGE}`};ShiftType=fe;ShiftStatus=me;get pageSizeSelectOptions(){return[{value:"10",label:"10"},{value:"25",label:"25"},{value:"50",label:"50"}]}get statusSelectOptions(){return[{value:1 .toString(),label:this.t("shifts.status.active")},{value:2 .toString(),label:this.t("shifts.status.inactive")},{value:3 .toString(),label:this.t("shifts.status.draft")},{value:4 .toString(),label:this.t("shifts.status.archived")}]}loading=b(!1);shifts=b([]);branches=b([]);defaultShift=b(null);currentPage=b(1);pageSize=b(10);totalCount=b(0);totalPages=b(0);searchTerm="";branchFilter=void 0;showCreateModal=b(!1);showEditModal=b(!1);showDeleteModal=b(!1);showDefaultShiftModal=b(!1);selectedShift=b(null);shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,shiftPeriods:[]};submitting=b(!1);tableColumns=D(()=>[{key:"name",label:this.t("shifts.fields.name"),sortable:!0,width:"250px",priority:"high",mobileLabel:this.t("shifts.fields.name"),renderHtml:!0},{key:"status",label:this.t("shifts.fields.status"),sortable:!0,width:"120px",align:"center",priority:"high",mobileLabel:this.t("shifts.fields.status"),renderHtml:!0},{key:"type",label:this.t("shifts.fields.type"),sortable:!1,width:"120px",align:"center",priority:"medium",hideOnMobile:!1,mobileLabel:this.t("shifts.fields.type"),renderHtml:!0},{key:"periods",label:this.t("shifts.fields.periods"),sortable:!1,width:"200px",priority:"medium",hideOnMobile:!1,mobileLabel:"Periods",renderHtml:!0},{key:"requirements",label:this.t("shifts.fields.requirements"),sortable:!1,width:"180px",priority:"low",hideOnMobile:!0,mobileLabel:"Rules",renderHtml:!0}]);tableActions=D(()=>[{key:"set-default",label:this.t("shifts.defaultShift.setDefault"),icon:"fa-star",color:"success",condition:t=>this.canSetDefaultShift(t)},{key:"edit",label:this.t("common.edit"),icon:"fa-edit",color:"primary",condition:()=>this.permissionService.has(this.PERMISSIONS.SHIFT_UPDATE)},{key:"delete",label:this.t("common.delete"),icon:"fa-trash",color:"danger",condition:()=>this.permissionService.has(this.PERMISSIONS.SHIFT_DELETE)}]);tableData=D(()=>this.shifts().map(t=>q(A({},t),{name:this.formatShiftName(t),status:this.formatShiftStatus(t),type:this.formatShiftType(t),periods:this.formatShiftPeriods(t),requirements:this.formatShiftRequirements(t)})));ngOnInit(){this.loadBranches(),this.loadShifts(),this.loadDefaultShift()}t(t){return this.i18n.t(t)}loadBranches(){this.branchesService.getBranches(1,1e3).subscribe({next:t=>{this.branches.set(t.items)},error:t=>{console.error("Failed to load branches:",t)}})}loadShifts(){this.loading.set(!0);let t=this.searchTerm.trim()||void 0;this.shiftsService.getShifts(this.currentPage(),this.pageSize(),t).subscribe({next:i=>{this.shifts.set(i.items),this.totalCount.set(i.totalCount),this.totalPages.set(i.totalPages),this.loading.set(!1)},error:i=>{console.error("Failed to load shifts:",i),this.loading.set(!1)}})}loadDefaultShift(){this.shiftsService.getDefaultShift().subscribe({next:t=>{this.defaultShift.set(t)},error:t=>{console.error("Failed to load default shift:",t),this.defaultShift.set(null)}})}onSearch(){this.currentPage.set(1),this.loadShifts()}onFilterChange(){this.currentPage.set(1),this.loadShifts()}onPageChange(t){this.currentPage.set(t),this.loadShifts()}onPageSizeSelectionChange(t){this.pageSize.set(parseInt(t)),this.onPageSizeChange()}onPageSizeChange(){this.currentPage.set(1),this.loadShifts()}getShiftTypeText(t){return t===1?this.t("shifts.types.timeBased"):this.t("shifts.types.hoursOnly")}getShiftStatusText(t){switch(t){case 1:return this.t("shifts.status.active");case 2:return this.t("shifts.status.inactive");case 3:return this.t("shifts.status.draft");case 4:return this.t("shifts.status.archived");default:return this.t("shifts.status.active")}}getShiftStatusClass(t){switch(t){case 1:return"bg-success";case 2:return"bg-light text-dark border";case 3:return"bg-warning";case 4:return"bg-light text-dark border";default:return"bg-success"}}formatTime(t){return t}formatHours(t){let i=Math.floor(t),e=Math.round((t-i)*60);return e>0?`${i}h ${e}m`:`${i}h`}getShiftTypeBadgeClass(t){return t===1?"badge-primary":"badge-info"}getPeriodTypeText(t){return this.isNightShift(t.startTime,t.endTime)?this.t("shifts.periodTypes.nightShift"):this.t("shifts.periodTypes.dayShift")}getPeriodHoursText(t){let i=this.calculatePeriodHours(t.startTime,t.endTime);return this.formatHours(i)}formatDate(t){let i=new Date(t);return i.toLocaleDateString()+" "+i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}onCreateShift(){this.router.navigate(["/shifts/create"])}onEditShift(t){this.router.navigate(["/shifts",t.id,"edit"])}onDeleteShift(t){this.selectedShift.set(t),this.showDeleteModal.set(!0)}onSubmitCreate(){if(!this.isFormValid())return;this.submitting.set(!0);let t={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(i=>({periodOrder:i.periodOrder,startTime:i.startTime,endTime:i.endTime})):void 0};this.shiftsService.createShift(t).subscribe({next:()=>{this.showCreateModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:i=>{console.error("Failed to create shift:",i),this.submitting.set(!1)}})}onSubmitEdit(){if(!this.isFormValid()||!this.selectedShift())return;this.submitting.set(!0);let t={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(i=>({id:i.id,periodOrder:i.periodOrder,startTime:i.startTime,endTime:i.endTime})):void 0};this.shiftsService.updateShift(this.selectedShift().id,t).subscribe({next:()=>{this.showEditModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:i=>{console.error("Failed to update shift:",i),this.submitting.set(!1)}})}onConfirmDelete(){this.selectedShift()&&(this.submitting.set(!0),this.shiftsService.deleteShift(this.selectedShift().id).subscribe({next:()=>{this.showDeleteModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:t=>{console.error("Failed to delete shift:",t),this.submitting.set(!1);let i="Failed to delete shift";t?.error?.message?i=t.error.message:t?.message&&(i=t.message),console.error("Deletion error:",i)}}))}onCloseModal(){this.showCreateModal.set(!1),this.showEditModal.set(!1),this.showDeleteModal.set(!1),this.showDefaultShiftModal.set(!1),this.selectedShift.set(null),this.submitting.set(!1)}onSetDefaultShift(t){this.defaultShift()?(this.selectedShift.set(t),this.showDefaultShiftModal.set(!0)):this.setDefaultShift(t,!1)}onConfirmSetDefaultShift(){this.selectedShift()&&this.setDefaultShift(this.selectedShift(),!0)}setDefaultShift(t,i){this.submitting.set(!0),this.shiftsService.setDefaultShift(t.id,i).subscribe({next:()=>{this.defaultShift.set(t),this.showDefaultShiftModal.set(!1),this.submitting.set(!1),console.log(`Successfully set "${t.name}" as default shift`)},error:e=>{console.error("Failed to set default shift:",e),this.submitting.set(!1)}})}isDefaultShift(t){return this.defaultShift()?.id===t.id}canSetDefaultShift(t){return this.permissionService.hasRole("SystemAdmin")&&t.status===1&&!this.isDefaultShift(t)}onShiftTypeChange(){this.shiftForm.shiftType===2?(this.shiftForm.allowFlexibleHours=!1,this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0,this.shiftForm.gracePeriodMinutes=void 0,this.shiftForm.shiftPeriods=[]):(this.shiftForm.requiredHours=void 0,this.shiftForm.shiftPeriods.length===0&&this.addShiftPeriod())}onFlexibleHoursChange(){this.shiftForm.allowFlexibleHours||(this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0)}calculatePeriodHours(t,i){if(!t||!i)return 0;let e=this.parseTime(t),n=this.parseTime(i);if(n>e)return(n-e)/(1e3*60*60);if(n<e){let r=(864e5-e)/36e5,T=n/(1e3*60*60);return r+T}else return 0}isNightShift(t,i){if(!t||!i)return!1;let e=this.parseTime(t);return this.parseTime(i)<e}getTotalShiftHours(){return this.shiftForm.shiftType===2?this.shiftForm.requiredHours||0:this.shiftForm.shiftPeriods.reduce((t,i)=>t+this.calculatePeriodHours(i.startTime,i.endTime),0)}parseTime(t){let[i,e]=t.split(":").map(Number);return(i*60+e)*60*1e3}validateBusinessRules(){let t=[];this.shiftForm.shiftType===1?(this.shiftForm.shiftPeriods.length===0&&t.push(this.t("shifts.validation.timeBased.periodsRequired")),this.shiftForm.requiredHours!==void 0&&t.push(this.t("shifts.validation.timeBased.noRequiredHours"))):this.shiftForm.shiftType===2&&(this.shiftForm.shiftPeriods.length>0&&t.push(this.t("shifts.validation.hoursOnly.noPeriods")),(!this.shiftForm.requiredHours||this.shiftForm.requiredHours<=0)&&t.push(this.t("shifts.validation.hoursOnly.requiredHours")),this.shiftForm.requiredHours&&this.shiftForm.requiredHours>24&&t.push(this.t("shifts.validation.hoursOnly.maxHours"))),this.shiftForm.shiftPeriods.length>2&&t.push(this.t("shifts.validation.periods.maxTwo"));for(let i=0;i<this.shiftForm.shiftPeriods.length;i++){let e=this.shiftForm.shiftPeriods[i];e.startTime===e.endTime&&t.push(this.t("shifts.validation.periods.sameTime").replace("{{period}}",(i+1).toString()));let n=this.calculatePeriodHours(e.startTime,e.endTime);n<=0&&t.push(this.t("shifts.validation.periods.positiveHours").replace("{{period}}",(i+1).toString())),n>24&&t.push(this.t("shifts.validation.periods.maxHours").replace("{{period}}",(i+1).toString()))}if(this.shiftForm.shiftType===2&&(this.shiftForm.allowFlexibleHours&&t.push(this.t("shifts.validation.hoursOnly.noFlexibleHours")),this.shiftForm.gracePeriodMinutes&&t.push(this.t("shifts.validation.hoursOnly.noGracePeriod"))),this.shiftForm.allowFlexibleHours&&(this.shiftForm.flexMinutesBefore&&this.shiftForm.flexMinutesBefore>480&&t.push(this.t("shifts.validation.flexible.maxBefore")),this.shiftForm.flexMinutesAfter&&this.shiftForm.flexMinutesAfter>480&&t.push(this.t("shifts.validation.flexible.maxAfter"))),this.shiftForm.gracePeriodMinutes&&this.shiftForm.gracePeriodMinutes>120&&t.push(this.t("shifts.validation.gracePeriod.max")),!this.shiftForm.isCheckInRequired&&!this.shiftForm.isAutoCheckOut&&t.push(this.t("shifts.validation.checkInOut.conflict")),this.shiftForm.shiftPeriods.length===2){let i=this.shiftForm.shiftPeriods.sort((F,H)=>F.periodOrder-H.periodOrder),e=i[0],n=i[1],r=this.isNightShift(e.startTime,e.endTime),T=this.isNightShift(n.startTime,n.endTime);if(r&&T&&t.push(this.t("shifts.validation.periods.multipleNight")),!r&&!T){let F=this.parseTime(e.endTime),H=this.parseTime(n.startTime);F>=H&&t.push(this.t("shifts.validation.periods.overlap"))}}return t}addShiftPeriod(){this.shiftForm.shiftPeriods.length<2&&this.shiftForm.shiftPeriods.push({periodOrder:this.shiftForm.shiftPeriods.length+1,startTime:"08:00",endTime:"17:00"})}removeShiftPeriod(t){this.shiftForm.shiftPeriods.splice(t,1),this.shiftForm.shiftPeriods.forEach((i,e)=>{i.periodOrder=e+1})}resetForm(){this.shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,shiftPeriods:[{periodOrder:1,startTime:"08:00",endTime:"17:00"}]}}isFormValid(){return this.shiftForm.name.trim()?this.validateBusinessRules().length===0:!1}getFormErrors(){let t=[];return this.shiftForm.name.trim()||t.push(this.t("shifts.validation.name.required")),t.push(...this.validateBusinessRules()),t}getPaginationArray(){let t=this.totalPages(),i=this.currentPage(),e=2,n=Math.max(1,i-e),r=Math.min(t,i+e);r-n<4&&t>4&&(n===1?r=Math.min(t,n+4):r===t&&(n=Math.max(1,r-4)));let T=[];for(let F=n;F<=r;F++)T.push(F);return T}getEndCount(){return Math.min(this.currentPage()*this.pageSize(),this.totalCount())}formatShiftName(t){let i=`<div><strong>${t.name}</strong>`;return this.isDefaultShift(t)&&(i+=`<span class="badge bg-success ms-2">${this.t("shifts.defaultShift.currentDefault")}</span>`),t.description&&(i+=`<small class="d-block text-muted">${t.description}</small>`),i+="</div>",i}formatShiftStatus(t){let i=this.getShiftStatusText(t.status);return`<span class="badge ${this.getShiftStatusClass(t.status)}">${i}</span>`}formatShiftType(t){let i=this.getShiftTypeText(t.shiftType);return`<span class="badge ${t.shiftType===1?"bg-primary":"bg-info"}">${i}</span>`}formatShiftPeriods(t){if(t.shiftType===1&&t.shiftPeriods){let i="<div>";return t.shiftPeriods.forEach(e=>{i+=`<div class="small">${this.formatTime(e.startTime)} - ${this.formatTime(e.endTime)}`,e.isNightPeriod&&(i+=`<span class="badge bg-warning ms-1">${this.t("shifts.nightShift")}</span>`),i+="</div>"}),i+="</div>",i}else if(t.shiftType===2)return`<div>${t.requiredHours} ${this.t("shifts.hours")}</div>`;return"<div>-</div>"}formatShiftRequirements(t){let i='<div class="small">';return t.isCheckInRequired&&(i+=`<div><i class="fas fa-check text-success me-1"></i>${this.t("shifts.checkInRequired")}</div>`),t.isAutoCheckOut&&(i+=`<div><i class="fas fa-check text-success me-1"></i>${this.t("shifts.autoCheckOut")}</div>`),t.allowFlexibleHours&&(i+=`<div><i class="fas fa-check text-success me-1"></i>${this.t("shifts.flexibleHours")}</div>`),t.gracePeriodMinutes&&(i+=`<div><i class="fas fa-clock text-info me-1"></i>${t.gracePeriodMinutes}min ${this.t("shifts.gracePeriod")}</div>`),i+="</div>",i}onActionClick(t){let{action:i,item:e}=t;switch(i){case"set-default":this.onSetDefaultShift(e);break;case"edit":this.onEditShift(e);break;case"delete":this.onDeleteShift(e);break;default:console.warn("Unknown action:",i)}}onTablePageChange(t){this.onPageChange(t)}onTablePageSizeChange(t){this.pageSize.set(t),this.onPageSizeChange()}static \u0275fac=function(i){return new(i||d)};static \u0275cmp=B({type:d,selectors:[["app-shifts"]],decls:128,vars:89,consts:[[1,"container-fluid","p-4"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","btn btn-primary","type","button",3,"click",4,"appHasPermission"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[1,"input-group"],["type","text",1,"form-control",3,"ngModelChange","keyup.enter","ngModel","ngModelOptions","placeholder"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-search"],[1,"col-md-5"],[3,"selectionChange","options","ngModel","ngModelOptions","placeholder","searchable","clearable"],[1,"card"],[3,"actionClick","pageChange","pageSizeChange","data","columns","actions","loading","currentPage","totalPages","totalItems","pageSize","emptyMessage","emptyTitle","responsiveMode"],[1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label","required"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["rows","2","name","description",1,"form-control",3,"ngModelChange","ngModel"],["name","status",3,"ngModelChange","options","ngModel","placeholder","required","searchable","clearable"],[1,"row"],[1,"col-md-6"],[1,"form-check"],["type","radio","name","shiftType",1,"form-check-input",3,"ngModelChange","change","value","ngModel"],[1,"form-check-label"],[1,"form-text","text-muted","d-block"],[1,"row","mb-3"],["type","checkbox","name","isCheckInRequired",1,"form-check-input",3,"ngModelChange","ngModel"],["type","checkbox","name","isAutoCheckOut",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"modal-dialog"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"modal-backdrop","fade","show"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],["type","number","name","requiredHours","min","0.5","max","24","step","0.5",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-text"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click","disabled"],[1,"fas","fa-plus","me-1"],[1,"card","mb-2"],[1,"form-check","mb-2"],["type","checkbox","name","allowFlexibleHours",1,"form-check-input",3,"ngModelChange","change","ngModel"],["type","number","name","gracePeriodMinutes","min","1","max","120",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text","text-muted"],[1,"form-text","text-info","d-block"],[1,"card-body","p-3"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash"],["type","time","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","number","name","flexMinutesBefore","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","flexMinutesAfter","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],[1,"fas","fa-info-circle","me-1"],[1,"modal-backdrop","fade","show",3,"click"]],template:function(i,e){if(i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),l(5),o(),R(6,pe,3,1,"button",5),o()()(),a(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10),l(12),o(),a(13,"div",11)(14,"input",12),S("ngModelChange",function(r){return g(e.searchTerm,r)||(e.searchTerm=r),r}),f("keyup.enter",function(){return e.onSearch()}),o(),a(15,"button",13),f("click",function(){return e.onSearch()}),y(16,"i",14),o()()(),a(17,"div",15)(18,"label",10),l(19),o(),a(20,"app-searchable-select",16),f("selectionChange",function(r){return e.onPageSizeSelectionChange(r)}),o()()()()(),a(21,"div",17)(22,"div",7)(23,"app-data-table",18),f("actionClick",function(r){return e.onActionClick(r)})("pageChange",function(r){return e.onTablePageChange(r)})("pageSizeChange",function(r){return e.onTablePageSizeChange(r)}),o()()()(),a(24,"div",19)(25,"div",20)(26,"div",21)(27,"div",22)(28,"h5",23),l(29),o(),a(30,"button",24),f("click",function(){return e.onCloseModal()}),o()(),a(31,"div",25)(32,"form")(33,"div",26)(34,"label",27),l(35),o(),a(36,"input",28),S("ngModelChange",function(r){return g(e.shiftForm.name,r)||(e.shiftForm.name=r),r}),o()(),a(37,"div",26)(38,"label",10),l(39),o(),a(40,"textarea",29),S("ngModelChange",function(r){return g(e.shiftForm.description,r)||(e.shiftForm.description=r),r}),o()(),a(41,"div",26)(42,"label",27),l(43),o(),a(44,"app-searchable-select",30),S("ngModelChange",function(r){return g(e.shiftForm.status,r)||(e.shiftForm.status=r),r}),o()(),a(45,"div",26)(46,"label",27),l(47),o(),a(48,"div",31)(49,"div",32)(50,"div",33)(51,"input",34),S("ngModelChange",function(r){return g(e.shiftForm.shiftType,r)||(e.shiftForm.shiftType=r),r}),f("change",function(){return e.onShiftTypeChange()}),o(),a(52,"label",35),l(53),o(),a(54,"small",36),l(55),o()()(),a(56,"div",32)(57,"div",33)(58,"input",34),S("ngModelChange",function(r){return g(e.shiftForm.shiftType,r)||(e.shiftForm.shiftType=r),r}),f("change",function(){return e.onShiftTypeChange()}),o(),a(59,"label",35),l(60),o(),a(61,"small",36),l(62),o()()()()(),v(63,ge,7,3,"div",26),v(64,Ce,28,12,"div"),a(65,"div",37)(66,"div",32)(67,"div",33)(68,"input",38),S("ngModelChange",function(r){return g(e.shiftForm.isCheckInRequired,r)||(e.shiftForm.isCheckInRequired=r),r}),o(),a(69,"label",35),l(70),o(),a(71,"small",36),l(72),o()()(),a(73,"div",32)(74,"div",33)(75,"input",39),S("ngModelChange",function(r){return g(e.shiftForm.isAutoCheckOut,r)||(e.shiftForm.isAutoCheckOut=r),r}),o(),a(76,"label",35),l(77),o(),a(78,"small",36),l(79),o()()()()()(),a(80,"div",40)(81,"button",41),f("click",function(){return e.onCloseModal()}),l(82),o(),a(83,"button",42),f("click",function(){return e.showCreateModal()?e.onSubmitCreate():e.onSubmitEdit()}),v(84,ve,1,0,"span",43),l(85),o()()()()(),a(86,"div",19)(87,"div",44)(88,"div",21)(89,"div",22)(90,"h5",23),l(91),o(),a(92,"button",24),f("click",function(){return e.onCloseModal()}),o()(),a(93,"div",25)(94,"p"),l(95),o(),v(96,Me,3,1,"p"),o(),a(97,"div",40)(98,"button",41),f("click",function(){return e.onCloseModal()}),l(99),o(),a(100,"button",45),f("click",function(){return e.onConfirmDelete()}),v(101,ye,1,0,"span",43),l(102),o()()()()(),a(103,"div",19)(104,"div",44)(105,"div",21)(106,"div",22)(107,"h5",23),l(108),o(),a(109,"button",24),f("click",function(){return e.onCloseModal()}),o()(),a(110,"div",25)(111,"p"),l(112),o(),a(113,"p")(114,"strong"),l(115),o(),l(116),o(),a(117,"p")(118,"strong"),l(119),o(),l(120),o()(),a(121,"div",40)(122,"button",41),f("click",function(){return e.onCloseModal()}),l(123),o(),a(124,"button",46),f("click",function(){return e.onConfirmSetDefaultShift()}),v(125,Te,1,0,"span",43),l(126),o()()()()(),v(127,Fe,1,0,"div",47)),i&2){let n,r;s(5),h(e.t("shifts.title")),s(),c("appHasPermission",e.PERMISSIONS.SHIFT_CREATE),s(6),h(e.t("common.search")),s(2),p("ngModel",e.searchTerm),c("ngModelOptions",O(87,ue))("placeholder",e.t("shifts.searchPlaceholder")),s(5),h(e.t("common.pageSize")),s(),c("options",e.pageSizeSelectOptions)("ngModel",e.pageSize().toString())("ngModelOptions",O(88,ue))("placeholder",e.t("common.select"))("searchable",!1)("clearable",!1),s(3),c("data",e.tableData())("columns",e.tableColumns())("actions",e.tableActions())("loading",e.loading)("currentPage",e.currentPage)("totalPages",e.totalPages)("totalItems",e.totalCount)("pageSize",e.pageSize)("emptyMessage",e.t("shifts.noShifts"))("emptyTitle",e.t("shifts.noShiftsDescription"))("responsiveMode","auto"),s(),E("display",e.showCreateModal()||e.showEditModal()?"block":"none"),I("show",e.showCreateModal()||e.showEditModal()),s(5),m(" ",e.showCreateModal()?e.t("shifts.actions.create"):e.t("shifts.actions.edit")," "),s(6),h(e.t("shifts.fields.name")),s(),p("ngModel",e.shiftForm.name),s(3),h(e.t("shifts.fields.description")),s(),p("ngModel",e.shiftForm.description),s(3),h(e.t("shifts.fields.status")),s(),c("options",e.statusSelectOptions),p("ngModel",e.shiftForm.status),c("placeholder",e.t("common.select"))("required",!0)("searchable",!0)("clearable",!1),s(3),h(e.t("shifts.fields.type")),s(4),c("value",e.ShiftType.TimeBased),p("ngModel",e.shiftForm.shiftType),s(2),m(" ",e.t("shifts.types.timeBased")," "),s(2),h(e.t("shifts.types.timeBasedDescription")),s(3),c("value",e.ShiftType.HoursOnly),p("ngModel",e.shiftForm.shiftType),s(2),m(" ",e.t("shifts.types.hoursOnly")," "),s(2),h(e.t("shifts.types.hoursOnlyDescription")),s(),M(e.shiftForm.shiftType===e.ShiftType.HoursOnly?63:-1),s(),M(e.shiftForm.shiftType===e.ShiftType.TimeBased?64:-1),s(4),p("ngModel",e.shiftForm.isCheckInRequired),s(2),m(" ",e.t("shifts.fields.checkInRequired")," "),s(2),h(e.t("shifts.checkInRequiredDescription")),s(3),p("ngModel",e.shiftForm.isAutoCheckOut),s(2),m(" ",e.t("shifts.fields.autoCheckOut")," "),s(2),h(e.t("shifts.autoCheckOutDescription")),s(3),m(" ",e.t("common.cancel")," "),s(),c("disabled",!e.isFormValid()||e.submitting()),s(),M(e.submitting()?84:-1),s(),m(" ",e.showCreateModal()?e.t("common.create"):e.t("common.update")," "),s(),E("display",e.showDeleteModal()?"block":"none"),I("show",e.showDeleteModal()),s(5),h(e.t("shifts.actions.delete")),s(4),h(e.t("shifts.deleteConfirmation")),s(),M(e.selectedShift()?96:-1),s(3),m(" ",e.t("common.cancel")," "),s(),c("disabled",e.submitting()),s(),M(e.submitting()?101:-1),s(),m(" ",e.t("common.delete")," "),s(),E("display",e.showDefaultShiftModal()?"block":"none"),I("show",e.showDefaultShiftModal()),s(5),h(e.t("shifts.defaultShift.confirmReplace")),s(4),h(e.t("shifts.defaultShift.confirmReplaceMessage")),s(3),m("",e.t("shifts.defaultShift.newShift"),":"),s(),m(" ",(n=e.selectedShift())==null?null:n.name),s(3),m("",e.t("shifts.defaultShift.currentShift"),":"),s(),m(" ",(r=e.defaultShift())==null?null:r.name),s(3),m(" ",e.t("shifts.defaultShift.cancelButton")," "),s(),c("disabled",e.submitting()),s(),M(e.submitting()?125:-1),s(),m(" ",e.t("shifts.defaultShift.confirmButton")," "),s(),M(e.showCreateModal()||e.showEditModal()||e.showDeleteModal()||e.showDefaultShiftModal()?127:-1)}},dependencies:[L,se,Y,j,Z,G,ee,J,K,ne,ie,te,X,Q,re,ae,le],styles:['.required[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:none;font-weight:600}.badge[_ngcontent-%COMP%]{font-size:.75rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.form-text.text-muted[_ngcontent-%COMP%]{font-size:.8rem}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{border-radius:.375rem;margin:0 .125rem}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.table-responsive[_ngcontent-%COMP%]{border-radius:.375rem}@media (max-width: 768px){.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.2rem .4rem;font-size:.75rem}.table-responsive[_ngcontent-%COMP%]{font-size:.9rem}}']})};export{ce as ShiftsComponent};
