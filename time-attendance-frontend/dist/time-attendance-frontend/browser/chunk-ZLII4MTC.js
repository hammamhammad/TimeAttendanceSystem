import{a as j}from"./chunk-A3B6D6R2.js";import{a as T}from"./chunk-4QC5DFDN.js";import{a as M}from"./chunk-K7WTKFJQ.js";import{a as A}from"./chunk-MRHL7QNZ.js";import{a as D}from"./chunk-H5EPUHY6.js";import"./chunk-MUNQGSPX.js";import"./chunk-Y62N6K5S.js";import{a as V}from"./chunk-EYAJMHM7.js";import{a as y}from"./chunk-HHXRLUSQ.js";import"./chunk-S3CAEY4A.js";import{b as S}from"./chunk-TJ2U7DWW.js";import{d as w,g as I,m as R}from"./chunk-TWXUAMJ4.js";import{Bb as l,Cb as q,Db as f,Ea as C,R as d,W as v,X as g,Xa as u,Ya as p,Yb as b,bb as h,cb as r,da as _,db as o,eb as m,lb as W,nb as k,pb as c,ta as i,wc as x}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";function N(n,e){n&1&&m(0,"app-loading-spinner")}function B(n,e){if(n&1&&(r(0,"div",9)(1,"strong"),l(2),o(),r(3,"p",12),l(4),o()()),n&2){let t=c(2);i(2),f("",t.i18n.t("remoteWork.request.reason"),":"),i(2),q(t.request().reason)}}function P(n,e){if(n&1&&(r(0,"div",2)(1,"div",3)(2,"h5",5),l(3),o()(),r(4,"div",7),m(5,"app-definition-list",8),o()()),n&2){let t=c(2);i(3),q(t.i18n.t("remoteWork.request.approval_information")),i(2),h("items",t.approvalInfoItems())("labelWidth","4")("valueWidth","8")}}function O(n,e){if(n&1){let t=W();r(0,"button",13),k("click",function(){v(t);let a=c(2);return g(a.onReject())}),m(1,"i",14),l(2),o(),r(3,"button",15),k("click",function(){v(t);let a=c(2);return g(a.onApprove())}),m(4,"i",16),l(5),o(),r(6,"button",17),k("click",function(){v(t);let a=c(2);return g(a.onCancel())}),m(7,"i",18),l(8),o()}if(n&2){let t=c(2);i(2),f(" ",t.i18n.t("common.reject")," "),i(3),f(" ",t.i18n.t("common.approve")," "),i(3),f(" ",t.i18n.t("remoteWork.request.cancel")," ")}}function L(n,e){if(n&1){let t=W();r(0,"div",2)(1,"div",3)(2,"div",4)(3,"h5",5),l(4),o(),m(5,"app-status-badge",6),o()(),r(6,"div",7),m(7,"app-definition-list",8),u(8,B,5,2,"div",9),o()(),u(9,P,6,4,"div",2),r(10,"div",10)(11,"button",11),k("click",function(){v(t);let a=c();return g(a.onBack())}),l(12),o(),u(13,O,9,3),o()}if(n&2){let t=c();i(4),q(t.i18n.t("remoteWork.request.basic_information")),i(),h("status",t.statusBadge().variant)("label",t.statusBadge().label),i(2),h("items",t.basicInfoItems())("labelWidth","4")("valueWidth","8"),i(),p(t.request().reason?8:-1),i(),p(t.approvalInfoItems().length>0?9:-1),i(3),f(" ",t.i18n.t("common.back")," "),i(),p(t.request().status===0?13:-1)}}var E=class n{router=d(I);route=d(w);remoteWorkService=d(j);notification=d(y);confirmation=d(D);i18n=d(S);request=_(null);loading=_(!1);requestId=_(null);statusBadge=b(()=>{let e=this.request()?.status;return e===void 0?{label:"",variant:"secondary"}:{label:this.getStatusText(e),variant:this.getStatusVariant(e)}});basicInfoItems=b(()=>{let e=this.request();return e?[{label:this.i18n.t("remoteWork.request.employee"),value:e.employeeName||"-"},{label:this.i18n.t("remoteWork.request.startDate"),value:this.formatDate(e.startDate)},{label:this.i18n.t("remoteWork.request.endDate"),value:this.formatDate(e.endDate)},{label:this.i18n.t("remoteWork.request.workingDays"),value:e.workingDaysCount.toString()},{label:this.i18n.t("remoteWork.request.created_by"),value:e.createdByUserName||"-"}]:[]});approvalInfoItems=b(()=>{let e=this.request();if(!e)return[];let t=[];return e.approvedByUserName&&t.push({label:this.i18n.t("remoteWork.request.approved_by"),value:e.approvedByUserName}),e.approvedAt&&t.push({label:this.i18n.t("remoteWork.request.approval_date"),value:this.formatDateTime(e.approvedAt)}),e.rejectionReason&&t.push({label:this.i18n.t("remoteWork.request.rejection_reason"),value:e.rejectionReason}),t});ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e&&(this.requestId.set(parseInt(e,10)),this.loadRequest())}loadRequest(){let e=this.requestId();e&&(this.loading.set(!0),this.remoteWorkService.getById(e).subscribe({next:t=>{this.request.set(t),this.loading.set(!1)},error:()=>{this.notification.error(this.i18n.t("remoteWork.request.errors.load_failed")),this.loading.set(!1),this.router.navigate(["/remote-work"])}}))}onEdit(){let e=this.requestId();e&&this.router.navigate(["/remote-work/edit",e])}onApprove(){let e=this.request();if(!e||e.status!==0){this.notification.warning(this.i18n.t("remoteWork.request.errors.cannot_approve"));return}this.confirmation.confirm({title:this.i18n.t("remoteWork.request.approveConfirm"),message:this.i18n.t("remoteWork.request.approveMessage"),confirmText:this.i18n.t("common.yes"),cancelText:this.i18n.t("common.no")}).then(t=>{t.confirmed&&e&&this.remoteWorkService.approve({requestId:e.id,approverId:1,decision:1}).subscribe({next:()=>{this.notification.success(this.i18n.t("remoteWork.request.success.approved")),this.loadRequest()},error:()=>{this.notification.error(this.i18n.t("remoteWork.request.errors.approve_failed"))}})})}onReject(){let e=this.request();if(!e||e.status!==0){this.notification.warning(this.i18n.t("remoteWork.request.errors.cannot_reject"));return}this.confirmation.confirm({title:this.i18n.t("remoteWork.request.rejectConfirm"),message:this.i18n.t("remoteWork.request.rejectMessage"),confirmText:this.i18n.t("common.yes"),cancelText:this.i18n.t("common.no")}).then(t=>{t.confirmed&&e&&this.remoteWorkService.approve({requestId:e.id,approverId:1,decision:2,rejectionReason:""}).subscribe({next:()=>{this.notification.success(this.i18n.t("remoteWork.request.success.rejected")),this.loadRequest()},error:()=>{this.notification.error(this.i18n.t("remoteWork.request.errors.reject_failed"))}})})}onCancel(){let e=this.request();if(!e||e.status!==0){this.notification.warning(this.i18n.t("remoteWork.request.errors.cannot_cancel"));return}this.confirmation.confirm({title:this.i18n.t("remoteWork.request.cancelConfirm"),message:this.i18n.t("remoteWork.request.cancelMessage"),confirmText:this.i18n.t("common.yes"),cancelText:this.i18n.t("common.no")}).then(t=>{t.confirmed&&e&&this.remoteWorkService.cancel(e.id).subscribe({next:()=>{this.notification.success(this.i18n.t("remoteWork.request.success.cancelled")),this.router.navigate(["/remote-work"])},error:()=>{this.notification.error(this.i18n.t("remoteWork.request.errors.cancel_failed"))}})})}onBack(){this.router.navigate(["/remote-work"])}getStatusText(e){return{0:this.i18n.t("remoteWork.status.pending"),1:this.i18n.t("remoteWork.status.approved"),2:this.i18n.t("remoteWork.status.rejected"),3:this.i18n.t("remoteWork.status.cancelled")}[e]||""}getStatusVariant(e){return{0:"warning",1:"success",2:"danger",3:"secondary"}[e]||"secondary"}formatDate(e){return e?new Date(e).toLocaleDateString():"-"}formatDateTime(e){return e?new Date(e).toLocaleString():"-"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["app-view-remote-work-assignment"]],decls:4,vars:4,consts:[[1,"view-remote-work-page"],["mode","view","moduleName","remoteWork.request","moduleRoute","remote-work",3,"title","entityId"],[1,"card","mb-3"],[1,"card-header"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[3,"status","label"],[1,"card-body"],[3,"items","labelWidth","valueWidth"],[1,"mt-3"],[1,"d-flex","justify-content-end","gap-2","mt-4"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"mt-2","mb-0"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-success",3,"click"],[1,"fas","fa-check","me-2"],["type","button",1,"btn","btn-warning",3,"click"],[1,"fas","fa-ban","me-2"]],template:function(t,s){if(t&1&&(r(0,"div",0),m(1,"app-form-header",1),u(2,N,1,0,"app-loading-spinner"),u(3,L,14,10),o()),t&2){let a;i(),h("title",s.i18n.t("remoteWork.request.view_details"))("entityId",(a=s.request())==null?null:a.id),i(),p(s.loading()?2:-1),i(),p(!s.loading()&&s.request()?3:-1)}},dependencies:[x,R,T,A,M,V],styles:[".view-remote-work-page[_ngcontent-%COMP%]{padding:1.5rem}.card-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{font-weight:600}"]})};export{E as ViewRemoteWorkAssignmentComponent};
