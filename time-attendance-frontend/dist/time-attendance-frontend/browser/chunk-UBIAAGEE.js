import{a as Z}from"./chunk-XICW7MB6.js";import{a as K}from"./chunk-7YUBOVPA.js";import{a as J}from"./chunk-AVDFWZMN.js";import{a as X}from"./chunk-MVZGGAOK.js";import"./chunk-4335LQ3A.js";import"./chunk-LDWMK676.js";import{a as H}from"./chunk-HCDX4O2L.js";import{b as N,c as R,e as V,f as q,g as O,h as T,i as Y,j as B,u as L,v as j,w as U,z as Q}from"./chunk-HF7V7ZC6.js";import{a as z}from"./chunk-RUOWTK24.js";import"./chunk-HZR4WXEY.js";import{d as I,g as A}from"./chunk-O3U3HUCY.js";import{a as G}from"./chunk-77FC2LKR.js";import"./chunk-A6EM5NV6.js";import{$a as C,Eb as l,Fb as b,Gb as c,Ha as F,J as M,K as w,Mb as f,Nb as v,Ob as x,T as g,Y as y,Z as u,_a as k,eb as h,f as W,fa as _,fb as o,gb as r,hb as p,ob as S,qb as P,sb as s,t as D,wa as t,zb as E}from"./chunk-IGEIB4M6.js";import"./chunk-YMDWBF3A.js";function ee(d,n){if(d&1&&(o(0,"div",3),p(1,"app-loading-spinner",4),r()),d&2){let a=s();t(),h("message",a.i18n.t("common.loading"))("variant","primary")("centered",!0)}}function te(d,n){d&1&&p(0,"span",43)}function ie(d,n){d&1&&p(0,"i",44)}function oe(d,n){if(d&1){let a=S();o(0,"form",5,0),P("ngSubmit",function(){y(a);let i=s();return u(i.onSubmit())}),o(2,"div",6)(3,"div",7)(4,"h5",8),p(5,"i",9),l(6),r()(),o(7,"div",10)(8,"div",11)(9,"div",12)(10,"label",13),l(11),r(),o(12,"app-searchable-select",14),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.branchId,i)||(m.policyForm.branchId=i),u(i)}),r()(),o(13,"div",12)(14,"label",15),l(15),r(),o(16,"div",16)(17,"input",17),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.isActive,i)||(m.policyForm.isActive=i),u(i)}),r(),o(18,"label",18),l(19),r()()()()()(),o(20,"div",6)(21,"div",7)(22,"h5",8),p(23,"i",19),l(24),r()(),o(25,"div",10)(26,"p",20),p(27,"i",21),l(28),r(),o(29,"div",11)(30,"div",22)(31,"label",23),l(32),r(),o(33,"input",24),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.maxDaysPerWeek,i)||(m.policyForm.maxDaysPerWeek=i),u(i)}),r(),o(34,"div",25),l(35),r()(),o(36,"div",22)(37,"label",26),l(38),r(),o(39,"input",27),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.maxDaysPerMonth,i)||(m.policyForm.maxDaysPerMonth=i),u(i)}),r(),o(40,"div",25),l(41),r()(),o(42,"div",22)(43,"label",28),l(44),r(),o(45,"input",29),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.maxDaysPerYear,i)||(m.policyForm.maxDaysPerYear=i),u(i)}),r(),o(46,"div",25),l(47),r()()()()(),o(48,"div",6)(49,"div",7)(50,"h5",8),p(51,"i",30),l(52),r()(),o(53,"div",10)(54,"div",11)(55,"div",31)(56,"div",32)(57,"input",33),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.requiresManagerApproval,i)||(m.policyForm.requiresManagerApproval=i),u(i)}),r(),o(58,"label",34),l(59),r()(),o(60,"div",25),l(61),r()()()()(),o(62,"div",6)(63,"div",7)(64,"h5",8),p(65,"i",35),l(66),r()(),o(67,"div",10)(68,"div",11)(69,"div",12)(70,"label",36),l(71),r(),o(72,"input",37),x("ngModelChange",function(i){y(a);let m=s();return v(m.policyForm.minAdvanceNoticeDays,i)||(m.policyForm.minAdvanceNoticeDays=i),u(i)}),r(),o(73,"div",25),l(74),r()()()()(),o(75,"div",38)(76,"div",10)(77,"div",39)(78,"button",40),P("click",function(){y(a);let i=s();return u(i.onCancel())}),p(79,"i",41),l(80),r(),o(81,"button",42),k(82,te,1,0,"span",43)(83,ie,1,0,"i",44),l(84),r()()()()()}if(d&2){let a=E(1),e=s();t(6),c(" ",e.i18n.t("common.basic_information")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.branch")," "),t(),f("ngModel",e.policyForm.branchId),h("options",e.branches())("placeholder",e.i18n.t("remoteWork.policy.select_branch"))("required",!0),t(3),c(" ",e.i18n.t("common.status")," "),t(2),f("ngModel",e.policyForm.isActive),t(2),c(" ",e.policyForm.isActive?e.i18n.t("common.active"):e.i18n.t("common.inactive")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.quota_settings")," "),t(4),c(" ",e.i18n.t("remoteWork.policy.quota_settings_help")," "),t(4),c(" ",e.i18n.t("remoteWork.policy.max_days_per_week")," "),t(),f("ngModel",e.policyForm.maxDaysPerWeek),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),t(2),b(e.i18n.t("remoteWork.policy.max_7_days")),t(3),c(" ",e.i18n.t("remoteWork.policy.max_days_per_month")," "),t(),f("ngModel",e.policyForm.maxDaysPerMonth),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),t(2),b(e.i18n.t("remoteWork.policy.max_31_days")),t(3),c(" ",e.i18n.t("remoteWork.policy.max_days_per_year")," "),t(),f("ngModel",e.policyForm.maxDaysPerYear),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),t(2),b(e.i18n.t("remoteWork.policy.max_365_days")),t(5),c(" ",e.i18n.t("remoteWork.policy.approval_settings")," "),t(5),f("ngModel",e.policyForm.requiresManagerApproval),t(2),c(" ",e.i18n.t("remoteWork.policy.requires_manager_approval")," "),t(2),c(" ",e.policyForm.requiresManagerApproval?e.i18n.t("remoteWork.policy.approval_required_help"):e.i18n.t("remoteWork.policy.approval_automatic_help")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.advance_notice")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.min_advance_notice_days")," "),t(),f("ngModel",e.policyForm.minAdvanceNoticeDays),h("placeholder",e.i18n.t("remoteWork.policy.no_advance_notice")),t(2),b(e.i18n.t("remoteWork.policy.advance_notice_help")),t(4),h("disabled",e.submitting()),t(2),c(" ",e.i18n.t("common.cancel")," "),t(),h("disabled",e.submitting()||!a.form.valid),t(),C(e.submitting()?82:83),t(2),c(" ",e.i18n.t("common.save")," ")}}var $=class d{service=g(Z);branchesService=g(X);router=g(A);route=g(I);notificationService=g(z);destroy$=new W;i18n=g(G);loading=_(!1);submitting=_(!1);branches=_([]);policyId=_(null);policyForm={branchId:void 0,maxDaysPerWeek:void 0,maxDaysPerMonth:void 0,maxDaysPerYear:void 0,requiresManagerApproval:!0,allowConsecutiveDays:!1,maxConsecutiveDays:void 0,minAdvanceNoticeDays:void 0,blackoutPeriods:void 0,countForOvertime:!0,enforceShiftTimes:!0,isActive:!0};ngOnInit(){this.loadData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadData(){this.loading.set(!0),this.route.paramMap.pipe(w(this.destroy$),M(n=>{let a=Number(n.get("id"));if(!a||a<=0)throw this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_id")),this.router.navigate(["/settings/remote-work-policy"]),new Error("Invalid policy ID");return this.policyId.set(a),D({branches:this.branchesService.getBranchesForDropdown(),policy:this.service.getById(a)})})).subscribe({next:({branches:n,policy:a})=>{this.branches.set(n.map(e=>({value:e.id,label:e.name}))),this.populateForm(a),this.loading.set(!1)},error:n=>{this.loading.set(!1),console.error("Failed to load data:",n),n.status===404?this.notificationService.error(this.i18n.t("remoteWork.policy.errors.not_found")):this.notificationService.error(this.i18n.t("remoteWork.policy.errors.load_failed")),this.router.navigate(["/settings/remote-work-policy"])}})}populateForm(n){this.policyForm={branchId:n.branchId,maxDaysPerWeek:n.maxDaysPerWeek??void 0,maxDaysPerMonth:n.maxDaysPerMonth??void 0,maxDaysPerYear:n.maxDaysPerYear??void 0,requiresManagerApproval:n.requiresManagerApproval,allowConsecutiveDays:n.allowConsecutiveDays,maxConsecutiveDays:n.maxConsecutiveDays??void 0,minAdvanceNoticeDays:n.minAdvanceNoticeDays??void 0,blackoutPeriods:n.blackoutPeriods??void 0,countForOvertime:n.countForOvertime,enforceShiftTimes:n.enforceShiftTimes,isActive:n.isActive}}onSubmit(){if(!this.validateForm())return;let n=this.policyId();if(!n){this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_id"));return}this.submitting.set(!0);let a={id:n,maxDaysPerWeek:this.policyForm.maxDaysPerWeek,maxDaysPerMonth:this.policyForm.maxDaysPerMonth,maxDaysPerYear:this.policyForm.maxDaysPerYear,requiresManagerApproval:this.policyForm.requiresManagerApproval,allowConsecutiveDays:this.policyForm.allowConsecutiveDays,maxConsecutiveDays:this.policyForm.maxConsecutiveDays,minAdvanceNoticeDays:this.policyForm.minAdvanceNoticeDays,blackoutPeriods:this.policyForm.blackoutPeriods,countForOvertime:this.policyForm.countForOvertime,enforceShiftTimes:this.policyForm.enforceShiftTimes};this.service.update(n,a).subscribe({next:()=>{this.submitting.set(!1),this.notificationService.success(this.i18n.t("remoteWork.policy.success.updated")),this.router.navigate(["/settings/remote-work-policy"])},error:e=>{this.submitting.set(!1),console.error("Failed to update policy:",e),this.notificationService.error(this.i18n.t("remoteWork.policy.errors.update_failed"))}})}validateForm(){return this.policyForm.branchId?(this.policyForm.maxDaysPerWeek!==void 0&&this.policyForm.maxDaysPerWeek!==null||this.policyForm.maxDaysPerMonth!==void 0&&this.policyForm.maxDaysPerMonth!==null||this.policyForm.maxDaysPerYear!==void 0&&this.policyForm.maxDaysPerYear!==null||this.notificationService.warning(this.i18n.t("remoteWork.policy.warnings.no_quotas")),this.policyForm.maxDaysPerWeek!==void 0&&this.policyForm.maxDaysPerWeek!==null&&(this.policyForm.maxDaysPerWeek<0||this.policyForm.maxDaysPerWeek>7)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_week")),!1):this.policyForm.maxDaysPerMonth!==void 0&&this.policyForm.maxDaysPerMonth!==null&&(this.policyForm.maxDaysPerMonth<0||this.policyForm.maxDaysPerMonth>31)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_month")),!1):this.policyForm.maxDaysPerYear!==void 0&&this.policyForm.maxDaysPerYear!==null&&(this.policyForm.maxDaysPerYear<0||this.policyForm.maxDaysPerYear>365)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_year")),!1):this.policyForm.minAdvanceNoticeDays!==void 0&&this.policyForm.minAdvanceNoticeDays!==null&&this.policyForm.minAdvanceNoticeDays<0?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_advance_notice")),!1):!0):(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.branch_required")),!1)}onCancel(){this.router.navigate(["/settings/remote-work-policy"])}static \u0275fac=function(a){return new(a||d)};static \u0275cmp=F({type:d,selectors:[["app-edit-remote-work-policy"]],decls:4,vars:4,consts:[["policyFormElement","ngForm"],[1,"edit-remote-work-policy-page"],["mode","edit","moduleName","remote-work-policy","moduleRoute","settings/remote-work-policy",3,"title","entityId","loading"],[1,"d-flex","justify-content-center","align-items-center","py-5"],[3,"message","variant","centered"],[3,"ngSubmit"],[1,"card","mb-4"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fas","fa-info-circle","text-info","me-2"],[1,"card-body"],[1,"row"],[1,"col-md-6","mb-3"],["for","branchId",1,"form-label","required"],["name","branchId",3,"ngModelChange","ngModel","options","placeholder","required"],["for","isActive",1,"form-label"],[1,"form-check","form-switch","mt-2"],["type","checkbox","id","isActive","name","isActive",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isActive",1,"form-check-label"],[1,"fas","fa-calendar-check","text-success","me-2"],[1,"text-muted","mb-3"],[1,"fas","fa-info-circle","me-1"],[1,"col-md-4","mb-3"],["for","maxDaysPerWeek",1,"form-label"],["type","number","id","maxDaysPerWeek","name","maxDaysPerWeek","min","0","max","7",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"form-text"],["for","maxDaysPerMonth",1,"form-label"],["type","number","id","maxDaysPerMonth","name","maxDaysPerMonth","min","0","max","31",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["for","maxDaysPerYear",1,"form-label"],["type","number","id","maxDaysPerYear","name","maxDaysPerYear","min","0","max","365",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"fas","fa-user-check","text-warning","me-2"],[1,"col-md-12","mb-3"],[1,"form-check","form-switch"],["type","checkbox","id","requiresManagerApproval","name","requiresManagerApproval",1,"form-check-input",3,"ngModelChange","ngModel"],["for","requiresManagerApproval",1,"form-check-label"],[1,"fas","fa-bell","text-primary","me-2"],["for","minAdvanceNoticeDays",1,"form-label"],["type","number","id","minAdvanceNoticeDays","name","minAdvanceNoticeDays","min","0",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"card"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"]],template:function(a,e){a&1&&(o(0,"div",1),p(1,"app-form-header",2),k(2,ee,2,3,"div",3)(3,oe,85,37,"form"),r()),a&2&&(t(),h("title",e.i18n.t("remoteWork.policy.edit_policy"))("entityId",e.policyId()||void 0)("loading",e.submitting()),t(),C(e.loading()?2:3))},dependencies:[Q,Y,R,B,N,V,q,U,j,L,T,O,K,J,H],styles:['.edit-remote-work-policy-page[_ngcontent-%COMP%]{padding:1.5rem}.card[_ngcontent-%COMP%]{border:1px solid #e9ecef;border-radius:.5rem;box-shadow:0 1px 3px #0000000d;transition:box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:1rem 1.5rem}.card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#495057}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.required[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#198754;border-color:#198754}.gap-2[_ngcontent-%COMP%]{gap:.5rem}@media (max-width: 768px){.edit-remote-work-policy-page[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}}']})};export{$ as EditRemoteWorkPolicyComponent};
