import{a as te}from"./chunk-PEVKBW7N.js";import{a as ee}from"./chunk-46YUKDEL.js";import{a as Y}from"./chunk-OCNPGNI4.js";import{a as Z}from"./chunk-NGEOUUU5.js";import{a as K}from"./chunk-KREF7F7A.js";import{a as X}from"./chunk-IE5XUEO5.js";import{a as Q}from"./chunk-C3GHRZ52.js";import{e as R,h as $,q as z,r as U,t as H,z as q}from"./chunk-YQIE4CGE.js";import{a as G}from"./chunk-JNFDDMIM.js";import{a as J}from"./chunk-GEGVYT7O.js";import"./chunk-A6EM5NV6.js";import{A as v,Da as N,E as h,Fb as O,Ga as c,Gb as A,Ha as s,Ia as P,L as t,Lb as j,Ma as F,Oa as k,Pa as w,Q as M,Qa as E,Wa as V,_a as D,aa as b,ab as W,ba as x,da as B,ea as T,fa as S,ga as m,ha as a,ia as i,ja as p,qa as C,rb as L,sa as f,ua as g,y as _,z as u}from"./chunk-5OFYUWMA.js";import{e as I}from"./chunk-YMDWBF3A.js";var ae=o=>["/nfc-tags",o,"view"],oe=o=>["/nfc-tags",o,"edit"],ie=(o,r)=>r.id;function re(o,r){if(o&1&&(a(0,"option",10),c(1),i()),o&2){let e=r.$implicit;m("ngValue",e.id),t(),s(e.name)}}function ce(o,r){if(o&1&&(a(0,"div",14),p(1,"app-loading-spinner",17),i()),o&2){let e=g();t(),m("message",e.i18n.t("nfc_tags.loading"))("centered",!0)}}function le(o,r){if(o&1){let e=C();a(0,"app-empty-state",18),f("action",function(){u(e);let l=g();return v(l.navigateToCreate())}),i()}if(o&2){let e=g();m("title",e.i18n.t("nfc_tags.no_tags_found"))("message",e.i18n.t("nfc_tags.no_tags_message"))("actionText",e.i18n.t("nfc_tags.register_tag"))}}function se(o,r){if(o&1){let e=C();a(0,"button",35),f("click",function(){u(e);let l=g().$implicit,d=g(2);return v(d.lockTag(l))}),p(1,"i",36),i()}if(o&2){let e=g(3);m("title",e.i18n.t("nfc_tags.lock"))}}function de(o,r){if(o&1){let e=C();a(0,"tr")(1,"td")(2,"code"),c(3),i()(),a(4,"td"),c(5),i(),a(6,"td"),c(7),i(),a(8,"td"),p(9,"app-status-badge",26),i(),a(10,"td"),p(11,"app-status-badge",26),i(),a(12,"td"),c(13),D(14,"date"),i(),a(15,"td",23)(16,"div",27)(17,"button",28),p(18,"i",29),i(),a(19,"button",30),p(20,"i",31),i(),b(21,se,2,1,"button",32),a(22,"button",33),f("click",function(){let l=u(e).$implicit,d=g(2);return v(d.deleteTag(l))}),p(23,"i",34),i()()()()}if(o&2){let e=r.$implicit,n=g(2);t(3),s(e.tagUid),t(2),s(e.branchName),t(2),s(e.description||"-"),t(2),m("status",e.isActive?n.i18n.t("common.active"):n.i18n.t("common.inactive"))("variant",e.isActive?"success":"secondary"),t(2),m("status",e.isWriteProtected?n.i18n.t("nfc_tags.locked"):n.i18n.t("nfc_tags.unlocked"))("variant",e.isWriteProtected?"warning":"info"),t(2),s(W(14,14,e.createdAtUtc,"short")),t(4),m("routerLink",V(17,ae,e.id))("title",n.i18n.t("common.view")),t(2),m("routerLink",V(19,oe,e.id))("title",n.i18n.t("common.edit")),t(2),x(e.isWriteProtected?-1:21),t(),m("title",n.i18n.t("common.delete"))}}function me(o,r){if(o&1){let e=C();a(0,"li",38)(1,"button",39),f("click",function(){let l=u(e).$implicit,d=g(3);return v(d.onPageChange(l))}),c(2),i()()}if(o&2){let e=r.$implicit,n=g(3);N("active",e===n.currentPage()),t(2),s(e)}}function ge(o,r){if(o&1){let e=C();a(0,"nav")(1,"ul",37)(2,"li",38)(3,"button",39),f("click",function(){u(e);let l=g(2);return v(l.onPageChange(l.currentPage()-1))}),p(4,"i",40),i()(),T(5,me,3,3,"li",41,B),a(7,"li",38)(8,"button",39),f("click",function(){u(e);let l=g(2);return v(l.onPageChange(l.currentPage()+1))}),p(9,"i",42),i()()()()}if(o&2){let e=g(2);t(2),N("disabled",e.currentPage()===1),t(3),S(e.getPageNumbers()),t(2),N("disabled",e.currentPage()===e.totalPages())}}function pe(o,r){if(o&1&&(a(0,"div",16)(1,"div",19)(2,"div",20)(3,"table",21)(4,"thead",22)(5,"tr")(6,"th"),c(7),i(),a(8,"th"),c(9),i(),a(10,"th"),c(11),i(),a(12,"th"),c(13),i(),a(14,"th"),c(15),i(),a(16,"th"),c(17),i(),a(18,"th",23),c(19),i()()(),a(20,"tbody"),T(21,de,24,21,"tr",null,ie),i()()()(),a(23,"div",24)(24,"small",25),c(25),i(),b(26,ge,10,4,"nav"),i()()),o&2){let e=g();t(7),s(e.i18n.t("nfc_tags.tag_uid")),t(2),s(e.i18n.t("common.branch")),t(2),s(e.i18n.t("common.description")),t(2),s(e.i18n.t("common.status")),t(2),s(e.i18n.t("nfc_tags.write_protected")),t(2),s(e.i18n.t("common.created_at")),t(2),s(e.i18n.t("common.actions")),t(2),S(e.nfcTags()),t(4),F(" ",e.i18n.t("common.showing")," ",e.nfcTags().length," ",e.i18n.t("common.of")," ",e.totalItems()," ",e.i18n.t("common.entries")," "),t(),x(e.totalPages()>1?26:-1)}}var ne=class o{router=_(O);nfcTagsService=_(te);branchesService=_(ee);notificationService=_(G);confirmationService=_(K);i18n=_(J);nfcTags=h([]);branches=h([]);loading=h(!0);currentPage=h(1);totalPages=h(1);totalItems=h(0);pageSize=10;selectedBranchId=null;selectedStatus=null;ngOnInit(){this.loadBranches(),this.loadNfcTags()}loadBranches(){this.branchesService.getBranchesForDropdown().subscribe({next:r=>this.branches.set(r),error:()=>this.notificationService.error(this.i18n.t("errors.loading_branches"))})}loadNfcTags(){this.loading.set(!0),this.nfcTagsService.getNfcTags(this.currentPage(),this.pageSize,this.selectedBranchId??void 0,this.selectedStatus??void 0).subscribe({next:r=>{this.nfcTags.set(r.items),this.totalPages.set(r.totalPages),this.totalItems.set(r.totalCount),this.loading.set(!1)},error:()=>{this.notificationService.error(this.i18n.t("nfc_tags.error_loading")),this.loading.set(!1)}})}onFilterChange(){this.currentPage.set(1),this.loadNfcTags()}clearFilters(){this.selectedBranchId=null,this.selectedStatus=null,this.currentPage.set(1),this.loadNfcTags()}onPageChange(r){r>=1&&r<=this.totalPages()&&(this.currentPage.set(r),this.loadNfcTags())}getPageNumbers(){let r=this.totalPages(),e=this.currentPage(),n=[],l=Math.max(1,e-2),d=Math.min(r,e+2);for(let y=l;y<=d;y++)n.push(y);return n}lockTag(r){return I(this,null,function*(){if(r.isWriteProtected){this.notificationService.warning(this.i18n.t("nfc_tags.already_locked"));return}(yield this.confirmationService.confirm({title:this.i18n.t("nfc_tags.lock_confirmation_title"),message:this.i18n.t("nfc_tags.lock_confirmation_message"),confirmText:this.i18n.t("nfc_tags.lock"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-warning",icon:"fa-lock",iconClass:"text-warning"})).confirmed&&this.nfcTagsService.lockNfcTag(r.id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("nfc_tags.lock_success")),this.loadNfcTags()},error:()=>this.notificationService.error(this.i18n.t("nfc_tags.lock_error"))})})}deleteTag(r){return I(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("nfc_tags.delete_confirmation_title"),message:this.i18n.t("nfc_tags.delete_confirmation_message"),confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.nfcTagsService.deleteNfcTag(r.id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("nfc_tags.delete_success")),this.loadNfcTags()},error:()=>this.notificationService.error(this.i18n.t("nfc_tags.delete_error"))})})}navigateToCreate(){this.router.navigate(["/nfc-tags/create"])}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=M({type:o,selectors:[["app-nfc-tags"]],decls:33,vars:17,consts:[[1,"container-fluid"],[3,"title","subtitle"],["routerLink","/nfc-tags/create",1,"btn","btn-primary"],[1,"fa-solid","fa-plus","me-2"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[1,"form-select",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[1,"col-md-4","d-flex","align-items-end"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-times","me-2"],[1,"d-flex","justify-content-center","py-5"],["icon","fa-solid fa-tag","actionIcon","fa-solid fa-plus",3,"title","message","actionText"],[1,"card"],[3,"message","centered"],["icon","fa-solid fa-tag","actionIcon","fa-solid fa-plus",3,"action","title","message","actionText"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"],[1,"text-end"],[1,"card-footer","d-flex","justify-content-between","align-items-center"],[1,"text-muted"],[3,"status","variant"],[1,"btn-group","btn-group-sm"],[1,"btn","btn-outline-info",3,"routerLink","title"],[1,"fa-solid","fa-eye"],[1,"btn","btn-outline-primary",3,"routerLink","title"],[1,"fa-solid","fa-edit"],[1,"btn","btn-outline-warning",3,"title"],[1,"btn","btn-outline-danger",3,"click","title"],[1,"fa-solid","fa-trash"],[1,"btn","btn-outline-warning",3,"click","title"],[1,"fa-solid","fa-lock"],[1,"pagination","pagination-sm","mb-0"],[1,"page-item"],[1,"page-link",3,"click"],[1,"fa-solid","fa-chevron-left"],[1,"page-item",3,"active"],[1,"fa-solid","fa-chevron-right"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"app-page-header",1)(2,"button",2),p(3,"i",3),c(4),i()(),a(5,"div",4)(6,"div",5)(7,"div",6)(8,"div",7)(9,"label",8),c(10),i(),a(11,"select",9),E("ngModelChange",function(d){return w(n.selectedBranchId,d)||(n.selectedBranchId=d),d}),f("change",function(){return n.onFilterChange()}),a(12,"option",10),c(13),i(),T(14,re,2,2,"option",10,ie),i()(),a(16,"div",7)(17,"label",8),c(18),i(),a(19,"select",9),E("ngModelChange",function(d){return w(n.selectedStatus,d)||(n.selectedStatus=d),d}),f("change",function(){return n.onFilterChange()}),a(20,"option",10),c(21),i(),a(22,"option",10),c(23),i(),a(24,"option",10),c(25),i()()(),a(26,"div",11)(27,"button",12),f("click",function(){return n.clearFilters()}),p(28,"i",13),c(29),i()()()()(),b(30,ce,2,2,"div",14)(31,le,1,3,"app-empty-state",15)(32,pe,27,13,"div",16),i()),e&2&&(t(),m("title",n.i18n.t("nfc_tags.title"))("subtitle",n.i18n.t("nfc_tags.subtitle")),t(3),P(" ",n.i18n.t("nfc_tags.register_tag")," "),t(6),s(n.i18n.t("common.branch")),t(),k("ngModel",n.selectedBranchId),t(),m("ngValue",null),t(),s(n.i18n.t("common.all")),t(),S(n.branches()),t(4),s(n.i18n.t("common.status")),t(),k("ngModel",n.selectedStatus),t(),m("ngValue",null),t(),s(n.i18n.t("common.all")),t(),m("ngValue",!0),t(),s(n.i18n.t("common.active")),t(),m("ngValue",!1),t(),s(n.i18n.t("common.inactive")),t(4),P(" ",n.i18n.t("common.clear_filters")," "),t(),x(n.loading()?30:n.nfcTags().length===0?31:32))},dependencies:[j,A,q,U,H,z,R,$,Q,X,Y,Z,L],encapsulation:2})};export{ne as NfcTagsComponent};
