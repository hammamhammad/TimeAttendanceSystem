import{a as O}from"./chunk-BUDDO7QI.js";import{d as A,g as N,h as B,m as L}from"./chunk-4DYU65FO.js";import{b as j}from"./chunk-CQWUHIOF.js";import{$a as o,$b as M,Ca as R,Q as x,Ta as v,Ua as _,V as S,W as w,Xa as k,Ya as V,Za as b,_a as n,ab as p,ca as f,eb as T,ec as P,gb as g,ib as c,qb as r,ra as i,rb as d,sb as m,tb as D}from"./chunk-LHYYCVNR.js";import"./chunk-DGAILPFQ.js";var $=(l,e)=>e.key||e.id;function U(l,e){if(l&1&&(n(0,"div",13)(1,"div",15)(2,"span",16),r(3),o()()()),l&2){let t=c();i(3),d(t.i18n.t("common.loading"))}}function q(l,e){if(l&1&&p(0,"i",27),l&2){let t=c(2);b("title",t.i18n.t("roles.system_role"))}}function z(l,e){if(l&1&&(n(0,"span",33),r(1),o()),l&2){let t=c(2);i(),d(t.i18n.t("roles.system"))}}function G(l,e){if(l&1&&(n(0,"span",34),r(1),o()),l&2){let t=c(2);i(),d(t.i18n.t("roles.custom"))}}function H(l,e){if(l&1&&(n(0,"div",44)(1,"div",45)(2,"div",46),p(3,"i",47),n(4,"div",48)(5,"div",49)(6,"small",50),r(7),o(),n(8,"span",51),r(9),o()(),n(10,"p",52),r(11),o()()()()()),l&2){let t=e.$implicit,a=c(3);i(3),b("ngClass",a.getPermissionIcon(t.key)),i(4),d(a.getPermissionResource(t.key)),i(),b("ngClass",a.getActionBadgeClass(t.key)),i(),m(" ",a.getPermissionAction(t.key)," "),i(2),m(" ",a.getPermissionDescription(t)," ")}}function J(l,e){if(l&1&&(n(0,"div",42),k(1,H,12,5,"div",44,$),o()),l&2){let t,a=c(2);i(),V((t=a.role())==null?null:t.permissions)}}function K(l,e){if(l&1&&(n(0,"div",43),p(1,"i",53),n(2,"p",54),r(3),o()()),l&2){let t=c(2);i(3),d(t.i18n.t("roles.no_permissions"))}}function Q(l,e){if(l&1){let t=T();n(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"h5",21)(5,"div",22)(6,"div",23)(7,"div",24),p(8,"i",25),o()(),n(9,"div")(10,"div",26),r(11),v(12,q,1,1,"i",27),o(),n(13,"small",28),r(14),o()()()()(),n(15,"div",29)(16,"div",17)(17,"div",30)(18,"dl",17)(19,"dt",31),r(20),o(),n(21,"dd",32),r(22),o(),n(23,"dt",31),r(24),o(),n(25,"dd",32),v(26,z,2,1,"span",33)(27,G,2,1,"span",34),o(),n(28,"dt",31),r(29),o(),n(30,"dd",32)(31,"span",35),r(32),o()()()(),n(33,"div",30)(34,"dl",17)(35,"dt",31),r(36),o(),n(37,"dd",32),r(38),o(),n(39,"dt",31),r(40),o(),n(41,"dd",32),r(42),o()()()()()()(),n(43,"div",36)(44,"div",19)(45,"div",20)(46,"h6",21),r(47),o()(),n(48,"div",29)(49,"div",37)(50,"button",38),g("click",function(){S(t);let u=c();return w(u.onEdit())}),p(51,"i",10),r(52),o(),n(53,"button",39),g("click",function(){S(t);let u=c();return w(u.onManagePermissions())}),p(54,"i",40),r(55),o()()()()()(),n(56,"div",41)(57,"div",20)(58,"h6",21),p(59,"i",40),r(60),o()(),n(61,"div",29),v(62,J,3,0,"div",42)(63,K,4,1,"div",43),o()()}if(l&2){let t,a,u,I,E,y,C,h,s=c();i(11),m(" ",(t=s.role())==null?null:t.name," "),i(),_((a=s.role())!=null&&a.isSystem?12:-1),i(2),D("",((u=s.role())==null||u.permissions==null?null:u.permissions.length)||0," ",s.i18n.t("roles.permissions_assigned")),i(6),m("",s.i18n.t("roles.name"),":"),i(2),d((I=s.role())==null?null:I.name),i(2),m("",s.i18n.t("roles.type"),":"),i(2),_((E=s.role())!=null&&E.isSystem?26:27),i(3),m("",s.i18n.t("roles.user_count"),":"),i(3),d(((y=s.role())==null?null:y.userCount)||0),i(4),m("",s.i18n.t("roles.created_at"),":"),i(2),d(s.formatDate(s.role().createdAtUtc)),i(2),m("",s.i18n.t("roles.permissions"),":"),i(2),d(((C=s.role())==null||C.permissions==null?null:C.permissions.length)||0),i(5),d(s.i18n.t("common.actions")),i(5),m(" ",s.i18n.t("roles.edit")," "),i(3),m(" ",s.i18n.t("roles.manage_permissions")," "),i(5),m(" ",s.i18n.t("roles.permissions")," "),i(2),_((h=s.role())!=null&&h.permissions&&s.role().permissions.length>0?62:63)}}function W(l,e){if(l&1&&(n(0,"div",14),p(1,"i",55),r(2),o()),l&2){let t=c();i(2),m(" ",t.error()||t.i18n.t("roles.role_not_found")," ")}}var F=class l{route=x(A);router=x(N);rolesService=x(O);i18n=x(j);role=f(null);loading=f(!0);error=f("");ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?this.loadRole(e):(this.error.set("Invalid role ID"),this.loading.set(!1))}loadRole(e){this.rolesService.getRoleById(+e).subscribe({next:t=>{this.role.set(t),this.loading.set(!1)},error:t=>{this.error.set(this.getErrorMessage(t)),this.loading.set(!1)}})}onEdit(){this.role()&&this.router.navigate(["/roles",this.role().id,"edit"])}onManagePermissions(){this.role()&&this.router.navigate(["/roles",this.role().id,"edit"])}onBack(){this.router.navigate(["/roles"])}formatDate(e){return new Date(e).toLocaleDateString()}getPermissionIcon(e){return e.includes("read")?"fa-eye":e.includes("create")?"fa-plus":e.includes("update")?"fa-edit":e.includes("delete")?"fa-trash":"fa-key"}getPermissionResource(e){return e.split(".")[0]||e}getPermissionAction(e){return e.split(".")[1]||"unknown"}getActionBadgeClass(e){return e.includes("read")?"bg-info-subtle text-info":e.includes("create")?"bg-success-subtle text-success":e.includes("update")?"bg-warning-subtle text-warning":e.includes("delete")?"bg-danger-subtle text-danger":"bg-secondary-subtle text-secondary"}getPermissionDescription(e){return e.description||`${e.key} permission`}getErrorMessage(e){return e?.error?.error?e.error.error:this.i18n.t("errors.unknown")}static \u0275fac=function(t){return new(t||l)};static \u0275cmp=R({type:l,selectors:[["app-view-role"]],decls:25,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/roles"],[1,"breadcrumb-item","active"],[1,"btn-group"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-edit","me-2"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"alert","alert-danger"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-title","bg-info-subtle","text-info","rounded-circle"],[1,"fa-solid","fa-user-shield"],[1,"fw-medium"],[1,"fa-solid","fa-shield-alt","text-primary","ms-2",3,"title"],[1,"text-muted"],[1,"card-body"],[1,"col-md-6"],[1,"col-sm-5"],[1,"col-sm-7"],[1,"badge","bg-warning-subtle","text-warning"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary"],[1,"col-lg-4"],[1,"d-grid","gap-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-outline-info",3,"click"],[1,"fa-solid","fa-key","me-2"],[1,"card","mt-4"],[1,"row","g-2"],[1,"text-center","py-4"],[1,"col-md-6","col-lg-4"],[1,"permission-item","border","rounded","p-2"],[1,"d-flex","align-items-start"],[1,"fas","me-2","text-muted","mt-1",3,"ngClass"],[1,"flex-grow-1"],[1,"d-flex","align-items-center","mb-1"],[1,"fw-medium","me-2"],[1,"badge",3,"ngClass"],[1,"text-muted","small","mb-0"],[1,"fa-solid","fa-key","fa-2x","text-muted","mb-2"],[1,"text-muted","mb-0"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(t,a){t&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),r(4),o(),n(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),r(9),o()(),n(10,"li",4)(11,"a",6),r(12),o()(),n(13,"li",7),r(14),o()()()(),n(15,"div",8)(16,"button",9),g("click",function(){return a.onEdit()}),p(17,"i",10),r(18),o(),n(19,"button",11),g("click",function(){return a.onBack()}),p(20,"i",12),r(21),o()()(),v(22,U,4,1,"div",13)(23,Q,64,19)(24,W,3,1,"div",14),o()),t&2&&(i(4),d(a.i18n.t("roles.view_details")),i(5),d(a.i18n.t("dashboard.title")),i(3),d(a.i18n.t("roles.title")),i(2),d(a.i18n.t("roles.view_details")),i(4),m(" ",a.i18n.t("roles.edit")," "),i(3),m(" ",a.i18n.t("common.back")," "),i(),_(a.loading()?22:a.role()?23:24))},dependencies:[P,M,L,B],encapsulation:2})};export{F as ViewRoleComponent};
