import{a as O}from"./chunk-PEVKBW7N.js";import{a as W}from"./chunk-D46AVG3X.js";import{a as A}from"./chunk-KREF7F7A.js";import{a as L}from"./chunk-IE5XUEO5.js";import{a as R}from"./chunk-C3GHRZ52.js";import{a as M}from"./chunk-JNFDDMIM.js";import{a as F}from"./chunk-GEGVYT7O.js";import"./chunk-A6EM5NV6.js";import{A as C,Cb as E,E as u,Fb as D,Ga as c,Gb as P,Ha as d,Ia as m,Ja as k,L as n,Lb as B,Q as w,Wa as S,_a as N,aa as g,ab as y,ba as p,fb as I,ga as _,ha as a,ia as o,ja as r,qa as b,rb as V,sa as T,ua as l,y as s,z as h}from"./chunk-5OFYUWMA.js";import{e as x}from"./chunk-YMDWBF3A.js";var j=e=>["/nfc-tags",e,"edit"];function H(e,i){if(e&1&&(a(0,"div",2),r(1,"app-loading-spinner",5),o()),e&2){let t=l();n(),_("message",t.i18n.t("common.loading"))("centered",!0)}}function q(e,i){if(e&1){let t=b();a(0,"button",22),T("click",function(){h(t);let v=l(2);return C(v.lockTag())}),r(1,"i",23),c(2),o()}if(e&2){let t=l(2);n(2),m(" ",t.i18n.t("nfc_tags.lock")," ")}}function z(e,i){if(e&1&&(a(0,"small",27),c(1),N(2,"date"),o()),e&2){let t=l(3);n(),k(" ",t.i18n.t("nfc_tags.locked_at"),": ",y(2,2,t.tag().lockedAt,"medium")," ")}}function G(e,i){if(e&1&&(a(0,"div",24),r(1,"i",25),a(2,"div")(3,"strong"),c(4),o(),a(5,"p",26),c(6),o()()(),g(7,z,3,5,"small",27)),e&2){let t=l(2);n(4),d(t.i18n.t("nfc_tags.locked")),n(2),d(t.i18n.t("nfc_tags.locked_description")),n(),p(t.tag().lockedAt?7:-1)}}function J(e,i){if(e&1&&(a(0,"div",21),r(1,"i",28),a(2,"div")(3,"strong"),c(4),o(),a(5,"p",26),c(6),o()()()),e&2){let t=l(2);n(4),d(t.i18n.t("nfc_tags.unlocked")),n(2),d(t.i18n.t("nfc_tags.unlocked_description"))}}function K(e,i){if(e&1){let t=b();a(0,"div",3)(1,"div",6),r(2,"app-detail-card",7),o(),a(3,"div",8)(4,"div",9)(5,"div",10)(6,"h6",11),c(7),o()(),a(8,"div",12)(9,"div",13)(10,"button",14),r(11,"i",15),c(12),o(),g(13,q,3,1,"button",16),a(14,"button",17),T("click",function(){h(t);let v=l();return C(v.deleteTag())}),r(15,"i",18),c(16),o()()()(),a(17,"div",19)(18,"div",10)(19,"h6",11),r(20,"i",20),c(21),o()(),a(22,"div",12),g(23,G,8,3)(24,J,7,2,"div",21),o()()()()}if(e&2){let t=l();n(2),_("title",t.tag().tagUid)("subtitle",t.tag().description||t.i18n.t("nfc_tags.no_description"))("fields",t.tagFields()),n(5),d(t.i18n.t("common.actions")),n(3),_("routerLink",S(10,j,t.tag().id)),n(2),m(" ",t.i18n.t("common.edit")," "),n(),p(t.tag().isWriteProtected?-1:13),n(3),m(" ",t.i18n.t("common.delete")," "),n(5),m(" ",t.i18n.t("nfc_tags.security_status")," "),n(2),p(t.tag().isWriteProtected?23:24)}}function Q(e,i){if(e&1&&(a(0,"div",4),r(1,"i",29),c(2),o()),e&2){let t=l();n(2),m(" ",t.error()||t.i18n.t("nfc_tags.tag_not_found")," ")}}var U=class e{route=s(E);router=s(D);nfcTagsService=s(O);notificationService=s(M);confirmationService=s(A);i18n=s(F);tag=u(null);loading=u(!0);error=u("");tagFields=I(()=>{let i=this.tag();return i?[{label:this.i18n.t("nfc_tags.tag_uid"),value:i.tagUid,copyable:!0},{label:this.i18n.t("common.branch"),value:i.branchName||"-"},{label:this.i18n.t("common.description"),value:i.description||"-"},{label:this.i18n.t("common.status"),value:i.isActive?this.i18n.t("common.active"):this.i18n.t("common.inactive"),type:"badge",badgeVariant:i.isActive?"success":"secondary"},{label:this.i18n.t("nfc_tags.write_protected"),value:i.isWriteProtected?this.i18n.t("nfc_tags.locked"):this.i18n.t("nfc_tags.unlocked"),type:"badge",badgeVariant:i.isWriteProtected?"warning":"info"},{label:this.i18n.t("common.created_at"),value:i.createdAtUtc,type:"date"}]:[]});ngOnInit(){let i=this.route.snapshot.paramMap.get("id");i?this.loadTag(parseInt(i)):(this.error.set("Invalid tag ID"),this.loading.set(!1))}loadTag(i){this.nfcTagsService.getNfcTagById(i).subscribe({next:t=>{this.tag.set(t),this.loading.set(!1)},error:t=>{this.error.set(t.error?.error||this.i18n.t("nfc_tags.tag_not_found")),this.loading.set(!1)}})}lockTag(){return x(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("nfc_tags.lock_confirmation_title"),message:this.i18n.t("nfc_tags.lock_confirmation_message"),confirmText:this.i18n.t("nfc_tags.lock"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-warning",icon:"fa-lock",iconClass:"text-warning"})).confirmed&&this.nfcTagsService.lockNfcTag(this.tag().id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("nfc_tags.lock_success")),this.loadTag(this.tag().id)},error:()=>this.notificationService.error(this.i18n.t("nfc_tags.lock_error"))})})}deleteTag(){return x(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("nfc_tags.delete_confirmation_title"),message:this.i18n.t("nfc_tags.delete_confirmation_message"),confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.nfcTagsService.deleteNfcTag(this.tag().id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("nfc_tags.delete_success")),this.router.navigate(["/nfc-tags"])},error:()=>this.notificationService.error(this.i18n.t("nfc_tags.delete_error"))})})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=w({type:e,selectors:[["app-view-nfc-tag"]],decls:5,vars:3,consts:[[1,"container-fluid"],["backRoute","/nfc-tags",3,"title","showBackButton"],[1,"d-flex","justify-content-center","py-5"],[1,"row"],[1,"alert","alert-danger"],[3,"message","centered"],[1,"col-lg-8"],["icon","fa-solid fa-tag","layout","two-column",3,"title","subtitle","fields"],[1,"col-lg-4"],[1,"card","mb-3"],[1,"card-header"],[1,"card-title","mb-0"],[1,"card-body"],[1,"d-grid","gap-2"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"fa-solid","fa-edit","me-2"],[1,"btn","btn-outline-warning"],[1,"btn","btn-outline-danger",3,"click"],[1,"fa-solid","fa-trash","me-2"],[1,"card"],[1,"fa-solid","fa-shield-halved","me-2"],[1,"d-flex","align-items-center","text-info"],[1,"btn","btn-outline-warning",3,"click"],[1,"fa-solid","fa-lock","me-2"],[1,"d-flex","align-items-center","text-warning","mb-2"],[1,"fa-solid","fa-lock","fa-2x","me-3"],[1,"text-muted","small","mb-0"],[1,"text-muted"],[1,"fa-solid","fa-lock-open","fa-2x","me-3"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(t,f){t&1&&(a(0,"div",0),r(1,"app-page-header",1),g(2,H,2,2,"div",2)(3,K,25,12,"div",3)(4,Q,3,1,"div",4),o()),t&2&&(n(),_("title",f.i18n.t("nfc_tags.view_tag"))("showBackButton",!0),n(),p(f.loading()?2:f.tag()?3:4))},dependencies:[B,P,R,W,L,V],encapsulation:2})};export{U as ViewNfcTagComponent};
