import{a as W}from"./chunk-TWVQBOJB.js";import{a as B}from"./chunk-5EWIY6BL.js";import{a as U}from"./chunk-NYAEJKNV.js";import{n as H,o as j,s as A}from"./chunk-RH4QBYEM.js";import{b as F}from"./chunk-CQWUHIOF.js";import{$a as l,Ca as k,Ga as f,Ia as P,Q as S,V as _,W as g,Za as d,_a as a,ab as p,ac as E,bc as V,ca as C,eb as v,ec as N,gb as u,ib as c,mb as J,nb as y,ob as K,pb as I,qb as m,ra as o,rb as b,sb as x,tb as O,vb as Q}from"./chunk-LHYYCVNR.js";import{a as $,b as z,d as T}from"./chunk-DGAILPFQ.js";function ie(n,t){if(n&1){let e=v();a(0,"button",23),u("click",function(){_(e);let r=c(2);return g(r.onAddDepartment())}),p(1,"i",24),l()}if(n&2){let e=c(2);d("title",e.i18n.t("department.addDepartment"))}}function oe(n,t){if(n&1){let e=v();a(0,"button",33),u("click",function(){_(e);let r=c(3);return g(r.onBulkDelete())}),p(1,"i",34),m(2),l()}if(n&2){let e=c(3);o(2),x(" ",e.i18n.t("common.deleteSelected")," ")}}function re(n,t){if(n&1){let e=v();a(0,"div",25)(1,"div",26)(2,"div",27)(3,"span",28),p(4,"i",29),m(5),l(),a(6,"div",18),f(7,oe,3,1,"button",30),a(8,"button",31),u("click",function(){_(e);let r=c(2);return g(r.clearSelection())}),p(9,"i",32),m(10),l()()()()()}if(n&2){let e=c(2);o(5),O(" ",e.selectedDepartments().size," ",e.i18n.t("common.selected")," "),o(2),d("ngIf",e.allowDelete),o(3),x(" ",e.i18n.t("common.clearSelection")," ")}}function ae(n,t){if(n&1){let e=v();a(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"span",8),p(5,"i",9),l(),a(6,"input",10),u("input",function(r){_(e);let s=c();return g(s.onSearchChange(r.target.value))}),l()()(),a(7,"div",11)(8,"div",12)(9,"input",13),u("change",function(r){_(e);let s=c();return g(s.onShowInactiveChange(r.target.checked))}),l(),a(10,"label",14),m(11),l()()(),a(12,"div",11)(13,"div",12)(14,"input",15),u("change",function(r){_(e);let s=c();return g(s.showHierarchy.set(r.target.checked))}),l(),a(15,"label",16),m(16),l()()(),a(17,"div",17)(18,"div",18)(19,"button",19),u("click",function(){_(e);let r=c();return g(r.refresh())}),p(20,"i",20),l(),f(21,ie,2,1,"button",21),l()()(),f(22,re,11,4,"div",22),l()}if(n&2){let e=c();o(6),d("placeholder",e.i18n.t("common.search")+"...")("value",e.searchTerm()),o(3),d("checked",e.showInactive()),o(2),x(" ",e.i18n.t("common.showInactive")," "),o(3),d("checked",e.showHierarchy()),o(2),x(" ",e.i18n.t("department.showHierarchy")," "),o(3),d("title",e.i18n.t("common.refresh")),o(2),d("ngIf",e.allowEdit),o(),d("ngIf",e.selectedDepartments().size>0&&e.allowSelection)}}function le(n,t){if(n&1&&(a(0,"div",35)(1,"div",36)(2,"span",37),m(3),l()()()),n&2){let e=c();o(3),x("",e.i18n.t("common.loading"),"...")}}function ce(n,t){if(n&1){let e=v();a(0,"th",53)(1,"div",12)(2,"input",54),u("change",function(){_(e);let r=c(2);return g(r.toggleAllSelection())}),l()()()}if(n&2){let e=c(2);o(2),d("checked",e.isAllPageSelected())("indeterminate",e.isSomePageSelected())}}function de(n,t){if(n&1&&(a(0,"th"),m(1),l()),n&2){let e=c(2);o(),b(e.i18n.t("department.path"))}}function me(n,t){if(n&1&&(a(0,"th",55),m(1),l()),n&2){let e=c(2);o(),b(e.i18n.t("common.actions"))}}function se(n,t){if(n&1){let e=v();a(0,"td",53)(1,"div",12)(2,"input",66),u("change",function(r){_(e);let s=c().$implicit;return c(2).toggleSelection(s.id),g(r.stopPropagation())}),l()()()}if(n&2){let e=c().$implicit,i=c(2);o(2),d("checked",i.isSelected(e.id))}}function pe(n,t){if(n&1&&p(0,"div"),n&2){let e=c().$implicit,i=c(2);I(i.getIndentClass(e.level))}}function _e(n,t){if(n&1&&(a(0,"div",67),m(1),l()),n&2){let e=c().$implicit;o(),b(e.nameAr)}}function ge(n,t){if(n&1&&(a(0,"div",67),m(1),l()),n&2){let e=c().$implicit;o(),b(e.description)}}function ue(n,t){if(n&1&&(a(0,"td")(1,"small",68),m(2),l()()),n&2){let e=c().$implicit;o(2),b(e.path)}}function fe(n,t){if(n&1&&(a(0,"div",44),p(1,"i",69),m(2),l()),n&2){let e=c().$implicit;o(2),x(" ",e.managerName," ")}}function xe(n,t){n&1&&(a(0,"span",68),m(1,"-"),l())}function be(n,t){if(n&1&&(a(0,"div",44),p(1,"i",70),m(2),l()),n&2){let e=c().$implicit;o(2),x(" ",e.location," ")}}function ve(n,t){n&1&&(a(0,"span",68),m(1,"-"),l())}function he(n,t){if(n&1){let e=v();a(0,"button",73),u("click",function(r){_(e);let s=c(2).$implicit;return c(2).onEditDepartment(s),g(r.stopPropagation())}),p(1,"i",74),l()}if(n&2){let e=c(4);d("title",e.i18n.t("common.edit"))}}function Ce(n,t){if(n&1){let e=v();a(0,"button",75),u("click",function(r){_(e);let s=c(2).$implicit;return c(2).onDeleteDepartment(s),g(r.stopPropagation())}),p(1,"i",76),l()}if(n&2){let e=c(4);d("title",e.i18n.t("common.delete"))}}function De(n,t){if(n&1&&(a(0,"td",55)(1,"div",18),f(2,he,2,1,"button",71)(3,Ce,2,1,"button",72),l()()),n&2){let e=c().$implicit,i=c(2);o(2),d("ngIf",i.allowEdit),o(),d("ngIf",i.allowDelete&&e.employeeCount===0)}}function we(n,t){if(n&1){let e=v();a(0,"tr",56),u("click",function(){let r=_(e).$implicit,s=c(2);return g(s.selectDepartment(r))}),f(1,se,3,1,"td",42),a(2,"td")(3,"div",44),f(4,pe,1,2,"div",57),p(5,"i",58),a(6,"div")(7,"div",59),m(8),l(),f(9,_e,2,1,"div",60)(10,ge,2,1,"div",60),l()()(),a(11,"td")(12,"span",61),m(13),l()(),f(14,ue,3,1,"td",46),a(15,"td"),f(16,fe,3,1,"div",62)(17,xe,2,0,"span",63),l(),a(18,"td",64)(19,"span",65),m(20),l()(),a(21,"td"),f(22,be,3,1,"div",62)(23,ve,2,0,"span",63),l(),a(24,"td",64)(25,"span",65),m(26),l()(),f(27,De,4,2,"td",49),l()}if(n&2){let e=t.$implicit,i=c(2);y("table-warning",!e.isActive)("selected-row",i.isSelected(e.id)),o(),d("ngIf",i.allowSelection),o(3),d("ngIf",i.showHierarchy()),o(4),b(e.name),o(),d("ngIf",e.nameAr),o(),d("ngIf",e.description),o(3),b(e.code),o(),d("ngIf",i.showHierarchy()),o(2),d("ngIf",e.managerName),o(),d("ngIf",!e.managerName),o(2),y("bg-success",e.employeeCount>0)("bg-secondary",e.employeeCount===0),o(),x(" ",e.employeeCount," "),o(2),d("ngIf",e.location),o(),d("ngIf",!e.location),o(2),y("bg-success",e.isActive)("bg-secondary",!e.isActive),o(),x(" ",e.isActive?i.i18n.t("common.active"):i.i18n.t("common.inactive")," "),o(),d("ngIf",i.showControls)}}function ye(n,t){if(n&1){let e=v();a(0,"button",80),u("click",function(){_(e);let r=c(3);return g(r.onAddDepartment())}),p(1,"i",81),m(2),l()}if(n&2){let e=c(3);o(2),x(" ",e.i18n.t("department.addFirstDepartment")," ")}}function Me(n,t){if(n&1&&(a(0,"div",77),p(1,"i",78),a(2,"h5"),m(3),l(),a(4,"p"),m(5),l(),f(6,ye,3,1,"button",79),l()),n&2){let e=c(2);o(3),b(e.i18n.t("department.noDepartments")),o(2),b(e.i18n.t("department.noDepartmentsDescription")),o(),d("ngIf",e.allowEdit)}}function Se(n,t){if(n&1&&(a(0,"option",95),m(1),l()),n&2){let e=t.$implicit;d("value",e),o(),b(e)}}function Pe(n,t){if(n&1){let e=v();a(0,"button",98),u("click",function(){_(e);let r=c().$implicit,s=c(3);return g(s.onPageChange(r))}),m(1),l()}if(n&2){let e=c().$implicit;o(),x(" ",e," ")}}function Te(n,t){n&1&&(a(0,"span",99),m(1,"..."),l())}function Ie(n,t){if(n&1&&(a(0,"li",90),f(1,Pe,2,1,"button",96)(2,Te,2,0,"span",97),l()),n&2){let e=t.$implicit,i=c(3);y("active",e===i.currentPage())("disabled",e===-1),o(),d("ngIf",e!==-1),o(),d("ngIf",e===-1)}}function ke(n,t){if(n&1){let e=v();a(0,"nav",82)(1,"div",83)(2,"div",84)(3,"div",44)(4,"label",85),m(5),l(),a(6,"select",86),u("change",function(r){_(e);let s=c(2);return g(s.onPageSizeChange(+r.target.value))}),f(7,Se,2,2,"option",87),l(),a(8,"span",88),m(9),l()()(),a(10,"div",84)(11,"ul",89)(12,"li",90)(13,"button",91),u("click",function(){_(e);let r=c(2);return g(r.onPageChange(r.currentPage()-1))}),p(14,"i",92),l()(),f(15,Ie,3,6,"li",93),a(16,"li",90)(17,"button",91),u("click",function(){_(e);let r=c(2);return g(r.onPageChange(r.currentPage()+1))}),p(18,"i",94),l()()()()()()}if(n&2){let e=c(2);o(5),x("",e.i18n.t("common.pageSize"),":"),o(),d("value",e.pageSize()),o(),d("ngForOf",e.pageSizeOptions),o(2),Q(" ",e.i18n.t("common.showing")," ",(e.currentPage()-1)*e.pageSize()+1,"-",e.Math.min(e.currentPage()*e.pageSize(),e.filteredDepartments().length)," ",e.i18n.t("common.of")," ",e.filteredDepartments().length," "),o(3),y("disabled",e.currentPage()===1),o(),d("disabled",e.currentPage()===1),o(2),d("ngForOf",e.getPageNumbers()),o(),y("disabled",e.currentPage()===e.totalPages()),o(),d("disabled",e.currentPage()===e.totalPages())}}function Oe(n,t){if(n&1){let e=v();a(0,"div",38)(1,"div",39)(2,"table",40)(3,"thead",41)(4,"tr"),f(5,ce,3,2,"th",42),a(6,"th",43),u("click",function(){_(e);let r=c();return g(r.onSort("name"))}),a(7,"div",44),m(8),p(9,"i",45),l()(),a(10,"th",43),u("click",function(){_(e);let r=c();return g(r.onSort("code"))}),a(11,"div",44),m(12),p(13,"i",45),l()(),f(14,de,2,1,"th",46),a(15,"th",43),u("click",function(){_(e);let r=c();return g(r.onSort("managerName"))}),a(16,"div",44),m(17),p(18,"i",45),l()(),a(19,"th",47),u("click",function(){_(e);let r=c();return g(r.onSort("employeeCount"))}),a(20,"div",48),m(21),p(22,"i",45),l()(),a(23,"th",43),u("click",function(){_(e);let r=c();return g(r.onSort("location"))}),a(24,"div",44),m(25),p(26,"i",45),l()(),a(27,"th",47),u("click",function(){_(e);let r=c();return g(r.onSort("isActive"))}),a(28,"div",48),m(29),p(30,"i",45),l()(),f(31,me,2,1,"th",49),l()(),a(32,"tbody"),f(33,we,28,26,"tr",50),l()()(),f(34,Me,7,3,"div",51)(35,ke,19,15,"nav",52),l()}if(n&2){let e=c();o(5),d("ngIf",e.allowSelection),o(3),x(" ",e.i18n.t("department.name")," "),o(),I(e.getSortIcon("name")),o(3),x(" ",e.i18n.t("department.code")," "),o(),I(e.getSortIcon("code")),o(),d("ngIf",e.showHierarchy()),o(3),x(" ",e.i18n.t("department.manager")," "),o(),I(e.getSortIcon("managerName")),o(3),x(" ",e.i18n.t("common.employees")," "),o(),I(e.getSortIcon("employeeCount")),o(3),x(" ",e.i18n.t("department.location")," "),o(),I(e.getSortIcon("location")),o(3),x(" ",e.i18n.t("common.status")," "),o(),I(e.getSortIcon("isActive")),o(),d("ngIf",e.showControls),o(2),d("ngForOf",e.getPaginatedDepartments())("ngForTrackBy",e.trackByDeptId),o(),d("ngIf",e.getPaginatedDepartments().length===0),o(),d("ngIf",e.totalPages()>1)}}var Y=class n{selectedBranchId;allowSelection=!0;allowEdit=!0;allowDelete=!0;showControls=!0;departmentSelected=new P;departmentEdit=new P;departmentDelete=new P;departmentAdd=new P;i18n=S(F);departmentsService=S(B);loading=C(!1);departments=C([]);filteredDepartments=C([]);selectedDepartments=C(new Set);sortConfig=C({column:"name",direction:"asc"});searchTerm=C("");showInactive=C(!1);currentPage=C(1);pageSize=C(10);totalPages=C(0);showHierarchy=C(!1);pageSizeOptions=[5,10,25,50,100];ngOnInit(){this.loadDepartments()}loadDepartments(){return T(this,null,function*(){this.loading.set(!0);try{let t=yield this.departmentsService.getDepartments({branchId:this.selectedBranchId,includeTree:!1,includeInactive:this.showInactive()}).toPromise();t&&(this.departments.set(t),this.applyFiltersAndSort())}catch(t){console.error("Failed to load departments:",t)}finally{this.loading.set(!1)}})}applyFiltersAndSort(){let t=[...this.departments()],e=this.searchTerm().toLowerCase();e&&(t=t.filter(r=>r.name.toLowerCase().includes(e)||r.code.toLowerCase().includes(e)||r.nameAr&&r.nameAr.toLowerCase().includes(e)||r.description&&r.description.toLowerCase().includes(e)||r.costCenter&&r.costCenter.toLowerCase().includes(e)||r.path.toLowerCase().includes(e))),this.showInactive()||(t=t.filter(r=>r.isActive));let i=this.sortConfig();t.sort((r,s)=>{let h=r[i.column],D=s[i.column];if(h==null&&D==null)return 0;if(h==null)return i.direction==="asc"?1:-1;if(D==null)return i.direction==="asc"?-1:1;let M=0;return typeof h=="string"&&typeof D=="string"?M=h.localeCompare(D):typeof h=="number"&&typeof D=="number"?M=h-D:M=String(h).localeCompare(String(D)),i.direction==="asc"?M:-M}),this.filteredDepartments.set(t),this.updatePagination()}updatePagination(){let t=this.filteredDepartments().length,e=Math.ceil(t/this.pageSize());this.totalPages.set(e),this.currentPage()>e&&e>0&&this.currentPage.set(e)}getPaginatedDepartments(){let t=(this.currentPage()-1)*this.pageSize(),e=t+this.pageSize();return this.filteredDepartments().slice(t,e)}onSort(t){let e=this.sortConfig(),i=e.column===t&&e.direction==="asc"?"desc":"asc";this.sortConfig.set({column:t,direction:i}),this.applyFiltersAndSort()}getSortIcon(t){let e=this.sortConfig();return e.column!==t?"fas fa-sort":e.direction==="asc"?"fas fa-sort-up":"fas fa-sort-down"}onSearchChange(t){this.searchTerm.set(t),this.currentPage.set(1),this.applyFiltersAndSort()}onShowInactiveChange(t){this.showInactive.set(t),this.currentPage.set(1),this.loadDepartments()}onPageSizeChange(t){this.pageSize.set(t),this.currentPage.set(1),this.updatePagination()}onPageChange(t){this.currentPage.set(t)}getPageNumbers(){let t=this.totalPages(),e=this.currentPage(),i=[];if(t<=7)for(let r=1;r<=t;r++)i.push(r);else e<=4?i.push(1,2,3,4,5,-1,t):e>=t-3?i.push(1,-1,t-4,t-3,t-2,t-1,t):i.push(1,-1,e-1,e,e+1,-1,t);return i}selectDepartment(t){this.allowSelection&&this.departmentSelected.emit(t)}toggleSelection(t){let e=this.selectedDepartments();e.has(t)?e.delete(t):e.add(t),this.selectedDepartments.set(new Set(e))}toggleAllSelection(){let t=this.selectedDepartments(),e=this.getPaginatedDepartments();this.isAllPageSelected()?e.forEach(i=>t.delete(i.id)):e.forEach(i=>t.add(i.id)),this.selectedDepartments.set(new Set(t))}isSelected(t){return this.selectedDepartments().has(t)}isAllPageSelected(){let t=this.getPaginatedDepartments();return t.length>0&&t.every(e=>this.isSelected(e.id))}isSomePageSelected(){return this.getPaginatedDepartments().some(e=>this.isSelected(e.id))&&!this.isAllPageSelected()}onAddDepartment(){this.departmentAdd.emit()}onEditDepartment(t){this.departmentEdit.emit(t)}onDeleteDepartment(t){this.departmentDelete.emit(t)}onBulkDelete(){let t=this.selectedDepartments();this.departments().filter(i=>t.has(i.id)).forEach(i=>this.departmentDelete.emit(i))}clearSelection(){this.selectedDepartments.set(new Set)}refresh(){this.loadDepartments()}getIndentClass(t){return`indent-${Math.min(t,5)}`}trackByDeptId(t,e){return e.id}Math=Math;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-department-table"]],inputs:{selectedBranchId:"selectedBranchId",allowSelection:"allowSelection",allowEdit:"allowEdit",allowDelete:"allowDelete",showControls:"showControls"},outputs:{departmentSelected:"departmentSelected",departmentEdit:"departmentEdit",departmentDelete:"departmentDelete",departmentAdd:"departmentAdd"},decls:4,vars:3,consts:[[1,"department-table"],["class","table-controls mb-3",4,"ngIf"],["class","text-center p-4",4,"ngIf"],["class","table-container",4,"ngIf"],[1,"table-controls","mb-3"],[1,"row","g-2","align-items-center"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"input","placeholder","value"],[1,"col-md-3"],[1,"form-check"],["type","checkbox","id","showInactiveTable",1,"form-check-input",3,"change","checked"],["for","showInactiveTable",1,"form-check-label"],["type","checkbox","id","showHierarchy",1,"form-check-input",3,"change","checked"],["for","showHierarchy",1,"form-check-label"],[1,"col-md-2"],[1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-sync"],["type","button","class","btn btn-primary",3,"title","click",4,"ngIf"],["class","row mt-2",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click","title"],[1,"fas","fa-plus"],[1,"row","mt-2"],[1,"col-12"],[1,"alert","alert-info","d-flex","align-items-center"],[1,"flex-grow-1"],[1,"fas","fa-info-circle","me-2"],["type","button","class","btn btn-outline-danger",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-times","me-1"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash","me-1"],[1,"text-center","p-4"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"table-container"],[1,"table-responsive"],[1,"table","table-hover"],[1,"table-light","sticky-top"],["class","selection-column",4,"ngIf"],[1,"sortable",3,"click"],[1,"d-flex","align-items-center"],[1,"ms-2"],[4,"ngIf"],[1,"sortable","text-center",3,"click"],[1,"d-flex","align-items-center","justify-content-center"],["class","actions-column",4,"ngIf"],[3,"table-warning","selected-row","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center p-4 text-muted",4,"ngIf"],["aria-label","Department pagination","class","mt-3",4,"ngIf"],[1,"selection-column"],["type","checkbox",1,"form-check-input",3,"change","checked","indeterminate"],[1,"actions-column"],[3,"click"],[3,"class",4,"ngIf"],[1,"fas","fa-building","text-primary","me-2"],[1,"fw-medium"],["class","text-muted small",4,"ngIf"],[1,"badge","bg-light","text-dark","border"],["class","d-flex align-items-center",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-center"],[1,"badge"],["type","checkbox",1,"form-check-input",3,"change","checked"],[1,"text-muted","small"],[1,"text-muted"],[1,"fas","fa-user-tie","text-secondary","me-2"],[1,"fas","fa-map-marker-alt","text-secondary","me-2"],["type","button","class","btn btn-outline-primary",3,"title","click",4,"ngIf"],["type","button","class","btn btn-outline-danger",3,"title","click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click","title"],[1,"fas","fa-edit"],["type","button",1,"btn","btn-outline-danger",3,"click","title"],[1,"fas","fa-trash"],[1,"text-center","p-4","text-muted"],[1,"fas","fa-building","fa-3x","mb-3"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],["aria-label","Department pagination",1,"mt-3"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"form-label","me-2","mb-0"],[1,"form-select","form-select-sm",2,"width","auto",3,"change","value"],[3,"value",4,"ngFor","ngForOf"],[1,"text-muted","ms-3"],[1,"pagination","pagination-sm","justify-content-end","mb-0"],[1,"page-item"],[1,"page-link",3,"click","disabled"],[1,"fas","fa-chevron-left"],["class","page-item",3,"active","disabled",4,"ngFor","ngForOf"],[1,"fas","fa-chevron-right"],[3,"value"],["class","page-link",3,"click",4,"ngIf"],["class","page-link",4,"ngIf"],[1,"page-link",3,"click"],[1,"page-link"]],template:function(e,i){e&1&&(a(0,"div",0),f(1,ae,23,9,"div",1)(2,le,4,1,"div",2)(3,Oe,36,25,"div",3),l()),e&2&&(o(),d("ngIf",i.showControls),o(),d("ngIf",i.loading()),o(),d("ngIf",!i.loading()))},dependencies:[N,E,V,A,H,j],styles:[".department-table[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.table-controls[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e9ecef;background-color:#f8f9fa;border-radius:8px 8px 0 0}.table-container[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}.table[_ngcontent-%COMP%]{margin-bottom:0}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #dee2e6;background-color:#f8f9fa;font-weight:600;color:#495057;position:sticky;top:0;z-index:10}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .2s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;cursor:pointer}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected-row[_ngcontent-%COMP%]{background-color:#e3f2fd;border-left:4px solid #2196f3}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-warning[_ngcontent-%COMP%]{background-color:#fff3cd}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-warning[_ngcontent-%COMP%]:hover{background-color:#ffeaa7}.selection-column[_ngcontent-%COMP%]{width:50px;text-align:center}.actions-column[_ngcontent-%COMP%]{width:100px;text-align:center}.sortable[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;transition:color .2s ease}.sortable[_ngcontent-%COMP%]:hover{color:#2196f3;background-color:#f0f7ff}.sortable[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%]{font-size:.75rem;opacity:.6;transition:opacity .2s ease}.sortable[_ngcontent-%COMP%]:hover   .fas[_ngcontent-%COMP%]{opacity:1}.indent-0[_ngcontent-%COMP%]{margin-left:0}.indent-1[_ngcontent-%COMP%]{margin-left:20px}.indent-2[_ngcontent-%COMP%]{margin-left:40px}.indent-3[_ngcontent-%COMP%]{margin-left:60px}.indent-4[_ngcontent-%COMP%]{margin-left:80px}.indent-5[_ngcontent-%COMP%]{margin-left:100px}.badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.35rem .6rem;font-weight:500}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border:none;box-shadow:0 1px 3px #0000001a;transition:all .2s ease}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 6px #00000026}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#2196f3;border-color:#2196f3}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;border-color:#6c757d}.form-check-input[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#2196f3;border-color:#2196f3}.form-check-input[_ngcontent-%COMP%]:indeterminate{background-color:#ffc107;border-color:#ffc107}.form-select[_ngcontent-%COMP%]{cursor:pointer;transition:border-color .2s ease}.form-select[_ngcontent-%COMP%]:focus{border-color:#2196f3;box-shadow:0 0 0 .2rem #2196f340}.pagination[_ngcontent-%COMP%]{margin-bottom:0}.page-link[_ngcontent-%COMP%]{color:#6c757d;border:1px solid #dee2e6;transition:all .2s ease}.page-link[_ngcontent-%COMP%]:hover{color:#2196f3;background-color:#f8f9fa;border-color:#dee2e6}.page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#2196f3;border-color:#2196f3;color:#fff}.page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{color:#adb5bd;background-color:#fff;border-color:#dee2e6;cursor:not-allowed}.alert[_ngcontent-%COMP%]{border:none;border-radius:6px;box-shadow:0 1px 3px #0000001a}.alert-info[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#0277bd;border-left:4px solid #2196f3}.spinner-border[_ngcontent-%COMP%]{color:#2196f3;width:3rem;height:3rem}.text-muted[_ngcontent-%COMP%]   i.fa-3x[_ngcontent-%COMP%]{color:#adb5bd!important;margin-bottom:1rem}[dir=rtl][_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected-row[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #2196f3}[dir=rtl][_ngcontent-%COMP%]   .indent-1[_ngcontent-%COMP%]{margin-right:20px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-2[_ngcontent-%COMP%]{margin-right:40px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-3[_ngcontent-%COMP%]{margin-right:60px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-4[_ngcontent-%COMP%]{margin-right:80px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-5[_ngcontent-%COMP%]{margin-right:100px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .alert-info[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #2196f3}@media (max-width: 768px){.table-controls[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:.5rem}.table-responsive[_ngcontent-%COMP%]{font-size:.875rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}.badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .4rem}.pagination[_ngcontent-%COMP%]{justify-content:center;margin-top:1rem}.d-flex.align-items-center[_ngcontent-%COMP%]   span.text-muted[_ngcontent-%COMP%]{display:none}}@media (max-width: 576px){.table-container[_ngcontent-%COMP%]{max-height:60vh}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .25rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .25rem}.btn-group[_ngcontent-%COMP%]{flex-direction:column}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:2px;border-radius:4px!important}.actions-column[_ngcontent-%COMP%]{width:80px}}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.badge.bg-success[_ngcontent-%COMP%]{background-color:#198754!important}.badge.bg-secondary[_ngcontent-%COMP%]{background-color:#6c757d!important}.badge.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border:1px solid #dee2e6}.text-primary[_ngcontent-%COMP%]{color:#2196f3!important}.text-secondary[_ngcontent-%COMP%], .text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.sortable[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .2s ease}.sortable[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transition:transform .2s ease}.btn-outline-primary[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%], .btn-outline-danger[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%], .btn-outline-secondary[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:focus-within{outline:2px solid #2196f3;outline-offset:-2px}.btn[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #2196f340}@media print{.table-controls[_ngcontent-%COMP%], .actions-column[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]{display:none!important}.table[_ngcontent-%COMP%]{font-size:.8rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected-row[_ngcontent-%COMP%]{background-color:transparent!important;border-left:none!important}}"]})};function Ee(n,t){if(n&1){let e=v();a(0,"button",22),u("click",function(){_(e);let r=c(2);return g(r.onAddDepartment())}),p(1,"i",23),l()}if(n&2){let e=c(2);d("title",e.i18n.t("department.addDepartment"))}}function Ve(n,t){if(n&1){let e=v();a(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"span",8),p(5,"i",9),l(),a(6,"input",10),u("input",function(r){_(e);let s=c();return g(s.onSearchChange(r.target.value))}),l()()(),a(7,"div",11)(8,"div",12)(9,"input",13),u("change",function(r){_(e);let s=c();return g(s.onShowInactiveChange(r.target.checked))}),l(),a(10,"label",14),m(11),l()()(),a(12,"div",15)(13,"div",16)(14,"button",17),u("click",function(){_(e);let r=c();return g(r.expandAll())}),p(15,"i",18),l(),a(16,"button",17),u("click",function(){_(e);let r=c();return g(r.collapseAll())}),p(17,"i",19),l(),a(18,"button",17),u("click",function(){_(e);let r=c();return g(r.refresh())}),p(19,"i",20),l(),f(20,Ee,2,1,"button",21),l()()()()}if(n&2){let e=c();o(6),d("placeholder",e.i18n.t("common.search")+"...")("value",e.searchTerm()),o(3),d("checked",e.showInactive()),o(2),x(" ",e.i18n.t("common.showInactive")," "),o(3),d("title",e.i18n.t("common.expandAll")),o(2),d("title",e.i18n.t("common.collapseAll")),o(2),d("title",e.i18n.t("common.refresh")),o(2),d("ngIf",e.allowEdit)}}function Ne(n,t){if(n&1&&(a(0,"div",24)(1,"div",25)(2,"span",26),m(3),l()()()),n&2){let e=c();o(3),x("",e.i18n.t("common.loading"),"...")}}function Ae(n,t){if(n&1){let e=v();a(0,"button",44),u("click",function(r){_(e);let s=c().$implicit;return c(2).toggleNode(s.id),g(r.stopPropagation())}),p(1,"i",45),l()}if(n&2){let e=c().$implicit,i=c(2);o(),y("fa-chevron-right",!i.isExpanded(e.id))("fa-chevron-down",i.isExpanded(e.id))}}function Fe(n,t){n&1&&p(0,"div",46)}function Be(n,t){if(n&1&&(a(0,"span",47),m(1),l()),n&2){let e=c(3);o(),x(" ",e.i18n.t("common.inactive")," ")}}function $e(n,t){if(n&1&&(a(0,"div",48),m(1),l()),n&2){let e=c().$implicit;o(),x(" ",e.description," ")}}function ze(n,t){if(n&1&&(a(0,"span"),p(1,"i",49),m(2),l()),n&2){let e=c().$implicit;o(2),x(" ",e.managerName," ")}}function Le(n,t){if(n&1&&(a(0,"span",50),p(1,"i",51),m(2),l()),n&2){let e=c().$implicit,i=c(2);o(2),O(" ",e.employeeCount," ",i.i18n.t("common.employees")," ")}}function He(n,t){if(n&1&&(a(0,"span",50),p(1,"i",52),m(2),l()),n&2){let e=c().$implicit;o(2),x(" ",e.location," ")}}function je(n,t){if(n&1){let e=v();a(0,"button",57),u("click",function(r){_(e);let s=c(2).$implicit;return c(2).onAddDepartment(s),g(r.stopPropagation())}),p(1,"i",23),l()}if(n&2){let e=c(4);d("title",e.i18n.t("department.addSubDepartment"))}}function Ye(n,t){if(n&1){let e=v();a(0,"button",58),u("click",function(r){_(e);let s=c(2).$implicit;return c(2).onEditDepartment(s),g(r.stopPropagation())}),p(1,"i",59),l()}if(n&2){let e=c(4);d("title",e.i18n.t("common.edit"))}}function qe(n,t){if(n&1){let e=v();a(0,"button",60),u("click",function(r){_(e);let s=c(2).$implicit;return c(2).onDeleteDepartment(s),g(r.stopPropagation())}),p(1,"i",61),l()}if(n&2){let e=c(4);d("title",e.i18n.t("common.delete"))}}function Re(n,t){if(n&1&&(a(0,"div",53)(1,"div",16),f(2,je,2,1,"button",54)(3,Ye,2,1,"button",55)(4,qe,2,1,"button",56),l()()),n&2){let e=c().$implicit,i=c(2);o(2),d("ngIf",i.allowEdit),o(),d("ngIf",i.allowEdit),o(),d("ngIf",i.allowDelete&&e.employeeCount===0)}}function Ge(n,t){if(n&1){let e=v();a(0,"div",30)(1,"div",31),u("click",function(){let r=_(e).$implicit,s=c(2);return g(s.selectNode(r))}),f(2,Ae,2,4,"button",32)(3,Fe,1,0,"div",33),p(4,"i",34),a(5,"div",35)(6,"div",36)(7,"strong"),m(8),l(),a(9,"span",37),m(10),l(),f(11,Be,2,1,"span",38),l(),f(12,$e,2,1,"div",39),a(13,"div",40),f(14,ze,3,1,"span",41)(15,Le,3,2,"span",42)(16,He,3,1,"span",42),l()(),f(17,Re,5,3,"div",43),l()()}if(n&2){let e=t.$implicit,i=c(2);y("selected",i.isSelected(e.id))("inactive",!e.isActive),o(),K(i.getIndentStyle(e.indentLevel)),o(),d("ngIf",e.hasChildren),o(),d("ngIf",!e.hasChildren),o(5),b(e.name),o(2),x("(",e.code,")"),o(),d("ngIf",!e.isActive),o(),d("ngIf",e.description),o(2),d("ngIf",e.managerName),o(),d("ngIf",e.employeeCount>0),o(),d("ngIf",e.location),o(),d("ngIf",i.showControls)}}function Je(n,t){if(n&1){let e=v();a(0,"button",65),u("click",function(){_(e);let r=c(3);return g(r.onAddDepartment())}),p(1,"i",66),m(2),l()}if(n&2){let e=c(3);o(2),x(" ",e.i18n.t("department.addFirstDepartment")," ")}}function Ke(n,t){if(n&1&&(a(0,"div",62),p(1,"i",63),a(2,"h5"),m(3),l(),a(4,"p"),m(5),l(),f(6,Je,3,1,"button",64),l()),n&2){let e=c(2);o(3),b(e.i18n.t("department.noDepartments")),o(2),b(e.i18n.t("department.noDepartmentsDescription")),o(),d("ngIf",e.allowEdit)}}function Qe(n,t){if(n&1&&(a(0,"div",27),f(1,Ge,18,16,"div",28)(2,Ke,7,3,"div",29),l()),n&2){let e=c();o(),d("ngForOf",e.getVisibleNodes())("ngForTrackBy",e.trackByNodeId),o(),d("ngIf",e.getVisibleNodes().length===0)}}var q=class n{selectedBranchId;allowSelection=!0;allowEdit=!0;allowDelete=!0;showControls=!0;departmentSelected=new P;departmentEdit=new P;departmentDelete=new P;departmentAdd=new P;i18n=S(F);departmentsService=S(B);loading=C(!1);departments=C([]);expandedNodes=C(new Set);selectedNode=C(null);searchTerm=C("");showInactive=C(!1);ngOnInit(){this.loadDepartments()}loadDepartments(){return T(this,null,function*(){this.loading.set(!0);try{let t=yield this.departmentsService.getDepartmentTree(this.selectedBranchId).toPromise();t&&this.departments.set(this.convertToTreeNodes(t))}catch(t){console.error("Failed to load departments:",t)}finally{this.loading.set(!1)}})}convertToTreeNodes(t){return t.map(e=>z($({},e),{expanded:!1,selected:!1,indentLevel:e.level,children:e.children?this.convertToTreeNodes(e.children):[]}))}toggleNode(t){let e=this.expandedNodes();e.has(t)?e.delete(t):e.add(t),this.expandedNodes.set(new Set(e))}selectNode(t){this.allowSelection&&(this.selectedNode.set(t.id),this.departmentSelected.emit(t))}isExpanded(t){return this.expandedNodes().has(t)}isSelected(t){return this.selectedNode()===t}getVisibleNodes(){let t=[],e=this.searchTerm().toLowerCase(),i=this.showInactive(),r=(s,h=0)=>{for(let D of s){let M=!e||D.name.toLowerCase().includes(e)||D.code.toLowerCase().includes(e)||D.nameAr&&D.nameAr.toLowerCase().includes(e),L=i||D.isActive;M&&L&&t.push(z($({},D),{indentLevel:h})),D.children&&this.isExpanded(D.id)&&r(D.children,h+1)}};return r(this.departments()),t}expandAll(){let t=this.getAllNodeIds(this.departments());this.expandedNodes.set(new Set(t))}collapseAll(){this.expandedNodes.set(new Set)}getAllNodeIds(t){let e=[];for(let i of t)e.push(i.id),i.children&&e.push(...this.getAllNodeIds(i.children));return e}onAddDepartment(t){this.departmentAdd.emit({parentId:t?.id})}onEditDepartment(t){this.departmentEdit.emit(t)}onDeleteDepartment(t){this.departmentDelete.emit(t)}getIndentStyle(t){return`margin-left: ${(t||0)*20}px`}onSearchChange(t){this.searchTerm.set(t),t&&this.expandMatchingNodes()}expandMatchingNodes(){let t=this.searchTerm().toLowerCase(),e=new Set,i=(r,s=[])=>{for(let h of r)(h.name.toLowerCase().includes(t)||h.code.toLowerCase().includes(t)||h.nameAr&&h.nameAr.toLowerCase().includes(t))&&s.forEach(M=>e.add(M)),h.children&&i(h.children,[...s,h.id])};i(this.departments()),this.expandedNodes.set(e)}onShowInactiveChange(t){this.showInactive.set(t)}refresh(){this.loadDepartments()}trackByNodeId(t,e){return e.id}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-department-tree"]],inputs:{selectedBranchId:"selectedBranchId",allowSelection:"allowSelection",allowEdit:"allowEdit",allowDelete:"allowDelete",showControls:"showControls"},outputs:{departmentSelected:"departmentSelected",departmentEdit:"departmentEdit",departmentDelete:"departmentDelete",departmentAdd:"departmentAdd"},decls:4,vars:3,consts:[[1,"department-tree"],["class","tree-controls mb-3",4,"ngIf"],["class","text-center p-4",4,"ngIf"],["class","tree-container",4,"ngIf"],[1,"tree-controls","mb-3"],[1,"row","g-2","align-items-center"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"input","placeholder","value"],[1,"col-md-3"],[1,"form-check"],["type","checkbox","id","showInactive",1,"form-check-input",3,"change","checked"],["for","showInactive",1,"form-check-label"],[1,"col-md-5"],[1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-expand-arrows-alt"],[1,"fas","fa-compress-arrows-alt"],[1,"fas","fa-sync"],["type","button","class","btn btn-primary",3,"title","click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click","title"],[1,"fas","fa-plus"],[1,"text-center","p-4"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"tree-container"],["class","tree-node",3,"selected","inactive",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center p-4 text-muted",4,"ngIf"],[1,"tree-node"],[1,"node-content","d-flex","align-items-center","p-2",3,"click"],["type","button","class","btn btn-sm btn-link expand-btn p-0 me-2",3,"click",4,"ngIf"],["class","expand-spacer me-2",4,"ngIf"],[1,"fas","fa-building","me-2","text-primary"],[1,"node-info","flex-grow-1"],[1,"node-title"],[1,"text-muted","ms-1"],["class","badge bg-secondary ms-2",4,"ngIf"],["class","node-subtitle text-muted small",4,"ngIf"],[1,"node-meta","text-muted","small"],[4,"ngIf"],["class","ms-2",4,"ngIf"],["class","node-actions",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-link","expand-btn","p-0","me-2",3,"click"],[1,"fas"],[1,"expand-spacer","me-2"],[1,"badge","bg-secondary","ms-2"],[1,"node-subtitle","text-muted","small"],[1,"fas","fa-user-tie","me-1"],[1,"ms-2"],[1,"fas","fa-users","me-1"],[1,"fas","fa-map-marker-alt","me-1"],[1,"node-actions"],["type","button","class","btn btn-outline-success",3,"title","click",4,"ngIf"],["type","button","class","btn btn-outline-primary",3,"title","click",4,"ngIf"],["type","button","class","btn btn-outline-danger",3,"title","click",4,"ngIf"],["type","button",1,"btn","btn-outline-success",3,"click","title"],["type","button",1,"btn","btn-outline-primary",3,"click","title"],[1,"fas","fa-edit"],["type","button",1,"btn","btn-outline-danger",3,"click","title"],[1,"fas","fa-trash"],[1,"text-center","p-4","text-muted"],[1,"fas","fa-building","fa-3x","mb-3"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"]],template:function(e,i){e&1&&(a(0,"div",0),f(1,Ve,21,8,"div",1)(2,Ne,4,1,"div",2)(3,Qe,3,3,"div",3),l()),e&2&&(o(),d("ngIf",i.showControls),o(),d("ngIf",i.loading()),o(),d("ngIf",!i.loading()))},dependencies:[N,E,V,A],styles:[".department-tree[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.tree-controls[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e9ecef;background-color:#f8f9fa;border-radius:8px 8px 0 0}.tree-container[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto}.tree-node[_ngcontent-%COMP%]{border-bottom:1px solid #f8f9fa;transition:all .2s ease}.tree-node[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.tree-node.selected[_ngcontent-%COMP%]{background-color:#e3f2fd;border-left:4px solid #2196f3}.tree-node.inactive[_ngcontent-%COMP%]{opacity:.6}.node-content[_ngcontent-%COMP%]{cursor:pointer;position:relative;min-height:48px}.expand-btn[_ngcontent-%COMP%]{width:24px;height:24px;border:none!important;color:#6c757d;display:flex;align-items:center;justify-content:center}.expand-btn[_ngcontent-%COMP%]:hover{color:#495057;background-color:#e9ecef;border-radius:4px}.expand-spacer[_ngcontent-%COMP%]{width:24px;height:24px}.node-info[_ngcontent-%COMP%]{min-height:36px;display:flex;flex-direction:column;justify-content:center}.node-title[_ngcontent-%COMP%]{font-weight:500;color:#212529;line-height:1.2}.node-subtitle[_ngcontent-%COMP%]{margin-top:2px;font-size:.875rem;line-height:1.2}.node-meta[_ngcontent-%COMP%]{margin-top:2px;font-size:.75rem;line-height:1.2}.node-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.node-actions[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s ease}.tree-node[_ngcontent-%COMP%]:hover   .node-actions[_ngcontent-%COMP%]{opacity:1}.node-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border:none;box-shadow:0 1px 3px #0000001a}.node-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 6px #00000026}[dir=rtl][_ngcontent-%COMP%]   .tree-node.selected[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #2196f3}[dir=rtl][_ngcontent-%COMP%]   .node-content[_ngcontent-%COMP%]{flex-direction:row-reverse}@media (max-width: 768px){.tree-controls[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:.5rem}.node-actions[_ngcontent-%COMP%]{opacity:1}.node-actions[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{flex-direction:column}.node-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-left:0!important;margin-top:2px}}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.tree-node[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.spinner-border[_ngcontent-%COMP%]{color:#2196f3}.text-muted[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#adb5bd!important}.badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .5rem}.btn-outline-success[_ngcontent-%COMP%]:hover, .btn-outline-primary[_ngcontent-%COMP%]:hover, .btn-outline-danger[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}"]})};function Ue(n,t){if(n&1&&(a(0,"option",27),m(1),l()),n&2){let e=t.$implicit;d("value",e.id),o(),O(" ",e.name," (",e.code,") ")}}function We(n,t){if(n&1&&(a(0,"div",28)(1,"div",29),p(2,"i",30),a(3,"div")(4,"strong"),m(5),l(),p(6,"br"),a(7,"small"),m(8),l()()()()),n&2){let e=c();o(5),b(e.i18n.t("common.selectBranch")),o(3),b(e.i18n.t("department.selectBranchToManage"))}}function Xe(n,t){if(n&1){let e=v();a(0,"app-department-table",31),u("departmentSelected",function(r){_(e);let s=c();return g(s.onDepartmentSelected(r))})("departmentEdit",function(r){_(e);let s=c();return g(s.onDepartmentEdit(r))})("departmentDelete",function(r){_(e);let s=c();return g(s.onDepartmentDelete(r))})("departmentAdd",function(){_(e);let r=c();return g(r.onDepartmentAdd())}),l()}if(n&2){let e,i=c();d("selectedBranchId",(e=i.selectedBranch())==null?null:e.id)("allowSelection",!0)("allowEdit",!0)("allowDelete",!0)("showControls",!0)}}function Ze(n,t){if(n&1){let e=v();a(0,"app-department-tree",31),u("departmentSelected",function(r){_(e);let s=c();return g(s.onDepartmentSelected(r))})("departmentEdit",function(r){_(e);let s=c();return g(s.onDepartmentEdit(r))})("departmentDelete",function(r){_(e);let s=c();return g(s.onDepartmentDelete(r))})("departmentAdd",function(r){_(e);let s=c();return g(s.onDepartmentAdd(r))}),l()}if(n&2){let e,i=c();d("selectedBranchId",(e=i.selectedBranch())==null?null:e.id)("allowSelection",!0)("allowEdit",!0)("allowDelete",!0)("showControls",!0)}}function et(n,t){if(n&1&&(a(0,"p",55),m(1),l()),n&2){let e,i=c(2);o(),x(" ",(e=i.selectedDepartment())==null?null:e.description," ")}}function tt(n,t){if(n&1&&(a(0,"div",46)(1,"small",47),m(2),l(),p(3,"br"),a(4,"strong"),m(5),l()()),n&2){let e,i=c(2);o(2),b(i.i18n.t("department.manager")),o(3),b((e=i.selectedDepartment())==null?null:e.managerName)}}function nt(n,t){if(n&1&&(a(0,"div",46)(1,"small",47),m(2),l(),p(3,"br"),a(4,"strong"),m(5),l()()),n&2){let e,i=c(2);o(2),b(i.i18n.t("department.location")),o(3),b((e=i.selectedDepartment())==null?null:e.location)}}function it(n,t){if(n&1){let e=v();a(0,"div",32)(1,"div",33)(2,"div",34)(3,"div",35)(4,"div"),p(5,"i",36),m(6),l(),a(7,"button",37),u("click",function(){_(e);let r=c();return g(r.selectedDepartment.set(null))}),p(8,"i",38),l()()(),a(9,"div",3)(10,"div",39)(11,"div",40)(12,"h6",41),m(13),l(),a(14,"p",42),m(15),l(),f(16,et,2,1,"p",43),l(),a(17,"div",40)(18,"div",44),f(19,tt,6,2,"div",45),a(20,"div",46)(21,"small",47),m(22),l(),p(23,"br"),a(24,"strong"),m(25),l()(),f(26,nt,6,2,"div",45),a(27,"div",46)(28,"small",47),m(29),l(),p(30,"br"),a(31,"span",48),m(32),l()()()()(),a(33,"div",49)(34,"div",50)(35,"button",51),u("click",function(){_(e);let r=c();return g(r.onDepartmentEdit(r.selectedDepartment()))}),p(36,"i",52),m(37),l(),a(38,"button",53),u("click",function(){_(e);let r=c();return g(r.onDepartmentDelete(r.selectedDepartment()))}),p(39,"i",54),m(40),l()()()()()()}if(n&2){let e,i,r,s,h,D,M,L,R,G,w=c();o(6),x(" ",w.i18n.t("department.selectedDepartment")," "),o(7),b((e=w.selectedDepartment())==null?null:e.name),o(2),b((i=w.selectedDepartment())==null?null:i.code),o(),d("ngIf",(r=w.selectedDepartment())==null?null:r.description),o(3),d("ngIf",(s=w.selectedDepartment())==null?null:s.managerName),o(3),b(w.i18n.t("common.employees")),o(3),b(((h=w.selectedDepartment())==null?null:h.employeeCount)||0),o(),d("ngIf",(D=w.selectedDepartment())==null?null:D.location),o(3),b(w.i18n.t("common.status")),o(2),y("bg-success",(M=w.selectedDepartment())==null?null:M.isActive)("bg-secondary",!((L=w.selectedDepartment())!=null&&L.isActive)),o(),x(" ",(R=w.selectedDepartment())!=null&&R.isActive?w.i18n.t("common.active"):w.i18n.t("common.inactive")," "),o(5),x(" ",w.i18n.t("common.edit")," "),o(),d("disabled",((G=w.selectedDepartment())==null?null:G.employeeCount)>0),o(2),x(" ",w.i18n.t("common.delete")," ")}}function ot(n,t){if(n&1){let e=v();a(0,"div",56)(1,"div",57)(2,"div",58)(3,"div",59)(4,"h5",60),p(5,"i",61),m(6),l(),a(7,"button",62),u("click",function(){_(e);let r=c();return g(r.onFormClose())}),l()(),a(8,"div",63)(9,"app-department-form",64),u("save",function(r){_(e);let s=c();return g(s.onFormSave(r))})("cancel",function(){_(e);let r=c();return g(r.onFormClose())}),l()()()()()}if(n&2){let e,i=c();J("display",i.showForm()?"block":"none"),y("show",i.showForm()),o(6),x(" ",i.isEditMode()?i.i18n.t("department.editDepartment"):i.i18n.t("department.addDepartment")," "),o(3),d("department",i.selectedDepartment())("branchId",((e=i.selectedBranch())==null?null:e.id)||null)("isEditMode",i.isEditMode())}}function rt(n,t){if(n&1){let e=v();a(0,"div",65),u("click",function(){_(e);let r=c();return g(r.onFormClose())}),l()}if(n&2){let e=c();y("show",e.showForm())}}var te=class n{i18n=S(F);departmentsService=S(B);confirmationService=S(U);viewMode=C("table");selectedBranch=C(null);selectedDepartment=C(null);showForm=C(!1);isEditMode=C(!1);branches=C([{id:1,name:"Main Branch",code:"MAIN",location:"Headquarters",isActive:!0},{id:2,name:"Branch 2",code:"BR02",location:"Downtown",isActive:!0}]);ngOnInit(){let t=this.branches();t.length>0&&this.selectedBranch.set(t[0])}onViewModeChange(t){this.viewMode.set(t)}onBranchChange(t){let e=this.branches().find(i=>i.id===t);this.selectedBranch.set(e||null)}onDepartmentSelected(t){this.selectedDepartment.set(t)}onDepartmentEdit(t){this.selectedDepartment.set(t),this.isEditMode.set(!0),this.showForm.set(!0)}onDepartmentDelete(t){return T(this,null,function*(){(yield this.confirmationService.confirm({title:"Delete Department",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.deleteDepartment(t.id)})}onDepartmentAdd(t){this.selectedDepartment.set(null),this.isEditMode.set(!1),this.showForm.set(!0),t?.parentId&&console.log("Adding department with parent:",t.parentId)}onFormClose(){this.showForm.set(!1),this.selectedDepartment.set(null),this.isEditMode.set(!1)}onFormSave(t){this.isEditMode()?this.updateDepartment(t):this.createDepartment(t)}createDepartment(t){return T(this,null,function*(){try{yield this.departmentsService.createDepartment(z($({},t),{branchId:this.selectedBranch()?.id})).toPromise(),this.onFormClose(),this.refreshData()}catch(e){console.error("Failed to create department:",e)}})}updateDepartment(t){return T(this,null,function*(){if(this.selectedDepartment()?.id)try{yield this.departmentsService.updateDepartment(this.selectedDepartment().id,t).toPromise(),this.onFormClose(),this.refreshData()}catch(e){console.error("Failed to update department:",e)}})}deleteDepartment(t){return T(this,null,function*(){try{yield this.departmentsService.deleteDepartment(t).toPromise(),this.refreshData()}catch(e){console.error("Failed to delete department:",e)}})}refreshData(){window.location.reload()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=k({type:n,selectors:[["app-departments"]],decls:38,vars:18,consts:[[1,"departments-page"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[1,"form-select",3,"change","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-3"],["role","group",1,"btn-group","w-100"],["type","radio","name","viewMode","id","tableView",1,"btn-check",3,"change","checked"],["for","tableView",1,"btn","btn-outline-primary"],[1,"fas","fa-table","me-2"],["type","radio","name","viewMode","id","treeView",1,"btn-check",3,"change","checked"],["for","treeView",1,"btn","btn-outline-primary"],[1,"fas","fa-sitemap","me-2"],[1,"col-md-3","d-flex","align-items-end"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-plus","me-2"],[1,"card"],["class","alert alert-info",4,"ngIf"],[3,"selectedBranchId","allowSelection","allowEdit","allowDelete","showControls","departmentSelected","departmentEdit","departmentDelete","departmentAdd",4,"ngIf"],["class","selected-info",4,"ngIf"],["class","modal fade",3,"show","display",4,"ngIf"],["class","modal-backdrop fade",3,"show","click",4,"ngIf"],[3,"value"],[1,"alert","alert-info"],[1,"d-flex","align-items-center"],[1,"fas","fa-info-circle","me-3"],[3,"departmentSelected","departmentEdit","departmentDelete","departmentAdd","selectedBranchId","allowSelection","allowEdit","allowDelete","showControls"],[1,"selected-info"],[1,"card","border-primary"],[1,"card-header","bg-primary","text-white"],[1,"d-flex","align-items-center","justify-content-between"],[1,"fas","fa-info-circle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-light",3,"click"],[1,"fas","fa-times"],[1,"row"],[1,"col-md-6"],[1,"fw-bold"],[1,"text-muted","mb-2"],["class","small mb-2",4,"ngIf"],[1,"row","g-2"],["class","col-6",4,"ngIf"],[1,"col-6"],[1,"text-muted"],[1,"badge"],[1,"mt-3"],[1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-edit","me-1"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash","me-1"],[1,"small","mb-2"],[1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-building","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"save","cancel","department","branchId","isEditMode"],[1,"modal-backdrop","fade",3,"click"]],template:function(e,i){if(e&1&&(a(0,"div",0)(1,"div",1)(2,"h2"),m(3),l()(),a(4,"div",2)(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),m(9),l(),a(10,"select",7),u("change",function(s){return i.onBranchChange(+s.target.value)}),a(11,"option",8),m(12),l(),f(13,Ue,2,3,"option",9),l()(),a(14,"div",10)(15,"label",6),m(16),l(),a(17,"div",11)(18,"input",12),u("change",function(){return i.onViewModeChange("table")}),l(),a(19,"label",13),p(20,"i",14),m(21),l(),a(22,"input",15),u("change",function(){return i.onViewModeChange("tree")}),l(),a(23,"label",16),p(24,"i",17),m(25),l()()(),a(26,"div",18)(27,"button",19),u("click",function(){return i.onDepartmentAdd()}),p(28,"i",20),m(29),l()()()()(),a(30,"div",21)(31,"div",3),f(32,We,9,2,"div",22)(33,Xe,1,5,"app-department-table",23)(34,Ze,1,5,"app-department-tree",23),l()(),f(35,it,41,17,"div",24),l(),f(36,ot,10,8,"div",25)(37,rt,1,2,"div",26)),e&2){let r;o(3),b(i.i18n.t("department.departments")),o(6),b(i.i18n.t("common.branch")),o(),d("value",((r=i.selectedBranch())==null?null:r.id)||""),o(2),b(i.i18n.t("common.selectBranch")),o(),d("ngForOf",i.branches()),o(3),b(i.i18n.t("common.view")),o(2),d("checked",i.viewMode()==="table"),o(3),x(" ",i.i18n.t("common.table")," "),o(),d("checked",i.viewMode()==="tree"),o(3),x(" ",i.i18n.t("common.tree")," "),o(2),d("disabled",!i.selectedBranch()),o(2),x(" ",i.i18n.t("department.addDepartment")," "),o(3),d("ngIf",!i.selectedBranch()),o(),d("ngIf",i.viewMode()==="table"&&i.selectedBranch()),o(),d("ngIf",i.viewMode()==="tree"&&i.selectedBranch()),o(),d("ngIf",i.selectedDepartment()&&!i.showForm()),o(),d("ngIf",i.showForm()),o(),d("ngIf",i.showForm())}},dependencies:[N,E,V,A,H,j,Y,q,W],styles:[".selected-info[_ngcontent-%COMP%]{position:fixed;top:50%;right:2rem;transform:translateY(-50%);width:350px;z-index:1000}@media (max-width: 1200px){.selected-info[_ngcontent-%COMP%]{position:relative;top:auto;right:auto;transform:none;width:100%;margin-top:2rem}}"]})};export{te as DepartmentsComponent};
