import{a as Q}from"./chunk-QPY65KO2.js";import{a as K}from"./chunk-NOJWDJOC.js";import{a as G}from"./chunk-EHNHB6RU.js";import"./chunk-QHBTYDS6.js";import{a as J}from"./chunk-7TWIWOLV.js";import{a as V}from"./chunk-4335LQ3A.js";import"./chunk-LDWMK676.js";import"./chunk-HCDX4O2L.js";import{a as q}from"./chunk-6B6T6MZ3.js";import{e as F,h as z,q as W,r as R,t as U,z as $}from"./chunk-HF7V7ZC6.js";import{a as j}from"./chunk-RUOWTK24.js";import"./chunk-HZR4WXEY.js";import{g as x}from"./chunk-O3U3HUCY.js";import{a as H}from"./chunk-77FC2LKR.js";import"./chunk-A6EM5NV6.js";import{$a as A,Eb as c,Fb as v,Gb as u,Ha as I,Mb as E,Nb as _,Ob as C,Pb as Y,T as p,Y as S,Z as L,_a as w,bb as N,cb as y,db as b,dc as M,eb as d,fa as m,fb as o,gb as l,hb as h,lb as O,mb as k,ob as B,qb as g,sb as f,wa as i}from"./chunk-IGEIB4M6.js";import{a as T,b as P,e as D}from"./chunk-YMDWBF3A.js";var X=(r,t)=>t.id;function ee(r,t){if(r&1){let n=B();o(0,"button",19),g("click",function(){S(n);let s=f();return L(s.openBulkUpload())}),h(1,"i",20),c(2),l(),o(3,"button",21),g("click",function(){S(n);let s=f();return L(s.createEntitlement())}),h(4,"i",22),c(5),l()}if(r&2){let n=f();i(2),u(" ",n.i18n.t("leaveBalance.bulkUpload")," "),i(3),u(" ",n.i18n.t("leaveBalance.createEntitlement")," ")}}function te(r,t){if(r&1&&(o(0,"option",9),c(1),l()),r&2){let n=t.$implicit;d("value",n),i(),v(n)}}function ne(r,t){if(r&1&&(o(0,"option",9),c(1),l()),r&2){let n=t.$implicit;d("value",n.id),i(),v(n.name)}}function ie(r,t){if(r&1&&(o(0,"option",9),c(1),l()),r&2){let n=t.$implicit;d("value",n.id),i(),v(n.name)}}var Z=class r{router=p(x);confirmationService=p(J);notificationService=p(j);employeesService=p(K);vacationTypesService=p(Q);permissionService=p(V);i18n=p(H);PERMISSIONS={LEAVE_BALANCE_CREATE:"leaveBalance.create",LEAVE_BALANCE_READ:"leaveBalance.read",LEAVE_BALANCE_UPDATE:"leaveBalance.update",LEAVE_BALANCE_DELETE:"leaveBalance.delete"};entitlements=m([]);loading=m(!1);totalCount=m(0);currentPage=m(1);pageSize=m(10);totalPages=m(0);selectedYear=m(new Date().getFullYear());selectedEmployeeId=m(null);selectedVacationTypeId=m(null);employees=m([]);vacationTypes=m([]);availableYears=m([]);tableColumns=M(()=>[{key:"employeeCode",label:this.t("employees.employeeCode"),sortable:!0,width:"120px",priority:"high",mobileLabel:this.t("employees.employeeCode")},{key:"employeeName",label:this.t("employees.employeeName"),sortable:!0,width:"180px",priority:"high",mobileLabel:this.t("employees.employeeName")},{key:"vacationTypeName",label:this.t("vacationTypes.vacationType"),sortable:!1,width:"150px",priority:"high",mobileLabel:this.t("vacationTypes.vacationType")},{key:"year",label:this.t("leaveBalance.year"),sortable:!0,width:"80px",align:"center",priority:"medium",mobileLabel:this.t("leaveBalance.year")},{key:"annualDays",label:this.t("leaveBalance.annualDays"),sortable:!1,width:"110px",align:"right",priority:"medium",mobileLabel:this.t("leaveBalance.annualDays")},{key:"carryOverDays",label:this.t("leaveBalance.carryOverDays"),sortable:!1,width:"120px",align:"right",priority:"low",hideOnMobile:!0,mobileLabel:this.t("leaveBalance.carryOverDays")},{key:"expiresStatus",label:this.t("leaveBalance.expiresAtYearEnd"),sortable:!1,width:"130px",align:"center",priority:"low",hideOnMobile:!0,mobileLabel:this.t("leaveBalance.expiresAtYearEnd"),renderHtml:!0},{key:"notes",label:this.t("common.notes"),sortable:!1,width:"150px",priority:"low",hideOnMobile:!0,mobileLabel:this.t("common.notes")}]);tableActions=M(()=>[{key:"edit",label:this.t("common.edit"),icon:"fa-pencil",color:"primary",condition:()=>this.permissionService.has(this.PERMISSIONS.LEAVE_BALANCE_UPDATE)},{key:"delete",label:this.t("common.delete"),icon:"fa-trash",color:"danger",condition:()=>this.permissionService.has(this.PERMISSIONS.LEAVE_BALANCE_DELETE)}]);tableData=M(()=>this.entitlements().map(t=>P(T({},t),{expiresStatus:this.formatExpiresStatus(t.expiresAtYearEnd),notes:t.notes||"-"})));ngOnInit(){this.loadFilterOptions(),this.loadEntitlements(),this.generateAvailableYears()}loadFilterOptions(){this.employeesService.getEmployees({pageSize:1e3}).subscribe({next:t=>{this.employees.set(t.items.map(n=>({id:n.id,name:n.fullName})))},error:t=>{console.error("Failed to load employees",t)}}),this.vacationTypesService.getVacationTypes({pageSize:1e3}).subscribe({next:t=>{this.vacationTypes.set(t.items.map(n=>({id:n.id,name:n.name})))},error:t=>{console.error("Failed to load vacation types",t)}})}generateAvailableYears(){let t=new Date().getFullYear(),n=[];for(let e=-2;e<=2;e++)n.push(t+e);this.availableYears.set(n)}loadEntitlements(){this.loading.set(!0),setTimeout(()=>{let n=[{id:1,employeeId:1,employeeName:"John Doe",employeeCode:"EMP001",vacationTypeId:1,vacationTypeName:"Annual Leave",year:this.selectedYear(),annualDays:30,carryOverDays:5,maxCarryOverDays:10,expiresAtYearEnd:!1,effectiveStartDate:`${this.selectedYear()}-01-01`,effectiveEndDate:`${this.selectedYear()}-12-31`,notes:"Standard annual leave entitlement"},{id:2,employeeId:1,employeeName:"John Doe",employeeCode:"EMP001",vacationTypeId:2,vacationTypeName:"Sick Leave",year:this.selectedYear(),annualDays:15,carryOverDays:0,maxCarryOverDays:null,expiresAtYearEnd:!0,effectiveStartDate:`${this.selectedYear()}-01-01`,effectiveEndDate:`${this.selectedYear()}-12-31`,notes:null}].filter(e=>e.year===this.selectedYear());this.selectedEmployeeId()&&(n=n.filter(e=>e.employeeId===this.selectedEmployeeId())),this.selectedVacationTypeId()&&(n=n.filter(e=>e.vacationTypeId===this.selectedVacationTypeId())),this.entitlements.set(n),this.loading.set(!1)},500)}createEntitlement(){this.router.navigate(["/settings/leave-entitlements/create"])}editEntitlement(t){this.router.navigate(["/settings/leave-entitlements/edit",t.id])}deleteEntitlement(t){return D(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("leaveBalance.deleteEntitlementTitle"),message:this.i18n.t("leaveBalance.deleteEntitlementMessage",{employee:t.employeeName,vacationType:t.vacationTypeName,year:t.year.toString()}),confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger"})).confirmed&&(this.notificationService.success(this.i18n.t("leaveBalance.entitlementDeleted")),this.loadEntitlements())})}onYearChange(){this.loadEntitlements()}onEmployeeChange(){this.loadEntitlements()}onVacationTypeChange(){this.loadEntitlements()}clearFilters(){this.selectedYear.set(new Date().getFullYear()),this.selectedEmployeeId.set(null),this.selectedVacationTypeId.set(null),this.loadEntitlements()}openBulkUpload(){this.notificationService.info("Bulk upload feature coming soon")}t(t){return this.i18n.t(t)}formatExpiresStatus(t){let n=t?this.t("common.yes"):this.t("common.no");return`<span class="${t?"badge bg-warning":"badge bg-success"}">${n}</span>`}onActionClick(t){let{action:n,item:e}=t;switch(n){case"edit":this.editEntitlement(e);break;case"delete":this.deleteEntitlement(e);break;default:console.warn("Unknown action:",n)}}onPageChange(t){this.currentPage.set(t),this.loadEntitlements()}onPageSizeChange(t){this.pageSize.set(t),this.currentPage.set(1),this.loadEntitlements()}hasActiveFilters(){return this.selectedEmployeeId()!==null||this.selectedVacationTypeId()!==null}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=I({type:r,selectors:[["app-leave-entitlements-list"]],decls:33,vars:26,consts:[[1,"container-fluid"],[3,"title","subtitle"],["actions",""],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-3"],["for","yearFilter",1,"form-label"],["id","yearFilter",1,"form-select",3,"ngModelChange","ngModel"],[3,"value"],[1,"col-md-4"],["for","employeeFilter",1,"form-label"],["id","employeeFilter",1,"form-select",3,"ngModelChange","ngModel"],["for","vacationTypeFilter",1,"form-label"],["id","vacationTypeFilter",1,"form-select",3,"ngModelChange","ngModel"],[1,"col-md-1","d-flex","align-items-end"],["type","button",1,"btn","btn-outline-secondary","w-100",3,"click","disabled","title"],[1,"fa","fa-times"],[3,"actionClick","pageChange","pageSizeChange","columns","data","actions","loading","currentPage","pageSize","totalItems","totalPages","emptyTitle","emptyMessage"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-upload","me-2"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa","fa-plus","me-2"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"app-page-header",1),O(2,2),w(3,ee,6,2),k(),l(),o(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"label",7),c(9),l(),o(10,"select",8),C("ngModelChange",function(a){return _(e.selectedYear,a)||(e.selectedYear=a),a}),g("ngModelChange",function(){return e.onYearChange()}),y(11,te,2,2,"option",9,N),l()(),o(13,"div",10)(14,"label",11),c(15),l(),o(16,"select",12),C("ngModelChange",function(a){return _(e.selectedEmployeeId,a)||(e.selectedEmployeeId=a),a}),g("ngModelChange",function(){return e.onEmployeeChange()}),o(17,"option",9),c(18),l(),y(19,ne,2,2,"option",9,X),l()(),o(21,"div",10)(22,"label",13),c(23),l(),o(24,"select",14),C("ngModelChange",function(a){return _(e.selectedVacationTypeId,a)||(e.selectedVacationTypeId=a),a}),g("ngModelChange",function(){return e.onVacationTypeChange()}),o(25,"option",9),c(26),l(),y(27,ie,2,2,"option",9,X),l()(),o(29,"div",15)(30,"button",16),g("click",function(){return e.clearFilters()}),h(31,"i",17),l()()()()(),o(32,"app-data-table",18),g("actionClick",function(a){return e.onActionClick(a)})("pageChange",function(a){return e.onPageChange(a)})("pageSizeChange",function(a){return e.onPageSizeChange(a)}),l()()),n&2&&(i(),d("title",e.i18n.t("leaveBalance.leaveEntitlements"))("subtitle",e.i18n.t("leaveBalance.leaveEntitlementsDescription")),i(2),A(e.permissionService.has(e.PERMISSIONS.LEAVE_BALANCE_CREATE)?3:-1),i(6),u(" ",e.i18n.t("leaveBalance.year")," "),i(),E("ngModel",e.selectedYear),i(),b(e.availableYears()),i(4),u(" ",e.i18n.t("employees.employee")," "),i(),E("ngModel",e.selectedEmployeeId),i(),d("value",null),i(),v(e.i18n.t("common.all")),i(),b(e.employees()),i(4),u(" ",e.i18n.t("vacationTypes.vacationType")," "),i(),E("ngModel",e.selectedVacationTypeId),i(),d("value",null),i(),v(e.i18n.t("common.all")),i(),b(e.vacationTypes()),i(3),d("title",Y(e.i18n.t("common.clearFilters")))("disabled",!e.hasActiveFilters()),i(2),d("columns",e.tableColumns())("data",e.tableData())("actions",e.tableActions())("loading",e.loading())("currentPage",e.currentPage())("pageSize",e.pageSize())("totalItems",e.totalCount())("totalPages",e.totalPages())("emptyTitle",e.i18n.t("leaveBalance.noEntitlementsTitle"))("emptyMessage",e.i18n.t("leaveBalance.noEntitlementsMessage")))},dependencies:[$,R,U,W,F,z,G,q],styles:[".container-fluid[_ngcontent-%COMP%]{padding:1.5rem}h2[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600}.text-muted[_ngcontent-%COMP%]{font-size:.9rem}.card[_ngcontent-%COMP%]{border-radius:.5rem;box-shadow:0 .125rem .25rem #00000013}.card-body[_ngcontent-%COMP%]{padding:1.25rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#495057;margin-bottom:.5rem}.form-select[_ngcontent-%COMP%]{border-radius:.375rem;border:1px solid #ced4da;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-select[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #007bff40}.btn[_ngcontent-%COMP%]{border-radius:.375rem;font-weight:500;padding:.5rem 1rem;transition:all .15s ease-in-out}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0056b3;border-color:#004085}.btn-outline-primary[_ngcontent-%COMP%]{color:#007bff;border-color:#007bff}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#007bff;color:#fff}.btn-outline-secondary[_ngcontent-%COMP%]{color:#6c757d;border-color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;color:#fff}.gap-2[_ngcontent-%COMP%]{gap:.5rem}.gap-3[_ngcontent-%COMP%]{gap:1rem}@media (max-width: 768px){.container-fluid[_ngcontent-%COMP%]{padding:1rem}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.d-flex.gap-2[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{width:100%}}"]})};export{Z as LeaveEntitlementsListComponent};
