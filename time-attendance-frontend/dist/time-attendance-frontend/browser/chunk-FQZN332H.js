import{a as H}from"./chunk-QIFMF2AZ.js";import{a as z}from"./chunk-NPDCAEA6.js";import{a as N}from"./chunk-OLZC5SAB.js";import"./chunk-HUSARQNL.js";import{a as L}from"./chunk-H5EPUHY6.js";import"./chunk-VRETN7JA.js";import{a as A}from"./chunk-GRQ6RO47.js";import{a as I}from"./chunk-UBCI4X5Q.js";import{a as V}from"./chunk-EYAJMHM7.js";import{a as O}from"./chunk-HHXRLUSQ.js";import{b as R}from"./chunk-TJ2U7DWW.js";import{g as M}from"./chunk-TWXUAMJ4.js";import{Bb as d,Cb as w,Db as f,Ea as T,Ia as S,R as m,Ub as D,W as _,X as b,Xa as u,Ya as p,Yb as P,bb as c,cb as o,da as C,db as r,eb as x,lb as h,nb as g,pb as s,ta as a,wc as q,yb as k}from"./chunk-JSQL33QG.js";import{a as v,b as y,d as E}from"./chunk-DGAILPFQ.js";function B(i,e){if(i&1&&x(0,"app-loading-spinner",7),i&2){let t=s();c("message",t.i18n.t("common.loading"))}}function $(i,e){if(i&1){let t=h();o(0,"div",8),x(1,"i",12),d(2),o(3,"button",13),g("click",function(){_(t);let l=s();return b(l.refresh())}),d(4),r()()}if(i&2){let t=s();a(2),f(" ",t.error()," "),a(2),f(" ",t.i18n.t("common.retry")," ")}}function Y(i,e){if(i&1){let t=h();o(0,"app-empty-state",14),g("action",function(){_(t);let l=s();return b(l.createExcuse())}),r()}if(i&2){let t=s();c("title",t.i18n.t("portal.no_excuses"))("message",t.i18n.t("portal.no_excuses_message"))("actionText",t.i18n.t("portal.request_excuse"))}}function U(i,e){if(i&1){let t=h();o(0,"app-table-actions",17),g("actionClick",function(l){_(t);let j=s(2);return b(j.onActionClick(l))}),r()}if(i&2){let t=e.$implicit,n=s(2);c("actions",n.actions)("item",t)}}function G(i,e){if(i&1&&(o(0,"div",10)(1,"div",15)(2,"app-data-table",16),S(3,U,1,2,"ng-template",null,0,D),r()()()),i&2){let t=s();a(2),c("data",t.tableData())("columns",t.columns)("loading",t.loading())("pageSize",10)}}function J(i,e){if(i&1&&(o(0,"div",11)(1,"div",15)(2,"div",18),x(3,"i",19),o(4,"div")(5,"h6",20),d(6),r(),o(7,"p",21),d(8),r()()()()()),i&2){let t=s();a(6),w(t.i18n.t("portal.excuse_info_title")),a(2),f(" ",t.i18n.t("portal.excuse_info_text")," ")}}var F=class i{i18n=m(R);router=m(M);notificationService=m(O);confirmationService=m(L);excuseService=m(N);excuses=C([]);loading=C(!1);error=C(null);columns=[{key:"excuseDate",label:"Date",sortable:!0},{key:"excuseType",label:"Type",sortable:!0},{key:"startTime",label:"Start Time",sortable:!1},{key:"endTime",label:"End Time",sortable:!1},{key:"durationHours",label:"Duration (hrs)",sortable:!0},{key:"reason",label:"Reason",sortable:!1},{key:"status",label:"Status",sortable:!0,renderHtml:!0},{key:"actions",label:"Actions",sortable:!1}];actions=[{id:"view",label:"View",icon:"fa-eye",variant:"primary"},{id:"cancel",label:"Cancel",icon:"fa-times",variant:"danger",visible:e=>e.status==="Pending"}];tableData=P(()=>this.excuses().map(e=>y(v({},e),{excuseDate:this.formatDate(e.excuseDate),excuseType:this.getExcuseTypeLabel(e.excuseType),startTime:this.formatTime(e.startTime),endTime:this.formatTime(e.endTime),durationHours:`${e.durationHours.toFixed(1)} hrs`,status:this.getStatusBadgeHtml(e),actions:e})));ngOnInit(){this.loadExcuses()}loadExcuses(){this.loading.set(!0),this.error.set(null),this.excuseService.getEmployeeExcuses({}).subscribe({next:()=>{let e=this.excuseService.pagedResult();e&&this.excuses.set(e.items),this.loading.set(!1)},error:e=>{console.error("Failed to load excuse requests:",e),this.error.set("Failed to load excuse requests"),this.notificationService.error(this.i18n.t("portal.failed_to_load_excuses")),this.loading.set(!1)}})}onActionClick(e){let t=e.item;switch(e.action.id){case"view":this.viewExcuse(t);break;case"cancel":this.cancelExcuse(t);break}}viewExcuse(e){this.router.navigate(["/portal/excuse-requests",e.id])}createExcuse(){this.router.navigate(["/portal/excuse-requests","new"])}cancelExcuse(e){return E(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("portal.cancel_excuse"),message:this.i18n.t("portal.cancel_excuse_confirm"),confirmText:this.i18n.t("common.yes_cancel"),cancelText:this.i18n.t("common.no"),confirmButtonClass:"btn-danger",icon:"fa-times",iconClass:"text-danger"})).confirmed&&(this.loading.set(!0),this.excuseService.cancelEmployeeExcuse(e.id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("portal.excuse_cancelled")),this.loadExcuses()},error:n=>{console.error("Failed to cancel excuse:",n),this.notificationService.error(this.i18n.t("portal.failed_to_cancel_excuse")),this.loading.set(!1)}}))})}refresh(){this.loadExcuses()}formatDate(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}formatTime(e){return e.substring(0,5)}getExcuseTypeLabel(e){switch(e){case"PersonalExcuse":return this.i18n.t("portal.personal_excuse");case"OfficialDuty":return this.i18n.t("portal.official_duty");default:return e}}getStatusBadgeHtml(e){switch(e.status){case"Pending":return'<span class="badge bg-warning">Pending</span>';case"Approved":return'<span class="badge bg-success">Approved</span>';case"Rejected":return'<span class="badge bg-danger">Rejected</span>';case"Cancelled":return'<span class="badge bg-secondary">Cancelled</span>';default:return`<span class="badge bg-secondary">${e.status}</span>`}}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=T({type:i,selectors:[["app-excuse-requests-list"]],decls:13,vars:12,consts:[["actionsTemplate",""],[3,"title"],["header-actions",""],["type","button",1,"btn","btn-primary","btn-sm","me-2",3,"click","disabled"],[1,"fa-solid","fa-plus","me-1"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click","disabled"],[1,"fa-solid","fa-sync-alt"],[3,"message"],["role","alert",1,"alert","alert-danger"],["icon","fa-solid fa-clock",3,"title","message","actionText"],[1,"card"],[1,"card","mt-3"],[1,"fa-solid","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-3",3,"click"],["icon","fa-solid fa-clock",3,"action","title","message","actionText"],[1,"card-body"],[3,"data","columns","loading","pageSize"],[3,"actionClick","actions","item"],[1,"d-flex","align-items-start"],[1,"fa-solid","fa-info-circle","text-info","me-3","mt-1",2,"font-size","1.5rem"],[1,"mb-2"],[1,"text-muted","mb-0","small"]],template:function(t,n){t&1&&(o(0,"app-page-header",1)(1,"div",2)(2,"button",3),g("click",function(){return n.createExcuse()}),x(3,"i",4),d(4),r(),o(5,"button",5),g("click",function(){return n.refresh()}),x(6,"i",6),d(7),r()()(),u(8,B,1,1,"app-loading-spinner",7),u(9,$,5,2,"div",8),u(10,Y,1,3,"app-empty-state",9),u(11,G,5,4,"div",10),u(12,J,9,2,"div",11)),t&2&&(c("title",n.i18n.t("portal.excuse_requests")),a(2),c("disabled",n.loading()),a(2),f(" ",n.i18n.t("portal.new_excuse")," "),a(),c("disabled",n.loading()),a(),k("fa-spin",n.loading()),a(),f(" ",n.i18n.t("common.refresh")," "),a(),p(n.loading()&&n.excuses().length===0?8:-1),a(),p(n.error()&&n.excuses().length===0?9:-1),a(),p(!n.loading()&&n.excuses().length===0&&!n.error()?10:-1),a(),p(n.excuses().length>0?11:-1),a(),p(n.excuses().length>0?12:-1))},dependencies:[q,z,H,A,V,I],styles:[".card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid var(--bs-border-color)}.card-body[_ngcontent-%COMP%]{padding:1.5rem}[_nghost-%COMP%]     .data-table{width:100%}[_nghost-%COMP%]     .data-table th{background-color:var(--bs-light);font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px;color:var(--bs-secondary);border-bottom:2px solid var(--bs-border-color)}[_nghost-%COMP%]     .data-table td{vertical-align:middle;font-size:.9rem}[_nghost-%COMP%]     .data-table tbody tr:hover{background-color:var(--bs-light);cursor:pointer;transition:background-color .2s ease}[_nghost-%COMP%]     .badge{font-size:.75rem;padding:.35rem .65rem;font-weight:600}.card[_ngcontent-%COMP%]   .fa-info-circle[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){[_nghost-%COMP%]     .data-table{font-size:.85rem}[_nghost-%COMP%]     .data-table th, [_nghost-%COMP%]     .data-table td{padding:.5rem}.card-body[_ngcontent-%COMP%]{padding:1rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"]})};export{F as ExcuseRequestsListComponent};
