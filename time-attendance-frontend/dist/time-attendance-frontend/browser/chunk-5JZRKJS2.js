import{a as J}from"./chunk-RM7DPSQZ.js";import{a as G}from"./chunk-LCQOFV6P.js";import{a as f,b as C}from"./chunk-5BLMYARA.js";import"./chunk-SZUF4QIO.js";import{a as z}from"./chunk-TSIHMY7T.js";import{b as q}from"./chunk-AS5QRUY4.js";import{$ as a,E as i,J as H,N as S,U as p,V as _,X as V,Y as R,Z as T,_ as v,aa as o,ba as x,fb as j,ia as h,ka as g,ma as s,nb as B,qb as F,rb as K,t as b,u as U,v as w,wa as l,xa as d,ya as c,z as y}from"./chunk-LDUBOZPL.js";import"./chunk-DGAILPFQ.js";function W(e,n){if(e&1){let t=h();a(0,"button",15),g("click",function(){U(t);let u=s();return w(u.onEdit())}),x(1,"i",16),l(2),o()}if(e&2){let t=s();i(2),c(" ",t.t("users.edit")," ")}}function X(e,n){if(e&1&&(a(0,"div",12)(1,"div",17)(2,"span",18),l(3),o()()()),e&2){let t=s();i(3),d(t.t("common.loading"))}}function Y(e,n){if(e&1&&x(0,"i",27),e&2){let t=s(2);v("title",t.t("users.must_change_password"))}}function Z(e,n){if(e&1&&l(0),e&2){let t=s(2);c(" ",t.t("common.language_arabic")," ")}}function ee(e,n){if(e&1&&l(0),e&2){let t=s(2);c(" ",t.t("common.language_english")," ")}}function te(e,n){if(e&1&&(a(0,"span",33),l(1),o()),e&2){let t=s(2);i(),d(t.t("users.locked"))}}function ne(e,n){if(e&1&&(a(0,"span",34),l(1),o()),e&2){let t=s(2);i(),d(t.t("common.active"))}}function ie(e,n){if(e&1&&(a(0,"span",35),l(1),o()),e&2){let t=s(2);i(),d(t.t("common.inactive"))}}function oe(e,n){if(e&1&&(a(0,"span",34),l(1),o()),e&2){let t=s(2);i(),d(t.t("common.enabled"))}}function ae(e,n){if(e&1&&(a(0,"span",35),l(1),o()),e&2){let t=s(2);i(),d(t.t("common.disabled"))}}function le(e,n){if(e&1&&(a(0,"span",47),l(1),o()),e&2){let t=n.$implicit,m=s(3);i(),d(m.getRoleName(t))}}function re(e,n){if(e&1&&(a(0,"div",39),R(1,le,2,1,"span",47,V),o()),e&2){let t,m=s(2);i(),T((t=m.user())==null?null:t.roles)}}function se(e,n){if(e&1&&(a(0,"p",40),l(1),o()),e&2){let t=s(2);i(),d(t.t("users.no_roles"))}}function de(e,n){if(e&1&&(a(0,"span",35),l(1),o()),e&2){let t=n.$implicit,m=s(3);i(),d(m.getBranchName(t))}}function me(e,n){if(e&1&&(a(0,"div",39),R(1,de,2,1,"span",35,V),o()),e&2){let t,m=s(2);i(),T((t=m.user())==null?null:t.branches)}}function ce(e,n){if(e&1&&(a(0,"p",40),l(1),o()),e&2){let t=s(2);i(),d(t.t("users.all_branches"))}}function ue(e,n){if(e&1){let t=h();a(0,"button",48),g("click",function(){U(t);let u=s(2);return w(u.onEdit())}),x(1,"i",16),l(2),o()}if(e&2){let t=s(2);i(2),c(" ",t.t("users.edit")," ")}}function pe(e,n){if(e&1){let t=h();a(0,"button",49),g("click",function(){U(t);let u=s(2);return w(u.onManageRoles())}),x(1,"i",50),l(2),o()}if(e&2){let t=s(2);i(2),c(" ",t.t("users.manage_roles")," ")}}function _e(e,n){if(e&1&&(a(0,"button",45),x(1,"i",52),l(2),o()),e&2){let t=s(3);i(2),c(" ",t.t("users.lock_account")," ")}}function xe(e,n){if(e&1&&S(0,_e,3,1,"button",51),e&2){let t=s(2);v("appHasPermission",t.PERMISSIONS.USER_LOCK)}}function fe(e,n){if(e&1&&(a(0,"button",46),x(1,"i",54),l(2),o()),e&2){let t=s(3);i(2),c(" ",t.t("users.unlock_account")," ")}}function Ce(e,n){if(e&1&&S(0,fe,3,1,"button",53),e&2){let t=s(2);v("appHasPermission",t.PERMISSIONS.USER_UNLOCK)}}function ve(e,n){if(e&1&&(a(0,"div",13)(1,"div",19)(2,"div",20)(3,"div",21)(4,"h5",22)(5,"div",23)(6,"div",24)(7,"div",25),l(8),o()(),a(9,"div")(10,"div",26),l(11),p(12,Y,1,1,"i",27),o(),a(13,"small",28),l(14),o()()()()(),a(15,"div",29)(16,"div",13)(17,"div",30)(18,"dl",13)(19,"dt",31),l(20),o(),a(21,"dd",32),l(22),o(),a(23,"dt",31),l(24),o(),a(25,"dd",32),l(26),o(),a(27,"dt",31),l(28),o(),a(29,"dd",32),l(30),o(),a(31,"dt",31),l(32),o(),a(33,"dd",32),p(34,Z,1,1)(35,ee,1,1),o()()(),a(36,"div",30)(37,"dl",13)(38,"dt",31),l(39),o(),a(40,"dd",32),p(41,te,2,1,"span",33)(42,ne,2,1,"span",34)(43,ie,2,1,"span",35),o(),a(44,"dt",31),l(45),o(),a(46,"dd",32),l(47),o(),a(48,"dt",31),l(49),o(),a(50,"dd",32),p(51,oe,2,1,"span",34)(52,ae,2,1,"span",35),o(),a(53,"dt",31),l(54),o(),a(55,"dd",32),l(56),o()()()()()()(),a(57,"div",36)(58,"div",20)(59,"div",21)(60,"h6",22),l(61),o()(),a(62,"div",29)(63,"div",37)(64,"h6",38),l(65),o(),p(66,re,3,0,"div",39)(67,se,2,1,"p",40),o(),a(68,"div")(69,"h6",38),l(70),o(),p(71,me,3,0,"div",39)(72,ce,2,1,"p",40),o()()(),a(73,"div",41)(74,"div",21)(75,"h6",22),l(76),o()(),a(77,"div",29)(78,"div",42),S(79,ue,3,1,"button",43)(80,pe,3,1,"button",44),p(81,xe,1,1,"button",45)(82,Ce,1,1,"button",46),o()()()()()),e&2){let t,m,u,k,P,N,O,M,I,L,D,A,E,$,r=s();i(8),c(" ",(((t=r.user())==null||t.username==null?null:t.username.charAt(0))||"")==null?null:(((t=t)==null||t.username==null?null:t.username.charAt(0))||"").toUpperCase()," "),i(3),c(" ",(m=r.user())==null?null:m.username," "),i(),_((u=r.user())!=null&&u.mustChangePassword?12:-1),i(2),d((k=r.user())==null?null:k.email),i(6),c("",r.t("users.username"),":"),i(2),d((P=r.user())==null?null:P.username),i(2),c("",r.t("users.email"),":"),i(2),d((N=r.user())==null?null:N.email),i(2),c("",r.t("users.phone"),":"),i(2),d(((O=r.user())==null?null:O.phone)||"-"),i(2),c("",r.t("users.language"),":"),i(2),_(((M=r.user())==null?null:M.preferredLanguage)==="ar"?34:35),i(5),c("",r.t("common.status"),":"),i(2),_(r.isUserLocked((I=r.user())==null?null:I.lockoutEndUtc)?41:(I=r.user())!=null&&I.isActive?42:43),i(4),c("",r.t("users.created_at"),":"),i(2),d(r.formatDate(r.user().createdAtUtc)),i(2),c("",r.t("users.two_factor"),":"),i(2),_((L=r.user())!=null&&L.twoFactorEnabled?51:52),i(3),c("",r.t("users.login_attempts"),":"),i(2),d(((D=r.user())==null?null:D.accessFailedCount)||0),i(5),d(r.t("users.roles_and_access")),i(4),d(r.t("users.roles")),i(),_((A=r.user())!=null&&A.roles&&r.user().roles.length>0?66:67),i(4),d(r.t("users.branches")),i(),_((E=r.user())!=null&&E.branches&&(((E=r.user())==null||E.branches==null?null:E.branches.length)||0)>0?71:72),i(5),d(r.t("common.actions")),i(3),v("appHasPermission",r.PERMISSIONS.USER_UPDATE),i(),v("appHasPermission",r.PERMISSIONS.USER_ASSIGN_ROLE),i(),_(($=r.user())!=null&&$.isActive?81:82)}}function be(e,n){if(e&1&&(a(0,"div",14),x(1,"i",55),l(2),o()),e&2){let t=s();i(2),c(" ",t.error()||t.t("users.user_not_found")," ")}}var Q=class e{router=b(F);route=b(B);usersService=b(z);i18n=b(q);permissionService=b(G);loading=y(!1);error=y(null);user=y(null);userId=0;PERMISSIONS={USER_UPDATE:`${C.USER}.${f.UPDATE}`,USER_DELETE:`${C.USER}.${f.DELETE}`,USER_LOCK:`${C.USER}.${f.LOCK}`,USER_UNLOCK:`${C.USER}.${f.UNLOCK}`,USER_ASSIGN_ROLE:`${C.USER}.${f.ASSIGN_ROLE}`,USER_REMOVE_ROLE:`${C.USER}.${f.REMOVE_ROLE}`,USER_MANAGE:`${C.USER}.${f.MANAGE}`};ngOnInit(){this.userId=+this.route.snapshot.params.id,this.userId?this.loadUser():this.router.navigate(["/users"])}loadUser(){this.loading.set(!0),this.usersService.getUserById(this.userId).subscribe({next:n=>{this.user.set(n),this.loading.set(!1)},error:n=>{this.error.set("Failed to load user"),this.loading.set(!1),console.error("Error loading user:",n)}})}onEdit(){this.router.navigate(["/users",this.userId,"edit"])}onBack(){this.router.navigate(["/users"])}onManageRoles(){console.log("Manage roles for user:",this.userId)}isUserLocked(n){return n?new Date(n)>new Date:!1}formatDate(n){return new Date(n).toLocaleDateString()}t(n){return this.i18n.t(n)}getRoleName(n){return typeof n=="string"?n:n&&typeof n=="object"&&n.name?n.name:n&&typeof n=="object"&&n.roleName?n.roleName:String(n)||"Unknown Role"}getBranchName(n){return typeof n=="string"?n:n&&typeof n=="object"&&n.name?n.name:n&&typeof n=="object"&&n.branchName?n.branchName:String(n)||"Unknown Branch"}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=H({type:e,selectors:[["app-view-user"]],decls:23,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/users"],[1,"breadcrumb-item","active"],[1,"btn-group"],["type","button","class","btn btn-primary",3,"click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"row"],[1,"alert","alert-danger"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-edit","me-2"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle"],[1,"fw-medium"],[1,"fa-solid","fa-exclamation-triangle","text-warning","ms-2",3,"title"],[1,"text-muted"],[1,"card-body"],[1,"col-md-6"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"badge","bg-danger"],[1,"badge","bg-success"],[1,"badge","bg-light","text-dark","border"],[1,"col-lg-4"],[1,"mb-3"],[1,"fw-semibold"],[1,"d-flex","flex-wrap","gap-1"],[1,"text-muted","mb-0"],[1,"card","mt-3"],[1,"d-grid","gap-2"],["type","button","class","btn btn-outline-primary",3,"click",4,"appHasPermission"],["type","button","class","btn btn-outline-info",3,"click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-warning"],["type","button",1,"btn","btn-outline-success"],[1,"badge","bg-info"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-outline-info",3,"click"],[1,"fa-solid","fa-user-tag","me-2"],["type","button","class","btn btn-outline-warning",4,"appHasPermission"],[1,"fa-solid","fa-lock","me-2"],["type","button","class","btn btn-outline-success",4,"appHasPermission"],[1,"fa-solid","fa-unlock","me-2"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(t,m){t&1&&(a(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),l(4),o(),a(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),l(9),o()(),a(10,"li",4)(11,"a",6),l(12),o()(),a(13,"li",7),l(14),o()()()(),a(15,"div",8),S(16,W,3,1,"button",9),a(17,"button",10),g("click",function(){return m.onBack()}),x(18,"i",11),l(19),o()()(),p(20,X,4,1,"div",12)(21,ve,83,29,"div",13)(22,be,3,1,"div",14),o()),t&2&&(i(4),d(m.t("users.view_details")),i(5),d(m.t("dashboard.title")),i(3),d(m.t("users.title")),i(2),d(m.t("users.view_details")),i(2),v("appHasPermission",m.PERMISSIONS.USER_UPDATE),i(3),c(" ",m.t("common.back")," "),i(),_(m.loading()?20:m.user()?21:22))},dependencies:[j,K,J],styles:[".avatar-sm[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center}.avatar-title[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-weight:600}"]})};export{Q as ViewUserComponent};
