{
  "version": 3,
  "sources": ["src/app/pages/roles/roles.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable, map } from 'rxjs';\r\nimport { Role, Permission, AssignPermissionRequest } from '../../shared/models/role.model';\r\nimport { environment } from '../../../environments/environment';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class RolesService {\r\n  private http = inject(HttpClient);\r\n  private baseUrl = `${environment.apiUrl}/api/v1/roles`;\r\n  private permissionsUrl = `${environment.apiUrl}/api/v1/permissions`;\r\n\r\n  getRoles(includePermissions: boolean = false): Observable<Role[]> {\r\n    let httpParams = new HttpParams();\r\n    if (includePermissions) {\r\n      httpParams = httpParams.set('includePermissions', 'true');\r\n    }\r\n    return this.http.get<Role[]>(this.baseUrl, { params: httpParams });\r\n  }\r\n\r\n  getRoleById(id: number): Observable<Role> {\r\n    return this.http.get<Role>(`${this.baseUrl}/${id}`);\r\n  }\r\n\r\n  getPermissions(group?: string): Observable<Permission[]> {\r\n    let httpParams = new HttpParams();\r\n    if (group) {\r\n      httpParams = httpParams.set('group', group);\r\n    }\r\n    return this.http.get<PermissionGroupDto[]>(this.permissionsUrl, { params: httpParams })\r\n      .pipe(\r\n        map(groups => {\r\n          // Flatten the grouped permissions into a single array\r\n          return groups.flatMap(group => group.permissions);\r\n        })\r\n      );\r\n  }\r\n\r\n  getGroupedPermissions(group?: string): Observable<PermissionGroupDto[]> {\r\n    let httpParams = new HttpParams();\r\n    if (group) {\r\n      httpParams = httpParams.set('group', group);\r\n    }\r\n    return this.http.get<PermissionGroupDto[]>(this.permissionsUrl, { params: httpParams });\r\n  }\r\n\r\n  assignPermissionToRole(roleId: number, request: AssignPermissionRequest): Observable<void> {\r\n    return this.http.post<void>(`${this.baseUrl}/${roleId}/permissions`, request);\r\n  }\r\n\r\n  removePermissionFromRole(roleId: number, permissionId: number): Observable<void> {\r\n    return this.http.delete<void>(`${this.baseUrl}/${roleId}/permissions/${permissionId}`);\r\n  }\r\n\r\n  createRole(roleData: CreateRoleRequest): Observable<Role> {\r\n    return this.http.post<Role>(this.baseUrl, roleData);\r\n  }\r\n\r\n  updateRole(roleId: number, roleData: UpdateRoleRequest): Observable<Role> {\r\n    return this.http.put<Role>(`${this.baseUrl}/${roleId}`, roleData);\r\n  }\r\n\r\n  deleteRole(roleId: number): Observable<void> {\r\n    return this.http.delete<void>(`${this.baseUrl}/${roleId}`);\r\n  }\r\n}\r\n\r\nexport interface CreateRoleRequest {\r\n  name: string;\r\n  permissionIds: number[];\r\n}\r\n\r\nexport interface UpdateRoleRequest {\r\n  name: string;\r\n  permissionIds: number[];\r\n}\r\n\r\nexport interface PermissionGroupDto {\r\n  group: string;\r\n  permissions: Permission[];\r\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;AASM,IAAO,gBAAP,MAAO,cAAY;EACf,OAAO,OAAO,UAAU;EACxB,UAAU,GAAG,YAAY,MAAM;EAC/B,iBAAiB,GAAG,YAAY,MAAM;EAE9C,SAAS,qBAA8B,OAAK;AAC1C,QAAI,aAAa,IAAI,WAAU;AAC/B,QAAI,oBAAoB;AACtB,mBAAa,WAAW,IAAI,sBAAsB,MAAM;IAC1D;AACA,WAAO,KAAK,KAAK,IAAY,KAAK,SAAS,EAAE,QAAQ,WAAU,CAAE;EACnE;EAEA,YAAY,IAAU;AACpB,WAAO,KAAK,KAAK,IAAU,GAAG,KAAK,OAAO,IAAI,EAAE,EAAE;EACpD;EAEA,eAAe,OAAc;AAC3B,QAAI,aAAa,IAAI,WAAU;AAC/B,QAAI,OAAO;AACT,mBAAa,WAAW,IAAI,SAAS,KAAK;IAC5C;AACA,WAAO,KAAK,KAAK,IAA0B,KAAK,gBAAgB,EAAE,QAAQ,WAAU,CAAE,EACnF,KACC,IAAI,YAAS;AAEX,aAAO,OAAO,QAAQ,CAAAA,WAASA,OAAM,WAAW;IAClD,CAAC,CAAC;EAER;EAEA,sBAAsB,OAAc;AAClC,QAAI,aAAa,IAAI,WAAU;AAC/B,QAAI,OAAO;AACT,mBAAa,WAAW,IAAI,SAAS,KAAK;IAC5C;AACA,WAAO,KAAK,KAAK,IAA0B,KAAK,gBAAgB,EAAE,QAAQ,WAAU,CAAE;EACxF;EAEA,uBAAuB,QAAgB,SAAgC;AACrE,WAAO,KAAK,KAAK,KAAW,GAAG,KAAK,OAAO,IAAI,MAAM,gBAAgB,OAAO;EAC9E;EAEA,yBAAyB,QAAgB,cAAoB;AAC3D,WAAO,KAAK,KAAK,OAAa,GAAG,KAAK,OAAO,IAAI,MAAM,gBAAgB,YAAY,EAAE;EACvF;EAEA,WAAW,UAA2B;AACpC,WAAO,KAAK,KAAK,KAAW,KAAK,SAAS,QAAQ;EACpD;EAEA,WAAW,QAAgB,UAA2B;AACpD,WAAO,KAAK,KAAK,IAAU,GAAG,KAAK,OAAO,IAAI,MAAM,IAAI,QAAQ;EAClE;EAEA,WAAW,QAAc;AACvB,WAAO,KAAK,KAAK,OAAa,GAAG,KAAK,OAAO,IAAI,MAAM,EAAE;EAC3D;;AAzDuB;cAAZ;mCAAA,eAAY;AAAA;cAAZ,mFAAA,eAAY,SAAZ,cAAY,WAAA,YAFX,OAAM,CAAA;AAEd,IAAO,eAAP;;sEAAO,cAAY,CAAA;UAHxB;WAAW;MACV,YAAY;KACb;;;",
  "names": ["group"]
}
