import{A as x,b as E,c as N,d as M,e as _,f as D,i as A,l as $,m as j,p as q,q as G,r as R,t as V,y as z}from"./chunk-YQIE4CGE.js";import{a as B}from"./chunk-JNFDDMIM.js";import{b as L}from"./chunk-ZURD34HZ.js";import{a as W}from"./chunk-GEGVYT7O.js";import"./chunk-A6EM5NV6.js";import{Da as C,E as S,Fa as w,Fb as T,Ga as l,Ha as f,Ia as u,L as n,O as g,Q as h,Sa as O,_ as v,aa as s,ba as p,ea as P,fa as k,ga as d,ha as r,ia as a,ja as c,sa as b,ua as m,y as I}from"./chunk-5OFYUWMA.js";import"./chunk-YMDWBF3A.js";var X=(t,i)=>i.value;function Y(t,i){if(t&1&&c(0,"i"),t&2){let e=m();w(O("",e.icon," me-1"))}}function Z(t,i){if(t&1&&(r(0,"option",10),l(1),a()),t&2){let e=i.$implicit;d("value",e.value),n(),f(e.label)}}function ee(t,i){if(t&1&&(r(0,"select",8)(1,"option",9),l(2),a(),P(3,Z,2,2,"option",10,X),a()),t&2){let e=m();C("is-invalid",e.isInvalid),d("id",e.fieldId)("formControl",e.control),v("aria-describedby",e.help?e.fieldId+"-help":null),n(2),f(e.placeholder),n(),k(e.options)}}function te(t,i){if(t&1&&(r(0,"textarea",11),l(1,"    "),a()),t&2){let e=m();C("is-invalid",e.isInvalid),d("id",e.fieldId)("formControl",e.control)("placeholder",e.placeholder),v("aria-describedby",e.help?e.fieldId+"-help":null)}}function ie(t,i){if(t&1&&c(0,"input",12),t&2){let e=m();C("is-invalid",e.isInvalid),d("id",e.fieldId)("type",e.type)("formControl",e.control)("placeholder",e.placeholder),v("aria-describedby",e.help?e.fieldId+"-help":null)}}function oe(t,i){if(t&1&&(r(0,"div",6),l(1),a()),t&2){let e=m();d("id",e.fieldId+"-help"),n(),f(e.help)}}function ne(t,i){if(t&1&&(r(0,"div",7),l(1),a()),t&2){let e=m();n(),f(e.errorMessage)}}var F=class t{label="";control;placeholder="";help="";type="text";icon="";options=[];static fieldCounter=0;fieldId;constructor(){this.fieldId=`field-${++t.fieldCounter}`}get isInvalid(){return!!(this.control?.invalid&&(this.control?.dirty||this.control?.touched))}get errorMessage(){if(!this.control?.errors)return"";let i=this.control.errors;return i.required?`${this.label} is required`:i.email?"Please enter a valid email address":i.minlength?`${this.label} must be at least ${i.minlength.requiredLength} characters`:i.maxlength?`${this.label} must not exceed ${i.maxlength.requiredLength} characters`:i.pattern?`${this.label} format is invalid`:"This field is invalid"}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=h({type:t,selectors:[["app-form-field"]],inputs:{label:"label",control:"control",placeholder:"placeholder",help:"help",type:"type",icon:"icon",options:"options"},decls:9,vars:6,consts:[[1,"mb-3"],[1,"form-label",3,"for"],[3,"class"],[1,"form-select",3,"id","is-invalid","formControl"],["rows","3",1,"form-control",3,"id","is-invalid","formControl","placeholder"],[1,"form-control",3,"id","type","is-invalid","formControl","placeholder"],[1,"form-text",3,"id"],[1,"invalid-feedback"],[1,"form-select",3,"id","formControl"],["value",""],[3,"value"],["rows","3",1,"form-control",3,"id","formControl","placeholder"],[1,"form-control",3,"id","type","formControl","placeholder"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"label",1),s(2,Y,1,3,"i",2),l(3),a(),s(4,ee,5,6,"select",3)(5,te,2,6,"textarea",4)(6,ie,1,7,"input",5),s(7,oe,2,2,"div",6),s(8,ne,2,1,"div",7),a()),e&2&&(n(),d("for",o.fieldId),n(),p(o.icon?2:-1),n(),u(" ",o.label," "),n(),p(o.type==="select"?4:o.type==="textarea"?5:6),n(3),p(o.help?7:-1),n(),p(o.isInvalid?8:-1))},dependencies:[x,R,V,N,G,_,$],styles:[".form-label[_ngcontent-%COMP%]{font-weight:500}.form-text[_ngcontent-%COMP%]{font-size:.875rem;color:var(--bs-secondary)}.is-invalid[_ngcontent-%COMP%]{border-color:var(--bs-danger)}.invalid-feedback[_ngcontent-%COMP%]{display:block;font-size:.875rem;color:var(--bs-danger);margin-top:.25rem}"]})};function re(t,i){if(t&1&&(r(0,"div",6),c(1,"i",20),l(2),a()),t&2){let e=m();n(2),u(" ",e.error()," ")}}function ae(t,i){t&1&&c(0,"span",14)}var H=class t{constructor(i,e,o,y){this.fb=i;this.authService=e;this.router=o;this.i18n=y;this.loginForm=this.fb.group({username:["",[M.required]],password:["",[M.required]],rememberMe:[!1]}),this.authService.isAuthenticated()&&this.router.navigate(["/dashboard"])}notificationService=I(B);loginForm;loading=S(!1);error=S("");t(i){return this.i18n.t(i)}onSubmit(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}this.loading.set(!0),this.error.set(""),this.authService.login(this.loginForm.value).subscribe({next:i=>{i.mustChangePassword?(this.notificationService.warning(this.t("auth.must_change_password"),"Please change your password to continue"),this.router.navigate(["/auth/change-password"])):(this.notificationService.success(this.t("auth.login_success"),"Welcome back!"),this.router.navigate(["/dashboard"]))},error:i=>{this.loading.set(!1),this.error.set(this.t("auth.invalid_credentials")),console.error("Login failed:",i),this.notificationService.error(this.t("auth.invalid_credentials"),"Please check your username and password")}})}get usernameControl(){return this.loginForm.get("username")}get passwordControl(){return this.loginForm.get("password")}onSwitchLanguage(){let i=this.i18n.getCurrentLocale()==="en"?"ar":"en";this.i18n.setLocale(i)}static \u0275fac=function(e){return new(e||t)(g(z),g(L),g(T),g(W))};static \u0275cmp=h({type:t,selectors:[["app-login"]],decls:26,vars:15,consts:[[1,"login-container"],[1,"login-card"],[1,"login-header","text-center","mb-4"],[1,"fa-solid","fa-clock","fa-3x","text-primary","mb-3"],[1,"h3","mb-2"],[1,"text-muted"],["role","alert",1,"alert","alert-danger"],["novalidate","",3,"ngSubmit","formGroup"],["type","text","icon","fa-solid fa-user",3,"label","control","placeholder"],["type","password","icon","fa-solid fa-lock",3,"label","control","placeholder"],[1,"mb-3","form-check"],["type","checkbox","id","rememberMe","formControlName","rememberMe",1,"form-check-input"],["for","rememberMe",1,"form-check-label"],["type","submit",1,"btn","btn-primary","w-100","mb-3",3,"disabled"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"text-center"],["href","#",1,"text-decoration-none",3,"click"],[1,"login-footer","mt-4","pt-3","border-top","text-center"],["type","button",1,"btn","btn-link","btn-sm",3,"click"],[1,"fa-solid","fa-globe","me-1"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2),c(3,"i",3),r(4,"h1",4),l(5,"Time Attendance System"),a(),r(6,"p",5),l(7),a()(),s(8,re,3,1,"div",6),r(9,"form",7),b("ngSubmit",function(){return o.onSubmit()}),c(10,"app-form-field",8)(11,"app-form-field",9),r(12,"div",10),c(13,"input",11),r(14,"label",12),l(15),a()(),r(16,"button",13),s(17,ae,1,0,"span",14),l(18),a(),r(19,"div",15)(20,"a",16),b("click",function(J){return J.preventDefault()}),l(21),a()()(),r(22,"div",17)(23,"button",18),b("click",function(){return o.onSwitchLanguage()}),c(24,"i",19),l(25),a()()()()),e&2&&(n(7),f(o.t("auth.login")),n(),p(o.error()?8:-1),n(),d("formGroup",o.loginForm),n(),d("label",o.t("auth.username"))("control",o.usernameControl)("placeholder",o.t("auth.username")),n(),d("label",o.t("auth.password"))("control",o.passwordControl)("placeholder",o.t("auth.password")),n(4),u(" ",o.t("auth.remember_me")," "),n(),d("disabled",o.loading()||o.loginForm.invalid),n(),p(o.loading()?17:-1),n(),u(" ",o.t("auth.login")," "),n(3),u(" ",o.t("auth.forgot_password")," "),n(4),u(" ",o.i18n.getCurrentLocale()==="en"?"\u0639\u0631\u0628\u064A":"English"," "))},dependencies:[x,A,E,_,D,j,q,F],styles:[".login-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#667eea,#764ba2);padding:1rem}.login-card[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;box-shadow:0 1rem 3rem #0000002d;padding:2rem;width:100%;max-width:400px}.login-header[_ngcontent-%COMP%]{margin-bottom:2rem}.login-header[_ngcontent-%COMP%]   .fa-clock[_ngcontent-%COMP%]{color:var(--bs-primary)}.login-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:700;color:var(--bs-dark)}.login-footer[_ngcontent-%COMP%]{border-top:1px solid var(--bs-border-color)}.btn-primary[_ngcontent-%COMP%]{padding:.75rem 1rem;font-weight:600;border-radius:.5rem}.form-check-input[_ngcontent-%COMP%]:checked{background-color:var(--bs-primary);border-color:var(--bs-primary)}.alert[_ngcontent-%COMP%]{border-radius:.5rem;border:none}[_ngcontent-%COMP%]:root[dir=rtl]   .me-1[_ngcontent-%COMP%]{margin-left:.25rem!important;margin-right:0!important}[_ngcontent-%COMP%]:root[dir=rtl]   .me-2[_ngcontent-%COMP%]{margin-left:.5rem!important;margin-right:0!important}@media (max-width: 576px){.login-container[_ngcontent-%COMP%]{padding:.5rem}.login-card[_ngcontent-%COMP%]{padding:1.5rem}.login-header[_ngcontent-%COMP%]   .fa-clock[_ngcontent-%COMP%]{font-size:2rem!important}}"]})};export{H as LoginComponent};
