import"./chunk-IOKJIQ6J.js";import{a as z}from"./chunk-QIFMF2AZ.js";import{a as V}from"./chunk-NPDCAEA6.js";import{a as O}from"./chunk-H5EPUHY6.js";import"./chunk-VRETN7JA.js";import{a as E}from"./chunk-23PGFYQZ.js";import{a as A}from"./chunk-GRQ6RO47.js";import{a as I}from"./chunk-UBCI4X5Q.js";import{a as L}from"./chunk-EYAJMHM7.js";import{a as D}from"./chunk-HHXRLUSQ.js";import{b as M}from"./chunk-RUY4WPQA.js";import{g as P}from"./chunk-TWXUAMJ4.js";import{Bb as d,Cb as T,Db as _,Ea as x,Ia as R,R as p,Ub as F,W as b,X as v,Xa as m,Ya as u,Yb as w,bb as l,cb as a,db as s,eb as g,lb as C,nb as f,pb as o,ta as r,wc as k,yb as S}from"./chunk-JSQL33QG.js";import{a as q,b as h,d as y}from"./chunk-DGAILPFQ.js";function B(n,t){if(n&1&&g(0,"app-loading-spinner",7),n&2){let e=o();l("message",e.i18n.t("common.loading"))}}function H(n,t){if(n&1){let e=C();a(0,"div",8),g(1,"i",12),d(2),a(3,"button",13),f("click",function(){b(e);let c=o();return v(c.refresh())}),d(4),s()()}if(n&2){let e=o();r(2),_(" ",e.error()," "),r(2),_(" ",e.i18n.t("common.retry")," ")}}function $(n,t){if(n&1){let e=C();a(0,"app-empty-state",14),f("action",function(){b(e);let c=o();return v(c.createRequest())}),s()}if(n&2){let e=o();l("title",e.i18n.t("portal.no_requests"))("message",e.i18n.t("portal.no_requests_message"))("actionText",e.i18n.t("portal.create_first_request"))}}function j(n,t){if(n&1){let e=C();a(0,"app-table-actions",17),f("actionClick",function(c){b(e);let U=o(2);return v(U.onActionClick(c))}),s()}if(n&2){let e=t.$implicit,i=o(2);l("actions",i.actions)("item",e)}}function Y(n,t){if(n&1&&(a(0,"div",10)(1,"div",15)(2,"app-data-table",16),R(3,j,1,2,"ng-template",null,0,F),s()()()),n&2){let e=o();r(2),l("data",e.tableData())("columns",e.columns)("loading",e.loading())("pageSize",10)}}function G(n,t){if(n&1&&(a(0,"div",11)(1,"div",15)(2,"div",18),g(3,"i",19),a(4,"div")(5,"h6",20),d(6),s(),a(7,"p",21),d(8),s()()()()()),n&2){let e=o();r(6),T(e.i18n.t("portal.fingerprint_request_info_title")),r(2),_(" ",e.i18n.t("portal.fingerprint_request_info_text")," ")}}var N=class n{portalService=p(E);router=p(P);notificationService=p(D);confirmationService=p(O);i18n=p(M);requests=this.portalService.fingerprintRequests;loading=this.portalService.fingerprintRequestsLoading;error=this.portalService.fingerprintRequestsError;columns=[{key:"id",label:"ID",sortable:!0,width:"80px"},{key:"requestType",label:"Request Type",sortable:!0},{key:"issueDescription",label:"Description",sortable:!1},{key:"preferredDate",label:"Preferred Date",sortable:!0},{key:"status",label:"Status",sortable:!0,renderHtml:!0},{key:"createdAtUtc",label:"Created",sortable:!0},{key:"actions",label:"Actions",sortable:!1,width:"120px"}];actions=[{id:"view",label:"View",icon:"fa-eye",variant:"primary"},{id:"edit",label:"Edit",icon:"fa-edit",variant:"warning",visible:t=>t.status==="Pending"},{id:"cancel",label:"Cancel",icon:"fa-times",variant:"danger",visible:t=>t.status==="Pending"||t.status==="Scheduled"}];tableData=w(()=>this.requests().map(e=>h(q({},e),{requestType:this.formatRequestType(e.requestType),preferredDate:e.preferredDate?this.formatDate(e.preferredDate):"-",status:this.getStatusBadgeHtml(e.status),createdAtUtc:this.formatDate(e.createdAtUtc)})));ngOnInit(){this.loadRequests()}ngOnDestroy(){this.portalService.clearFingerprintRequests()}loadRequests(){this.portalService.loadFingerprintRequests().subscribe({error:t=>{console.error("Failed to load fingerprint requests:",t),this.notificationService.error(this.i18n.t("portal.failed_to_load_requests"))}})}refresh(){this.loadRequests()}createRequest(){this.router.navigate(["/portal/fingerprint-requests/new"])}onActionClick(t){let e=this.requests().find(i=>i.id===t.item.id);if(e)switch(t.action.id){case"view":this.viewRequest(e);break;case"edit":this.editRequest(e);break;case"cancel":this.cancelRequest(e);break}}viewRequest(t){this.router.navigate(["/portal/fingerprint-requests",t.id])}editRequest(t){this.router.navigate(["/portal/fingerprint-requests",t.id,"edit"])}cancelRequest(t){return y(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("portal.cancel_request"),message:this.i18n.t("portal.cancel_request_confirm"),confirmText:this.i18n.t("common.yes_cancel"),cancelText:this.i18n.t("common.no"),confirmButtonClass:"btn-danger",icon:"fa-times",iconClass:"text-danger"})).confirmed&&this.portalService.cancelFingerprintRequest(t.id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("portal.request_cancelled_successfully")),this.loadRequests()},error:i=>{console.error("Failed to cancel request:",i),this.notificationService.error(this.i18n.t("portal.failed_to_cancel_request"))}})})}formatRequestType(t){return{NewEnrollment:"New Enrollment",Update:"Update",Issue:"Issue/Problem",AdditionalFingers:"Additional Fingers",LocationChange:"Location Change"}[t]||t}getStatusBadgeHtml(t){return`<span class="badge bg-${{Pending:"warning",Scheduled:"info",Completed:"success",Cancelled:"secondary",Rejected:"danger"}[t]||"secondary"}">${t}</span>`}formatDate(t){return(typeof t=="string"?new Date(t):t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=x({type:n,selectors:[["app-fingerprint-requests-list"]],decls:13,vars:12,consts:[["actionsTemplate",""],[3,"title"],["header-actions",""],["type","button",1,"btn","btn-primary","btn-sm","me-2",3,"click","disabled"],[1,"fa-solid","fa-plus","me-1"],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click","disabled"],[1,"fa-solid","fa-sync-alt"],[3,"message"],["role","alert",1,"alert","alert-danger"],["icon","fa-solid fa-fingerprint",3,"title","message","actionText"],[1,"card"],[1,"card","mt-3"],[1,"fa-solid","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-3",3,"click"],["icon","fa-solid fa-fingerprint",3,"action","title","message","actionText"],[1,"card-body"],[3,"data","columns","loading","pageSize"],[3,"actionClick","actions","item"],[1,"d-flex","align-items-start"],[1,"fa-solid","fa-info-circle","text-info","me-3","mt-1",2,"font-size","1.5rem"],[1,"mb-2"],[1,"text-muted","mb-0","small"]],template:function(e,i){e&1&&(a(0,"app-page-header",1)(1,"div",2)(2,"button",3),f("click",function(){return i.createRequest()}),g(3,"i",4),d(4),s(),a(5,"button",5),f("click",function(){return i.refresh()}),g(6,"i",6),d(7),s()()(),m(8,B,1,1,"app-loading-spinner",7),m(9,H,5,2,"div",8),m(10,$,1,3,"app-empty-state",9),m(11,Y,5,4,"div",10),m(12,G,9,2,"div",11)),e&2&&(l("title",i.i18n.t("portal.fingerprint_requests")),r(2),l("disabled",i.loading()),r(2),_(" ",i.i18n.t("portal.new_request")," "),r(),l("disabled",i.loading()),r(),S("fa-spin",i.loading()),r(),_(" ",i.i18n.t("common.refresh")," "),r(),u(i.loading()&&i.requests().length===0?8:-1),r(),u(i.error()&&i.requests().length===0?9:-1),r(),u(!i.loading()&&i.requests().length===0&&!i.error()?10:-1),r(),u(i.requests().length>0?11:-1),r(),u(i.requests().length>0?12:-1))},dependencies:[k,I,L,V,z,A],styles:[".card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013;border:1px solid var(--bs-border-color)}.card-body[_ngcontent-%COMP%]{padding:1.5rem}[_nghost-%COMP%]     .data-table{width:100%}[_nghost-%COMP%]     .data-table th{background-color:var(--bs-light);font-weight:600;font-size:.875rem;text-transform:uppercase;letter-spacing:.5px;color:var(--bs-secondary);border-bottom:2px solid var(--bs-border-color)}[_nghost-%COMP%]     .data-table td{vertical-align:middle;font-size:.9rem}[_nghost-%COMP%]     .data-table tbody tr:hover{background-color:var(--bs-light);cursor:pointer;transition:background-color .2s ease}[_nghost-%COMP%]     .badge{font-size:.75rem;padding:.35rem .65rem;font-weight:600}.card[_ngcontent-%COMP%]   .fa-info-circle[_ngcontent-%COMP%]{flex-shrink:0}@media (max-width: 768px){[_nghost-%COMP%]     .data-table{font-size:.85rem}[_nghost-%COMP%]     .data-table th, [_nghost-%COMP%]     .data-table td{padding:.5rem}.card-body[_ngcontent-%COMP%]{padding:1rem}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"]})};export{N as FingerprintRequestsListComponent};
