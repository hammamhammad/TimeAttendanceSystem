import{c as W,e as N,h as z,x as U}from"./chunk-VRETN7JA.js";import{a as j}from"./chunk-23PGFYQZ.js";import{a as Y}from"./chunk-GRQ6RO47.js";import{a as R}from"./chunk-UBCI4X5Q.js";import{a as V}from"./chunk-EYAJMHM7.js";import"./chunk-HHXRLUSQ.js";import{b as L}from"./chunk-UWVH5K3J.js";import{b as B}from"./chunk-RUY4WPQA.js";import"./chunk-TWXUAMJ4.js";import{$a as P,Ab as F,Bb as o,Cb as l,Db as g,Ea as E,Eb as C,Ib as S,Jb as M,Kb as D,R as _,W as O,X as w,Xa as v,Ya as b,Yb as I,ab as k,bb as f,cb as a,da as x,db as r,eb as s,lb as A,nb as y,pb as u,ta as t,wc as H,yb as T}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";var K=(d,i)=>i.id;function Q(d,i){if(d&1&&s(0,"app-loading-spinner",4),d&2){let e=u();f("message",e.i18n.t("common.loading"))}}function X(d,i){if(d&1){let e=A();a(0,"div",5),s(1,"i",21),o(2),a(3,"button",22),y("click",function(){O(e);let c=u();return w(c.refresh())}),o(4),r()()}if(d&2){let e=u();t(2),g(" ",e.error()," "),t(2),g(" ",e.i18n.t("common.retry")," ")}}function Z(d,i){if(d&1&&(a(0,"div",6)(1,"div",23)(2,"div",24)(3,"div",11)(4,"div",25)(5,"div",26),s(6,"i",27),r(),a(7,"div",28)(8,"h6",29),o(9),r(),a(10,"h3",30),o(11),r()()()()()(),a(12,"div",23)(13,"div",24)(14,"div",11)(15,"div",25)(16,"div",31),s(17,"i",32),r(),a(18,"div",28)(19,"h6",29),o(20),r(),a(21,"h3",30),o(22),r()()()()()(),a(23,"div",23)(24,"div",24)(25,"div",11)(26,"div",25)(27,"div",33),s(28,"i",34),r(),a(29,"div",28)(30,"h6",29),o(31),r(),a(32,"h3",30),o(33),r()()()()()(),a(34,"div",23)(35,"div",24)(36,"div",11)(37,"div",25)(38,"div",35),s(39,"i",36),r(),a(40,"div",28)(41,"h6",29),o(42),r(),a(43,"h3",30),o(44),r()()()()()()()),d&2){let e=u();t(9),l(e.i18n.t("attendance.attendance_rate")),t(2),g("",e.summary().attendanceRate.toFixed(1),"%"),t(9),l(e.i18n.t("attendance.present_days")),t(2),C("",e.summary().presentDays," / ",e.summary().totalDays),t(9),l(e.i18n.t("attendance.working_hours")),t(2),g("",e.summary().totalWorkingHours.toFixed(1),"h"),t(9),l(e.i18n.t("attendance.overtime")),t(2),g("",e.summary().totalOvertimeHours.toFixed(1),"h")}}function ee(d,i){if(d&1&&(a(0,"tr")(1,"td"),o(2),r(),a(3,"td")(4,"span"),o(5),r()(),a(6,"td"),o(7),r(),a(8,"td"),o(9),r(),a(10,"td"),o(11),r(),a(12,"td"),o(13),r(),a(14,"td"),o(15),r()()),d&2){let e=i.$implicit,n=u(2);t(2),l(n.formatDate(e.date)),t(2),F(n.getStatusBadgeClass(e.status)),t(),g(" ",e.status," "),t(2),l(n.formatTime(e.checkInTime)),t(2),l(n.formatTime(e.checkOutTime)),t(2),l(n.formatHours(e.workingHours||0)),t(2),l(n.formatHours((e.preShiftOvertimeHours||0)+(e.postShiftOvertimeHours||0))),t(2),l(e.shiftName||"-")}}function te(d,i){if(d&1&&(a(0,"div",19)(1,"div",37)(2,"h5",9),s(3,"i",38),o(4),r(),a(5,"span",39),o(6),r()(),a(7,"div",40)(8,"div",41)(9,"table",42)(10,"thead",43)(11,"tr")(12,"th"),o(13),r(),a(14,"th"),o(15),r(),a(16,"th"),o(17),r(),a(18,"th"),o(19),r(),a(20,"th"),o(21),r(),a(22,"th"),o(23),r(),a(24,"th"),o(25),r()()(),a(26,"tbody"),P(27,ee,16,9,"tr",null,K),r()()()()()),d&2){let e=u();t(4),g(" ",e.i18n.t("attendance.attendance_records")," "),t(2),C("",e.attendance().length," ",e.i18n.t("common.records")),t(7),l(e.i18n.t("common.date")),t(2),l(e.i18n.t("common.status")),t(2),l(e.i18n.t("attendance.check_in")),t(2),l(e.i18n.t("attendance.check_out")),t(2),l(e.i18n.t("attendance.working_hours")),t(2),l(e.i18n.t("attendance.overtime")),t(2),l(e.i18n.t("attendance.shift")),t(2),k(e.attendance())}}function ne(d,i){if(d&1&&s(0,"app-empty-state",20),d&2){let e=u();f("title",e.i18n.t("attendance.no_records"))("message",e.i18n.t("attendance.no_records_message"))}}var $=class d{portalService=_(j);authService=_(L);i18n=_(B);attendance=this.portalService.myAttendance;loading=this.portalService.myAttendanceLoading;error=this.portalService.myAttendanceError;currentUser=I(()=>this.authService.currentUser());startDate=x(this.getFirstDayOfMonth());endDate=x(this.getTodayString());summary=I(()=>{let i=this.attendance();if(i.length===0)return null;let e=i.length,n=i.filter(m=>m.status==="Present"||m.status==="Late"||m.status==="EarlyLeave").length,c=i.filter(m=>m.status==="Absent").length,p=i.filter(m=>m.status==="Late").length,q=i.reduce((m,h)=>m+(h.workingHours||0),0),G=i.reduce((m,h)=>m+(h.preShiftOvertimeHours||0)+(h.postShiftOvertimeHours||0),0),J=e>0?n/e*100:0;return{totalDays:e,presentDays:n,absentDays:c,lateDays:p,totalWorkingHours:q,totalOvertimeHours:G,attendanceRate:J}});ngOnInit(){this.loadAttendance()}ngOnDestroy(){this.portalService.clearMyAttendance()}loadAttendance(){let e=this.currentUser()?.employeeId;this.portalService.loadMyAttendance({startDate:new Date(this.startDate()),endDate:new Date(this.endDate()),employeeId:e}).subscribe({error:n=>{console.error("Failed to load attendance:",n)}})}applyFilters(){this.loadAttendance()}clearFilters(){this.startDate.set(this.getFirstDayOfMonth()),this.endDate.set(this.getTodayString()),this.loadAttendance()}refresh(){this.loadAttendance()}getStatusBadgeClass(i){return{Present:"badge bg-success",Absent:"badge bg-danger",Late:"badge bg-warning",EarlyLeave:"badge bg-warning",Holiday:"badge bg-info",Weekend:"badge bg-secondary",OnLeave:"badge bg-primary",RemoteWork:"badge bg-info"}[i]||"badge bg-secondary"}formatDate(i){return(typeof i=="string"?new Date(i):i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}formatTime(i){return i?(typeof i=="string"?new Date(i):i).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"-"}formatHours(i){return i.toFixed(2)+"h"}getFirstDayOfMonth(){let i=new Date,e=new Date(i.getFullYear(),i.getMonth(),1);return this.dateToInputString(e)}getTodayString(){return this.dateToInputString(new Date)}dateToInputString(i){let e=i.getFullYear(),n=String(i.getMonth()+1).padStart(2,"0"),c=String(i.getDate()).padStart(2,"0");return`${e}-${n}-${c}`}static \u0275fac=function(e){return new(e||d)};static \u0275cmp=E({type:d,selectors:[["app-my-attendance"]],decls:29,vars:15,consts:[[3,"title"],["header-actions",""],["type","button",1,"btn","btn-outline-primary","btn-sm",3,"click","disabled"],[1,"fa-solid","fa-sync-alt"],[3,"message"],["role","alert",1,"alert","alert-danger"],[1,"row","g-3","mb-4"],[1,"card","mb-4"],[1,"card-header","bg-white"],[1,"card-title","mb-0"],[1,"fa-solid","fa-filter","me-2"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-md-4","d-flex","align-items-end"],["type","button",1,"btn","btn-outline-secondary","w-100",3,"click"],[1,"fa-solid","fa-times","me-2"],[1,"card"],["icon","fa-calendar-alt",3,"title","message"],[1,"fa-solid","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-3",3,"click"],[1,"col-6","col-md-3"],[1,"card","summary-card","h-100"],[1,"d-flex","align-items-center","mb-2"],[1,"summary-icon","bg-primary-subtle","me-3"],[1,"fa-solid","fa-percentage","text-primary"],[1,"flex-grow-1"],[1,"mb-0","text-muted"],[1,"mb-0"],[1,"summary-icon","bg-success-subtle","me-3"],[1,"fa-solid","fa-check","text-success"],[1,"summary-icon","bg-info-subtle","me-3"],[1,"fa-solid","fa-clock","text-info"],[1,"summary-icon","bg-warning-subtle","me-3"],[1,"fa-solid","fa-business-time","text-warning"],[1,"card-header","bg-white","d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-table","me-2"],[1,"badge","bg-primary","rounded-pill"],[1,"card-body","p-0"],[1,"table-responsive"],[1,"table","table-hover","mb-0"],[1,"table-light"]],template:function(e,n){e&1&&(a(0,"app-page-header",0)(1,"div",1)(2,"button",2),y("click",function(){return n.refresh()}),s(3,"i",3),o(4),r()()(),v(5,Q,1,1,"app-loading-spinner",4),v(6,X,5,2,"div",5),v(7,Z,45,9,"div",6),a(8,"div",7)(9,"div",8)(10,"h5",9),s(11,"i",10),o(12),r()(),a(13,"div",11)(14,"div",12)(15,"div",13)(16,"label",14),o(17),r(),a(18,"input",15),D("ngModelChange",function(p){return M(n.startDate,p)||(n.startDate=p),p}),y("change",function(){return n.applyFilters()}),r()(),a(19,"div",13)(20,"label",14),o(21),r(),a(22,"input",15),D("ngModelChange",function(p){return M(n.endDate,p)||(n.endDate=p),p}),y("change",function(){return n.applyFilters()}),r()(),a(23,"div",16)(24,"button",17),y("click",function(){return n.clearFilters()}),s(25,"i",18),o(26),r()()()()(),v(27,te,29,10,"div",19)(28,ne,1,2,"app-empty-state",20)),e&2&&(f("title",n.i18n.t("portal.my_attendance")),t(2),f("disabled",n.loading()),t(),T("fa-spin",n.loading()),t(),g(" ",n.i18n.t("common.refresh")," "),t(),b(n.loading()&&!n.attendance().length?5:-1),t(),b(n.error()&&!n.attendance().length?6:-1),t(),b(n.summary()?7:-1),t(5),g(" ",n.i18n.t("common.filters")," "),t(5),l(n.i18n.t("common.start_date")),t(),S("ngModel",n.startDate),t(3),l(n.i18n.t("common.end_date")),t(),S("ngModel",n.endDate),t(4),g(" ",n.i18n.t("common.clear_filters")," "),t(),b(n.attendance().length>0?27:n.loading()?-1:28))},dependencies:[H,U,W,N,z,R,V,Y],styles:[".summary-card[_ngcontent-%COMP%]{border:none;box-shadow:0 .125rem .25rem #00000013;transition:all .3s ease}.summary-card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026;transform:translateY(-2px)}.summary-icon[_ngcontent-%COMP%]{width:3rem;height:3rem;border-radius:.5rem;display:flex;align-items:center;justify-content:center;font-size:1.5rem}.card[_ngcontent-%COMP%]{box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid var(--bs-border-color)}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;text-transform:uppercase;font-size:.875rem;letter-spacing:.5px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:var(--bs-light)}.badge[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;padding:.25rem .75rem}@media (max-width: 576px){.summary-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem}.summary-icon[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;font-size:1.25rem}.table[_ngcontent-%COMP%]{font-size:.875rem}}.bg-primary-subtle[_ngcontent-%COMP%]{background-color:#0d6efd1a!important}.bg-success-subtle[_ngcontent-%COMP%]{background-color:#1987541a!important}.bg-warning-subtle[_ngcontent-%COMP%]{background-color:#ffc1071a!important}.bg-info-subtle[_ngcontent-%COMP%]{background-color:#0dcaf01a!important}.bg-danger-subtle[_ngcontent-%COMP%]{background-color:#dc35451a!important}.bg-secondary-subtle[_ngcontent-%COMP%]{background-color:#6c757d1a!important}"]})};export{$ as MyAttendanceComponent};
