import{a as L}from"./chunk-MGKABIP3.js";import{a as J}from"./chunk-SRPEDAT4.js";import{a as K}from"./chunk-U6T3NABJ.js";import{c as F,d as P,e as T,f as O,i as k,m as V,n as A,o as G,p as $,r as q,w as z,x as R,y as j}from"./chunk-VRETN7JA.js";import{a as U}from"./chunk-UBCI4X5Q.js";import{a as H}from"./chunk-HHXRLUSQ.js";import{b as B}from"./chunk-RUY4WPQA.js";import{d as N,g as w}from"./chunk-TWXUAMJ4.js";import{$a as E,Bb as r,Cb as u,Db as s,Ea as b,Eb as S,R as v,W as x,X as _,Xa as f,Ya as h,ab as I,bb as c,cb as n,da as g,db as a,eb as m,lb as D,nb as y,pb as d,ta as i,wc as M,yb as C}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";var W=(o,t)=>t.id;function X(o,t){if(o&1&&(n(0,"div",2)(1,"div",5)(2,"span",6),r(3),a()(),n(4,"p",7),r(5),a()()),o&2){let e=d();i(3),u(e.i18n.t("common.loading")),i(2),u(e.i18n.t("employees.loading_details"))}}function Y(o,t){if(o&1&&(n(0,"div",3),m(1,"i",8),r(2),a()),o&2){let e=d();i(2),s(" ",e.error()," ")}}function Z(o,t){if(o&1&&(n(0,"app-form-section",1)(1,"div",52)(2,"div",53)(3,"div",54)(4,"div")(5,"strong"),r(6),a(),n(7,"div",55),r(8),a()(),n(9,"span",56),r(10),a()()()()()),o&2){let e=d(2);c("title",e.i18n.t("employees.current_shift")),i(6),u(e.employee().currentShiftName),i(2),s(" ",e.getCurrentShiftDisplay()," "),i(2),u(e.i18n.t("common.current"))}}function ee(o,t){if(o&1&&(n(0,"div",18),m(1,"i",8),r(2),a()),o&2){let e=d(2);i(2),s(" ",e.error()," ")}}function te(o,t){if(o&1&&(n(0,"option",25),r(1),a()),o&2){let e=t.$implicit,l=d(2);c("value",e.id),i(),S(" ",e.name," (",l.getShiftTimeDisplay(e),") ")}}function ie(o,t){if(o&1&&(n(0,"div",26),r(1),a()),o&2){let e=d(2);i(),s(" ",e.getErrorMessage("shiftId")," ")}}function ne(o,t){if(o&1&&(n(0,"div",26),r(1),a()),o&2){let e=d(2);i(),s(" ",e.getErrorMessage("effectiveDate")," ")}}function oe(o,t){if(o&1&&(m(0,"span",57),r(1)),o&2){let e=d(2);i(),s(" ",e.i18n.t("employees.changing_shift")," ")}}function ae(o,t){if(o&1&&(m(0,"i",58),r(1)),o&2){let e=d(2);i(),s(" ",e.i18n.t("employees.change_shift")," ")}}function re(o,t){if(o&1){let e=D();n(0,"form",9),y("ngSubmit",function(){x(e);let p=d();return _(p.onSubmit())}),n(1,"div",10)(2,"div",11)(3,"app-form-section",1)(4,"div",12)(5,"div",13)(6,"div",14)(7,"div",15),r(8),a()(),n(9,"div")(10,"h6",16),r(11),a(),n(12,"small",17),r(13),a()()()()(),f(14,Z,11,4,"app-form-section",1),n(15,"app-form-section",1),f(16,ee,3,1,"div",18),n(17,"div",19)(18,"div",20)(19,"label",21),r(20),n(21,"span",22),r(22,"*"),a()(),n(23,"select",23)(24,"option",24),r(25),a(),E(26,te,2,3,"option",25,W),a(),f(28,ie,2,1,"div",26),a(),n(29,"div",20)(30,"label",27),r(31),n(32,"span",22),r(33,"*"),a()(),m(34,"input",28),f(35,ne,2,1,"div",26),n(36,"div",29),r(37),a()(),n(38,"div",30)(39,"label",31),r(40),a(),n(41,"textarea",32),r(42,"                "),a()()()()(),n(43,"div",33)(44,"div",34)(45,"div",35)(46,"h6",36),m(47,"i",37),r(48),a()(),n(49,"div",38)(50,"div",39)(51,"button",40),f(52,oe,2,1)(53,ae,2,1),a(),n(54,"button",41),y("click",function(){x(e);let p=d();return _(p.onReset())}),m(55,"i",42),r(56),a(),n(57,"button",43),y("click",function(){x(e);let p=d();return _(p.onCancel())}),m(58,"i",44),r(59),a()()()(),n(60,"div",45)(61,"div",35)(62,"h6",36),m(63,"i",46),r(64),a()(),n(65,"div",38)(66,"p",47),r(67),a(),n(68,"ul",48)(69,"li",16),m(70,"i",49),r(71),a(),n(72,"li",16),m(73,"i",50),r(74),a(),n(75,"li"),m(76,"i",51),r(77),a()()()()()()()}if(o&2){let e=d();c("formGroup",e.changeShiftForm),i(3),c("title",e.i18n.t("employees.employee_information")),i(5),s(" ",e.getEmployeeInitials()," "),i(3),S("",e.employee().firstName," ",e.employee().lastName),i(2),S("",e.employee().departmentName," - ",e.employee().branchName),i(),h(e.employee().currentShiftId?14:-1),i(),c("title",e.i18n.t("employees.new_shift_assignment")),i(),h(e.error()?16:-1),i(4),s(" ",e.i18n.t("fields.newShift")," "),i(3),C("is-invalid",e.isFieldInvalid("shiftId")),i(2),u(e.i18n.t("employees.placeholders.select_shift")),i(),I(e.availableShifts()),i(2),h(e.hasError("shiftId")?28:-1),i(3),s(" ",e.i18n.t("fields.effectiveDate")," "),i(3),C("is-invalid",e.isFieldInvalid("effectiveDate")),i(),h(e.hasError("effectiveDate")?35:-1),i(2),u(e.i18n.t("employees.help.shift_advance_planning")),i(3),s(" ",e.i18n.t("fields.notes")," "),i(),c("placeholder",e.i18n.t("employees.placeholders.shift_change_notes")),i(7),s(" ",e.i18n.t("common.actions")," "),i(3),c("disabled",e.changeShiftForm.invalid||e.saving()),i(),h(e.saving()?52:53),i(2),c("disabled",e.saving()),i(2),s(" ",e.i18n.t("common.reset")," "),i(),c("disabled",e.saving()),i(2),s(" ",e.i18n.t("common.cancel")," "),i(5),s(" ",e.i18n.t("common.help")," "),i(3),s(" ",e.i18n.t("employees.help.shift_change_instructions")," "),i(4),s(" ",e.i18n.t("employees.help.select_new_shift")," "),i(3),s(" ",e.i18n.t("employees.help.future_date_required")," "),i(3),s(" ",e.i18n.t("employees.help.optional_notes")," ")}}var Q=class o{i18n=v(B);router=v(w);route=v(N);fb=v(z);employeesService=v(K);shiftsService=v(L);notificationService=v(H);loading=g(!1);saving=g(!1);employee=g(null);availableShifts=g([]);error=g(null);changeShiftForm;constructor(){let t=new Date;t.setDate(t.getDate()+1),this.changeShiftForm=this.fb.group({shiftId:["",P.required],effectiveDate:[t.toISOString().split("T")[0],this.futureDateValidator()],notes:[""]})}ngOnInit(){this.loadEmployeeDetails()}loadEmployeeDetails(){let t=this.route.snapshot.paramMap.get("employeeId");if(!t){this.router.navigate(["/employees"]);return}this.loading.set(!0),this.error.set(null),this.employeesService.getEmployeeById(+t).subscribe({next:e=>{this.employee.set(e),this.loadShifts(),this.loading.set(!1)},error:e=>{console.error("Failed to load employee details:",e),this.error.set(this.i18n.t("employees.errors.load_failed")),this.loading.set(!1)}})}loadShifts(){this.shiftsService.getActiveShifts().subscribe({next:t=>{let e=t.items,l=this.employee();l?.currentShiftId&&(e=e.filter(p=>p.id!==l.currentShiftId)),this.availableShifts.set(e)},error:t=>{console.error("Failed to load shifts:",t),this.notificationService.error(this.i18n.t("shifts.errors.load_failed"))}})}futureDateValidator(){return t=>{if(!t.value)return null;let e=new Date;e.setHours(0,0,0,0);let l=new Date(t.value);return l.setHours(0,0,0,0),l>e?null:{futureDate:!0}}}onSubmit(){if(this.changeShiftForm.invalid||!this.employee()){this.changeShiftForm.markAllAsTouched();return}this.saving.set(!0),this.error.set(null);let t=this.changeShiftForm.value,l={employeeId:this.employee().id,shiftId:+t.shiftId,effectiveDate:t.effectiveDate,notes:t.notes||void 0};this.employeesService.changeEmployeeShift(l).subscribe({next:()=>{this.notificationService.success(this.i18n.t("employees.success.shift_changed")),this.router.navigate(["/employees"])},error:p=>{console.error("Failed to change employee shift:",p),this.error.set(this.i18n.t("employees.errors.shift_change_failed")),this.saving.set(!1)}})}onReset(){let t=new Date;t.setDate(t.getDate()+1),this.changeShiftForm.reset({shiftId:"",effectiveDate:t.toISOString().split("T")[0],notes:""}),this.error.set(null)}onCancel(){this.router.navigate(["/employees"])}getEmployeeInitials(){let t=this.employee();if(!t)return"";let e=t.firstName?t.firstName.charAt(0).toUpperCase():"",l=t.lastName?t.lastName.charAt(0).toUpperCase():"";return e+l}getCurrentShiftDisplay(){let t=this.employee();return t?.currentShiftName?t.currentShift?.startTime&&t.currentShift?.endTime?`${t.currentShift.startTime} - ${t.currentShift.endTime}`:t.currentShiftName:this.i18n.t("employees.no_current_shift")}getShiftTimeDisplay(t){if(t.shiftPeriods&&t.shiftPeriods.length>0){let e=t.shiftPeriods[0],l=t.shiftPeriods[t.shiftPeriods.length-1];return`${e.startTime} - ${l.endTime}`}return this.i18n.t("shifts.time_not_specified")}isFieldInvalid(t){let e=this.changeShiftForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}hasError(t){return this.isFieldInvalid(t)}getErrorMessage(t){let e=this.changeShiftForm.get(t);return!e||!e.errors?"":e.errors.required?this.i18n.t("validation.required"):e.errors.futureDate?this.i18n.t("employees.validation.future_date_required"):""}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=b({type:o,selectors:[["app-change-employee-shift"]],decls:5,vars:4,consts:[[1,"app-form-page"],[3,"title"],[1,"text-center","py-5"],[1,"alert","alert-danger"],[3,"formGroup"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"fas","fa-exclamation-triangle","me-2"],[3,"ngSubmit","formGroup"],[1,"app-desktop-sidebar"],[1,"app-main-content"],[1,"alert","alert-info"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-initial","bg-primary","text-white","rounded-circle"],[1,"mb-1"],[1,"text-muted"],[1,"alert","alert-danger","mb-3"],[1,"row"],[1,"col-md-6","mb-3"],["for","shiftId",1,"form-label"],[1,"text-danger"],["id","shiftId","formControlName","shiftId",1,"form-select"],["value",""],[3,"value"],[1,"invalid-feedback"],["for","effectiveDate",1,"form-label"],["type","date","id","effectiveDate","formControlName","effectiveDate",1,"form-control"],[1,"form-text"],[1,"col-12","mb-3"],["for","notes",1,"form-label"],["id","notes","formControlName","notes","rows","4",1,"form-control",3,"placeholder"],[1,"app-sidebar-content"],[1,"card","mb-3"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fas","fa-cogs","me-2"],[1,"card-body"],[1,"d-grid","gap-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-undo","me-2"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-times","me-2"],[1,"card"],[1,"fas","fa-info-circle","me-2"],[1,"card-text","small","text-muted","mb-2"],[1,"list-unstyled","small","text-muted","mb-0"],[1,"fas","fa-check-circle","text-success","me-1"],[1,"fas","fa-calendar","text-info","me-1"],[1,"fas","fa-sticky-note","text-warning","me-1"],[1,"card","bg-light"],[1,"card-body","py-3"],[1,"d-flex","justify-content-between","align-items-center"],[1,"small","text-muted","mt-1"],[1,"badge","bg-primary"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-clock","me-2"]],template:function(e,l){e&1&&(n(0,"div",0),m(1,"app-page-header",1),f(2,X,6,2,"div",2),f(3,Y,3,1,"div",3),f(4,re,78,34,"form",4),a()),e&2&&(i(),c("title",l.i18n.t("employees.change_shift")),i(),h(l.loading()?2:-1),i(),h(l.error()&&!l.loading()?3:-1),i(),h(!l.loading()&&l.employee()?4:-1))},dependencies:[M,R,k,$,q,F,G,T,O,j,V,A,U,J],styles:[".avatar-sm[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}.avatar-initial[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:1rem;font-weight:600}.alert-info[_ngcontent-%COMP%]{border-left:4px solid var(--bs-info)}.card.bg-light[_ngcontent-%COMP%]{border:1px solid #e9ecef}.card.bg-light[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{background-color:#f8f9fa}.form-control[_ngcontent-%COMP%]:invalid{border-color:var(--bs-danger)}.form-control[_ngcontent-%COMP%]:valid{border-color:var(--bs-success)}.form-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d}.btn-primary[_ngcontent-%COMP%]{min-width:120px}@media (max-width: 768px){.avatar-sm[_ngcontent-%COMP%]{width:2rem;height:2rem}.avatar-initial[_ngcontent-%COMP%]{font-size:.875rem}.alert-info[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-size:1rem}.alert-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:.8rem}}"]})};export{Q as ChangeEmployeeShiftComponent};
