import{a as _e}from"./chunk-5TOXFC3K.js";import"./chunk-5KJOOWHZ.js";import{a as k}from"./chunk-NTMNSCJN.js";import{a as ue}from"./chunk-HYS7KV3K.js";import"./chunk-LNNUMUW4.js";import{a as ye}from"./chunk-GNG6SBUX.js";import{a as fe}from"./chunk-4G2EQDXN.js";import{a as N}from"./chunk-Y4G43P3P.js";import{a as S,b as v}from"./chunk-AYMGSBNU.js";import{a as ge}from"./chunk-4DSP56PF.js";import"./chunk-3BUDJKKE.js";import{c as te,d as ie,e as ne,f as oe,i as ae,m as le,n as re,o as se,p as me,r as pe,w as ce,x as de,y as he}from"./chunk-OTKBQKTN.js";import{b as T}from"./chunk-NJ656CWW.js";import{$ as r,$a as Z,A as Y,E as o,J as M,N as b,O as y,Oa as J,Ya as K,Za as O,_ as p,_a as X,aa as l,ba as E,eb as x,fa as G,ga as j,ia as D,ka as _,ma as f,oa as U,pa as H,pb as ee,qa as Q,ra as W,sa as P,t as u,u as d,ua as q,v as h,va as m,wa as w,xa as C,ya as I,z as g}from"./chunk-6T5SYK5O.js";import{a as F,b as z,d as R}from"./chunk-DGAILPFQ.js";var V=class n{employeesService=u(k);i18n=u(T);showAddButton=!0;addButtonText="Add Employee";searchChange=new y;filtersChange=new y;addEmployee=new y;branches=g([]);departments=g([]);filterFields=g([]);ngOnInit(){this.loadBranches(),this.setupFilterFields()}loadBranches(){this.employeesService.getBranches().subscribe({next:e=>{this.branches.set(e.items),this.updateFilterFields()},error:e=>{console.error("Failed to load branches:",e)}})}setupFilterFields(){this.updateFilterFields()}updateFilterFields(){let e=[{value:"",label:this.i18n.t("common.all")},...this.branches().map(c=>({value:c.id.toString(),label:c.name}))],t=[{value:"",label:this.i18n.t("common.all")},...this.departments().map(c=>({value:c.id.toString(),label:c.name}))],i=[{value:"",label:this.i18n.t("common.all")},{value:2 .toString(),label:"Full Time"},{value:3 .toString(),label:"Part Time"},{value:4 .toString(),label:"Contract"},{value:5 .toString(),label:"Intern"},{value:6 .toString(),label:"Consultant"},{value:7 .toString(),label:"Terminated"}],s=[{value:"",label:this.i18n.t("common.all")},{value:"true",label:this.i18n.t("common.active")},{value:"false",label:this.i18n.t("common.inactive")}];this.filterFields.set([{key:"branchId",label:"Branch",type:"select",options:e},{key:"departmentId",label:"Department",type:"select",options:t},{key:"employmentStatus",label:"Employment Status",type:"select",options:i},{key:"isActive",label:"Status",type:"select",options:s}])}onSearch(e){this.searchChange.emit(e)}onFilterChange(e){if(e.branchId){let t=parseInt(e.branchId);this.employeesService.getDepartments(t).subscribe({next:i=>{this.departments.set(i),this.updateFilterFields()},error:i=>{console.error("Failed to load departments:",i)}})}else this.departments.set([]),this.updateFilterFields();this.filtersChange.emit(e)}onAdd(){this.addEmployee.emit()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-employee-filters"]],inputs:{showAddButton:"showAddButton",addButtonText:"addButtonText"},outputs:{searchChange:"searchChange",filtersChange:"filtersChange",addEmployee:"addEmployee"},decls:1,vars:4,consts:[[3,"search","filterChange","add","filterFields","showAddButton","addButtonText","searchPlaceholder"]],template:function(t,i){t&1&&(r(0,"app-search-filter",0),_("search",function(c){return i.onSearch(c)})("filterChange",function(c){return i.onFilterChange(c)})("add",function(){return i.onAdd()}),l()),t&2&&p("filterFields",i.filterFields())("showAddButton",i.showAddButton)("addButtonText",i.addButtonText)("searchPlaceholder","Search employees...")},dependencies:[x,ue],encapsulation:2})};function ve(n,e){if(n&1&&(r(0,"div",9)(1,"div",10)(2,"div",11),m(3),l()(),r(4,"div")(5,"div",12),m(6),l(),r(7,"small",13),m(8),l()()()),n&2){let t=f().$implicit,i=f();o(3),C(" ",i.getInitials(t.firstName,t.lastName)," "),o(3),I("",t.firstName," ",t.lastName),o(2),w(t.email)}}function Ee(n,e){if(n&1&&(r(0,"span",12),m(1),l()),n&2){let t=f().$implicit;o(),C(" ",t.employeeNumber," ")}}function we(n,e){if(n&1&&(r(0,"div")(1,"div"),m(2),l(),r(3,"small",13),m(4),l()()),n&2){let t=f().$implicit;o(2),w(t.departmentName),o(2),w(t.branchName)}}function Me(n,e){if(n&1&&(r(0,"span",14),m(1),l()),n&2){let t=f().$implicit,i=f();q(i.getEmploymentStatusClass(t.employmentStatus)),o(),C(" ",i.getEmploymentStatusLabel(t.employmentStatus)," ")}}function xe(n,e){if(n&1&&(r(0,"span"),m(1),l()),n&2){let t=f().$implicit,i=f();o(),C(" ",i.getGenderLabel(t.gender)," ")}}function Te(n,e){if(n&1&&(r(0,"span",15),m(1),l()),n&2){let t=f().$implicit,i=f();o(),C(" ",i.getWorkLocationLabel(t.workLocationType)," ")}}function De(n,e){if(n&1&&(r(0,"span",14),E(1,"i",16),m(2),l()),n&2){let t=f().$implicit;P("bg-success",t.isActive)("bg-danger",!t.isActive),o(),P("fa-check-circle",t.isActive)("fa-times-circle",!t.isActive),o(),C(" ",t.isActive?"Active":"Inactive"," ")}}function Pe(n,e){if(n&1&&(r(0,"span"),m(1),l()),n&2){let t=f().$implicit,i=f();o(),C(" ",i.formatDate(t.hireDate)," ")}}function Ie(n,e){if(n&1&&(r(0,"div"),m(1),l()),n&2){let t=f(2).$implicit;o(),w(t.currentShiftName)}}function Fe(n,e){n&1&&(r(0,"span",13),m(1,"No shift assigned"),l())}function Oe(n,e){if(n&1&&(r(0,"div"),b(1,Ie,2,1,"div",17)(2,Fe,2,0,"span",18),l()),n&2){let t=f().$implicit;o(),p("ngIf",t.currentShiftName),o(),p("ngIf",!t.currentShiftName)}}function Ne(n,e){if(n&1&&(G(0,2),b(1,ve,9,4,"div",3)(2,Ee,2,1,"span",4)(3,we,5,2,"div",5)(4,Me,2,3,"span",6)(5,xe,2,1,"span",5)(6,Te,2,1,"span",7)(7,De,3,9,"span",8)(8,Pe,2,1,"span",5)(9,Oe,3,2,"div",5),j()),n&2){let t=e.column;p("ngSwitch",t.key),o(),p("ngSwitchCase","name"),o(),p("ngSwitchCase","employeeCode"),o(),p("ngSwitchCase","department"),o(),p("ngSwitchCase","employmentStatus"),o(),p("ngSwitchCase","gender"),o(),p("ngSwitchCase","workLocation"),o(),p("ngSwitchCase","status"),o(),p("ngSwitchCase","hireDate"),o(),p("ngSwitchCase","shift")}}var A=class n{i18n=u(T);permissionService=u(N);employees=[];loading=g(!1);currentPage=g(1);totalPages=g(1);totalItems=g(0);pageSize=g(10);viewEmployee=new y;editEmployee=new y;deleteEmployee=new y;changeShift=new y;pageChange=new y;pageSizeChange=new y;selectionChange=new y;sortChange=new y;columns=[{key:"name",label:"Employee",width:"250px",sortable:!0,priority:"high",mobileLabel:"Employee"},{key:"employeeCode",label:"Code",width:"100px",sortable:!0,priority:"high",mobileLabel:"Code"},{key:"department",label:"Department",width:"200px",sortable:!0,priority:"medium",hideOnMobile:!1,mobileLabel:"Dept"},{key:"employmentStatus",label:"Employment",width:"120px",align:"center",sortable:!0,priority:"low",hideOnMobile:!0,mobileLabel:"Status"},{key:"workLocation",label:"Location",width:"100px",align:"center",priority:"low",hideOnMobile:!0,mobileLabel:"Location"},{key:"shift",label:"Current Shift",width:"150px",priority:"medium",hideOnMobile:!1,mobileLabel:"Shift"},{key:"hireDate",label:"Hire Date",width:"120px",sortable:!0,priority:"low",hideOnMobile:!0,mobileLabel:"Hired"},{key:"status",label:"Status",width:"100px",align:"center",sortable:!0,priority:"high",mobileLabel:"Status"}];get actions(){let e=[];return this.permissionService.has(`${v.EMPLOYEE}.${S.READ}`)&&e.push({key:"view",label:"View",icon:"fa-eye",color:"info"}),this.permissionService.has(`${v.EMPLOYEE}.${S.UPDATE}`)&&(e.push({key:"edit",label:"Edit",icon:"fa-edit",color:"primary"}),e.push({key:"changeShift",label:"Change Shift",icon:"fa-clock",color:"warning"})),this.permissionService.has(`${v.EMPLOYEE}.${S.DELETE}`)&&e.push({key:"delete",label:"Delete",icon:"fa-trash",color:"danger"}),e}onActionClick(e){let{action:t,item:i}=e;switch(t){case"view":this.viewEmployee.emit(i);break;case"edit":this.editEmployee.emit(i);break;case"delete":this.deleteEmployee.emit(i);break;case"changeShift":this.changeShift.emit(i);break}}onPageChange(e){this.pageChange.emit(e)}onPageSizeChange(e){this.pageSizeChange.emit(e)}onSelectionChange(e){this.selectionChange.emit(e)}onSortChange(e){this.sortChange.emit(e)}getInitials(e,t){let i=e?e.charAt(0).toUpperCase():"",s=t?t.charAt(0).toUpperCase():"";return i+s}getEmploymentStatusLabel(e){return{1:"Active",2:"Full Time",3:"Part Time",4:"Contract",5:"Intern",6:"Consultant",7:"Terminated",8:"Inactive"}[e]||"Unknown"}getEmploymentStatusClass(e){return{1:"bg-success",2:"bg-success",3:"bg-info",4:"bg-warning",5:"bg-primary",6:"bg-light text-dark border",7:"bg-danger",8:"bg-light text-dark border"}[e]||"bg-light text-dark border"}getGenderLabel(e){return e===1?"Male":"Female"}getWorkLocationLabel(e){return{1:"On-site",2:"Remote",3:"Hybrid"}[e]||"Unknown"}formatDate(e){return new Date(e).toLocaleDateString()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-employee-table"]],inputs:{employees:"employees",loading:"loading",currentPage:"currentPage",totalPages:"totalPages",totalItems:"totalItems",pageSize:"pageSize"},outputs:{viewEmployee:"viewEmployee",editEmployee:"editEmployee",deleteEmployee:"deleteEmployee",changeShift:"changeShift",pageChange:"pageChange",pageSizeChange:"pageSizeChange",selectionChange:"selectionChange",sortChange:"sortChange"},decls:3,vars:9,consts:[["cellTemplate",""],[3,"actionClick","pageChange","pageSizeChange","selectionChange","sortChange","data","columns","actions","loading","currentPage","totalPages","totalItems","pageSize","emptyMessage"],[3,"ngSwitch"],["class","d-flex align-items-center",4,"ngSwitchCase"],["class","fw-medium",4,"ngSwitchCase"],[4,"ngSwitchCase"],["class","badge",3,"class",4,"ngSwitchCase"],["class","badge bg-info",4,"ngSwitchCase"],["class","badge",3,"bg-success","bg-danger",4,"ngSwitchCase"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-2"],[1,"avatar-initial","bg-primary","text-white","rounded-circle"],[1,"fw-medium"],[1,"text-muted"],[1,"badge"],[1,"badge","bg-info"],[1,"fas"],[4,"ngIf"],["class","text-muted",4,"ngIf"]],template:function(t,i){if(t&1){let s=D();r(0,"app-data-table",1),_("actionClick",function(a){return d(s),h(i.onActionClick(a))})("pageChange",function(a){return d(s),h(i.onPageChange(a))})("pageSizeChange",function(a){return d(s),h(i.onPageSizeChange(a))})("selectionChange",function(a){return d(s),h(i.onSelectionChange(a))})("sortChange",function(a){return d(s),h(i.onSortChange(a))}),b(1,Ne,10,10,"ng-template",null,0,J),l()}t&2&&p("data",i.employees)("columns",i.columns)("actions",i.actions)("loading",i.loading)("currentPage",i.currentPage)("totalPages",i.totalPages)("totalItems",i.totalItems)("pageSize",i.pageSize)("emptyMessage","No employees found")},dependencies:[x,O,X,Z,ye],styles:[".avatar-sm[_ngcontent-%COMP%]{width:2rem;height:2rem}.avatar-initial[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:.875rem;font-weight:600}"]})};function ke(n,e){if(n&1&&(r(0,"div",24)(1,"label",35),m(2,"Current Shift"),l(),r(3,"div",36)(4,"div",37)(5,"div",38)(6,"div")(7,"strong"),m(8),l(),r(9,"div",39),m(10),l()(),r(11,"span",40),m(12,"Current"),l()()()()()),n&2){let t=f(2);o(8),w(t.employee.currentShiftName),o(2),C(" ",t.getCurrentShiftDisplay()," ")}}function Ve(n,e){if(n&1&&(r(0,"div",41),E(1,"i",42),m(2),l()),n&2){let t=f(2);o(2),C(" ",t.errorMessage()," ")}}function Ae(n,e){if(n&1&&(r(0,"option",43),m(1),l()),n&2){let t=e.$implicit,i=f(2);p("value",t.id),o(),I(" ",t.name," (",i.getShiftTimeDisplay(t),") ")}}function Le(n,e){n&1&&(r(0,"div",44),m(1," Please select a shift. "),l())}function ze(n,e){n&1&&(r(0,"div",44),m(1," Effective date must be greater than today's date. "),l())}function $e(n,e){if(n&1){let t=D();r(0,"div")(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18),m(5),l()(),r(6,"div")(7,"h6",19),m(8),l(),r(9,"small",20),m(10),l()()()(),b(11,ke,13,2,"div",21)(12,Ve,3,1,"div",22),r(13,"form",23),_("ngSubmit",function(){d(t);let s=f();return h(s.onSubmit())}),r(14,"div",24)(15,"label",25),m(16,"New Shift *"),l(),r(17,"select",26)(18,"option",27),m(19,"Select a shift..."),l(),b(20,Ae,2,3,"option",28),l(),b(21,Le,2,0,"div",29),l(),r(22,"div",24)(23,"label",30),m(24,"Effective Date *"),l(),E(25,"input",31),b(26,ze,2,0,"div",29),r(27,"div",32),m(28,"Shift assignments must be planned in advance."),l()(),r(29,"div",24)(30,"label",33),m(31,"Notes"),l(),E(32,"textarea",34),l()()()}if(n&2){let t,i,s,c,a=f();o(5),C(" ",a.getInitials(a.employee.firstName,a.employee.lastName)," "),o(3),I("",a.employee.firstName," ",a.employee.lastName),o(2),I("",a.employee.departmentName," - ",a.employee.branchName),o(),p("ngIf",a.employee.currentShiftId),o(),p("ngIf",a.errorMessage()),o(),p("formGroup",a.changeShiftForm),o(4),P("is-invalid",((t=a.changeShiftForm.get("shiftId"))==null?null:t.invalid)&&((t=a.changeShiftForm.get("shiftId"))==null?null:t.touched)),o(3),p("ngForOf",a.availableShifts()),o(),p("ngIf",((i=a.changeShiftForm.get("shiftId"))==null?null:i.invalid)&&((i=a.changeShiftForm.get("shiftId"))==null?null:i.touched)),o(4),P("is-invalid",((s=a.changeShiftForm.get("effectiveDate"))==null?null:s.invalid)&&((s=a.changeShiftForm.get("effectiveDate"))==null?null:s.touched)),o(),p("ngIf",((c=a.changeShiftForm.get("effectiveDate"))==null||c.errors==null?null:c.errors.futureDate)&&((c=a.changeShiftForm.get("effectiveDate"))==null?null:c.touched))}}function Be(n,e){n&1&&E(0,"span",45)}function Re(n,e){n&1&&E(0,"i",46)}function Ye(n,e){if(n&1){let t=D();r(0,"div",47),_("click",function(){d(t);let s=f();return h(s.onClose())}),l()}}var L=class n{fb=u(ce);shiftsService=u(_e);i18n=u(T);show=!1;employee=null;close=new y;shiftChanged=new y;availableShifts=g([]);submitting=g(!1);errorMessage=g(null);changeShiftForm;constructor(){let e=new Date;e.setDate(e.getDate()+1),this.changeShiftForm=this.fb.group({shiftId:["",ie.required],effectiveDate:[e.toISOString().split("T")[0],this.futureDateValidator()],notes:[""]})}ngOnInit(){this.show&&this.loadShifts()}ngOnChanges(){this.show&&this.employee&&(this.loadShifts(),this.resetForm())}loadShifts(){this.shiftsService.getActiveShifts().subscribe({next:e=>{let t=e.items;this.employee?.currentShiftId&&(t=t.filter(i=>i.id!==this.employee.currentShiftId)),this.availableShifts.set(t)},error:e=>{console.error("Failed to load shifts:",e)}})}futureDateValidator(){return e=>{if(!e.value)return null;let t=new Date;t.setHours(0,0,0,0);let i=new Date(e.value);return i.setHours(0,0,0,0),i>t?null:{futureDate:!0}}}resetForm(){let e=new Date;e.setDate(e.getDate()+1),this.changeShiftForm.reset({shiftId:"",effectiveDate:e.toISOString().split("T")[0],notes:""}),this.clearError()}onSubmit(){if(this.changeShiftForm.invalid||!this.employee)return;this.clearError(),this.submitting.set(!0);let e=this.changeShiftForm.value,t={shiftId:+e.shiftId,effectiveDate:e.effectiveDate||void 0,notes:e.notes||void 0};this.shiftChanged.emit({employee:this.employee,shiftData:t})}onClose(){this.close.emit()}getInitials(e,t){let i=e?e.charAt(0).toUpperCase():"",s=t?t.charAt(0).toUpperCase():"";return i+s}resetSubmitting(){this.submitting.set(!1)}showError(e){this.errorMessage.set(e),this.submitting.set(!1)}clearError(){this.errorMessage.set(null)}getCurrentShiftDisplay(){return this.employee?.currentShiftName?this.employee.currentShift?.startTime&&this.employee.currentShift?.endTime?`${this.employee.currentShift.startTime} - ${this.employee.currentShift.endTime}`:this.employee.currentShiftName:"No current shift assigned"}getShiftTimeDisplay(e){if(e.shiftPeriods&&e.shiftPeriods.length>0){let t=e.shiftPeriods[0],i=e.shiftPeriods[e.shiftPeriods.length-1];return`${t.startTime} - ${i.endTime}`}return"Time not specified"}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-change-shift-modal"]],inputs:{show:"show",employee:"employee"},outputs:{close:"close",shiftChanged:"shiftChanged"},features:[Y],decls:18,vars:11,consts:[["tabindex","-1","role","dialog",1,"modal","fade","show"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-clock","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],["class","fas fa-save me-2",4,"ngIf"],["class","modal-backdrop fade show",3,"click",4,"ngIf"],[1,"alert","alert-info"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-initial","bg-primary","text-white","rounded-circle"],[1,"mb-1"],[1,"text-muted"],["class","mb-3",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","shiftId",1,"form-label"],["id","shiftId","formControlName","shiftId",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["for","effectiveDate",1,"form-label"],["type","date","id","effectiveDate","formControlName","effectiveDate",1,"form-control"],[1,"form-text"],["for","notes",1,"form-label"],["id","notes","rows","3","formControlName","notes","placeholder","Optional notes about this shift change...",1,"form-control"],[1,"form-label"],[1,"card","bg-light"],[1,"card-body","py-2"],[1,"d-flex","justify-content-between","align-items-center"],[1,"small","text-muted"],[1,"badge","bg-primary"],[1,"alert","alert-danger"],[1,"fas","fa-exclamation-triangle","me-2"],[3,"value"],[1,"invalid-feedback"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"],[1,"modal-backdrop","fade","show",3,"click"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h5",4),E(5,"i",5),m(6," Change Employee Shift "),l(),r(7,"button",6),_("click",function(){return i.onClose()}),l()(),r(8,"div",7),b(9,$e,33,15,"div",8),l(),r(10,"div",9)(11,"button",10),_("click",function(){return i.onClose()}),m(12," Cancel "),l(),r(13,"button",11),_("click",function(){return i.onSubmit()}),b(14,Be,1,0,"span",12)(15,Re,1,0,"i",13),m(16),l()()()()(),b(17,Ye,1,0,"div",14)),t&2&&(W("display",i.show?"block":"none"),P("d-block",i.show),o(9),p("ngIf",i.employee),o(2),p("disabled",i.submitting()),o(2),p("disabled",i.changeShiftForm.invalid||i.submitting()),o(),p("ngIf",i.submitting()),o(),p("ngIf",!i.submitting()),o(),C(" ",i.submitting()?"Changing...":"Change Shift"," "),o(),p("ngIf",i.show))},dependencies:[x,K,O,de,ae,me,pe,te,se,ne,oe,he,le,re],styles:[".modal[_ngcontent-%COMP%]{z-index:1055}.modal-backdrop[_ngcontent-%COMP%]{z-index:1050}.avatar-sm[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem}.avatar-initial[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;font-size:1rem;font-weight:600}"]})};var Ge=["changeShiftModal"],Ce=class n{i18n=u(T);permissionService=u(N);employeesService=u(k);notificationService=u(ge);confirmationService=u(fe);router=u(ee);changeShiftModal;employees=g([]);loading=g(!1);totalCount=g(0);currentPage=g(1);pageSize=g(10);totalPages=g(0);showChangeShiftModal=g(!1);selectedEmployee=g(null);currentFilter={};PERMISSIONS={EMPLOYEE_CREATE:`${v.EMPLOYEE}.${S.CREATE}`,EMPLOYEE_READ:`${v.EMPLOYEE}.${S.READ}`,EMPLOYEE_UPDATE:`${v.EMPLOYEE}.${S.UPDATE}`,EMPLOYEE_DELETE:`${v.EMPLOYEE}.${S.DELETE}`,EMPLOYEE_MANAGE:`${v.EMPLOYEE}.${S.MANAGE}`};ngOnInit(){this.loadEmployees()}loadEmployees(){this.loading.set(!0);let e=F({page:this.currentPage(),pageSize:this.pageSize()},this.currentFilter);this.employeesService.getEmployees(e).subscribe({next:t=>{this.employees.set(t.items),this.totalCount.set(t.totalCount),this.totalPages.set(t.totalPages),this.loading.set(!1)},error:t=>{console.error("Failed to load employees:",t),this.loading.set(!1)}})}onSearchChange(e){this.currentFilter=z(F({},this.currentFilter),{search:e}),this.currentPage.set(1),this.loadEmployees()}onFiltersChange(e){this.currentFilter=F({},e),this.currentPage.set(1),this.loadEmployees()}onAddEmployee(){this.router.navigate(["/employees/create"])}onViewEmployee(e){this.router.navigate(["/employees",e.id,"view"])}onEditEmployee(e){this.router.navigate(["/employees",e.id,"edit"])}onDeleteEmployee(e){return R(this,null,function*(){(yield this.confirmationService.confirm({title:this.i18n.t("employees.delete_employee"),message:`Are you sure you want to delete "${e.firstName} ${e.lastName}"? This action cannot be undone.`,confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.employeesService.deleteEmployee(e.id).subscribe({next:()=>{this.loadEmployees(),this.notificationService.success(this.i18n.t("app.success"),this.i18n.t("employees.employee_deleted"))},error:i=>{console.error("Failed to delete employee:",i),this.notificationService.error(this.i18n.t("app.error"),this.i18n.t("errors.server"))}})})}onChangeShift(e){this.selectedEmployee.set(e),this.showChangeShiftModal.set(!0)}onPageChange(e){this.currentPage.set(e),this.loadEmployees()}onPageSizeChange(e){this.pageSize.set(e),this.currentPage.set(1),this.loadEmployees()}onSelectionChange(e){console.log("Selected employees:",e)}onSortChange(e){this.currentFilter=z(F({},this.currentFilter),{sortBy:e.column,sortDirection:e.direction}),this.currentPage.set(1),this.loadEmployees()}onShiftChanged(e){this.employeesService.updateEmployeeShift(e.employee.id,e.shiftData).subscribe({next:()=>{this.changeShiftModal.resetSubmitting(),this.showChangeShiftModal.set(!1),this.selectedEmployee.set(null),this.loadEmployees(),this.notificationService.success(this.i18n.t("app.success"),"Employee shift updated successfully")},error:t=>{console.error("Failed to update employee shift:",t);let i="Failed to update employee shift";t?.error?.message?i=t.error.message:typeof t?.error=="string"&&(i=t.error),this.changeShiftModal.showError(i),this.notificationService.error(this.i18n.t("app.error"),i)}})}onCloseChangeShiftModal(){this.showChangeShiftModal.set(!1),this.selectedEmployee.set(null)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-employees"]],viewQuery:function(t,i){if(t&1&&U(Ge,5),t&2){let s;H(s=Q())&&(i.changeShiftModal=s.first)}},decls:8,vars:11,consts:[["changeShiftModal",""],[1,"employees-page"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[3,"searchChange","filtersChange","addEmployee","showAddButton","addButtonText"],[3,"viewEmployee","editEmployee","deleteEmployee","changeShift","pageChange","pageSizeChange","selectionChange","sortChange","employees","loading","currentPage","totalPages","totalItems","pageSize"],[3,"close","shiftChanged","show","employee"]],template:function(t,i){if(t&1){let s=D();r(0,"div",1)(1,"div",2)(2,"h2"),m(3),l()(),r(4,"app-employee-filters",3),_("searchChange",function(a){return d(s),h(i.onSearchChange(a))})("filtersChange",function(a){return d(s),h(i.onFiltersChange(a))})("addEmployee",function(){return d(s),h(i.onAddEmployee())}),l(),r(5,"app-employee-table",4),_("viewEmployee",function(a){return d(s),h(i.onViewEmployee(a))})("editEmployee",function(a){return d(s),h(i.onEditEmployee(a))})("deleteEmployee",function(a){return d(s),h(i.onDeleteEmployee(a))})("changeShift",function(a){return d(s),h(i.onChangeShift(a))})("pageChange",function(a){return d(s),h(i.onPageChange(a))})("pageSizeChange",function(a){return d(s),h(i.onPageSizeChange(a))})("selectionChange",function(a){return d(s),h(i.onSelectionChange(a))})("sortChange",function(a){return d(s),h(i.onSortChange(a))}),l(),r(6,"app-change-shift-modal",5,0),_("close",function(){return d(s),h(i.onCloseChangeShiftModal())})("shiftChanged",function(a){return d(s),h(i.onShiftChanged(a))}),l()()}t&2&&(o(3),w(i.i18n.t("employees.title")),o(),p("showAddButton",i.permissionService.has(i.PERMISSIONS.EMPLOYEE_CREATE))("addButtonText",i.i18n.t("employees.add_employee")),o(),p("employees",i.employees())("loading",i.loading)("currentPage",i.currentPage)("totalPages",i.totalPages)("totalItems",i.totalCount)("pageSize",i.pageSize),o(),p("show",i.showChangeShiftModal())("employee",i.selectedEmployee()))},dependencies:[x,V,A,L],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:none;font-weight:600;color:#495057}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}.modal[_ngcontent-%COMP%]{background-color:#00000080}.employee-avatar[_ngcontent-%COMP%]{width:40px;height:40px;object-fit:cover}.badge[_ngcontent-%COMP%]{font-size:.75em}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #dee2e6}.pagination[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:0}.search-filters[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .search-filters[_ngcontent-%COMP%]   .form-select[_ngcontent-%COMP%]{border-radius:.375rem}.employee-status.active[_ngcontent-%COMP%]{color:#198754}.employee-status.inactive[_ngcontent-%COMP%]{color:#6c757d}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{font-size:.875rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.125rem .25rem}.modal-lg[_ngcontent-%COMP%]{max-width:95%}}"]})};export{Ce as EmployeesComponent};
