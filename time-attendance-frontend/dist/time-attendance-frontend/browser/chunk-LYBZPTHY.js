import{c as $}from"./chunk-W2XC6RE5.js";import{a as Y}from"./chunk-HPD5AHCS.js";import{a as W}from"./chunk-7NQIBQVK.js";import{a as B}from"./chunk-K7WTKFJQ.js";import{a as F}from"./chunk-MRHL7QNZ.js";import{a as k}from"./chunk-H5EPUHY6.js";import{a as E}from"./chunk-N7S3JMGU.js";import{a as v}from"./chunk-Y62N6K5S.js";import{a as A}from"./chunk-EYAJMHM7.js";import{a as N}from"./chunk-HHXRLUSQ.js";import"./chunk-UWVH5K3J.js";import{b as V}from"./chunk-RUY4WPQA.js";import{d as D,g as H,h as O,m as T}from"./chunk-TWXUAMJ4.js";import{Bb as c,Cb as g,Db as y,Ea as I,Pb as w,R as f,W as C,X as x,Xa as m,Ya as p,Yb as b,bb as s,cb as o,da as h,db as r,eb as d,lb as P,nb as S,pb as u,ta as i,wc as M}from"./chunk-JSQL33QG.js";import{d as _}from"./chunk-DGAILPFQ.js";var z=()=>["/settings/public-holidays"];function j(a,e){if(a&1&&(o(0,"div",2),d(1,"app-loading-spinner",5),r()),a&2){let t=u();i(),s("message",t.i18n.t("common.loading"))("variant","primary")("centered",!0)}}function R(a,e){if(a&1&&(o(0,"div",3),d(1,"i",6),c(2),r()),a&2){let t=u();i(2),y(" ",t.error()," ")}}function U(a,e){if(a&1&&(o(0,"app-section-card",11),d(1,"app-definition-list",9),r()),a&2){let t=u(2);s("title",t.i18n.t("settings.holidays.additionalSettings")),i(),s("items",t.additionalInfoItems())("labelWidth","4")("valueWidth","8")}}function q(a,e){a&1&&d(0,"span",30)}function G(a,e){a&1&&d(0,"i",31)}function J(a,e){if(a&1){let t=P();o(0,"button",29),S("click",function(){C(t);let n=u(3);return x(n.deleteHoliday())}),m(1,q,1,0,"span",30)(2,G,1,0,"i",31),c(3),r()}if(a&2){let t=u(3);s("disabled",t.processing()),i(),p(t.processing()?1:2),i(2),y(" ",t.i18n.t("common.delete")," ")}}function K(a,e){if(a&1&&(o(0,"app-section-card",14)(1,"div",27),m(2,J,4,3,"button",28),r()()),a&2){let t=u(2);s("title",t.i18n.t("common.actions")),i(2),p(t.canDelete()?2:-1)}}function Q(a,e){if(a&1&&(o(0,"div",15),d(1,"i",6),o(2,"strong"),c(3),r(),o(4,"p",32),c(5),r()()),a&2){let t=u(2);i(3),g(t.i18n.t("settings.holidays.conflicts_detected")),i(2),y(" ",t.i18n.t("settings.holidays.conflicts_description")," ")}}function X(a,e){if(a&1&&(o(0,"div",4)(1,"div",7)(2,"app-section-card",8),d(3,"app-definition-list",9),r(),o(4,"app-section-card",10),d(5,"app-definition-list",9),r(),m(6,U,2,4,"app-section-card",11),o(7,"app-section-card",12),d(8,"app-definition-list",9),r()(),o(9,"div",13),m(10,K,3,2,"app-section-card",14),m(11,Q,6,2,"div",15),o(12,"app-section-card",16)(13,"div",17)(14,"div",18)(15,"div",19),c(16),r(),o(17,"div",20),d(18,"app-status-badge",21),r()(),o(19,"div",18)(20,"div",19),c(21),r(),o(22,"div",20),d(23,"app-status-badge",21),r()(),o(24,"div",18)(25,"div",19),c(26),r(),o(27,"div",22),c(28),r()(),o(29,"div",18)(30,"div",19),c(31),r(),o(32,"div",20),c(33),r()()()(),o(34,"app-section-card",23)(35,"div",24)(36,"a",25),d(37,"i",26),c(38),r()()()()()),a&2){let t,l,n=u();i(2),s("title",n.i18n.t("settings.holidays.basicInformation")),i(),s("items",n.basicInfoItems())("labelWidth","4")("valueWidth","8"),i(),s("title",n.i18n.t("settings.holidays.dateConfiguration")),i(),s("items",n.dateInfoItems())("labelWidth","4")("valueWidth","8"),i(),p(n.additionalInfoItems().length>0?6:-1),i(),s("title",n.i18n.t("common.audit_information")),i(),s("items",n.auditItems())("labelWidth","3")("valueWidth","9"),i(2),p(n.hasActiveActions()?10:-1),i(),p((t=n.holiday())!=null&&t.hasConflicts?11:-1),i(),s("title",n.i18n.t("settings.holidays.summary")),i(4),g(n.i18n.t("fields.status")),i(2),s("status",n.statusBadge().label)("variant",n.statusBadge().variant),i(3),g(n.i18n.t("fields.scope")),i(2),s("status",n.scopeBadge().label)("variant",n.scopeBadge().variant),i(3),g(n.i18n.t("fields.priority")),i(2),g((l=n.holiday())==null?null:l.priority),i(3),g(n.i18n.t("fields.holidayType")),i(2),g(n.getHolidayTypeLabel(n.holiday().holidayType)),i(),s("title",n.i18n.t("common.navigation")),i(2),s("routerLink",w(29,z)),i(2),y(" ",n.i18n.t("settings.holidays.title")," ")}}var L=class a{i18n=f(V);router=f(H);route=f(D);publicHolidaysService=f($);notificationService=f(N);confirmationService=f(k);permissionService=f(E);loading=h(!1);processing=h(!1);holiday=h(null);error=h(null);basicInfoItems=b(()=>{let e=this.holiday();return e?[{label:this.i18n.t("fields.name"),value:e.name},{label:this.i18n.t("fields.nameAr"),value:e.nameAr||this.i18n.t("common.not_specified")},{label:this.i18n.t("fields.holidayType"),value:this.getHolidayTypeLabel(e.holidayType)},{label:this.i18n.t("fields.scope"),value:e.isNational?this.i18n.t("settings.holidays.national"):e.branchId?e.branchName||`Branch ${e.branchId}`:this.i18n.t("common.company_wide")}]:[]});dateInfoItems=b(()=>{let e=this.holiday();if(!e)return[];let t=[{label:this.i18n.t("settings.holidays.pattern_description"),value:e.patternDescription}];if(e.nextOccurrence&&t.push({label:this.i18n.t("settings.holidays.nextOccurrence"),value:this.formatDate(e.nextOccurrence)}),e.effectiveFromYear||e.effectiveToYear){let l="";e.effectiveFromYear&&e.effectiveToYear?l=`${e.effectiveFromYear} - ${e.effectiveToYear}`:e.effectiveFromYear?l=`${this.i18n.t("common.from")} ${e.effectiveFromYear}`:e.effectiveToYear&&(l=`${this.i18n.t("settings.holidays.until")} ${e.effectiveToYear}`),l&&t.push({label:this.i18n.t("settings.holidays.effective_period"),value:l})}return t.push({label:this.i18n.t("fields.priority"),value:e.priority.toString()}),e.hasConflicts&&t.push({label:this.i18n.t("settings.holidays.conflicts"),value:this.i18n.t("common.yes")}),t});additionalInfoItems=b(()=>{let e=this.holiday();if(!e)return[];let t=[];return e.description&&t.push({label:this.i18n.t("fields.description"),value:e.description}),e.countryCode&&t.push({label:this.i18n.t("fields.countryCode"),value:e.countryCode.toUpperCase()}),t});auditItems=b(()=>{let e=this.holiday();if(!e)return[];let t=[{label:this.i18n.t("fields.createdAt"),value:this.formatDateTime(e.createdAt)}];return e.updatedAt&&t.push({label:this.i18n.t("fields.updatedAt"),value:this.formatDateTime(e.updatedAt)}),t});statusBadge=b(()=>({label:this.holiday()?.isActive?this.i18n.t("common.active"):this.i18n.t("common.inactive"),variant:this.holiday()?.isActive?"success":"secondary"}));scopeBadge=b(()=>{let e=this.holiday();return e?{label:e.isNational?this.i18n.t("settings.holidays.national"):e.branchId?e.branchName||`Branch ${e.branchId}`:this.i18n.t("common.company_wide"),variant:e.isNational?"primary":"info"}:{label:"",variant:"secondary"}});ngOnInit(){this.loadHolidayDetails()}loadHolidayDetails(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.router.navigate(["/settings/public-holidays"]);return}this.loading.set(!0),this.error.set(null),this.publicHolidaysService.getPublicHolidayById(+e,!0).subscribe({next:t=>{this.holiday.set(t),this.loading.set(!1)},error:t=>{console.error("Failed to load holiday details:",t),this.error.set(this.i18n.t("common.errors.load_failed")),this.loading.set(!1)}})}deleteHoliday(){return _(this,null,function*(){if(!this.holiday())return;(yield this.confirmationService.confirm({title:this.i18n.t("settings.holidays.deleteHoliday"),message:this.i18n.t("settings.holidays.deleteHolidayConfirmation"),confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&(this.processing.set(!0),this.publicHolidaysService.deletePublicHoliday(this.holiday().id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("settings.holidays.holidayDeletedSuccessfully")),this.router.navigate(["/settings/public-holidays"])},error:t=>{console.error("Failed to delete holiday:",t),this.notificationService.error(this.i18n.t("common.errors.delete_failed")),this.processing.set(!1)}}))})}getHolidayTypeLabel(e){let l=this.publicHolidaysService.getHolidayTypes().find(n=>n.value===e);return l?l.label:e.toString()}formatDate(e){if(!e)return"";let t=typeof e=="string"?new Date(e):e;return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(t)}formatDateTime(e){if(!e)return"";let t=typeof e=="string"?new Date(e):e;return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}canEdit(){return this.permissionService.has(`public-holiday.${v.UPDATE}`)}canDelete(){return this.permissionService.has(`public-holiday.${v.DELETE}`)}hasActiveActions(){return this.canEdit()||this.canDelete()}getHolidayName(){return this.holiday()?.name||""}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=I({type:a,selectors:[["app-view-public-holiday"]],decls:5,vars:6,consts:[[1,"app-view-page"],["mode","view","moduleName","settings","moduleRoute","settings/public-holidays",3,"title","entityId","loading"],[1,"text-center","py-5"],["role","alert",1,"alert","alert-danger"],[1,"app-desktop-sidebar"],[3,"message","variant","centered"],[1,"fas","fa-exclamation-triangle","me-2"],[1,"app-main-content"],["icon","fas fa-info-circle","headerClass","bg-light",1,"mb-4",3,"title"],[3,"items","labelWidth","valueWidth"],["icon","fas fa-calendar-alt","headerClass","bg-light",1,"mb-4",3,"title"],["icon","fas fa-list-ul","headerClass","bg-light",1,"mb-4",3,"title"],["icon","fas fa-history","headerClass","bg-light",1,"mb-4",3,"title"],[1,"app-sidebar-content"],["icon","fas fa-cogs","headerClass","bg-light",1,"mb-3",3,"title"],["role","alert",1,"alert","alert-warning"],["icon","fas fa-calendar-check","headerClass","bg-light",1,"mb-3",3,"title"],[1,"config-summary"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],[3,"status","variant"],[1,"summary-value","rate-value"],["icon","fas fa-arrow-left","headerClass","bg-light","bodyClass","p-0",3,"title"],[1,"list-group","list-group-flush"],[1,"list-group-item","list-group-item-action",3,"routerLink"],[1,"fas","fa-list","me-2"],[1,"d-grid","gap-2"],["type","button",1,"btn","btn-outline-danger",3,"disabled"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-trash","me-2"],[1,"mb-0","mt-2","small"]],template:function(t,l){if(t&1&&(o(0,"div",0),d(1,"app-form-header",1),m(2,j,2,3,"div",2),m(3,R,3,1,"div",3),m(4,X,39,30,"div",4),r()),t&2){let n;i(),s("title",l.i18n.t("settings.holidays.view_details"))("entityId",(n=l.holiday())==null?null:n.id)("loading",l.loading()),i(),p(l.loading()?2:-1),i(),p(l.error()?3:-1),i(),p(l.holiday()&&!l.loading()?4:-1)}},dependencies:[M,T,O,A,Y,F,B,W],styles:[".config-summary[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.summary-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.5rem 0;border-bottom:1px solid var(--bs-border-color)}.summary-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.summary-label[_ngcontent-%COMP%]{font-weight:500;color:var(--bs-gray-700);font-size:.875rem}.summary-value[_ngcontent-%COMP%]{font-weight:600;color:var(--bs-gray-900)}.rate-value[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--bs-primary)}.holiday-pattern[_ngcontent-%COMP%]{background:linear-gradient(45deg,var(--bs-primary-bg-subtle) 0%,var(--bs-info-bg-subtle) 100%);border-radius:.5rem;padding:1rem;margin:1rem 0}.pattern-description[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:500;color:var(--bs-primary);margin-bottom:.5rem}.next-occurrence[_ngcontent-%COMP%]{font-size:.9rem;color:var(--bs-secondary)}.conflict-indicator[_ngcontent-%COMP%]{background-color:var(--bs-warning-bg-subtle);border-left:4px solid var(--bs-warning);padding:.75rem;border-radius:.25rem}.holiday-type-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background-color:var(--bs-primary-bg-subtle);border:1px solid var(--bs-primary-border-subtle);border-radius:.5rem;color:var(--bs-primary-text-emphasis);font-weight:500}.scope-indicator[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .5rem;background-color:var(--bs-info-bg-subtle);border-radius:.25rem;font-size:.875rem;color:var(--bs-info-text-emphasis)}.scope-indicator.national[_ngcontent-%COMP%]{background-color:var(--bs-primary-bg-subtle);color:var(--bs-primary-text-emphasis)}.scope-indicator.branch[_ngcontent-%COMP%]{background-color:var(--bs-secondary-bg-subtle);color:var(--bs-secondary-text-emphasis)}.status-info-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--bs-success-bg-subtle) 0%,var(--bs-info-bg-subtle) 100%);border:1px solid var(--bs-success-border-subtle)}.status-info-card.inactive[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--bs-secondary-bg-subtle) 0%,var(--bs-light) 100%);border:1px solid var(--bs-secondary-border-subtle)}.loading-container[_ngcontent-%COMP%]{min-height:200px;display:flex;align-items:center;justify-content:center;flex-direction:column}.priority-indicator[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:2rem;height:2rem;background-color:var(--bs-primary);color:#fff;border-radius:50%;font-weight:600;font-size:.875rem}@media (max-width: 768px){.app-desktop-sidebar[_ngcontent-%COMP%]{flex-direction:column}.app-sidebar-content[_ngcontent-%COMP%]{margin-top:1rem}.actions-card[_ngcontent-%COMP%]{position:static}.d-grid.gap-2[_ngcontent-%COMP%]{display:flex!important;flex-direction:column;gap:.5rem}.info-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;text-align:left}.info-label[_ngcontent-%COMP%]{min-width:auto;margin-bottom:.25rem}.info-value[_ngcontent-%COMP%]{text-align:left}.holiday-pattern[_ngcontent-%COMP%]{margin:.5rem 0;padding:.75rem}.pattern-description[_ngcontent-%COMP%]{font-size:1rem}.next-occurrence[_ngcontent-%COMP%]{font-size:.85rem}}"]})};export{L as ViewPublicHolidayComponent};
