import{a as Z}from"./chunk-VIZLP3UJ.js";import{a as X}from"./chunk-7YUBOVPA.js";import{a as U}from"./chunk-CARDG6TO.js";import{a as Y}from"./chunk-MVZGGAOK.js";import"./chunk-4335LQ3A.js";import"./chunk-LDWMK676.js";import{b as V,c as W,e as q,f as R,g as T,h as k,i as N,j as B,q as A,r as O,t as L,u as j,v as z,w as G,z as J}from"./chunk-HF7V7ZC6.js";import{a as K}from"./chunk-RUOWTK24.js";import"./chunk-HZR4WXEY.js";import{g as D,m as I}from"./chunk-O3U3HUCY.js";import{a as Q}from"./chunk-77FC2LKR.js";import"./chunk-A6EM5NV6.js";import{$a as g,Eb as a,Fb as s,Gb as f,Ha as S,Mb as x,Nb as y,Ob as _,T as E,Y as m,Z as u,_a as v,cb as w,db as F,eb as h,fa as C,fb as t,gb as o,hb as M,ob as H,qb as b,sb as P,wa as i}from"./chunk-IGEIB4M6.js";import"./chunk-YMDWBF3A.js";var ee=(c,r)=>r.id;function ie(c,r){if(c&1&&(t(0,"option",10),a(1),o()),c&2){let l=r.$implicit;h("ngValue",l.id),i(),s(l.name)}}function te(c,r){if(c&1&&(t(0,"div",15),a(1),o()),c&2){let l=P();i(),s(l.validationErrors().maxPersonalExcusesPerMonth)}}function oe(c,r){if(c&1&&(t(0,"div",15),a(1),o()),c&2){let l=P();i(),s(l.validationErrors().maxPersonalExcuseHoursPerMonth)}}function ne(c,r){if(c&1&&(t(0,"div",15),a(1),o()),c&2){let l=P();i(),s(l.validationErrors().maxPersonalExcuseHoursPerDay)}}function re(c,r){if(c&1&&(t(0,"div",15),a(1),o()),c&2){let l=P();i(),s(l.validationErrors().maxHoursPerExcuse)}}function ae(c,r){if(c&1&&(t(0,"div",15),a(1),o()),c&2){let l=P();i(),s(l.validationErrors().minimumExcuseDuration)}}function le(c,r){c&1&&M(0,"span",38)}var $=class c{excusePoliciesService=E(Z);branchesService=E(Y);router=E(D);notificationService=E(K);i18n=E(Q);submitting=C(!1);branches=C([]);policyForm={branchId:null,maxPersonalExcusesPerMonth:5,maxPersonalExcuseHoursPerMonth:8,maxPersonalExcuseHoursPerDay:4,maxHoursPerExcuse:2,requiresApproval:!0,allowPartialHourExcuses:!0,minimumExcuseDuration:.5,maxRetroactiveDays:7,allowSelfServiceRequests:!0};validationErrors=C({});ngOnInit(){this.loadBranches()}t(r){return this.i18n.t(r)}loadBranches(){this.branchesService.getBranches(1,1e3).subscribe({next:r=>{this.branches.set(r.items)},error:r=>{console.error("Failed to load branches:",r)}})}validateForm(){let r={};return(this.policyForm.maxPersonalExcusesPerMonth<=0||this.policyForm.maxPersonalExcusesPerMonth>100)&&(r.maxPersonalExcusesPerMonth=this.t("excuse_policies.validation.excusesPerMonthRange")),(this.policyForm.maxPersonalExcuseHoursPerMonth<=0||this.policyForm.maxPersonalExcuseHoursPerMonth>744)&&(r.maxPersonalExcuseHoursPerMonth=this.t("excuse_policies.validation.hoursPerMonthRange")),(this.policyForm.maxPersonalExcuseHoursPerDay<=0||this.policyForm.maxPersonalExcuseHoursPerDay>24)&&(r.maxPersonalExcuseHoursPerDay=this.t("excuse_policies.validation.hoursPerDayRange")),this.policyForm.maxHoursPerExcuse<=0&&(r.maxHoursPerExcuse=this.t("validation.min")),this.policyForm.minimumExcuseDuration<=0&&(r.minimumExcuseDuration=this.t("validation.min")),this.policyForm.maxPersonalExcuseHoursPerDay>this.policyForm.maxPersonalExcuseHoursPerMonth&&(r.maxPersonalExcuseHoursPerDay=this.t("excuse_policies.validation.dailyExceedsMonthly")),this.policyForm.maxHoursPerExcuse>this.policyForm.maxPersonalExcuseHoursPerDay&&(r.maxHoursPerExcuse=this.t("excuse_policies.validation.excuseExceedsDaily")),this.policyForm.minimumExcuseDuration>this.policyForm.maxHoursPerExcuse&&(r.minimumExcuseDuration=this.t("excuse_policies.validation.minimumExceedsMaximum")),this.validationErrors.set(r),Object.keys(r).length===0}onSubmit(){if(!this.validateForm()){this.notificationService.error(this.t("app.error"),this.t("excuse_policies.validation.pleaseFix"));return}this.submitting.set(!0);let r={branchId:this.policyForm.branchId,maxPersonalExcusesPerMonth:this.policyForm.maxPersonalExcusesPerMonth,maxPersonalExcuseHoursPerMonth:this.policyForm.maxPersonalExcuseHoursPerMonth,maxPersonalExcuseHoursPerDay:this.policyForm.maxPersonalExcuseHoursPerDay,maxHoursPerExcuse:this.policyForm.maxHoursPerExcuse,requiresApproval:this.policyForm.requiresApproval,allowPartialHourExcuses:this.policyForm.allowPartialHourExcuses,minimumExcuseDuration:this.policyForm.minimumExcuseDuration,maxRetroactiveDays:this.policyForm.maxRetroactiveDays,allowSelfServiceRequests:this.policyForm.allowSelfServiceRequests};this.excusePoliciesService.createExcusePolicy(r).subscribe({next:l=>{this.submitting.set(!1),this.notificationService.success(this.t("app.success"),this.t("excuse_policies.create_success")),this.router.navigate(["/settings/excuse-policies",l,"view"])},error:l=>{this.submitting.set(!1),console.error("Failed to create excuse policy:",l);let e=this.t("excuse_policies.create_error");l?.error?.error?e=l.error.error:l?.message&&(e=l.message),this.notificationService.error(this.t("app.error"),e)}})}onCancel(){this.router.navigate(["/settings/excuse-policies"])}static \u0275fac=function(l){return new(l||c)};static \u0275cmp=S({type:c,selectors:[["app-create-excuse-policy"]],decls:93,vars:47,consts:[["policyFormRef","ngForm"],[1,"container-fluid"],["mode","create","moduleName","excuse_policies","moduleRoute","settings/excuse-policies",3,"title"],[3,"ngSubmit"],[1,"row"],[1,"col-md-12","mb-4"],[3,"title"],[1,"mb-3"],["for","branchId",1,"form-label"],["id","branchId","name","branchId",1,"form-select",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"form-text"],[1,"col-md-6","mb-4"],["for","maxExcusesMonth",1,"form-label"],["type","number","id","maxExcusesMonth","name","maxExcusesMonth","min","1","max","100","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"text-danger","small","mt-1"],["for","maxHoursMonth",1,"form-label"],["type","number","id","maxHoursMonth","name","maxHoursMonth","min","0.5","step","0.5","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","maxHoursDay",1,"form-label"],["type","number","id","maxHoursDay","name","maxHoursDay","min","0.5","step","0.5","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","maxHoursPerExcuse",1,"form-label"],["type","number","id","maxHoursPerExcuse","name","maxHoursPerExcuse","min","0.5","step","0.5","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","minimumDuration",1,"form-label"],["type","number","id","minimumDuration","name","minimumDuration","min","0.5","step","0.5","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-6","mb-3"],[1,"form-check","form-switch"],["type","checkbox","id","requiresApproval","name","requiresApproval",1,"form-check-input",3,"ngModelChange","ngModel"],["for","requiresApproval",1,"form-check-label"],["type","checkbox","id","allowPartialHours","name","allowPartialHours",1,"form-check-input",3,"ngModelChange","ngModel"],["for","allowPartialHours",1,"form-check-label"],["type","checkbox","id","allowSelfService","name","allowSelfService",1,"form-check-input",3,"ngModelChange","ngModel"],["for","allowSelfService",1,"form-check-label"],["for","maxRetroactiveDays",1,"form-label"],["type","number","id","maxRetroactiveDays","name","maxRetroactiveDays","min","0","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(l,e){if(l&1){let d=H();t(0,"div",1),M(1,"app-form-header",2),t(2,"form",3,0),b("ngSubmit",function(){return m(d),u(e.onSubmit())}),t(4,"div",4)(5,"div",5)(6,"app-form-section",6)(7,"div",7)(8,"label",8),a(9),o(),t(10,"select",9),_("ngModelChange",function(n){return m(d),y(e.policyForm.branchId,n)||(e.policyForm.branchId=n),u(n)}),t(11,"option",10),a(12),o(),w(13,ie,2,2,"option",10,ee),o(),t(15,"div",11),a(16),o()()()(),t(17,"div",12)(18,"app-form-section",6)(19,"div",7)(20,"label",13),a(21),o(),t(22,"input",14),_("ngModelChange",function(n){return m(d),y(e.policyForm.maxPersonalExcusesPerMonth,n)||(e.policyForm.maxPersonalExcusesPerMonth=n),u(n)}),o(),v(23,te,2,1,"div",15),t(24,"div",11),a(25),o()(),t(26,"div",7)(27,"label",16),a(28),o(),t(29,"input",17),_("ngModelChange",function(n){return m(d),y(e.policyForm.maxPersonalExcuseHoursPerMonth,n)||(e.policyForm.maxPersonalExcuseHoursPerMonth=n),u(n)}),o(),v(30,oe,2,1,"div",15),t(31,"div",11),a(32),o()()()(),t(33,"div",12)(34,"app-form-section",6)(35,"div",7)(36,"label",18),a(37),o(),t(38,"input",19),_("ngModelChange",function(n){return m(d),y(e.policyForm.maxPersonalExcuseHoursPerDay,n)||(e.policyForm.maxPersonalExcuseHoursPerDay=n),u(n)}),o(),v(39,ne,2,1,"div",15),t(40,"div",11),a(41),o()(),t(42,"div",7)(43,"label",20),a(44),o(),t(45,"input",21),_("ngModelChange",function(n){return m(d),y(e.policyForm.maxHoursPerExcuse,n)||(e.policyForm.maxHoursPerExcuse=n),u(n)}),o(),v(46,re,2,1,"div",15),t(47,"div",11),a(48),o()(),t(49,"div",7)(50,"label",22),a(51),o(),t(52,"input",23),_("ngModelChange",function(n){return m(d),y(e.policyForm.minimumExcuseDuration,n)||(e.policyForm.minimumExcuseDuration=n),u(n)}),o(),v(53,ae,2,1,"div",15),t(54,"div",11),a(55),o()()()(),t(56,"div",5)(57,"app-form-section",6)(58,"div",4)(59,"div",24)(60,"div",25)(61,"input",26),_("ngModelChange",function(n){return m(d),y(e.policyForm.requiresApproval,n)||(e.policyForm.requiresApproval=n),u(n)}),o(),t(62,"label",27),a(63),o()(),t(64,"div",11),a(65),o()(),t(66,"div",24)(67,"div",25)(68,"input",28),_("ngModelChange",function(n){return m(d),y(e.policyForm.allowPartialHourExcuses,n)||(e.policyForm.allowPartialHourExcuses=n),u(n)}),o(),t(69,"label",29),a(70),o()(),t(71,"div",11),a(72),o()(),t(73,"div",24)(74,"div",25)(75,"input",30),_("ngModelChange",function(n){return m(d),y(e.policyForm.allowSelfServiceRequests,n)||(e.policyForm.allowSelfServiceRequests=n),u(n)}),o(),t(76,"label",31),a(77),o()(),t(78,"div",11),a(79),o()(),t(80,"div",24)(81,"label",32),a(82),o(),t(83,"input",33),_("ngModelChange",function(n){return m(d),y(e.policyForm.maxRetroactiveDays,n)||(e.policyForm.maxRetroactiveDays=n),u(n)}),o(),t(84,"div",11),a(85),o()()()()(),t(86,"div",34)(87,"div",35)(88,"button",36),b("click",function(){return m(d),u(e.onCancel())}),a(89),o(),t(90,"button",37),v(91,le,1,0,"span",38),a(92),o()()()()()()}l&2&&(i(),h("title",e.t("excuse_policies.create_policy")),i(5),h("title",e.t("excuse_policies.scope_configuration")),i(3),s(e.t("excuse_policies.branch")),i(),x("ngModel",e.policyForm.branchId),i(),h("ngValue",null),i(),s(e.t("excuse_policies.organization_wide")),i(),F(e.branches()),i(3),s(e.t("excuse_policies.branch_help")),i(2),h("title",e.t("excuse_policies.monthly_limits")),i(3),s(e.t("excuse_policies.max_personal_excuses_per_month")),i(),x("ngModel",e.policyForm.maxPersonalExcusesPerMonth),i(),g(e.validationErrors().maxPersonalExcusesPerMonth?23:-1),i(2),s(e.t("excuse_policies.max_excuses_month_help")),i(3),s(e.t("excuse_policies.max_personal_excuse_hours_per_month")),i(),x("ngModel",e.policyForm.maxPersonalExcuseHoursPerMonth),i(),g(e.validationErrors().maxPersonalExcuseHoursPerMonth?30:-1),i(2),s(e.t("excuse_policies.max_hours_month_help")),i(2),h("title",e.t("excuse_policies.time_limits")),i(3),s(e.t("excuse_policies.max_personal_excuse_hours_per_day")),i(),x("ngModel",e.policyForm.maxPersonalExcuseHoursPerDay),i(),g(e.validationErrors().maxPersonalExcuseHoursPerDay?39:-1),i(2),s(e.t("excuse_policies.max_hours_day_help")),i(3),s(e.t("excuse_policies.max_hours_per_excuse")),i(),x("ngModel",e.policyForm.maxHoursPerExcuse),i(),g(e.validationErrors().maxHoursPerExcuse?46:-1),i(2),s(e.t("excuse_policies.max_hours_per_excuse_help")),i(3),s(e.t("excuse_policies.minimum_duration")),i(),x("ngModel",e.policyForm.minimumExcuseDuration),i(),g(e.validationErrors().minimumExcuseDuration?53:-1),i(2),s(e.t("excuse_policies.minimum_duration_help")),i(2),h("title",e.t("excuse_policies.policy_options")),i(4),x("ngModel",e.policyForm.requiresApproval),i(2),f(" ",e.t("excuse_policies.requires_approval")," "),i(2),s(e.t("excuse_policies.requires_approval_help")),i(3),x("ngModel",e.policyForm.allowPartialHourExcuses),i(2),f(" ",e.t("excuse_policies.allow_partial_hours")," "),i(2),s(e.t("excuse_policies.allow_partial_hours_help")),i(3),x("ngModel",e.policyForm.allowSelfServiceRequests),i(2),f(" ",e.t("excuse_policies.allow_self_service")," "),i(2),s(e.t("excuse_policies.allow_self_service_help")),i(3),s(e.t("excuse_policies.max_retroactive_days")),i(),x("ngModel",e.policyForm.maxRetroactiveDays),i(2),s(e.t("excuse_policies.max_retroactive_days_help")),i(3),h("disabled",e.submitting()),i(),f(" ",e.t("common.cancel")," "),i(),h("disabled",e.submitting()),i(),g(e.submitting()?91:-1),i(),f(" ",e.t("common.save")," "))},dependencies:[J,N,O,L,W,B,V,A,q,R,G,z,j,k,T,I,X,U],styles:[".container-fluid[_ngcontent-%COMP%]{padding:1.5rem}.card[_ngcontent-%COMP%]{border:1px solid #dee2e6;box-shadow:0 .125rem .25rem #00000013}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:.75rem 1rem}.card-header[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{font-weight:600;color:#495057}@media (max-width: 768px){.container-fluid[_ngcontent-%COMP%]{padding:1rem}}"]})};export{$ as CreateExcusePolicyComponent};
