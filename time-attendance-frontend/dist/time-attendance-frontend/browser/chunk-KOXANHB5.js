import{a as de,b as he}from"./chunk-GBFD7MFB.js";import{a as oe}from"./chunk-3OLRZNFC.js";import{a as le}from"./chunk-73EAVPDS.js";import{a as ae}from"./chunk-46YUKDEL.js";import{a as ne}from"./chunk-5ND4FORV.js";import{a as re}from"./chunk-VPCY7LU7.js";import{a as se}from"./chunk-MRSJZ7DK.js";import"./chunk-OCNPGNI4.js";import"./chunk-BSEKTODI.js";import"./chunk-HUSARQNL.js";import"./chunk-QXVLGI72.js";import{a as V}from"./chunk-LPMX3N5X.js";import{a as x,b as P}from"./chunk-LDWMK676.js";import"./chunk-IE5XUEO5.js";import{a as ie}from"./chunk-C3GHRZ52.js";import{b as z,c as L,e as $,f as U,g as G,h as j,i as J,j as K,k as Q,u as X,v as Y,w as Z,z as ee}from"./chunk-YQIE4CGE.js";import"./chunk-ZURD34HZ.js";import{a as te}from"./chunk-GEGVYT7O.js";import"./chunk-A6EM5NV6.js";import{A as C,E as c,Fb as W,Ga as l,Ha as h,Ia as m,Ja as R,L as s,Oa as g,Pa as S,Q as O,Qa as b,Va as N,aa as v,ba as y,ca as A,ea as q,fa as B,fb as k,ga as f,ha as a,ia as o,ja as M,qa as E,sa as u,ua as p,y as w,z as _}from"./chunk-5OFYUWMA.js";import{a as D,b as H}from"./chunk-YMDWBF3A.js";var me=()=>[];function ue(d,e){if(d&1){let i=E();a(0,"div",6)(1,"label",7),l(2),o(),a(3,"div",28)(4,"input",29),b("ngModelChange",function(n){_(i);let r=p();return S(r.shiftForm.requiredHours,n)||(r.shiftForm.requiredHours=n),C(n)}),o(),a(5,"span",30),l(6),o()()()}if(d&2){let i=p();s(2),h(i.t("shifts.fields.requiredHours")),s(2),g("ngModel",i.shiftForm.requiredHours),s(2),h(i.t("shifts.hours"))}}function ce(d,e){if(d&1){let i=E();a(0,"div",34)(1,"div",40)(2,"div",31)(3,"h6",41),l(4),o(),a(5,"button",42),u("click",function(){let n=_(i).$index,r=p(2);return C(r.removeShiftPeriod(n))}),M(6,"i",43),o()(),a(7,"div",12)(8,"div",13)(9,"label",9),l(10),o(),a(11,"input",44),b("ngModelChange",function(n){let r=_(i).$implicit;return S(r.startTime,n)||(r.startTime=n),C(n)}),o()(),a(12,"div",13)(13,"label",9),l(14),o(),a(15,"input",44),b("ngModelChange",function(n){let r=_(i).$implicit;return S(r.endTime,n)||(r.endTime=n),C(n)}),o()()()()()}if(d&2){let i=e.$implicit,t=e.$index,n=p(2);s(4),R("",n.t("shifts.period")," ",i.periodOrder),s(),f("disabled",n.shiftForm.shiftPeriods.length<=1),s(5),h(n.t("shifts.fields.startTime")),s(),g("ngModel",i.startTime),f("name","startTime"+t),s(3),h(n.t("shifts.fields.endTime")),s(),g("ngModel",i.endTime),f("name","endTime"+t)}}function pe(d,e){if(d&1){let i=E();a(0,"div",12)(1,"div",13)(2,"label",9),l(3),o(),a(4,"div",28)(5,"input",45),b("ngModelChange",function(n){_(i);let r=p(2);return S(r.shiftForm.flexMinutesBefore,n)||(r.shiftForm.flexMinutesBefore=n),C(n)}),o(),a(6,"span",30),l(7),o()()(),a(8,"div",13)(9,"label",9),l(10),o(),a(11,"div",28)(12,"input",46),b("ngModelChange",function(n){_(i);let r=p(2);return S(r.shiftForm.flexMinutesAfter,n)||(r.shiftForm.flexMinutesAfter=n),C(n)}),o(),a(13,"span",30),l(14),o()()()()}if(d&2){let i=p(2);s(3),h(i.t("shifts.fields.flexMinutesBefore")),s(2),g("ngModel",i.shiftForm.flexMinutesBefore),s(2),h(i.t("common.minutes")),s(3),h(i.t("shifts.fields.flexMinutesAfter")),s(2),g("ngModel",i.shiftForm.flexMinutesAfter),s(2),h(i.t("common.minutes"))}}function ge(d,e){if(d&1&&(a(0,"small",39),M(1,"i",47),l(2),o()),d&2){let i=p(2);s(2),m("",i.t("shifts.validation.flexibleHoursAndGraceCombined")," ")}}function Se(d,e){if(d&1){let i=E();a(0,"div")(1,"div",6)(2,"div",31)(3,"label",7),l(4),o(),a(5,"button",32),u("click",function(){_(i);let n=p();return C(n.addShiftPeriod())}),M(6,"i",33),l(7),o()(),q(8,ce,16,9,"div",34,A),o(),a(10,"div",6)(11,"div",35)(12,"input",36),b("ngModelChange",function(n){_(i);let r=p();return S(r.shiftForm.allowFlexibleHours,n)||(r.shiftForm.allowFlexibleHours=n),C(n)}),u("change",function(){_(i);let n=p();return C(n.onFlexibleHoursChange())}),o(),a(13,"label",16),l(14),o(),a(15,"small",17),l(16),o()(),v(17,pe,15,6,"div",12),o(),a(18,"div",6)(19,"label",9),l(20),o(),a(21,"div",28)(22,"input",37),b("ngModelChange",function(n){_(i);let r=p();return S(r.shiftForm.gracePeriodMinutes,n)||(r.shiftForm.gracePeriodMinutes=n),C(n)}),o(),a(23,"span",30),l(24),o()(),a(25,"small",38),l(26),o(),v(27,ge,3,1,"small",39),o()()}if(d&2){let i=p();s(4),h(i.t("shifts.fields.periods")),s(),f("disabled",i.shiftForm.shiftPeriods.length>=2),s(2),m("",i.t("shifts.addPeriod")," "),s(),B(i.shiftForm.shiftPeriods),s(4),g("ngModel",i.shiftForm.allowFlexibleHours),s(2),m(" ",i.t("shifts.fields.allowFlexibleHours")," "),s(2),h(i.t("shifts.flexibleHoursDescription")),s(),y(i.shiftForm.allowFlexibleHours?17:-1),s(3),h(i.t("shifts.fields.gracePeriod")),s(2),g("ngModel",i.shiftForm.gracePeriodMinutes),s(2),h(i.t("common.minutes")),s(2),h(i.t("shifts.gracePeriodDescription")),s(),y(i.shiftForm.allowFlexibleHours&&i.shiftForm.gracePeriodMinutes?27:-1)}}function be(d,e){d&1&&M(0,"span",24)}function _e(d,e){if(d&1&&(a(0,"p")(1,"strong"),l(2),o()()),d&2){let i,t=p();s(2),h((i=t.selectedShift())==null?null:i.name)}}function Ce(d,e){d&1&&M(0,"span",24)}function ve(d,e){d&1&&M(0,"span",24)}var fe=class d{shiftsService=w(le);branchesService=w(ae);router=w(W);i18n=w(te);permissionService=w(V);PERMISSIONS={SHIFT_CREATE:`${P.SHIFT}.${x.CREATE}`,SHIFT_READ:`${P.SHIFT}.${x.READ}`,SHIFT_UPDATE:`${P.SHIFT}.${x.UPDATE}`,SHIFT_DELETE:`${P.SHIFT}.${x.DELETE}`,SHIFT_MANAGE:`${P.SHIFT}.${x.MANAGE}`};ShiftType=de;ShiftStatus=he;get pageSizeSelectOptions(){return[{value:"10",label:"10"},{value:"25",label:"25"},{value:"50",label:"50"}]}get statusSelectOptions(){return[{value:1 .toString(),label:this.t("shifts.status.active")},{value:2 .toString(),label:this.t("shifts.status.inactive")},{value:3 .toString(),label:this.t("shifts.status.draft")},{value:4 .toString(),label:this.t("shifts.status.archived")}]}loading=c(!1);shifts=c([]);branches=c([]);defaultShift=c(null);currentPage=c(1);pageSize=c(10);totalCount=c(0);totalPages=c(0);searchTerm="";branchFilter=void 0;showCreateModal=c(!1);showEditModal=c(!1);showDeleteModal=c(!1);showDefaultShiftModal=c(!1);selectedShift=c(null);shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,shiftPeriods:[]};submitting=c(!1);tableColumns=k(()=>[{key:"name",label:this.t("shifts.fields.name"),sortable:!0,width:"250px",priority:"high",mobileLabel:this.t("shifts.fields.name"),renderHtml:!0},{key:"status",label:this.t("shifts.fields.status"),sortable:!0,width:"120px",align:"center",priority:"high",mobileLabel:this.t("shifts.fields.status"),renderHtml:!0},{key:"type",label:this.t("shifts.fields.type"),sortable:!1,width:"120px",align:"center",priority:"medium",hideOnMobile:!1,mobileLabel:this.t("shifts.fields.type"),renderHtml:!0},{key:"periods",label:this.t("shifts.fields.periods"),sortable:!1,width:"200px",priority:"medium",hideOnMobile:!1,mobileLabel:"Periods",renderHtml:!0},{key:"requirements",label:this.t("shifts.fields.requirements"),sortable:!1,width:"180px",priority:"low",hideOnMobile:!0,mobileLabel:"Rules",renderHtml:!0}]);tableActions=k(()=>[{key:"view",label:this.t("common.view"),icon:"fa-eye",color:"primary",condition:()=>this.permissionService.has(this.PERMISSIONS.SHIFT_READ)},{key:"set-default",label:this.t("shifts.defaultShift.setDefault"),icon:"fa-star",color:"success",condition:e=>this.canSetDefaultShift(e)},{key:"edit",label:this.t("common.edit"),icon:"fa-edit",color:"secondary",condition:()=>this.permissionService.has(this.PERMISSIONS.SHIFT_UPDATE)},{key:"delete",label:this.t("common.delete"),icon:"fa-trash",color:"danger",condition:()=>this.permissionService.has(this.PERMISSIONS.SHIFT_DELETE)}]);tableData=k(()=>this.shifts().map(e=>H(D({},e),{name:this.formatShiftName(e),status:this.formatShiftStatus(e),type:this.formatShiftType(e),periods:this.formatShiftPeriods(e),requirements:this.formatShiftRequirements(e)})));ngOnInit(){this.loadBranches(),this.loadShifts(),this.loadDefaultShift()}t(e){return this.i18n.t(e)}loadBranches(){this.branchesService.getBranches(1,1e3).subscribe({next:e=>{this.branches.set(e.items)},error:e=>{console.error("Failed to load branches:",e)}})}loadShifts(){this.loading.set(!0);let e=this.searchTerm.trim()||void 0;this.shiftsService.getShifts(this.currentPage(),this.pageSize(),e).subscribe({next:i=>{this.shifts.set(i.items),this.totalCount.set(i.totalCount),this.totalPages.set(i.totalPages),this.loading.set(!1)},error:i=>{console.error("Failed to load shifts:",i),this.loading.set(!1)}})}loadDefaultShift(){this.shiftsService.getDefaultShift().subscribe({next:e=>{this.defaultShift.set(e)},error:e=>{console.error("Failed to load default shift:",e),this.defaultShift.set(null)}})}onSearch(){this.currentPage.set(1),this.loadShifts()}onSearchChange(e){this.searchTerm=e,this.currentPage.set(1),this.loadShifts()}onFiltersChange(e){e.search!==void 0&&(this.searchTerm=e.search||""),e.status,e.shiftType,this.currentPage.set(1),this.loadShifts()}onRefreshData(){this.loadShifts()}onFilterChange(){this.currentPage.set(1),this.loadShifts()}onPageChange(e){this.currentPage.set(e),this.loadShifts()}onPageSizeSelectionChange(e){this.pageSize.set(parseInt(e)),this.onPageSizeChange()}onPageSizeChange(){this.currentPage.set(1),this.loadShifts()}getShiftTypeText(e){return e===1?this.t("shifts.types.timeBased"):this.t("shifts.types.hoursOnly")}getShiftStatusText(e){switch(e){case 1:return this.t("shifts.status.active");case 2:return this.t("shifts.status.inactive");case 3:return this.t("shifts.status.draft");case 4:return this.t("shifts.status.archived");default:return this.t("shifts.status.active")}}getShiftStatusClass(e){switch(e){case 1:return"bg-success";case 2:return"bg-light text-dark border";case 3:return"bg-warning";case 4:return"bg-light text-dark border";default:return"bg-success"}}getShiftStatusBadgeStatus(e){switch(e){case 1:return"success";case 2:return"secondary";case 3:return"warning";case 4:return"secondary";default:return"success"}}formatTime(e){return e}formatHours(e){let i=Math.floor(e),t=Math.round((e-i)*60);return t>0?`${i}h ${t}m`:`${i}h`}getShiftTypeBadgeClass(e){return e===1?"badge-primary":"badge-info"}getPeriodTypeText(e){return this.isNightShift(e.startTime,e.endTime)?this.t("shifts.periodTypes.nightShift"):this.t("shifts.periodTypes.dayShift")}getPeriodHoursText(e){let i=this.calculatePeriodHours(e.startTime,e.endTime);return this.formatHours(i)}formatDate(e){let i=new Date(e);return i.toLocaleDateString()+" "+i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}onCreateShift(){this.router.navigate(["/shifts/create"])}onViewShift(e){this.router.navigate(["/shifts",e.id,"view"])}onEditShift(e){this.router.navigate(["/shifts",e.id,"edit"])}onDeleteShift(e){this.selectedShift.set(e),this.showDeleteModal.set(!0)}onSubmitCreate(){if(!this.isFormValid())return;this.submitting.set(!0);let e={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(i=>({periodOrder:i.periodOrder,startTime:i.startTime,endTime:i.endTime})):void 0};this.shiftsService.createShift(e).subscribe({next:()=>{this.showCreateModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:i=>{console.error("Failed to create shift:",i),this.submitting.set(!1)}})}onSubmitEdit(){if(!this.isFormValid()||!this.selectedShift())return;this.submitting.set(!0);let e={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(i=>({id:i.id,periodOrder:i.periodOrder,startTime:i.startTime,endTime:i.endTime})):void 0};this.shiftsService.updateShift(this.selectedShift().id,e).subscribe({next:()=>{this.showEditModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:i=>{console.error("Failed to update shift:",i),this.submitting.set(!1)}})}onConfirmDelete(){this.selectedShift()&&(this.submitting.set(!0),this.shiftsService.deleteShift(this.selectedShift().id).subscribe({next:()=>{this.showDeleteModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:e=>{console.error("Failed to delete shift:",e),this.submitting.set(!1);let i="Failed to delete shift";e?.error?.message?i=e.error.message:e?.message&&(i=e.message),console.error("Deletion error:",i)}}))}onCloseModal(){this.showCreateModal.set(!1),this.showEditModal.set(!1),this.showDeleteModal.set(!1),this.showDefaultShiftModal.set(!1),this.selectedShift.set(null),this.submitting.set(!1)}onSetDefaultShift(e){this.defaultShift()?(this.selectedShift.set(e),this.showDefaultShiftModal.set(!0)):this.setDefaultShift(e,!1)}onConfirmSetDefaultShift(){this.selectedShift()&&this.setDefaultShift(this.selectedShift(),!0)}setDefaultShift(e,i){this.submitting.set(!0),this.shiftsService.setDefaultShift(e.id,i).subscribe({next:()=>{this.defaultShift.set(e),this.showDefaultShiftModal.set(!1),this.submitting.set(!1),console.log(`Successfully set "${e.name}" as default shift`)},error:t=>{console.error("Failed to set default shift:",t),this.submitting.set(!1)}})}isDefaultShift(e){return this.defaultShift()?.id===e.id}canSetDefaultShift(e){return this.permissionService.hasRole("SystemAdmin")&&e.status===1&&!this.isDefaultShift(e)}onShiftTypeChange(){this.shiftForm.shiftType===2?(this.shiftForm.allowFlexibleHours=!1,this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0,this.shiftForm.gracePeriodMinutes=void 0,this.shiftForm.shiftPeriods=[]):(this.shiftForm.requiredHours=void 0,this.shiftForm.shiftPeriods.length===0&&this.addShiftPeriod())}onFlexibleHoursChange(){this.shiftForm.allowFlexibleHours||(this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0)}calculatePeriodHours(e,i){if(!e||!i)return 0;let t=this.parseTime(e),n=this.parseTime(i);if(n>t)return(n-t)/(1e3*60*60);if(n<t){let r=(864e5-t)/36e5,T=n/(1e3*60*60);return r+T}else return 0}isNightShift(e,i){if(!e||!i)return!1;let t=this.parseTime(e);return this.parseTime(i)<t}getTotalShiftHours(){return this.shiftForm.shiftType===2?this.shiftForm.requiredHours||0:this.shiftForm.shiftPeriods.reduce((e,i)=>e+this.calculatePeriodHours(i.startTime,i.endTime),0)}parseTime(e){let[i,t]=e.split(":").map(Number);return(i*60+t)*60*1e3}validateBusinessRules(){let e=[];this.shiftForm.shiftType===1?(this.shiftForm.shiftPeriods.length===0&&e.push(this.t("shifts.validation.timeBased.periodsRequired")),this.shiftForm.requiredHours!==void 0&&e.push(this.t("shifts.validation.timeBased.noRequiredHours"))):this.shiftForm.shiftType===2&&(this.shiftForm.shiftPeriods.length>0&&e.push(this.t("shifts.validation.hoursOnly.noPeriods")),(!this.shiftForm.requiredHours||this.shiftForm.requiredHours<=0)&&e.push(this.t("shifts.validation.hoursOnly.requiredHours")),this.shiftForm.requiredHours&&this.shiftForm.requiredHours>24&&e.push(this.t("shifts.validation.hoursOnly.maxHours"))),this.shiftForm.shiftPeriods.length>2&&e.push(this.t("shifts.validation.periods.maxTwo"));for(let i=0;i<this.shiftForm.shiftPeriods.length;i++){let t=this.shiftForm.shiftPeriods[i];t.startTime===t.endTime&&e.push(this.t("shifts.validation.periods.sameTime").replace("{{period}}",(i+1).toString()));let n=this.calculatePeriodHours(t.startTime,t.endTime);n<=0&&e.push(this.t("shifts.validation.periods.positiveHours").replace("{{period}}",(i+1).toString())),n>24&&e.push(this.t("shifts.validation.periods.maxHours").replace("{{period}}",(i+1).toString()))}if(this.shiftForm.shiftType===2&&(this.shiftForm.allowFlexibleHours&&e.push(this.t("shifts.validation.hoursOnly.noFlexibleHours")),this.shiftForm.gracePeriodMinutes&&e.push(this.t("shifts.validation.hoursOnly.noGracePeriod"))),this.shiftForm.allowFlexibleHours&&(this.shiftForm.flexMinutesBefore&&this.shiftForm.flexMinutesBefore>480&&e.push(this.t("shifts.validation.flexible.maxBefore")),this.shiftForm.flexMinutesAfter&&this.shiftForm.flexMinutesAfter>480&&e.push(this.t("shifts.validation.flexible.maxAfter"))),this.shiftForm.gracePeriodMinutes&&this.shiftForm.gracePeriodMinutes>120&&e.push(this.t("shifts.validation.gracePeriod.max")),!this.shiftForm.isCheckInRequired&&!this.shiftForm.isAutoCheckOut&&e.push(this.t("shifts.validation.checkInOut.conflict")),this.shiftForm.shiftPeriods.length===2){let i=this.shiftForm.shiftPeriods.sort((F,I)=>F.periodOrder-I.periodOrder),t=i[0],n=i[1],r=this.isNightShift(t.startTime,t.endTime),T=this.isNightShift(n.startTime,n.endTime);if(r&&T&&e.push(this.t("shifts.validation.periods.multipleNight")),!r&&!T){let F=this.parseTime(t.endTime),I=this.parseTime(n.startTime);F>=I&&e.push(this.t("shifts.validation.periods.overlap"))}}return e}addShiftPeriod(){this.shiftForm.shiftPeriods.length<2&&this.shiftForm.shiftPeriods.push({periodOrder:this.shiftForm.shiftPeriods.length+1,startTime:"08:00",endTime:"17:00"})}removeShiftPeriod(e){this.shiftForm.shiftPeriods.splice(e,1),this.shiftForm.shiftPeriods.forEach((i,t)=>{i.periodOrder=t+1})}resetForm(){this.shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,shiftPeriods:[{periodOrder:1,startTime:"08:00",endTime:"17:00"}]}}isFormValid(){return this.shiftForm.name.trim()?this.validateBusinessRules().length===0:!1}getFormErrors(){let e=[];return this.shiftForm.name.trim()||e.push(this.t("shifts.validation.name.required")),e.push(...this.validateBusinessRules()),e}getPaginationArray(){let e=this.totalPages(),i=this.currentPage(),t=2,n=Math.max(1,i-t),r=Math.min(e,i+t);r-n<4&&e>4&&(n===1?r=Math.min(e,n+4):r===e&&(n=Math.max(1,r-4)));let T=[];for(let F=n;F<=r;F++)T.push(F);return T}getEndCount(){return Math.min(this.currentPage()*this.pageSize(),this.totalCount())}formatShiftName(e){let i=`<div><strong>${e.name}</strong>`;return this.isDefaultShift(e)&&(i+=`<span class="badge bg-success ms-2">${this.t("shifts.defaultShift.currentDefault")}</span>`),e.description&&(i+=`<small class="d-block text-muted">${e.description}</small>`),i+="</div>",i}formatShiftStatus(e){let i=this.getShiftStatusText(e.status);return`<span class="badge ${this.getShiftStatusClass(e.status)}">${i}</span>`}formatShiftType(e){let i=this.getShiftTypeText(e.shiftType);return`<span class="badge ${e.shiftType===1?"bg-primary":"bg-info"}">${i}</span>`}formatShiftPeriods(e){if(e.shiftType===1&&e.shiftPeriods){let i="<div>";return e.shiftPeriods.forEach(t=>{i+=`<div class="small">${this.formatTime(t.startTime)} - ${this.formatTime(t.endTime)}`,t.isNightPeriod&&(i+=`<span class="badge bg-warning ms-1">${this.t("shifts.nightShift")}</span>`),i+="</div>"}),i+="</div>",i}else if(e.shiftType===2)return`<div>${e.requiredHours} ${this.t("shifts.hours")}</div>`;return"<div>-</div>"}formatShiftRequirements(e){let i='<div class="small">';return e.isCheckInRequired&&(i+=`<div><i class="fas fa-check text-success me-1"></i>${this.t("shifts.checkInRequired")}</div>`),e.isAutoCheckOut&&(i+=`<div><i class="fas fa-check text-success me-1"></i>${this.t("shifts.autoCheckOut")}</div>`),e.allowFlexibleHours&&(i+=`<div><i class="fas fa-check text-success me-1"></i>${this.t("shifts.flexibleHours")}</div>`),e.gracePeriodMinutes&&(i+=`<div><i class="fas fa-clock text-info me-1"></i>${e.gracePeriodMinutes}min ${this.t("shifts.gracePeriod")}</div>`),i+="</div>",i}onActionClick(e){let{action:i,item:t}=e;switch(i){case"view":this.onViewShift(t);break;case"set-default":this.onSetDefaultShift(t);break;case"edit":this.onEditShift(t);break;case"delete":this.onDeleteShift(t);break;default:console.warn("Unknown action:",i)}}onTablePageChange(e){this.onPageChange(e)}onTablePageSizeChange(e){this.pageSize.set(e),this.onPageSizeChange()}static \u0275fac=function(i){return new(i||d)};static \u0275cmp=O({type:d,selectors:[["app-shifts"]],decls:89,vars:74,consts:[[1,"app-list-page"],[3,"title"],["moduleName","shifts",3,"searchChange","filtersChange","add","refresh","refreshing"],[3,"actionClick","pageChange","pageSizeChange","data","columns","actions","currentPage","totalPages","totalItems","pageSize","loading","emptyTitle","emptyMessage","responsiveMode"],[3,"close","show","title","size","centered","loading"],[1,"modal-body"],[1,"mb-3"],[1,"form-label","required"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-label"],["rows","2","name","description",1,"form-control",3,"ngModelChange","ngModel"],["name","status",3,"ngModelChange","options","ngModel","placeholder","required","searchable","clearable"],[1,"row"],[1,"col-md-6"],[1,"form-check"],["type","radio","name","shiftType",1,"form-check-input",3,"ngModelChange","change","value","ngModel"],[1,"form-check-label"],[1,"form-text","text-muted","d-block"],[1,"row","mb-3"],["type","checkbox","name","isCheckInRequired",1,"form-check-input",3,"ngModelChange","ngModel"],["type","checkbox","name","isAutoCheckOut",1,"form-check-input",3,"ngModelChange","ngModel"],["modal-footer","",1,"d-flex","gap-2","justify-content-end"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"spinner-border","spinner-border-sm","me-2"],[3,"close","show","title","centered","loading"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"input-group"],["type","number","name","requiredHours","min","0.5","max","24","step","0.5",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-text"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click","disabled"],[1,"fas","fa-plus","me-1"],[1,"card","mb-2"],[1,"form-check","mb-2"],["type","checkbox","name","allowFlexibleHours",1,"form-check-input",3,"ngModelChange","change","ngModel"],["type","number","name","gracePeriodMinutes","min","1","max","120",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text","text-muted"],[1,"form-text","text-info","d-block"],[1,"card-body","p-3"],[1,"mb-0"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash"],["type","time","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","number","name","flexMinutesBefore","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","flexMinutesAfter","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],[1,"fas","fa-info-circle","me-1"]],template:function(i,t){if(i&1&&(a(0,"div",0),M(1,"app-page-header",1),a(2,"app-unified-filter",2),u("searchChange",function(r){return t.onSearchChange(r)})("filtersChange",function(r){return t.onFiltersChange(r)})("add",function(){return t.onCreateShift()})("refresh",function(){return t.onRefreshData()}),o(),a(3,"app-data-table",3),u("actionClick",function(r){return t.onActionClick(r)})("pageChange",function(r){return t.onTablePageChange(r)})("pageSizeChange",function(r){return t.onTablePageSizeChange(r)}),o()(),a(4,"app-modal-wrapper",4),u("close",function(){return t.onCloseModal()}),a(5,"div",5)(6,"form")(7,"div",6)(8,"label",7),l(9),o(),a(10,"input",8),b("ngModelChange",function(r){return S(t.shiftForm.name,r)||(t.shiftForm.name=r),r}),o()(),a(11,"div",6)(12,"label",9),l(13),o(),a(14,"textarea",10),b("ngModelChange",function(r){return S(t.shiftForm.description,r)||(t.shiftForm.description=r),r}),o()(),a(15,"div",6)(16,"label",7),l(17),o(),a(18,"app-searchable-select",11),b("ngModelChange",function(r){return S(t.shiftForm.status,r)||(t.shiftForm.status=r),r}),o()(),a(19,"div",6)(20,"label",7),l(21),o(),a(22,"div",12)(23,"div",13)(24,"div",14)(25,"input",15),b("ngModelChange",function(r){return S(t.shiftForm.shiftType,r)||(t.shiftForm.shiftType=r),r}),u("change",function(){return t.onShiftTypeChange()}),o(),a(26,"label",16),l(27),o(),a(28,"small",17),l(29),o()()(),a(30,"div",13)(31,"div",14)(32,"input",15),b("ngModelChange",function(r){return S(t.shiftForm.shiftType,r)||(t.shiftForm.shiftType=r),r}),u("change",function(){return t.onShiftTypeChange()}),o(),a(33,"label",16),l(34),o(),a(35,"small",17),l(36),o()()()()(),v(37,ue,7,3,"div",6),v(38,Se,28,12,"div"),a(39,"div",18)(40,"div",13)(41,"div",14)(42,"input",19),b("ngModelChange",function(r){return S(t.shiftForm.isCheckInRequired,r)||(t.shiftForm.isCheckInRequired=r),r}),o(),a(43,"label",16),l(44),o(),a(45,"small",17),l(46),o()()(),a(47,"div",13)(48,"div",14)(49,"input",20),b("ngModelChange",function(r){return S(t.shiftForm.isAutoCheckOut,r)||(t.shiftForm.isAutoCheckOut=r),r}),o(),a(50,"label",16),l(51),o(),a(52,"small",17),l(53),o()()()()()(),a(54,"div",21)(55,"button",22),u("click",function(){return t.onCloseModal()}),l(56),o(),a(57,"button",23),u("click",function(){return t.showCreateModal()?t.onSubmitCreate():t.onSubmitEdit()}),v(58,be,1,0,"span",24),l(59),o()()(),a(60,"app-modal-wrapper",25),u("close",function(){return t.onCloseModal()}),a(61,"div",5)(62,"p"),l(63),o(),v(64,_e,3,1,"p"),o(),a(65,"div",21)(66,"button",22),u("click",function(){return t.onCloseModal()}),l(67),o(),a(68,"button",26),u("click",function(){return t.onConfirmDelete()}),v(69,Ce,1,0,"span",24),l(70),o()()(),a(71,"app-modal-wrapper",25),u("close",function(){return t.onCloseModal()}),a(72,"div",5)(73,"p"),l(74),o(),a(75,"p")(76,"strong"),l(77),o(),l(78),o(),a(79,"p")(80,"strong"),l(81),o(),l(82),o()(),a(83,"div",21)(84,"button",22),u("click",function(){return t.onCloseModal()}),l(85),o(),a(86,"button",27),u("click",function(){return t.onConfirmSetDefaultShift()}),v(87,ve,1,0,"span",24),l(88),o()()()),i&2){let n,r;s(),f("title",t.t("shifts.title")),s(),f("refreshing",t.loading()),s(),f("data",t.tableData()||N(73,me))("columns",t.tableColumns())("actions",t.tableActions())("currentPage",t.currentPage)("totalPages",t.totalPages)("totalItems",t.totalCount)("pageSize",t.pageSize)("loading",t.loading)("emptyTitle",t.t("shifts.noShifts"))("emptyMessage",t.t("shifts.noShiftsDescription"))("responsiveMode","auto"),s(),f("show",t.showCreateModal()||t.showEditModal())("title",t.showCreateModal()?t.t("shifts.actions.create"):t.t("shifts.actions.edit"))("size","lg")("centered",!0)("loading",t.submitting()),s(5),h(t.t("shifts.fields.name")),s(),g("ngModel",t.shiftForm.name),s(3),h(t.t("shifts.fields.description")),s(),g("ngModel",t.shiftForm.description),s(3),h(t.t("shifts.fields.status")),s(),f("options",t.statusSelectOptions),g("ngModel",t.shiftForm.status),f("placeholder",t.t("common.select"))("required",!0)("searchable",!0)("clearable",!1),s(3),h(t.t("shifts.fields.type")),s(4),f("value",t.ShiftType.TimeBased),g("ngModel",t.shiftForm.shiftType),s(2),m(" ",t.t("shifts.types.timeBased")," "),s(2),h(t.t("shifts.types.timeBasedDescription")),s(3),f("value",t.ShiftType.HoursOnly),g("ngModel",t.shiftForm.shiftType),s(2),m(" ",t.t("shifts.types.hoursOnly")," "),s(2),h(t.t("shifts.types.hoursOnlyDescription")),s(),y(t.shiftForm.shiftType===t.ShiftType.HoursOnly?37:-1),s(),y(t.shiftForm.shiftType===t.ShiftType.TimeBased?38:-1),s(4),g("ngModel",t.shiftForm.isCheckInRequired),s(2),m(" ",t.t("shifts.fields.checkInRequired")," "),s(2),h(t.t("shifts.checkInRequiredDescription")),s(3),g("ngModel",t.shiftForm.isAutoCheckOut),s(2),m(" ",t.t("shifts.fields.autoCheckOut")," "),s(2),h(t.t("shifts.autoCheckOutDescription")),s(3),m(" ",t.t("common.cancel")," "),s(),f("disabled",!t.isFormValid()||t.submitting()),s(),y(t.submitting()?58:-1),s(),m(" ",t.showCreateModal()?t.t("common.create"):t.t("common.update")," "),s(),f("show",t.showDeleteModal())("title",t.t("shifts.actions.delete"))("centered",!0)("loading",t.submitting()),s(3),h(t.t("shifts.deleteConfirmation")),s(),y(t.selectedShift()?64:-1),s(3),m(" ",t.t("common.cancel")," "),s(),f("disabled",t.submitting()),s(),y(t.submitting()?69:-1),s(),m(" ",t.t("common.delete")," "),s(),f("show",t.showDefaultShiftModal())("title",t.t("shifts.defaultShift.confirmReplace"))("centered",!0)("loading",t.submitting()),s(3),h(t.t("shifts.defaultShift.confirmReplaceMessage")),s(3),m("",t.t("shifts.defaultShift.newShift"),":"),s(),m(" ",(n=t.selectedShift())==null?null:n.name),s(3),m("",t.t("shifts.defaultShift.currentShift"),":"),s(),m(" ",(r=t.defaultShift())==null?null:r.name),s(3),m(" ",t.t("shifts.defaultShift.cancelButton")," "),s(),f("disabled",t.submitting()),s(),y(t.submitting()?87:-1),s(),m(" ",t.t("shifts.defaultShift.confirmButton")," ")}},dependencies:[ee,J,L,K,z,Q,$,U,Z,Y,X,j,G,oe,re,ie,se,ne],styles:['.required[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:none;font-weight:600}.badge[_ngcontent-%COMP%]{font-size:.75rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.form-text.text-muted[_ngcontent-%COMP%]{font-size:.8rem}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{border-radius:.375rem;margin:0 .125rem}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.table-responsive[_ngcontent-%COMP%]{border-radius:.375rem}@media (max-width: 768px){.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.2rem .4rem;font-size:.75rem}.table-responsive[_ngcontent-%COMP%]{font-size:.9rem}}']})};export{fe as ShiftsComponent};
