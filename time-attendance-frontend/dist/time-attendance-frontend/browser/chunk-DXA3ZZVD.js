import{a as R}from"./chunk-VVO5HLLI.js";import{a as z}from"./chunk-XEQ2WLKT.js";import{c as k,d as y,e as O,f as j,i as w,m as M,n as D,o as L,p as P,r as B,w as V,y as q}from"./chunk-VRETN7JA.js";import{b as G}from"./chunk-3VZ5QHEY.js";import{d as F,g as N,h as T,m as A}from"./chunk-TWXUAMJ4.js";import{Bb as l,Cb as d,Db as _,Ea as C,R as E,W as g,X as b,Xa as c,Ya as v,bb as x,cb as o,da as f,db as a,eb as m,lb as I,nb as h,pb as p,ta as e,wc as S,yb as u}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";function H(r,n){if(r&1&&(o(0,"div",10)(1,"div",13)(2,"span",14),l(3),a()()()),r&2){let i=p();e(3),d(i.i18n.t("common.loading"))}}function J(r,n){if(r&1&&(o(0,"div",20),m(1,"i",62),l(2),a()),r&2){let i=p(2);e(2),_(" ",i.error()," ")}}function K(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("firstName"))}}function Q(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("lastName"))}}function U(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("jobTitle"))}}function X(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("employmentStatus"))}}function Y(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("workLocationType"))}}function Z(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("firstNameAr"))}}function $(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("lastNameAr"))}}function ee(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("jobTitleAr"))}}function te(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("email"))}}function ie(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("phone"))}}function ne(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("nationalId"))}}function ae(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("dateOfBirth"))}}function oe(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("gender"))}}function le(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("departmentId"))}}function re(r,n){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let i=p(2);e(),d(i.getFieldError("managerEmployeeId"))}}function de(r,n){r&1&&m(0,"span",60)}function me(r,n){r&1&&m(0,"i",61)}function se(r,n){if(r&1){let i=I();o(0,"div",11)(1,"div",15)(2,"h5",16),m(3,"i",17),l(4),a()(),o(5,"div",18)(6,"form",19),h("ngSubmit",function(){g(i);let t=p();return b(t.onSubmit())}),c(7,J,3,1,"div",20),o(8,"div",21)(9,"h6",22),m(10,"i",23),l(11),a(),o(12,"div",24)(13,"div",25)(14,"label",26),l(15),a(),m(16,"input",27),o(17,"div",28),l(18),a()(),o(19,"div",25)(20,"label",26),l(21),a(),m(22,"input",27),o(23,"div",28),l(24),a()(),o(25,"div",25)(26,"label",26),l(27),o(28,"span",29),l(29,"*"),a()(),m(30,"input",30),c(31,K,2,1,"div",31),a(),o(32,"div",25)(33,"label",26),l(34),o(35,"span",29),l(36,"*"),a()(),m(37,"input",32),c(38,Q,2,1,"div",31),a(),o(39,"div",25)(40,"label",26),l(41),o(42,"span",29),l(43,"*"),a()(),m(44,"input",33),c(45,U,2,1,"div",31),a(),o(46,"div",25)(47,"label",26),l(48),o(49,"span",29),l(50,"*"),a()(),o(51,"select",34)(52,"option",35),l(53),a(),o(54,"option",36),l(55),a(),o(56,"option",37),l(57),a(),o(58,"option",38),l(59),a(),o(60,"option",39),l(61),a(),o(62,"option",40),l(63),a(),o(64,"option",41),l(65),a(),o(66,"option",42),l(67),a(),o(68,"option",43),l(69),a()(),c(70,X,2,1,"div",31),a(),o(71,"div",25)(72,"label",26),l(73),o(74,"span",29),l(75,"*"),a()(),o(76,"select",44)(77,"option",35),l(78),a(),o(79,"option",36),l(80),a(),o(81,"option",37),l(82),a(),o(83,"option",38),l(84),a()(),c(85,Y,2,1,"div",31),a()()(),m(86,"hr"),o(87,"div",21)(88,"h6",45),m(89,"i",46),l(90),a(),o(91,"div",24)(92,"div",25)(93,"label",26),l(94),a(),m(95,"input",47),c(96,Z,2,1,"div",31),a(),o(97,"div",25)(98,"label",26),l(99),a(),m(100,"input",48),c(101,$,2,1,"div",31),a(),o(102,"div",25)(103,"label",26),l(104),a(),m(105,"input",49),c(106,ee,2,1,"div",31),a(),o(107,"div",25)(108,"label",26),l(109),a(),m(110,"input",50),c(111,te,2,1,"div",31),a(),o(112,"div",25)(113,"label",26),l(114),a(),m(115,"input",51),c(116,ie,2,1,"div",31),a(),o(117,"div",25)(118,"label",26),l(119),a(),m(120,"input",52),c(121,ne,2,1,"div",31),a(),o(122,"div",25)(123,"label",26),l(124),a(),m(125,"input",53),c(126,ae,2,1,"div",31),a(),o(127,"div",25)(128,"label",26),l(129),a(),o(130,"select",54)(131,"option",35),l(132),a(),o(133,"option",36),l(134),a(),o(135,"option",37),l(136),a()(),c(137,oe,2,1,"div",31),a(),o(138,"div",25)(139,"label",26),l(140),a(),m(141,"app-searchable-select",55),c(142,le,2,1,"div",31),a(),o(143,"div",25)(144,"label",26),l(145),a(),m(146,"app-searchable-select",56),c(147,re,2,1,"div",31),a()()(),o(148,"div",57)(149,"button",8),h("click",function(){g(i);let t=p();return b(t.onCancel())}),m(150,"i",58),l(151),a(),o(152,"button",59),c(153,de,1,0,"span",60)(154,me,1,0,"i",61),l(155),a()()()()()}if(r&2){let i,s,t=p();e(4),_(" ",t.i18n.t("employees.employee_information")," "),e(2),x("formGroup",t.employeeForm),e(),v(t.error()?7:-1),e(4),_(" ",t.i18n.t("employees.required_information")," "),e(4),d(t.i18n.t("employees.employee_number")),e(),x("value",(i=t.employee())==null?null:i.employeeNumber),e(2),d(t.i18n.t("employees.employee_number_readonly")),e(3),d(t.i18n.t("employees.branch")),e(),x("value",(s=t.employee())==null?null:s.branchName),e(2),d(t.i18n.t("employees.branch_readonly")),e(3),_(" ",t.i18n.t("employees.first_name")," "),e(3),u("is-invalid",t.isFieldInvalid("firstName")),x("placeholder",t.i18n.t("employees.first_name_placeholder")),e(),v(t.isFieldInvalid("firstName")?31:-1),e(3),_(" ",t.i18n.t("employees.last_name")," "),e(3),u("is-invalid",t.isFieldInvalid("lastName")),x("placeholder",t.i18n.t("employees.last_name_placeholder")),e(),v(t.isFieldInvalid("lastName")?38:-1),e(3),_(" ",t.i18n.t("employees.job_title")," "),e(3),u("is-invalid",t.isFieldInvalid("jobTitle")),x("placeholder",t.i18n.t("employees.job_title_placeholder")),e(),v(t.isFieldInvalid("jobTitle")?45:-1),e(3),_(" ",t.i18n.t("employees.employment_status.title")," "),e(3),u("is-invalid",t.isFieldInvalid("employmentStatus")),e(2),d(t.i18n.t("common.select")),e(2),d(t.i18n.t("employees.employment_status.active")),e(2),d(t.i18n.t("employees.employment_status.fulltime")),e(2),d(t.i18n.t("employees.employment_status.parttime")),e(2),d(t.i18n.t("employees.employment_status.contract")),e(2),d(t.i18n.t("employees.employment_status.intern")),e(2),d(t.i18n.t("employees.employment_status.consultant")),e(2),d(t.i18n.t("employees.employment_status.terminated")),e(2),d(t.i18n.t("employees.employment_status.inactive")),e(),v(t.isFieldInvalid("employmentStatus")?70:-1),e(3),_(" ",t.i18n.t("employees.work_location.title")," "),e(3),u("is-invalid",t.isFieldInvalid("workLocationType")),e(2),d(t.i18n.t("common.select")),e(2),d(t.i18n.t("employees.work_location.onsite")),e(2),d(t.i18n.t("employees.work_location.remote")),e(2),d(t.i18n.t("employees.work_location.hybrid")),e(),v(t.isFieldInvalid("workLocationType")?85:-1),e(5),_(" ",t.i18n.t("employees.additional_information")," "),e(4),d(t.i18n.t("employees.first_name_ar")),e(),u("is-invalid",t.isFieldInvalid("firstNameAr")),x("placeholder",t.i18n.t("employees.first_name_ar_placeholder")),e(),v(t.isFieldInvalid("firstNameAr")?96:-1),e(3),d(t.i18n.t("employees.last_name_ar")),e(),u("is-invalid",t.isFieldInvalid("lastNameAr")),x("placeholder",t.i18n.t("employees.last_name_ar_placeholder")),e(),v(t.isFieldInvalid("lastNameAr")?101:-1),e(3),d(t.i18n.t("employees.job_title_ar")),e(),u("is-invalid",t.isFieldInvalid("jobTitleAr")),x("placeholder",t.i18n.t("employees.job_title_ar_placeholder")),e(),v(t.isFieldInvalid("jobTitleAr")?106:-1),e(3),d(t.i18n.t("employees.email")),e(),u("is-invalid",t.isFieldInvalid("email")),x("placeholder",t.i18n.t("employees.email_placeholder")),e(),v(t.isFieldInvalid("email")?111:-1),e(3),d(t.i18n.t("employees.phone")),e(),u("is-invalid",t.isFieldInvalid("phone")),x("placeholder",t.i18n.t("employees.phone_placeholder")),e(),v(t.isFieldInvalid("phone")?116:-1),e(3),d(t.i18n.t("employees.national_id")),e(),u("is-invalid",t.isFieldInvalid("nationalId")),x("placeholder",t.i18n.t("employees.national_id_placeholder")),e(),v(t.isFieldInvalid("nationalId")?121:-1),e(3),d(t.i18n.t("employees.date_of_birth")),e(),u("is-invalid",t.isFieldInvalid("dateOfBirth")),e(),v(t.isFieldInvalid("dateOfBirth")?126:-1),e(3),d(t.i18n.t("employees.gender.title")),e(),u("is-invalid",t.isFieldInvalid("gender")),e(2),d(t.i18n.t("common.select")),e(2),d(t.i18n.t("employees.gender.male")),e(2),d(t.i18n.t("employees.gender.female")),e(),v(t.isFieldInvalid("gender")?137:-1),e(3),d(t.i18n.t("employees.department")),e(),u("is-invalid",t.isFieldInvalid("departmentId")),x("options",t.departmentSelectOptions)("placeholder",t.i18n.t("common.select_department"))("searchable",!0)("clearable",!1),e(),v(t.isFieldInvalid("departmentId")?142:-1),e(3),d(t.i18n.t("employees.manager")),e(),u("is-invalid",t.isFieldInvalid("managerEmployeeId")),x("options",t.managerSelectOptions)("placeholder",t.i18n.t("common.select_manager"))("searchable",!0)("clearable",!1),e(),v(t.isFieldInvalid("managerEmployeeId")?147:-1),e(2),x("disabled",t.saving()),e(2),_(" ",t.i18n.t("common.cancel")," "),e(),x("disabled",t.employeeForm.invalid||t.saving()),e(),v(t.saving()?153:154),e(2),_(" ",t.saving()?t.i18n.t("common.saving"):t.i18n.t("employees.update_employee")," ")}}function pe(r,n){if(r&1&&(o(0,"div",12),m(1,"i",62),l(2),a()),r&2){let i=p();e(2),_(" ",i.error()||i.i18n.t("employees.employee_not_found")," ")}}var W=class r{route=E(F);router=E(N);employeesService=E(z);fb=E(V);i18n=E(G);employee=f(null);departments=f([]);managers=f([]);loading=f(!0);saving=f(!1);error=f("");employeeForm;ngOnInit(){this.initializeForm();let n=this.route.snapshot.paramMap.get("id");n?this.loadDepartmentsAndEmployee(n):(this.error.set(this.i18n.t("employees.invalid_employee_id")),this.loading.set(!1))}initializeForm(){this.employeeForm=this.fb.group({branchId:[""],firstName:["",[y.required,y.minLength(2)]],lastName:["",[y.required,y.minLength(2)]],firstNameAr:[""],lastNameAr:[""],jobTitle:["",y.required],jobTitleAr:[""],email:["",y.email],phone:[""],nationalId:[""],dateOfBirth:[""],gender:[""],employmentStatus:["",y.required],workLocationType:["",y.required],departmentId:[""],managerEmployeeId:[""]})}loadDepartmentsAndEmployee(n){this.employeesService.getDepartments().subscribe({next:i=>{this.departments.set(i),this.employeesService.getEmployeeById(+n).subscribe({next:s=>{this.employee.set(s),this.employeesService.getManagers(s.branchId).subscribe({next:t=>{this.managers.set(t),this.populateForm(s),this.loading.set(!1)},error:t=>{console.error("Error loading managers:",t),this.managers.set([]),this.populateForm(s),this.loading.set(!1)}})},error:s=>{this.error.set(this.getErrorMessage(s)),this.loading.set(!1)}})},error:i=>{console.error("Error loading departments:",i),this.departments.set([]),this.loadEmployee(n)}})}loadEmployee(n){this.employeesService.getEmployeeById(+n).subscribe({next:i=>{this.employee.set(i),this.loadManagers(i.branchId.toString()),this.populateForm(i),this.loading.set(!1)},error:i=>{this.error.set(this.getErrorMessage(i)),this.loading.set(!1)}})}loadManagers(n){this.employeesService.getManagers(+n).subscribe({next:i=>{this.managers.set(i)},error:i=>{console.error("Error loading managers:",i),this.managers.set([])}})}populateForm(n){this.employeeForm.patchValue({branchId:n.branchId,firstName:n.firstName,lastName:n.lastName,firstNameAr:n.firstNameAr||"",lastNameAr:n.lastNameAr||"",jobTitle:n.jobTitle,jobTitleAr:n.jobTitleAr||"",email:n.email||"",phone:n.phone||"",nationalId:n.nationalId||"",dateOfBirth:n.dateOfBirth?new Date(n.dateOfBirth).toISOString().split("T")[0]:"",gender:n.gender||"",employmentStatus:n.employmentStatus,workLocationType:n.workLocationType,departmentId:n.departmentId||"",managerEmployeeId:n.managerEmployeeId||""})}onSubmit(){if(this.employeeForm.invalid){this.employeeForm.markAllAsTouched();return}this.saving.set(!0),this.error.set("");let n=this.employeeForm.value,i={firstName:n.firstName,lastName:n.lastName,firstNameAr:n.firstNameAr||void 0,lastNameAr:n.lastNameAr||void 0,jobTitle:n.jobTitle,jobTitleAr:n.jobTitleAr||void 0,email:n.email||void 0,phone:n.phone||void 0,nationalId:n.nationalId||void 0,dateOfBirth:n.dateOfBirth||void 0,gender:n.gender?+n.gender:void 0,employmentStatus:+n.employmentStatus,workLocationType:+n.workLocationType,departmentId:n.departmentId||void 0,managerEmployeeId:n.managerEmployeeId||void 0};this.employeesService.updateEmployee(this.employee().id,i).subscribe({next:()=>{this.saving.set(!1),this.router.navigate(["/employees",this.employee().id,"view"])},error:s=>{this.saving.set(!1),this.error.set(this.getErrorMessage(s))}})}onCancel(){this.employee()?this.router.navigate(["/employees",this.employee().id,"view"]):this.router.navigate(["/employees"])}getFieldError(n){let i=this.employeeForm.get(n);if(i?.errors&&i.touched){if(i.errors.required)return this.i18n.t("validation.required");if(i.errors.email)return this.i18n.t("validation.email");if(i.errors.minlength)return this.i18n.t("validation.minlength").replace("{{min}}",i.errors.minlength.requiredLength)}return""}isFieldInvalid(n){let i=this.employeeForm.get(n);return!!(i?.errors&&i.touched)}get departmentSelectOptions(){let n=[{value:"",label:this.i18n.t("common.select_department")}];return this.departments().forEach(i=>{n.push({value:i.id.toString(),label:i.name,subLabel:i.nameAr||""})}),n}get managerSelectOptions(){let n=[{value:"",label:this.i18n.t("common.select_manager")}];return this.managers().forEach(i=>{n.push({value:i.id.toString(),label:i.name,subLabel:i.employeeNumber})}),n}getErrorMessage(n){return n?.error?.error?n.error.error:this.i18n.t("errors.unknown")}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=C({type:r,selectors:[["app-edit-employee"]],decls:21,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/employees"],[1,"breadcrumb-item","active"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"card"],[1,"alert","alert-danger"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fa-solid","fa-user","me-2"],[1,"card-body"],[3,"ngSubmit","formGroup"],["role","alert",1,"alert","alert-danger"],[1,"mb-4"],[1,"text-primary","mb-3"],[1,"fa-solid","fa-asterisk","me-2"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["type","text","readonly","",1,"form-control-plaintext",3,"value"],[1,"form-text"],[1,"text-danger"],["type","text","formControlName","firstName",1,"form-control",3,"placeholder"],[1,"invalid-feedback"],["type","text","formControlName","lastName",1,"form-control",3,"placeholder"],["type","text","formControlName","jobTitle",1,"form-control",3,"placeholder"],["formControlName","employmentStatus",1,"form-select"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["value","7"],["value","8"],["formControlName","workLocationType",1,"form-select"],[1,"text-secondary","mb-3"],[1,"fa-solid","fa-info-circle","me-2"],["type","text","formControlName","firstNameAr",1,"form-control",3,"placeholder"],["type","text","formControlName","lastNameAr",1,"form-control",3,"placeholder"],["type","text","formControlName","jobTitleAr",1,"form-control",3,"placeholder"],["type","email","formControlName","email",1,"form-control",3,"placeholder"],["type","tel","formControlName","phone",1,"form-control",3,"placeholder"],["type","text","formControlName","nationalId",1,"form-control",3,"placeholder"],["type","date","formControlName","dateOfBirth",1,"form-control"],["formControlName","gender",1,"form-select"],["formControlName","departmentId",3,"options","placeholder","searchable","clearable"],["formControlName","managerEmployeeId",3,"options","placeholder","searchable","clearable"],[1,"d-flex","justify-content-end","gap-2","mt-4"],[1,"fa-solid","fa-times","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fa-solid","fa-save","me-2"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(i,s){i&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),l(4),a(),o(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),l(9),a()(),o(10,"li",4)(11,"a",6),l(12),a()(),o(13,"li",7),l(14),a()()()(),o(15,"button",8),h("click",function(){return s.onCancel()}),m(16,"i",9),l(17),a()(),c(18,H,4,1,"div",10)(19,se,156,109,"div",11)(20,pe,3,1,"div",12),a()),i&2&&(e(4),d(s.i18n.t("employees.edit_employee")),e(5),d(s.i18n.t("dashboard.title")),e(3),d(s.i18n.t("employees.title")),e(2),d(s.i18n.t("employees.edit_employee")),e(),x("disabled",s.saving()),e(2),_(" ",s.i18n.t("common.back")," "),e(),v(s.loading()?18:s.employee()?19:20))},dependencies:[S,A,T,q,w,P,B,k,L,O,j,M,D,R],encapsulation:2})};export{W as EditEmployeeComponent};
