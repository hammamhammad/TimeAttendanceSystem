import{a as pe}from"./chunk-DGBMBYUB.js";import{a as ce}from"./chunk-7YUBOVPA.js";import{a as de}from"./chunk-AVDFWZMN.js";import{a as me}from"./chunk-CARDG6TO.js";import{a as ve}from"./chunk-QPY65KO2.js";import{a as se}from"./chunk-NOJWDJOC.js";import"./chunk-4335LQ3A.js";import"./chunk-LDWMK676.js";import{a as re}from"./chunk-HCDX4O2L.js";import{A as ae,b as G,c as z,d as s,e as $,f as j,i as U,j as J,m as K,p as Q,q as W,r as X,t as Z,u as ee,v as te,x as ne,y as ie}from"./chunk-HF7V7ZC6.js";import{a as oe}from"./chunk-RUOWTK24.js";import"./chunk-HZR4WXEY.js";import{d as R,g as H}from"./chunk-O3U3HUCY.js";import{a as le}from"./chunk-77FC2LKR.js";import"./chunk-A6EM5NV6.js";import{$a as y,Bb as _,Eb as l,Fb as b,Gb as d,Ha as N,T as g,Wa as L,Y as P,Z as T,_a as f,bb as k,cb as V,db as Y,dc as q,eb as c,fa as x,fb as i,gb as o,hb as v,ob as A,qb as B,sb as p,wa as n}from"./chunk-IGEIB4M6.js";import"./chunk-YMDWBF3A.js";function fe(a,r){if(a&1&&v(0,"app-loading-spinner",2),a&2){let t=p();c("message",t.i18n.t("common.loading"))("centered",!0)}}function ye(a,r){if(a&1&&(i(0,"div",13),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.fieldRequired")," ")}}function ge(a,r){if(a&1&&(i(0,"div",13),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.fieldRequired")," ")}}function be(a,r){if(a&1&&(i(0,"option",18),l(1),o()),a&2){let t=r.$implicit;c("value",t),n(),b(t)}}function xe(a,r){if(a&1&&(i(0,"div",19),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.invalidYear")," ")}}function _e(a,r){if(a&1&&(i(0,"div",19),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.invalidDays")," ")}}function Ce(a,r){if(a&1&&(i(0,"div",19),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.invalidDays")," ")}}function he(a,r){if(a&1&&(i(0,"div",19),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.invalidDays")," ")}}function Ee(a,r){if(a&1&&(i(0,"div",19),l(1),o()),a&2){let t=p(2);n(),d(" ",t.i18n.t("errors.notesTooLong")," ")}}function De(a,r){a&1&&v(0,"span",40)}function Fe(a,r){if(a&1){let t=A();i(0,"div",3)(1,"div",4)(2,"form",5),B("ngSubmit",function(){P(t);let u=p();return T(u.onSubmit())}),i(3,"div",6)(4,"div",7)(5,"app-form-section",8)(6,"div",9)(7,"label",10),l(8),i(9,"span",11),l(10,"*"),o()(),v(11,"app-searchable-select",12),f(12,ye,2,1,"div",13),o(),i(13,"div",9)(14,"label",14),l(15),i(16,"span",11),l(17,"*"),o()(),v(18,"app-searchable-select",15),f(19,ge,2,1,"div",13),o(),i(20,"div",9)(21,"label",16),l(22),i(23,"span",11),l(24,"*"),o()(),i(25,"select",17),V(26,be,2,2,"option",18,k),o(),f(28,xe,2,1,"div",19),o(),i(29,"div",9)(30,"label",20),l(31),i(32,"span",11),l(33,"*"),o()(),v(34,"input",21),f(35,_e,2,1,"div",19),i(36,"div",22),l(37),o()()()(),i(38,"div",7)(39,"app-form-section",8)(40,"div",9)(41,"label",23),l(42),o(),i(43,"input",24),B("blur",function(){P(t);let u=p();return T(u.validateMaxCarryOver())}),o(),f(44,Ce,2,1,"div",19),i(45,"div",22),l(46),o()(),i(47,"div",9)(48,"label",25),l(49),o(),v(50,"input",26),f(51,he,2,1,"div",19),i(52,"div",22),l(53),o()(),i(54,"div",9)(55,"div",27),v(56,"input",28),i(57,"label",29),l(58),o()(),i(59,"div",22),l(60),o()()()()(),i(61,"app-form-section",8)(62,"div",6)(63,"div",7)(64,"div",9)(65,"label",30),l(66),o(),v(67,"input",31),i(68,"div",22),l(69),o()()(),i(70,"div",7)(71,"div",9)(72,"label",32),l(73),o(),v(74,"input",33),i(75,"div",22),l(76),o()()()()(),i(77,"app-form-section",8)(78,"div",9)(79,"label",34),l(80),o(),v(81,"textarea",35),f(82,Ee,2,1,"div",19),i(83,"small",36),l(84),o()()(),i(85,"div",37)(86,"button",38),B("click",function(){P(t);let u=p();return T(u.onCancel())}),l(87),o(),i(88,"button",39),f(89,De,1,0,"span",40),l(90),o()()()()()}if(a&2){let t,m,u,C,h,E,D,F,S,O,I,M,w,e=p();n(2),c("formGroup",e.entitlementForm),n(3),c("title",e.i18n.t("leaveBalance.basicInformation"))("description",e.i18n.t("leaveBalance.basicInformationDescription")),n(3),d(" ",e.i18n.t("employees.employee")," "),n(3),c("options",e.employees())("placeholder",e.i18n.t("leaveBalance.selectEmployee"))("disabled",e.isEditMode()),n(),y((t=e.entitlementForm.get("employeeId"))!=null&&t.invalid&&((t=e.entitlementForm.get("employeeId"))!=null&&t.touched)?12:-1),n(3),d(" ",e.i18n.t("vacationTypes.vacationType")," "),n(3),c("options",e.vacationTypes())("placeholder",e.i18n.t("leaveBalance.selectVacationType"))("disabled",e.isEditMode()),n(),y((m=e.entitlementForm.get("vacationTypeId"))!=null&&m.invalid&&((m=e.entitlementForm.get("vacationTypeId"))!=null&&m.touched)?19:-1),n(3),d(" ",e.i18n.t("leaveBalance.year")," "),n(3),_("is-invalid",((u=e.entitlementForm.get("year"))==null?null:u.invalid)&&((u=e.entitlementForm.get("year"))==null?null:u.touched)),L("disabled",e.isEditMode()?!0:null),n(),Y(e.availableYears()),n(2),y((C=e.entitlementForm.get("year"))!=null&&C.invalid&&((C=e.entitlementForm.get("year"))!=null&&C.touched)?28:-1),n(3),d(" ",e.i18n.t("leaveBalance.annualDays")," "),n(3),_("is-invalid",((h=e.entitlementForm.get("annualDays"))==null?null:h.invalid)&&((h=e.entitlementForm.get("annualDays"))==null?null:h.touched)),n(),y((E=e.entitlementForm.get("annualDays"))!=null&&E.invalid&&((E=e.entitlementForm.get("annualDays"))!=null&&E.touched)?35:-1),n(2),b(e.i18n.t("leaveBalance.annualDaysHelp")),n(2),c("title",e.i18n.t("leaveBalance.carryOverConfiguration"))("description",e.i18n.t("leaveBalance.carryOverConfigurationDescription")),n(3),d(" ",e.i18n.t("leaveBalance.carryOverDays")," "),n(),_("is-invalid",((D=e.entitlementForm.get("carryOverDays"))==null?null:D.invalid)&&((D=e.entitlementForm.get("carryOverDays"))==null?null:D.touched)),n(),y((F=e.entitlementForm.get("carryOverDays"))!=null&&F.invalid&&((F=e.entitlementForm.get("carryOverDays"))!=null&&F.touched)?44:-1),n(2),b(e.i18n.t("leaveBalance.carryOverDaysHelp")),n(3),d(" ",e.i18n.t("leaveBalance.maxCarryOverDays")," "),n(),_("is-invalid",((S=e.entitlementForm.get("maxCarryOverDays"))==null?null:S.invalid)&&((S=e.entitlementForm.get("maxCarryOverDays"))==null?null:S.touched)),c("placeholder",e.i18n.t("common.unlimited")),n(),y((O=e.entitlementForm.get("maxCarryOverDays"))!=null&&O.invalid&&((O=e.entitlementForm.get("maxCarryOverDays"))!=null&&O.touched)?51:-1),n(2),b(e.i18n.t("leaveBalance.maxCarryOverDaysHelp")),n(5),d(" ",e.i18n.t("leaveBalance.expiresAtYearEnd")," "),n(2),b(e.i18n.t("leaveBalance.expiresAtYearEndHelp")),n(),c("title",e.i18n.t("leaveBalance.effectiveDates"))("description",e.i18n.t("leaveBalance.effectiveDatesDescription")),n(5),d(" ",e.i18n.t("leaveBalance.effectiveStartDate")," "),n(3),b(e.i18n.t("leaveBalance.effectiveStartDateHelp")),n(4),d(" ",e.i18n.t("leaveBalance.effectiveEndDate")," "),n(3),b(e.i18n.t("leaveBalance.effectiveEndDateHelp")),n(),c("title",e.i18n.t("common.notes"))("description",e.i18n.t("leaveBalance.notesDescription")),n(3),d(" ",e.i18n.t("common.notes")," "),n(),_("is-invalid",((I=e.entitlementForm.get("notes"))==null?null:I.invalid)&&((I=e.entitlementForm.get("notes"))==null?null:I.touched)),c("placeholder",e.i18n.t("leaveBalance.notesPlaceholder")),n(),y((M=e.entitlementForm.get("notes"))!=null&&M.invalid&&((M=e.entitlementForm.get("notes"))!=null&&M.touched)?82:-1),n(2),d(" ",((w=e.entitlementForm.get("notes"))==null||w.value==null?null:w.value.length)||0," / 500 "),n(2),c("disabled",e.submitting()),n(),d(" ",e.i18n.t("common.cancel")," "),n(),c("disabled",e.submitting()||e.entitlementForm.invalid),n(),y(e.submitting()?89:-1),n(),d(" ",e.getSubmitButtonLabel()," ")}}var ue=class a{router=g(H);route=g(R);fb=g(ie);leaveBalanceService=g(pe);employeesService=g(se);vacationTypesService=g(ve);notificationService=g(oe);i18n=g(le);entitlementId=x(null);loading=x(!1);submitting=x(!1);isEditMode=q(()=>this.entitlementId()!==null);employees=x([]);vacationTypes=x([]);availableYears=x([]);entitlementForm;constructor(){this.entitlementForm=this.fb.group({employeeId:[null,[s.required]],vacationTypeId:[null,[s.required]],year:[new Date().getFullYear(),[s.required,s.min(2e3),s.max(2100)]],annualDays:[0,[s.required,s.min(0),s.max(365)]],carryOverDays:[0,[s.min(0),s.max(365)]],maxCarryOverDays:[null,[s.min(0),s.max(365)]],expiresAtYearEnd:[!0,[s.required]],effectiveStartDate:[null],effectiveEndDate:[null],notes:["",[s.maxLength(500)]]})}ngOnInit(){this.generateAvailableYears(),this.loadFormOptions(),this.route.params.subscribe(r=>{let t=r.id;t&&(this.entitlementId.set(+t),this.loadEntitlement(+t))})}generateAvailableYears(){let r=new Date().getFullYear(),t=[];for(let m=-5;m<=5;m++)t.push(r+m);this.availableYears.set(t)}loadFormOptions(){this.employeesService.getEmployees({pageSize:1e3}).subscribe({next:r=>{this.employees.set(r.items.map(t=>({value:t.id,label:`${t.employeeNumber} - ${t.fullName}`})))},error:r=>{console.error("Failed to load employees",r),this.notificationService.error(this.i18n.t("errors.loadEmployeesFailed"))}}),this.vacationTypesService.getVacationTypes({pageSize:1e3}).subscribe({next:r=>{this.vacationTypes.set(r.items.map(t=>({value:t.id,label:t.name})))},error:r=>{console.error("Failed to load vacation types",r),this.notificationService.error(this.i18n.t("errors.loadVacationTypesFailed"))}})}loadEntitlement(r){this.loading.set(!0),setTimeout(()=>{let t={employeeId:1,vacationTypeId:1,year:new Date().getFullYear(),annualDays:30,carryOverDays:5,maxCarryOverDays:10,expiresAtYearEnd:!1,effectiveStartDate:`${new Date().getFullYear()}-01-01`,effectiveEndDate:`${new Date().getFullYear()}-12-31`,notes:"Standard annual leave entitlement"};this.entitlementForm.patchValue(t),this.loading.set(!1)},500)}onSubmit(){if(this.entitlementForm.invalid){this.entitlementForm.markAllAsTouched(),this.notificationService.error(this.i18n.t("errors.formValidationFailed"));return}this.submitting.set(!0);let r={employeeId:this.entitlementForm.value.employeeId,vacationTypeId:this.entitlementForm.value.vacationTypeId,year:this.entitlementForm.value.year,annualDays:this.entitlementForm.value.annualDays,carryOverDays:this.entitlementForm.value.carryOverDays||0,maxCarryOverDays:this.entitlementForm.value.maxCarryOverDays,expiresAtYearEnd:this.entitlementForm.value.expiresAtYearEnd,effectiveStartDate:this.entitlementForm.value.effectiveStartDate,effectiveEndDate:this.entitlementForm.value.effectiveEndDate,notes:this.entitlementForm.value.notes||null};this.leaveBalanceService.setLeaveEntitlement(r).subscribe({next:t=>{this.submitting.set(!1);let m=this.isEditMode()?this.i18n.t("leaveBalance.entitlementUpdated"):this.i18n.t("leaveBalance.entitlementCreated");this.notificationService.success(m),this.router.navigate(["/settings/leave-entitlements"])},error:t=>{this.submitting.set(!1);let m=t.error?.message||this.i18n.t("errors.operationFailed");this.notificationService.error(m)}})}onCancel(){this.router.navigate(["/settings/leave-entitlements"])}getPageTitle(){return this.isEditMode()?this.i18n.t("leaveBalance.editEntitlement"):this.i18n.t("leaveBalance.createEntitlement")}getSubmitButtonLabel(){return this.isEditMode()?this.i18n.t("common.update"):this.i18n.t("common.create")}validateMaxCarryOver(){let r=this.entitlementForm.value.carryOverDays,t=this.entitlementForm.value.maxCarryOverDays;t!==null&&t<r&&this.entitlementForm.patchValue({maxCarryOverDays:r})}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=N({type:a,selectors:[["app-leave-entitlement-form"]],decls:4,vars:8,consts:[[1,"container-fluid"],[3,"title","subtitle","mode","moduleName","moduleRoute","entityId","loading"],[3,"message","centered"],[1,"card"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"row"],[1,"col-md-6"],[3,"title","description"],[1,"mb-3"],["for","employeeId",1,"form-label"],[1,"text-danger"],["formControlName","employeeId",3,"options","placeholder","disabled"],[1,"text-danger","small","mt-1"],["for","vacationTypeId",1,"form-label"],["formControlName","vacationTypeId",3,"options","placeholder","disabled"],["for","year",1,"form-label"],["id","year","formControlName","year",1,"form-select"],[3,"value"],[1,"invalid-feedback"],["for","annualDays",1,"form-label"],["type","number","id","annualDays","formControlName","annualDays","min","0","max","365","step","0.5","placeholder","30",1,"form-control"],[1,"form-text"],["for","carryOverDays",1,"form-label"],["type","number","id","carryOverDays","formControlName","carryOverDays","min","0","max","365","step","0.5","placeholder","0",1,"form-control",3,"blur"],["for","maxCarryOverDays",1,"form-label"],["type","number","id","maxCarryOverDays","formControlName","maxCarryOverDays","min","0","max","365","step","0.5",1,"form-control",3,"placeholder"],[1,"form-check","form-switch"],["type","checkbox","id","expiresAtYearEnd","formControlName","expiresAtYearEnd",1,"form-check-input"],["for","expiresAtYearEnd",1,"form-check-label"],["for","effectiveStartDate",1,"form-label"],["type","date","id","effectiveStartDate","formControlName","effectiveStartDate",1,"form-control"],["for","effectiveEndDate",1,"form-label"],["type","date","id","effectiveEndDate","formControlName","effectiveEndDate",1,"form-control"],["for","notes",1,"form-label"],["id","notes","formControlName","notes","rows","4","maxlength","500",1,"form-control",3,"placeholder"],[1,"text-muted"],[1,"d-flex","justify-content-end","gap-2","mt-4"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"]],template:function(t,m){t&1&&(i(0,"div",0),v(1,"app-form-header",1),f(2,fe,1,2,"app-loading-spinner",2)(3,Fe,91,57,"div",3),o()),t&2&&(n(),c("title",m.getPageTitle())("subtitle",m.i18n.t("leaveBalance.entitlementFormDescription"))("mode",m.isEditMode()?"edit":"create")("moduleName","leaveBalance")("moduleRoute","settings/leave-entitlements")("entityId",m.entitlementId()??void 0)("loading",m.submitting()),n(),y(m.loading()?2:3))},dependencies:[ae,U,X,Z,z,J,G,W,$,j,ne,te,ee,K,Q,ce,me,de,re],styles:[".container-fluid[_ngcontent-%COMP%]{padding:1.5rem;max-width:1200px;margin:0 auto}.row[_ngcontent-%COMP%]{margin-bottom:0}.g-3[_ngcontent-%COMP%]{--bs-gutter-x: 1rem;--bs-gutter-y: 1rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:.375rem;border:1px solid #ced4da;transition:border-color .15s ease-in-out,box-shadow .15s ease-in-out}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#80bdff;outline:0;box-shadow:0 0 0 .2rem #007bff40}.form-control[_ngcontent-%COMP%]:disabled, .form-select[_ngcontent-%COMP%]:disabled{background-color:#e9ecef;opacity:1}.form-control[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}.form-control[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .form-control[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.form-check-input[_ngcontent-%COMP%]{cursor:pointer;width:2.5rem;height:1.25rem}.form-check-label[_ngcontent-%COMP%]{cursor:pointer;font-weight:400;color:#495057}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#28a745;border-color:#28a745}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.text-muted[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d!important}.btn[_ngcontent-%COMP%]{border-radius:.375rem;font-weight:500;padding:.5rem 1.25rem;transition:all .15s ease-in-out}.btn[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.65}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;border-color:#007bff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3;border-color:#004085}.btn-outline-secondary[_ngcontent-%COMP%]{color:#6c757d;border-color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#6c757d;color:#fff}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem;border-width:.125rem}.gap-2[_ngcontent-%COMP%]{gap:.5rem}.spinner-border[_ngcontent-%COMP%]{width:3rem;height:3rem}small.text-muted[_ngcontent-%COMP%]{display:block;margin-top:.25rem}@media (max-width: 768px){.container-fluid[_ngcontent-%COMP%]{padding:1rem}.col-md-4[_ngcontent-%COMP%], .col-md-6[_ngcontent-%COMP%]{width:100%}.d-flex.gap-2[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}}"]})};export{ue as LeaveEntitlementFormComponent};
