import{a as Y}from"./chunk-4FEKP77N.js";import{a as W}from"./chunk-GWHM7BJD.js";import{a as z}from"./chunk-3IQ53VGU.js";import{a as N}from"./chunk-LCQOFV6P.js";import"./chunk-5BLMYARA.js";import{a as H}from"./chunk-CYQTDKAB.js";import"./chunk-SZUF4QIO.js";import{c as L,e as $,h as U,x as B}from"./chunk-7QCK55IR.js";import{b as j}from"./chunk-AS5QRUY4.js";import{$ as r,E as o,Ea as k,Fa as A,Ga as F,J as P,Sa as x,U as h,V as p,Y as w,Z as I,_ as M,aa as a,ba as u,fb as R,ia as T,ka as C,ma as m,qb as V,t as g,u as y,v as S,wa as s,xa as d,ya as b,z as _}from"./chunk-LDUBOZPL.js";import{a as D,b as E,d as O}from"./chunk-DGAILPFQ.js";var G=(n,e)=>e.id;function J(n,e){if(n&1&&(s(0),r(1,"strong"),s(2),a()),n&2){let i=m(2).$implicit,t=m(2);b(" ",t.t("settings.overtime.until")," "),o(2),d(t.formatDate(i.effectiveToDate))}}function K(n,e){if(n&1&&(r(0,"div",18),u(1,"i",19),r(2,"div",20)(3,"h6",2),s(4),a(),r(5,"p",21),s(6),r(7,"strong"),s(8),a(),h(9,J,3,2),a()()()),n&2){let i=m().$implicit,t=m(2);o(4),d(t.t("settings.overtime.activePolicyInfo")),o(2),b(" ",t.t("settings.overtime.currentlyActive")," "),o(2),d(t.formatDate(i.effectiveFromDate)),o(),p(i.effectiveToDate?9:-1)}}function Q(n,e){if(n&1&&h(0,K,10,4,"div",18),n&2){let i=e.$implicit;p(i.isActive?0:-1)}}function X(n,e){if(n&1&&w(0,Q,1,1,null,null,G),n&2){let i=m();I(i.configurations())}}function Z(n,e){if(n&1){let i=T();r(0,"button",22),C("click",function(){y(i);let c=m();return S(c.onClearFilters())}),u(1,"i",23),s(2),a()}if(n&2){let i=m();o(2),b(" ",i.t("common.clearFilters")," ")}}function ee(n,e){if(n&1){let i=T();r(0,"div",16)(1,"div",24)(2,"div",25),u(3,"i",26),a(),r(4,"h4",27),s(5),a(),r(6,"p",28),s(7),a(),r(8,"button",4),C("click",function(){y(i);let c=m();return S(c.onCreateConfiguration())}),u(9,"i",5),s(10),a()()()}if(n&2){let i=m();o(5),d(i.t("settings.overtime.noConfigurationsTitle")),o(2),d(i.t("settings.overtime.noConfigurationsMessage")),o(3),b(" ",i.t("settings.overtime.createFirstPolicy")," ")}}var q=class n{overtimeService=g(Y);router=g(V);notificationService=g(H);confirmationService=g(z);i18n=g(j);permissionService=g(N);PERMISSIONS={OVERTIME_CREATE:"settings.overtime.create",OVERTIME_READ:"settings.overtime.read",OVERTIME_UPDATE:"settings.overtime.update",OVERTIME_DELETE:"settings.overtime.delete",OVERTIME_ACTIVATE:"settings.overtime.activate"};loading=_(!1);configurations=_([]);searchTerm="";sortColumn=_("effectiveFromDate");sortDirection=_("desc");tableColumns=x(()=>[{key:"status",label:this.t("settings.overtime.status"),sortable:!1,width:"120px",align:"center",priority:"high",mobileLabel:this.t("settings.overtime.status"),renderHtml:!0},{key:"effectiveFromDate",label:this.t("settings.overtime.effectiveFrom"),sortable:!0,width:"150px",priority:"high",mobileLabel:this.t("settings.overtime.effectiveFrom")},{key:"effectiveToDate",label:this.t("settings.overtime.effectiveTo"),sortable:!0,width:"150px",priority:"medium",hideOnMobile:!1,mobileLabel:this.t("settings.overtime.effectiveTo")},{key:"rates",label:this.t("settings.overtime.rates"),sortable:!1,width:"200px",priority:"medium",hideOnMobile:!1,mobileLabel:this.t("settings.overtime.rates"),renderHtml:!0},{key:"settings",label:this.t("settings.overtime.configuration"),sortable:!1,width:"180px",priority:"low",hideOnMobile:!0,mobileLabel:this.t("settings.overtime.configuration"),renderHtml:!0},{key:"createdAtUtc",label:this.t("common.created"),sortable:!0,width:"150px",priority:"low",hideOnMobile:!0,mobileLabel:this.t("common.created")}]);tableActions=x(()=>[{key:"activate",label:this.t("settings.overtime.activate"),icon:"fa-play",color:"success",condition:e=>!e.isActive&&this.permissionService.has(this.PERMISSIONS.OVERTIME_ACTIVATE)},{key:"deactivate",label:this.t("settings.overtime.deactivate"),icon:"fa-pause",color:"warning",condition:e=>e.isActive&&this.permissionService.has(this.PERMISSIONS.OVERTIME_ACTIVATE)},{key:"edit",label:this.t("common.edit"),icon:"fa-edit",color:"secondary",condition:()=>this.permissionService.has(this.PERMISSIONS.OVERTIME_UPDATE)},{key:"delete",label:this.t("common.delete"),icon:"fa-trash",color:"danger",condition:e=>!e.isActive&&this.permissionService.has(this.PERMISSIONS.OVERTIME_DELETE)}]);tableData=x(()=>this.filteredConfigurations().map(e=>E(D({},e),{status:this.formatStatus(e),effectiveFromDate:this.formatDate(e.effectiveFromDate),effectiveToDate:e.effectiveToDate?this.formatDate(e.effectiveToDate):this.t("settings.overtime.indefinite"),rates:this.formatRates(e),settings:this.formatSettings(e),createdAtUtc:this.formatDate(e.createdAtUtc)})));ngOnInit(){this.loadConfigurations()}t(e){return this.i18n.t(e)}loadConfigurations(){this.loading.set(!0),this.overtimeService.getOvertimeConfigurations().subscribe({next:e=>{this.configurations.set(e),this.loading.set(!1)},error:e=>{console.error("Failed to load overtime configurations:",e),this.loading.set(!1),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})}formatDate(e){return new Date(e).toLocaleDateString(this.i18n.getCurrentLocale(),{year:"numeric",month:"short",day:"numeric"})}formatStatus(e){return e.isActive?`<span class="badge bg-success">${this.t("settings.overtime.active")}</span>`:`<span class="badge bg-light text-dark border">${this.t("settings.overtime.inactive")}</span>`}formatRates(e){return`<div class="small">
      <div><strong>${this.t("settings.overtime.normalDay")}:</strong> ${e.normalDayRate}x</div>
      <div><strong>${this.t("settings.overtime.holiday")}:</strong> ${e.publicHolidayRate}x</div>
      <div><strong>${this.t("settings.overtime.offDay")}:</strong> ${e.offDayRate}x</div>
    </div>`}formatSettings(e){let i=[];return e.enablePreShiftOvertime&&i.push(this.t("settings.overtime.preShift")),e.enablePostShiftOvertime&&i.push(this.t("settings.overtime.postShift")),e.considerFlexibleTime&&i.push(this.t("settings.overtime.flexibleTime")),e.requireApproval&&i.push(this.t("settings.overtime.requiresApproval")),`<div class="small">${i.join(", ")}</div>`}filteredConfigurations=x(()=>{let e=this.configurations();if(this.searchTerm?.trim()){let c=this.searchTerm.toLowerCase();e=e.filter(l=>l.policyNotes?.toLowerCase().includes(c)||l.createdBy?.toLowerCase().includes(c))}let i=this.sortColumn(),t=this.sortDirection();return e.sort((c,l)=>{let f=c[i],v=l[i];return i==="effectiveFromDate"||i==="effectiveToDate"||i==="createdAtUtc"?(f=new Date(f).getTime(),v=new Date(v).getTime()):typeof f=="string"&&(f=f.toLowerCase(),v=v.toLowerCase()),f<v?t==="asc"?-1:1:f>v?t==="asc"?1:-1:0})});onActionClick(e){let{action:i,item:t}=e;switch(i){case"activate":this.onActivateConfiguration(t);break;case"deactivate":this.onDeactivateConfiguration(t);break;case"edit":this.onEditConfiguration(t);break;case"delete":this.onDeleteConfiguration(t);break;default:console.warn("Unknown action:",i)}}onSearchChange(){setTimeout(()=>{},300)}onClearFilters(){this.searchTerm=""}hasActiveFilters(){return!!this.searchTerm}onCreateConfiguration(){this.router.navigate(["/settings/overtime/create"])}onEditConfiguration(e){this.router.navigate(["/settings/overtime/edit",e.id])}onActivateConfiguration(e){return O(this,null,function*(){(yield this.confirmationService.confirm({title:this.t("settings.overtime.activatePolicy"),message:this.t("settings.overtime.activatePolicyConfirmation"),confirmText:this.t("settings.overtime.activate"),cancelText:this.t("common.cancel"),confirmButtonClass:"btn-success",icon:"fa-play",iconClass:"text-success"})).confirmed&&this.overtimeService.activateOvertimeConfiguration(e.id).subscribe({next:()=>{this.loadConfigurations(),this.notificationService.success(this.t("app.success"),this.t("settings.overtime.policyActivatedSuccessfully"))},error:t=>{console.error("Failed to activate configuration:",t),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})})}onDeactivateConfiguration(e){return O(this,null,function*(){(yield this.confirmationService.confirm({title:this.t("settings.overtime.deactivatePolicy"),message:this.t("settings.overtime.deactivatePolicyConfirmation"),confirmText:this.t("settings.overtime.deactivate"),cancelText:this.t("common.cancel"),confirmButtonClass:"btn-warning",icon:"fa-pause",iconClass:"text-warning"})).confirmed&&this.overtimeService.deactivateOvertimeConfiguration(e.id).subscribe({next:()=>{this.loadConfigurations(),this.notificationService.success(this.t("app.success"),this.t("settings.overtime.policyDeactivatedSuccessfully"))},error:t=>{console.error("Failed to deactivate configuration:",t),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})})}onDeleteConfiguration(e){return O(this,null,function*(){(yield this.confirmationService.confirm({title:this.t("settings.overtime.deletePolicy"),message:this.t("settings.overtime.deletePolicyConfirmation"),confirmText:this.t("common.delete"),cancelText:this.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.overtimeService.deleteOvertimeConfiguration(e.id).subscribe({next:()=>{this.configurations.set(this.configurations().filter(t=>t.id!==e.id)),this.notificationService.success(this.t("app.success"),this.t("settings.overtime.policyDeletedSuccessfully"))},error:t=>{console.error("Failed to delete configuration:",t),this.notificationService.error(this.t("app.error"),this.t("errors.server"))}})})}canCreateConfigurations(){return this.permissionService.has(this.PERMISSIONS.OVERTIME_CREATE)}onSort(e){let i=this.sortColumn(),t=this.sortDirection();i===e?this.sortDirection.set(t==="asc"?"desc":"asc"):(this.sortColumn.set(e),this.sortDirection.set("asc"))}getSortIcon(e){let i=this.sortColumn(),t=this.sortDirection();return i!==e?"fas fa-sort text-muted":t==="asc"?"fas fa-sort-up text-primary":"fas fa-sort-down text-primary"}isSortable(e){return["effectiveFromDate","effectiveToDate","createdAtUtc"].includes(e)}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=P({type:n,selectors:[["app-overtime-configurations"]],decls:26,vars:14,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[1,"mb-1"],[1,"text-muted","mb-0"],[1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-plus","me-2"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-6"],[1,"input-group"],[1,"input-group-text"],[1,"fa-solid","fa-search"],["type","text",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"col-md-6","text-end"],[1,"btn","btn-outline-secondary"],[1,"card"],[3,"actionClick","data","columns","actions","loading","paginated","emptyMessage"],[1,"alert","alert-info","d-flex","align-items-center","mb-4"],[1,"fa-solid","fa-info-circle","me-3","fs-4"],[1,"flex-grow-1"],[1,"mb-0"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-times","me-1"],[1,"card-body","text-center","py-5"],[1,"mb-4"],[1,"fa-solid","fa-clock","display-1","text-muted"],[1,"text-muted","mb-3"],[1,"text-muted","mb-4"]],template:function(i,t){i&1&&(r(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),s(4),a(),r(5,"p",3),s(6),a()(),r(7,"div")(8,"button",4),C("click",function(){return t.onCreateConfiguration()}),u(9,"i",5),s(10),a()()(),h(11,X,2,0),r(12,"div",6)(13,"div",7)(14,"div",8)(15,"div",9)(16,"div",10)(17,"span",11),u(18,"i",12),a(),r(19,"input",13),F("ngModelChange",function(l){return A(t.searchTerm,l)||(t.searchTerm=l),l}),C("ngModelChange",function(){return t.onSearchChange()}),a()()(),r(20,"div",14),h(21,Z,3,1,"button",15),a()()()(),r(22,"div",16)(23,"div",7)(24,"app-data-table",17),C("actionClick",function(l){return t.onActionClick(l)}),a()()(),h(25,ee,11,3,"div",16),a()),i&2&&(o(4),d(t.t("settings.overtime.title")),o(2),d(t.t("settings.overtime.subtitle")),o(4),b(" ",t.t("settings.overtime.createPolicy")," "),o(),p(t.configurations().length>0?11:-1),o(8),k("ngModel",t.searchTerm),M("placeholder",t.t("settings.overtime.searchPlaceholder")),o(2),p(t.hasActiveFilters()?21:-1),o(3),M("data",t.tableData())("columns",t.tableColumns())("actions",t.tableActions())("loading",t.loading)("paginated",!0)("emptyMessage",t.t("settings.overtime.noConfigurations")),o(),p(!t.loading()&&t.configurations().length===0?25:-1))},dependencies:[R,B,L,$,U,W],styles:[".card[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.125);border-radius:.5rem;box-shadow:0 .125rem .25rem #00000013;transition:all .15s ease-in-out}.card[_ngcontent-%COMP%]:hover{box-shadow:0 .5rem 1rem #00000026}.alert[_ngcontent-%COMP%]{border-radius:.5rem;border:none}.alert-info[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1ecf1,#bee5eb);color:#0c5460}.btn[_ngcontent-%COMP%]{border-radius:.375rem;transition:all .15s ease-in-out}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.input-group[_ngcontent-%COMP%]{border-radius:.375rem;overflow:hidden}.input-group-text[_ngcontent-%COMP%]{background-color:#f8f9fa;border-color:#dee2e6}.form-control[_ngcontent-%COMP%]{border-color:#dee2e6}.form-control[_ngcontent-%COMP%]:focus{border-color:#86b7fe;box-shadow:0 0 0 .25rem #0d6efd40}.badge[_ngcontent-%COMP%]{font-size:.75em;padding:.35em .65em;border-radius:.375rem}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.display-1[_ngcontent-%COMP%]{font-size:6rem;font-weight:300;line-height:1.2}@media (max-width: 768px){.display-1[_ngcontent-%COMP%]{font-size:4rem}.d-flex.justify-content-between[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.text-end[_ngcontent-%COMP%]{text-align:start!important}}.fade-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.badge.bg-success[_ngcontent-%COMP%]{background-color:#198754!important}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;font-weight:600;color:#495057;background-color:#f8f9fa}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-right:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-right:0}"]})};export{q as OvertimeConfigurationsComponent};
