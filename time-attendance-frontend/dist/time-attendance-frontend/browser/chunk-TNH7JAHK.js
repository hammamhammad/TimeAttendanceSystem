import{a as G}from"./chunk-DNP7HDGU.js";import{a as U}from"./chunk-Y4G43P3P.js";import{a as w,b as R}from"./chunk-AYMGSBNU.js";import"./chunk-3BUDJKKE.js";import{b as j}from"./chunk-NJ656CWW.js";import{$ as o,E as i,J as k,U as _,V as x,Xa as N,Y as M,Z as T,_ as S,aa as l,ba as p,eb as O,ia as E,ka as f,ma as d,mb as A,pb as L,qb as B,t as v,u as g,v as b,va as r,vb as $,wa as m,xa as c,ya as D,z as C}from"./chunk-6T5SYK5O.js";import"./chunk-DGAILPFQ.js";var H=(n,e)=>e.key||e.id;function q(n,e){if(n&1){let t=E();o(0,"button",14),f("click",function(){g(t);let u=d();return b(u.onEdit())}),p(1,"i",15),r(2),l()}if(n&2){let t=d();i(2),c(" ",t.i18n.t("roles.edit")," ")}}function z(n,e){if(n&1&&(o(0,"div",12)(1,"div",16)(2,"span",17),r(3),l()()()),n&2){let t=d();i(3),m(t.i18n.t("common.loading"))}}function J(n,e){if(n&1&&p(0,"i",28),n&2){let t=d(2);S("title",t.i18n.t("roles.system_role"))}}function K(n,e){if(n&1&&(o(0,"span",34),r(1),l()),n&2){let t=d(2);i(),m(t.i18n.t("roles.system"))}}function Q(n,e){if(n&1&&(o(0,"span",35),r(1),l()),n&2){let t=d(2);i(),m(t.i18n.t("roles.custom"))}}function W(n,e){if(n&1){let t=E();o(0,"button",45),f("click",function(){g(t);let u=d(2);return b(u.onEdit())}),p(1,"i",15),r(2),l()}if(n&2){let t=d(2);i(2),c(" ",t.i18n.t("roles.edit")," ")}}function X(n,e){if(n&1){let t=E();o(0,"button",46),f("click",function(){g(t);let u=d(2);return b(u.onManagePermissions())}),p(1,"i",42),r(2),l()}if(n&2){let t=d(2);i(2),c(" ",t.i18n.t("roles.manage_permissions")," ")}}function Y(n,e){if(n&1&&(o(0,"div",47)(1,"div",48)(2,"div",49),p(3,"i",50),o(4,"div",51)(5,"div",52)(6,"small",53),r(7),l(),o(8,"span",54),r(9),l()(),o(10,"p",55),r(11),l()()()()()),n&2){let t=e.$implicit,a=d(3);i(3),S("ngClass",a.getPermissionIcon(t.key)),i(4),m(a.getPermissionResource(t.key)),i(),S("ngClass",a.getActionBadgeClass(t.key)),i(),c(" ",a.getPermissionAction(t.key)," "),i(2),c(" ",a.getPermissionDescription(t)," ")}}function Z(n,e){if(n&1&&(o(0,"div",43),M(1,Y,12,5,"div",47,H),l()),n&2){let t,a=d(2);i(),T((t=a.role())==null?null:t.permissions)}}function ee(n,e){if(n&1&&(o(0,"div",44),p(1,"i",56),o(2,"p",57),r(3),l()()),n&2){let t=d(2);i(3),m(t.i18n.t("roles.no_permissions"))}}function te(n,e){if(n&1&&(o(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"h5",22)(5,"div",23)(6,"div",24)(7,"div",25),p(8,"i",26),l()(),o(9,"div")(10,"div",27),r(11),_(12,J,1,1,"i",28),l(),o(13,"small",29),r(14),l()()()()(),o(15,"div",30)(16,"div",18)(17,"div",31)(18,"dl",18)(19,"dt",32),r(20),l(),o(21,"dd",33),r(22),l(),o(23,"dt",32),r(24),l(),o(25,"dd",33),_(26,K,2,1,"span",34)(27,Q,2,1,"span",35),l(),o(28,"dt",32),r(29),l(),o(30,"dd",33)(31,"span",36),r(32),l()()()(),o(33,"div",31)(34,"dl",18)(35,"dt",32),r(36),l(),o(37,"dd",33),r(38),l(),o(39,"dt",32),r(40),l(),o(41,"dd",33),r(42),l()()()()()()(),o(43,"div",37)(44,"div",20)(45,"div",21)(46,"h6",22),r(47),l()(),o(48,"div",30)(49,"div",38),_(50,W,3,1,"button",39),_(51,X,3,1,"button",40),l()()()()(),o(52,"div",41)(53,"div",21)(54,"h6",22),p(55,"i",42),r(56),l()(),o(57,"div",30),_(58,Z,3,0,"div",43)(59,ee,4,1,"div",44),l()()),n&2){let t,a,u,h,y,V,I,P,s=d();i(11),c(" ",(t=s.role())==null?null:t.name," "),i(),x((a=s.role())!=null&&a.isSystem?12:-1),i(2),D("",((u=s.role())==null||u.permissions==null?null:u.permissions.length)||0," ",s.i18n.t("roles.permissions_assigned")),i(6),c("",s.i18n.t("roles.name"),":"),i(2),m((h=s.role())==null?null:h.name),i(2),c("",s.i18n.t("roles.type"),":"),i(2),x((y=s.role())!=null&&y.isSystem?26:27),i(3),c("",s.i18n.t("roles.user_count"),":"),i(3),m(((V=s.role())==null?null:V.userCount)||0),i(4),c("",s.i18n.t("roles.created_at"),":"),i(2),m(s.formatDate(s.role().createdAtUtc)),i(2),c("",s.i18n.t("roles.permissions"),":"),i(2),m(((I=s.role())==null||I.permissions==null?null:I.permissions.length)||0),i(5),m(s.i18n.t("common.actions")),i(3),x(s.canEditRole()?50:-1),i(),x(s.canManagePermissions()?51:-1),i(5),c(" ",s.i18n.t("roles.permissions")," "),i(2),x((P=s.role())!=null&&P.permissions&&s.role().permissions.length>0?58:59)}}function ie(n,e){if(n&1&&(o(0,"div",13),p(1,"i",58),r(2),l()),n&2){let t=d();i(2),c(" ",t.error()||t.i18n.t("roles.role_not_found")," ")}}var F=class n{route=v(A);router=v(L);rolesService=v(G);i18n=v(j);permissionService=v(U);PERMISSIONS={ROLE_UPDATE:`${R.ROLE}.${w.UPDATE}`,ROLE_ASSIGN_PERMISSIONS:`${R.ROLE}.${w.ASSIGN_PERMISSION}`};role=C(null);loading=C(!0);error=C("");ngOnInit(){let e=this.route.snapshot.paramMap.get("id");e?this.loadRole(e):(this.error.set(this.i18n.t("roles.invalid_role_id")),this.loading.set(!1))}loadRole(e){this.rolesService.getRoleById(+e).subscribe({next:t=>{this.role.set(t),this.loading.set(!1)},error:t=>{this.error.set(this.getErrorMessage(t)),this.loading.set(!1)}})}canEditRole(){let e=this.role();return!e||!this.permissionService.has(this.PERMISSIONS.ROLE_UPDATE)?!1:e.isEditable}canManagePermissions(){let e=this.role();return!e||!this.permissionService.has(this.PERMISSIONS.ROLE_ASSIGN_PERMISSIONS)?!1:e.isEditable}onEdit(){this.canEditRole()&&this.router.navigate(["/roles",this.role().id,"edit"])}onManagePermissions(){this.canManagePermissions()&&this.router.navigate(["/roles",this.role().id,"edit"])}onBack(){this.router.navigate(["/roles"])}formatDate(e){return new Date(e).toLocaleDateString()}getPermissionIcon(e){return e.includes("read")?"fa-eye":e.includes("create")?"fa-plus":e.includes("update")?"fa-edit":e.includes("delete")?"fa-trash":"fa-key"}getPermissionResource(e){return e.split(".")[0]||e}getPermissionAction(e){return e.split(".")[1]||"unknown"}getActionBadgeClass(e){return e.includes("read")?"bg-info-subtle text-info":e.includes("create")?"bg-success-subtle text-success":e.includes("update")?"bg-warning-subtle text-warning":e.includes("delete")?"bg-danger-subtle text-danger":"bg-secondary-subtle text-secondary"}getPermissionDescription(e){return e.description||this.i18n.t("roles.no_description")}getErrorMessage(e){return e?.error?.error?e.error.error:this.i18n.t("errors.unknown")}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=k({type:n,selectors:[["app-view-role"]],decls:23,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/roles"],[1,"breadcrumb-item","active"],[1,"btn-group"],["type","button",1,"btn","btn-primary"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"alert","alert-danger"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-edit","me-2"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-title","bg-info-subtle","text-info","rounded-circle"],[1,"fa-solid","fa-user-shield"],[1,"fw-medium"],[1,"fa-solid","fa-shield-alt","text-primary","ms-2",3,"title"],[1,"text-muted"],[1,"card-body"],[1,"col-md-6"],[1,"col-sm-5"],[1,"col-sm-7"],[1,"badge","bg-warning-subtle","text-warning"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary"],[1,"col-lg-4"],[1,"d-grid","gap-2"],["type","button",1,"btn","btn-outline-primary"],["type","button",1,"btn","btn-outline-info"],[1,"card","mt-4"],[1,"fa-solid","fa-key","me-2"],[1,"row","g-2"],[1,"text-center","py-4"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-outline-info",3,"click"],[1,"col-md-6","col-lg-4"],[1,"permission-item","border","rounded","p-2"],[1,"d-flex","align-items-start"],[1,"fas","me-2","text-muted","mt-1",3,"ngClass"],[1,"flex-grow-1"],[1,"d-flex","align-items-center","mb-1"],[1,"fw-medium","me-2"],[1,"badge",3,"ngClass"],[1,"text-muted","small","mb-0"],[1,"fa-solid","fa-key","fa-2x","text-muted","mb-2"],[1,"text-muted","mb-0"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(t,a){t&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),r(4),l(),o(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),r(9),l()(),o(10,"li",4)(11,"a",6),r(12),l()(),o(13,"li",7),r(14),l()()()(),o(15,"div",8),_(16,q,3,1,"button",9),o(17,"button",10),f("click",function(){return a.onBack()}),p(18,"i",11),r(19),l()()(),_(20,z,4,1,"div",12)(21,te,60,19)(22,ie,3,1,"div",13),l()),t&2&&(i(4),m(a.i18n.t("roles.view_details")),i(5),m(a.i18n.t("dashboard.title")),i(3),m(a.i18n.t("roles.title")),i(2),m(a.i18n.t("roles.view_details")),i(2),x(a.canEditRole()?16:-1),i(3),c(" ",a.i18n.t("common.back")," "),i(),x(a.loading()?20:a.role()?21:22))},dependencies:[O,N,$,B],encapsulation:2})};export{F as ViewRoleComponent};
