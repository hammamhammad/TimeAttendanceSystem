import{a as B}from"./chunk-H3Z5YLEO.js";import{a as O}from"./chunk-K7WTKFJQ.js";import{a as N}from"./chunk-MRHL7QNZ.js";import{a as V}from"./chunk-AY3UTFSR.js";import"./chunk-HUSARQNL.js";import{a as T}from"./chunk-H5EPUHY6.js";import{a as q}from"./chunk-UBCI4X5Q.js";import{a as R}from"./chunk-EYAJMHM7.js";import{a as k}from"./chunk-HHXRLUSQ.js";import{b as M}from"./chunk-RUY4WPQA.js";import{d as I,g as S}from"./chunk-TWXUAMJ4.js";import{Bb as c,Cb as P,Db as m,Ea as D,R as _,W as g,X as v,Xa as u,Ya as p,Yb as f,bb as d,cb as a,da as h,db as o,eb as r,lb as b,nb as C,pb as s,ra as E,ta as i,wc as w}from"./chunk-JSQL33QG.js";import{d as y}from"./chunk-DGAILPFQ.js";function W(n,t){if(n&1&&r(0,"app-loading-spinner",0),n&2){let e=s();d("message",e.i18n.t("common.loading"))}}function j(n,t){if(n&1){let e=b();a(0,"div",1),r(1,"i",3),c(2),a(3,"button",4),C("click",function(){g(e);let x=s();return v(x.onBack())}),c(4),o()()}if(n&2){let e=s();i(2),m(" ",e.error()," "),i(2),m(" ",e.i18n.t("common.back")," ")}}function U(n,t){if(n&1){let e=b();a(0,"button",19),C("click",function(){g(e);let x=s(2);return v(x.onEdit())}),r(1,"i",20),c(2),o()}if(n&2){let e=s(2);i(2),m(" ",e.i18n.t("common.edit")," ")}}function A(n,t){if(n&1){let e=b();a(0,"button",21),C("click",function(){g(e);let x=s(2);return v(x.onCancel())}),r(1,"i",22),c(2),o()}if(n&2){let e=s(2);i(2),m(" ",e.i18n.t("common.cancel")," ")}}function F(n,t){if(n&1&&(a(0,"app-detail-card",15)(1,"div",23),r(2,"i",24),a(3,"a",25),c(4),r(5,"i",26),o()()()),n&2){let e=s(2);d("title",e.i18n.t("portal.attachment")),i(3),d("href",e.excuse().attachmentUrl,E),i(),m(" ",e.i18n.t("portal.view_attachment")," ")}}function Y(n,t){if(n&1&&(a(0,"div",16),r(1,"i",27),c(2),o()),n&2){let e=s(2);i(2),m(" ",e.i18n.t("portal.excuse_approved_message")," ")}}function z(n,t){if(n&1&&(a(0,"div",17),r(1,"i",28),c(2),o()),n&2){let e=s(2);i(2),m(" ",e.i18n.t("portal.excuse_rejected_message")," ")}}function H(n,t){if(n&1&&(a(0,"div",18),r(1,"i",29),c(2),o()),n&2){let e=s(2);i(2),m(" ",e.i18n.t("portal.excuse_pending_message")," ")}}function $(n,t){if(n&1){let e=b();a(0,"div",2)(1,"app-page-header",5)(2,"div",6),u(3,U,3,1,"button",7),u(4,A,3,1,"button",8),a(5,"button",9),C("click",function(){g(e);let x=s();return v(x.onBack())}),r(6,"i",10),c(7),o()()(),a(8,"div",11)(9,"label",12),c(10),o(),r(11,"app-status-badge",13),o(),a(12,"app-detail-card",5),r(13,"app-definition-list",14),o(),a(14,"app-detail-card",15),r(15,"app-definition-list",14),o(),u(16,F,6,3,"app-detail-card",15),u(17,Y,3,1,"div",16)(18,z,3,1,"div",17)(19,H,3,1,"div",18),o()}if(n&2){let e=s();i(),d("title",e.i18n.t("portal.excuse_details")),i(2),p(e.canEdit()?3:-1),i(),p(e.canCancel()?4:-1),i(3),m(" ",e.i18n.t("common.back")," "),i(3),P(e.i18n.t("portal.status")),i(),d("status",e.statusBadge().label)("variant",e.statusBadge().variant),i(),d("title",e.i18n.t("portal.request_details")),i(),d("items",e.basicInfoItems())("labelWidth","4")("valueWidth","8"),i(),d("title",e.i18n.t("portal.submission_information")),i(),d("items",e.submissionInfoItems())("labelWidth","4")("valueWidth","8"),i(),p(e.excuse().attachmentUrl?16:-1),i(),p(e.excuse().status==="Approved"?17:e.excuse().status==="Rejected"?18:e.excuse().status==="Pending"?19:-1)}}var L=class n{i18n=_(M);router=_(S);route=_(I);excuseService=_(V);notificationService=_(k);confirmationService=_(T);excuse=h(null);loading=h(!0);error=h(null);statusBadge=f(()=>{let t=this.excuse();if(!t)return{label:"",variant:"secondary"};switch(t.status){case"Pending":return{label:"Pending",variant:"warning"};case"Approved":return{label:"Approved",variant:"success"};case"Rejected":return{label:"Rejected",variant:"danger"};case"Cancelled":return{label:"Cancelled",variant:"secondary"};default:return{label:t.status,variant:"secondary"}}});basicInfoItems=f(()=>{let t=this.excuse();return t?[{label:this.i18n.t("portal.excuse_date"),value:this.formatDate(t.excuseDate)},{label:this.i18n.t("portal.excuse_type"),value:this.getExcuseTypeLabel(t.excuseType)},{label:this.i18n.t("portal.start_time"),value:t.startTime.substring(0,5)},{label:this.i18n.t("portal.end_time"),value:t.endTime.substring(0,5)},{label:this.i18n.t("portal.duration"),value:`${t.durationHours.toFixed(1)} hours`},{label:this.i18n.t("portal.reason"),value:t.reason||this.i18n.t("common.not_provided")}]:[]});submissionInfoItems=f(()=>{let t=this.excuse();if(!t)return[];let e=[{label:this.i18n.t("portal.submission_date"),value:this.formatDateTime(t.submissionDate)}];return t.reviewDate&&e.push({label:this.i18n.t("portal.review_date"),value:this.formatDateTime(t.reviewDate)}),t.reviewerName&&e.push({label:this.i18n.t("portal.reviewed_by"),value:t.reviewerName}),t.reviewerComments&&e.push({label:this.i18n.t("portal.reviewer_comments"),value:t.reviewerComments}),e});canEdit=f(()=>{let t=this.excuse();return t&&t.status==="Pending"});canCancel=f(()=>{let t=this.excuse();return t&&t.status==="Pending"});ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t&&this.loadExcuse(+t)}loadExcuse(t){this.loading.set(!0),this.error.set(null),this.excuseService.getEmployeeExcuseById(t).subscribe({next:e=>{e?this.excuse.set(e):this.error.set(this.i18n.t("portal.excuse_not_found")),this.loading.set(!1)},error:e=>{console.error("Failed to load excuse:",e),this.error.set(this.i18n.t("portal.failed_to_load_excuse")),this.loading.set(!1)}})}onEdit(){let t=this.excuse();t&&this.router.navigate(["/portal/excuse-requests",t.id,"edit"])}onCancel(){return y(this,null,function*(){let t=this.excuse();if(!t)return;(yield this.confirmationService.confirm({title:this.i18n.t("portal.cancel_excuse"),message:this.i18n.t("portal.cancel_excuse_confirm"),confirmText:this.i18n.t("common.yes_cancel"),cancelText:this.i18n.t("common.no"),confirmButtonClass:"btn-danger",icon:"fa-times",iconClass:"text-danger"})).confirmed&&this.excuseService.cancelEmployeeExcuse(t.id).subscribe({next:()=>{this.notificationService.success(this.i18n.t("portal.excuse_cancelled")),this.router.navigate(["/portal/excuse-requests"])},error:l=>{console.error("Failed to cancel excuse:",l),this.notificationService.error(this.i18n.t("portal.failed_to_cancel_excuse"))}})})}onBack(){this.router.navigate(["/portal/excuse-requests"])}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}formatDateTime(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}getExcuseTypeLabel(t){switch(t){case"PersonalExcuse":return this.i18n.t("portal.personal_excuse");case"OfficialDuty":return this.i18n.t("portal.official_duty");default:return t}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["app-portal-excuse-request-details"]],decls:3,vars:3,consts:[[3,"message"],[1,"alert","alert-danger"],[1,"excuse-details"],[1,"fa-solid","fa-exclamation-triangle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-danger","ms-3",3,"click"],[3,"title"],["header-actions",""],["type","button",1,"btn","btn-primary","btn-sm","me-2"],["type","button",1,"btn","btn-danger","btn-sm","me-2"],["type","button",1,"btn","btn-outline-secondary","btn-sm",3,"click"],[1,"fa-solid","fa-arrow-left","me-1"],[1,"status-section","mb-4"],[1,"status-label"],[3,"status","variant"],[3,"items","labelWidth","valueWidth"],[1,"mt-3",3,"title"],[1,"alert","alert-success","mt-3"],[1,"alert","alert-danger","mt-3"],[1,"alert","alert-warning","mt-3"],["type","button",1,"btn","btn-primary","btn-sm","me-2",3,"click"],[1,"fa-solid","fa-edit","me-1"],["type","button",1,"btn","btn-danger","btn-sm","me-2",3,"click"],[1,"fa-solid","fa-times","me-1"],[1,"attachment-section"],[1,"fa-solid","fa-file","me-2","text-primary"],["target","_blank","rel","noopener noreferrer",1,"attachment-link",3,"href"],[1,"fa-solid","fa-external-link-alt","ms-1"],[1,"fa-solid","fa-check-circle","me-2"],[1,"fa-solid","fa-times-circle","me-2"],[1,"fa-solid","fa-clock","me-2"]],template:function(e,l){e&1&&(u(0,W,1,1,"app-loading-spinner",0),u(1,j,5,2,"div",1),u(2,$,20,17,"div",2)),e&2&&(p(l.loading()?0:-1),i(),p(l.error()&&!l.loading()?1:-1),i(),p(l.excuse()&&!l.loading()&&!l.error()?2:-1))},dependencies:[w,q,R,O,N,B],styles:[".excuse-details[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto;padding:1.5rem}.status-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem;background-color:var(--bs-light);border-radius:.5rem}.status-label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:0;color:var(--bs-secondary)}.attachment-section[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.75rem;background-color:var(--bs-light);border-radius:.375rem}.attachment-link[_ngcontent-%COMP%]{color:var(--bs-primary);text-decoration:none;font-weight:500;transition:color .2s ease}.attachment-link[_ngcontent-%COMP%]:hover{color:var(--bs-primary);text-decoration:underline}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;border-radius:.5rem}.alert[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}@media (max-width: 768px){.excuse-details[_ngcontent-%COMP%]{padding:1rem}.status-section[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.excuse-details[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 8px #00000026;transition:all .2s ease}"]})};export{L as PortalExcuseRequestDetailsComponent};
