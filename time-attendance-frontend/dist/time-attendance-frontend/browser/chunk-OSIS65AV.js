import{a as re,b as oe,c as ae}from"./chunk-OTYH7YON.js";import{a as se}from"./chunk-635VP34W.js";import{a as ne}from"./chunk-ASABUVRV.js";import{a as ie}from"./chunk-JTZMRZUG.js";import{a as N}from"./chunk-GC2ZOSF6.js";import{a as w,b as E}from"./chunk-5BLMYARA.js";import"./chunk-O7VLIHRG.js";import{b as L,c as z,e as U,f as j,g as G,h as J,i as K,j as Q,k as X,r as Y,s as Z,t as $,w as ee}from"./chunk-UWMUXUZF.js";import{b as te}from"./chunk-MCSGSJCX.js";import{Ba as v,C as i,Ca as S,Da as b,H as q,Ia as A,L as p,Va as B,Wa as D,X as m,Y as r,Z as s,_ as x,ab as R,fa as y,ha as c,ja as h,lb as W,oa as O,pa as P,ra as H,s as F,sa as d,t as g,ta as f,u as _,ua as u,va as I,y as C,za as V}from"./chunk-H3A4D7EH.js";import"./chunk-DGAILPFQ.js";var le=()=>({standalone:!0});function me(a,n){if(a&1){let e=y();r(0,"button",49),c("click",function(){g(e);let o=h();return _(o.onCreateShift())}),x(1,"i",50),d(2),s()}if(a&2){let e=h();i(2),u("",e.t("shifts.actions.create")," ")}}function he(a,n){if(a&1&&(r(0,"div",51)(1,"div",52)(2,"span",53),d(3),s()()()),a&2){let e=h();i(3),f(e.t("common.loading"))}}function fe(a,n){if(a&1&&(r(0,"small",64),d(1),s()),a&2){let e=h().$implicit;i(),u(" ",e.description," ")}}function ce(a,n){if(a&1&&(r(0,"span",67),d(1),s()),a&2){let e=h(5);i(),f(e.t("shifts.nightShift"))}}function ue(a,n){if(a&1&&(r(0,"div",60),d(1),p(2,ce,2,1,"span",66),s()),a&2){let e=n.$implicit,t=h(4);i(),I(" ",t.formatTime(e.startTime)," - ",t.formatTime(e.endTime)," "),i(),m("ngIf",e.isNightPeriod)}}function pe(a,n){if(a&1&&(r(0,"div"),p(1,ue,3,3,"div",65),s()),a&2){let e=h().$implicit;i(),m("ngForOf",e.shiftPeriods)}}function ge(a,n){if(a&1&&(r(0,"div"),d(1),s()),a&2){let e=h().$implicit,t=h(2);i(),I(" ",e.requiredHours," ",t.t("shifts.hours")," ")}}function _e(a,n){if(a&1&&(r(0,"div"),x(1,"i",68),d(2),s()),a&2){let e=h(3);i(2),u("",e.t("shifts.checkInRequired")," ")}}function ve(a,n){if(a&1&&(r(0,"div"),x(1,"i",68),d(2),s()),a&2){let e=h(3);i(2),u("",e.t("shifts.autoCheckOut")," ")}}function Se(a,n){if(a&1&&(r(0,"div"),x(1,"i",68),d(2),s()),a&2){let e=h(3);i(2),u("",e.t("shifts.flexibleHours")," ")}}function be(a,n){if(a&1&&(r(0,"div"),x(1,"i",69),d(2),s()),a&2){let e=h().$implicit,t=h(2);i(2),I("",e.gracePeriodMinutes,"min ",t.t("shifts.gracePeriod")," ")}}function xe(a,n){if(a&1){let e=y();r(0,"button",70),c("click",function(){g(e);let o=h().$implicit,l=h(2);return _(l.onEditShift(o))}),x(1,"i",71),s()}if(a&2){let e=h(3);m("title",e.t("common.edit"))}}function Ce(a,n){if(a&1){let e=y();r(0,"button",72),c("click",function(){g(e);let o=h().$implicit,l=h(2);return _(l.onDeleteShift(o))}),x(1,"i",73),s()}if(a&2){let e=h(3);m("title",e.t("common.delete"))}}function ye(a,n){if(a&1&&(r(0,"tr")(1,"td")(2,"div")(3,"strong"),d(4),s(),p(5,fe,2,1,"small",58),s()(),r(6,"td")(7,"span",59),d(8),s()(),r(9,"td")(10,"span",59),d(11),s()(),r(12,"td"),p(13,pe,2,1,"div",19)(14,ge,2,2,"div",19),s(),r(15,"td")(16,"div",60),p(17,_e,3,1,"div",19)(18,ve,3,1,"div",19)(19,Se,3,1,"div",19)(20,be,3,2,"div",19),s()(),r(21,"td")(22,"div",61),p(23,xe,2,1,"button",62)(24,Ce,2,1,"button",63),s()()()),a&2){let e=n.$implicit,t=h(2);i(4),f(e.name),i(),m("ngIf",e.description),i(2),H(t.getShiftStatusClass(e.status)),i(),u(" ",t.getShiftStatusText(e.status)," "),i(2),H(e.shiftType===t.ShiftType.TimeBased?"bg-primary":"bg-info"),i(),u(" ",t.getShiftTypeText(e.shiftType)," "),i(2),m("ngIf",e.shiftType===t.ShiftType.TimeBased),i(),m("ngIf",e.shiftType===t.ShiftType.HoursOnly),i(3),m("ngIf",e.isCheckInRequired),i(),m("ngIf",e.isAutoCheckOut),i(),m("ngIf",e.allowFlexibleHours),i(),m("ngIf",e.gracePeriodMinutes),i(3),m("appHasPermission",t.PERMISSIONS.SHIFT_UPDATE),i(),m("appHasPermission",t.PERMISSIONS.SHIFT_DELETE)}}function Te(a,n){if(a&1&&(r(0,"div",51),x(1,"i",74),r(2,"h5",75),d(3),s(),r(4,"p",75),d(5),s()()),a&2){let e=h(2);i(3),f(e.t("shifts.noShifts")),i(2),f(e.t("shifts.noShiftsDescription"))}}function Me(a,n){if(a&1){let e=y();r(0,"li",78)(1,"button",81),c("click",function(){let o=g(e).$implicit,l=h(3);return _(l.onPageChange(o))}),d(2),s()()}if(a&2){let e=n.$implicit,t=h(3);P("active",e===t.currentPage()),i(2),f(e)}}function Fe(a,n){if(a&1){let e=y();r(0,"nav",76)(1,"div",75),d(2),s(),r(3,"ul",77)(4,"li",78)(5,"button",79),c("click",function(){g(e);let o=h(2);return _(o.onPageChange(o.currentPage()-1))}),d(6),s()(),p(7,Me,3,3,"li",80),r(8,"li",78)(9,"button",79),c("click",function(){g(e);let o=h(2);return _(o.onPageChange(o.currentPage()+1))}),d(10),s()()()()}if(a&2){let e=h(2);i(2),V(" ",e.t("common.showing")," ",(e.currentPage()-1)*e.pageSize()+1," - ",e.getEndCount()," ",e.t("common.of")," ",e.totalCount()," ",e.t("common.results")," "),i(2),P("disabled",e.currentPage()===1),i(),m("disabled",e.currentPage()===1),i(),u(" ",e.t("common.previous")," "),i(),m("ngForOf",e.getPaginationArray()),i(),P("disabled",e.currentPage()===e.totalPages()),i(),m("disabled",e.currentPage()===e.totalPages()),i(),u(" ",e.t("common.next")," ")}}function Pe(a,n){if(a&1&&(r(0,"div")(1,"div",54)(2,"table",55)(3,"thead")(4,"tr")(5,"th"),d(6),s(),r(7,"th"),d(8),s(),r(9,"th"),d(10),s(),r(11,"th"),d(12),s(),r(13,"th"),d(14),s(),r(15,"th"),d(16),s()()(),r(17,"tbody"),p(18,ye,25,16,"tr",56),s()()(),p(19,Te,6,2,"div",18)(20,Fe,11,15,"nav",57),s()),a&2){let e=h();i(6),f(e.t("shifts.fields.name")),i(2),f(e.t("shifts.fields.status")),i(2),f(e.t("shifts.fields.type")),i(2),f(e.t("shifts.fields.periods")),i(2),f(e.t("shifts.fields.requirements")),i(2),f(e.t("common.actions")),i(2),m("ngForOf",e.shifts()),i(),m("ngIf",e.shifts().length===0),i(),m("ngIf",e.totalPages()>1)}}function we(a,n){if(a&1){let e=y();r(0,"div",27)(1,"label",28),d(2),s(),r(3,"div",11)(4,"input",82),b("ngModelChange",function(o){g(e);let l=h();return S(l.shiftForm.requiredHours,o)||(l.shiftForm.requiredHours=o),_(o)}),s(),r(5,"span",83),d(6),s()()()}if(a&2){let e=h();i(2),f(e.t("shifts.fields.requiredHours")),i(2),v("ngModel",e.shiftForm.requiredHours),i(2),f(e.t("shifts.hours"))}}function Ee(a,n){if(a&1){let e=y();r(0,"div",94)(1,"div",95)(2,"div",84)(3,"h6",4),d(4),s(),r(5,"button",96),c("click",function(){let o=g(e).index,l=h(2);return _(l.removeShiftPeriod(o))}),x(6,"i",73),s()(),r(7,"div",32)(8,"div",33)(9,"label",10),d(10),s(),r(11,"input",97),b("ngModelChange",function(o){let l=g(e).$implicit;return S(l.startTime,o)||(l.startTime=o),_(o)}),s()(),r(12,"div",33)(13,"label",10),d(14),s(),r(15,"input",97),b("ngModelChange",function(o){let l=g(e).$implicit;return S(l.endTime,o)||(l.endTime=o),_(o)}),s()()()()()}if(a&2){let e=n.$implicit,t=n.index,o=h(2);i(4),I("",o.t("shifts.period")," ",e.periodOrder),i(),m("disabled",o.shiftForm.shiftPeriods.length<=1),i(5),f(o.t("shifts.fields.startTime")),i(),v("ngModel",e.startTime),m("name","startTime"+t),i(3),f(o.t("shifts.fields.endTime")),i(),v("ngModel",e.endTime),m("name","endTime"+t)}}function Ie(a,n){if(a&1){let e=y();r(0,"div",32)(1,"div",33)(2,"label",10),d(3),s(),r(4,"div",11)(5,"input",98),b("ngModelChange",function(o){g(e);let l=h(2);return S(l.shiftForm.flexMinutesBefore,o)||(l.shiftForm.flexMinutesBefore=o),_(o)}),s(),r(6,"span",83),d(7),s()()(),r(8,"div",33)(9,"label",10),d(10),s(),r(11,"div",11)(12,"input",99),b("ngModelChange",function(o){g(e);let l=h(2);return S(l.shiftForm.flexMinutesAfter,o)||(l.shiftForm.flexMinutesAfter=o),_(o)}),s(),r(13,"span",83),d(14),s()()()()}if(a&2){let e=h(2);i(3),f(e.t("shifts.fields.flexMinutesBefore")),i(2),v("ngModel",e.shiftForm.flexMinutesBefore),i(2),f(e.t("common.minutes")),i(3),f(e.t("shifts.fields.flexMinutesAfter")),i(2),v("ngModel",e.shiftForm.flexMinutesAfter),i(2),f(e.t("common.minutes"))}}function ke(a,n){if(a&1&&(r(0,"small",100),x(1,"i",101),d(2),s()),a&2){let e=h(2);i(2),u("",e.t("shifts.validation.flexibleHoursAndGraceCombined")," ")}}function Oe(a,n){if(a&1){let e=y();r(0,"div")(1,"div",27)(2,"div",84)(3,"label",28),d(4),s(),r(5,"button",85),c("click",function(){g(e);let o=h();return _(o.addShiftPeriod())}),x(6,"i",86),d(7),s()(),p(8,Ee,16,9,"div",87),s(),r(9,"div",27)(10,"div",88)(11,"input",89),b("ngModelChange",function(o){g(e);let l=h();return S(l.shiftForm.allowFlexibleHours,o)||(l.shiftForm.allowFlexibleHours=o),_(o)}),c("change",function(){g(e);let o=h();return _(o.onFlexibleHoursChange())}),s(),r(12,"label",36),d(13),s(),r(14,"small",37),d(15),s()(),p(16,Ie,15,6,"div",90),s(),r(17,"div",27)(18,"label",10),d(19),s(),r(20,"div",11)(21,"input",91),b("ngModelChange",function(o){g(e);let l=h();return S(l.shiftForm.gracePeriodMinutes,o)||(l.shiftForm.gracePeriodMinutes=o),_(o)}),s(),r(22,"span",83),d(23),s()(),r(24,"small",92),d(25),s(),p(26,ke,3,1,"small",93),s()()}if(a&2){let e=h();i(4),f(e.t("shifts.fields.periods")),i(),m("disabled",e.shiftForm.shiftPeriods.length>=2),i(2),u("",e.t("shifts.addPeriod")," "),i(),m("ngForOf",e.shiftForm.shiftPeriods),i(3),v("ngModel",e.shiftForm.allowFlexibleHours),i(2),u(" ",e.t("shifts.fields.allowFlexibleHours")," "),i(2),f(e.t("shifts.flexibleHoursDescription")),i(),m("ngIf",e.shiftForm.allowFlexibleHours),i(3),f(e.t("shifts.fields.gracePeriod")),i(2),v("ngModel",e.shiftForm.gracePeriodMinutes),i(2),f(e.t("common.minutes")),i(2),f(e.t("shifts.gracePeriodDescription")),i(),m("ngIf",e.shiftForm.allowFlexibleHours&&e.shiftForm.gracePeriodMinutes)}}function He(a,n){a&1&&x(0,"span",102)}function Ae(a,n){if(a&1&&(r(0,"p")(1,"strong"),d(2),s()()),a&2){let e,t=h();i(2),f((e=t.selectedShift())==null?null:e.name)}}function qe(a,n){a&1&&x(0,"span",102)}function Ve(a,n){if(a&1){let e=y();r(0,"div",103),c("click",function(){g(e);let o=h();return _(o.onCloseModal())}),s()}}var de=class a{shiftsService=F(re);branchesService=F(se);router=F(W);i18n=F(te);permissionService=F(N);PERMISSIONS={SHIFT_CREATE:`${E.SHIFT}.${w.CREATE}`,SHIFT_READ:`${E.SHIFT}.${w.READ}`,SHIFT_UPDATE:`${E.SHIFT}.${w.UPDATE}`,SHIFT_DELETE:`${E.SHIFT}.${w.DELETE}`,SHIFT_MANAGE:`${E.SHIFT}.${w.MANAGE}`};ShiftType=oe;ShiftStatus=ae;get pageSizeSelectOptions(){return[{value:"10",label:"10"},{value:"25",label:"25"},{value:"50",label:"50"}]}get statusSelectOptions(){return[{value:1 .toString(),label:this.t("shifts.status.active")},{value:2 .toString(),label:this.t("shifts.status.inactive")},{value:3 .toString(),label:this.t("shifts.status.draft")},{value:4 .toString(),label:this.t("shifts.status.archived")}]}loading=C(!1);shifts=C([]);branches=C([]);currentPage=C(1);pageSize=C(10);totalCount=C(0);totalPages=C(0);searchTerm="";branchFilter=void 0;showCreateModal=C(!1);showEditModal=C(!1);showDeleteModal=C(!1);selectedShift=C(null);shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,shiftPeriods:[]};submitting=C(!1);ngOnInit(){this.loadBranches(),this.loadShifts()}t(n){return this.i18n.t(n)}loadBranches(){this.branchesService.getBranches(1,1e3).subscribe({next:n=>{this.branches.set(n.items)},error:n=>{console.error("Failed to load branches:",n)}})}loadShifts(){this.loading.set(!0);let n=this.searchTerm.trim()||void 0;this.shiftsService.getShifts(this.currentPage(),this.pageSize(),n).subscribe({next:e=>{this.shifts.set(e.items),this.totalCount.set(e.totalCount),this.totalPages.set(e.totalPages),this.loading.set(!1)},error:e=>{console.error("Failed to load shifts:",e),this.loading.set(!1)}})}onSearch(){this.currentPage.set(1),this.loadShifts()}onFilterChange(){this.currentPage.set(1),this.loadShifts()}onPageChange(n){this.currentPage.set(n),this.loadShifts()}onPageSizeSelectionChange(n){this.pageSize.set(parseInt(n)),this.onPageSizeChange()}onPageSizeChange(){this.currentPage.set(1),this.loadShifts()}getShiftTypeText(n){return n===1?this.t("shifts.types.timeBased"):this.t("shifts.types.hoursOnly")}getShiftStatusText(n){switch(n){case 1:return this.t("shifts.status.active");case 2:return this.t("shifts.status.inactive");case 3:return this.t("shifts.status.draft");case 4:return this.t("shifts.status.archived");default:return this.t("shifts.status.active")}}getShiftStatusClass(n){switch(n){case 1:return"bg-success";case 2:return"bg-secondary";case 3:return"bg-warning";case 4:return"bg-dark";default:return"bg-success"}}formatTime(n){return n}formatHours(n){let e=Math.floor(n),t=Math.round((n-e)*60);return t>0?`${e}h ${t}m`:`${e}h`}getShiftTypeBadgeClass(n){return n===1?"badge-primary":"badge-info"}getPeriodTypeText(n){return this.isNightShift(n.startTime,n.endTime)?this.t("shifts.periodTypes.nightShift"):this.t("shifts.periodTypes.dayShift")}getPeriodHoursText(n){let e=this.calculatePeriodHours(n.startTime,n.endTime);return this.formatHours(e)}formatDate(n){let e=new Date(n);return e.toLocaleDateString()+" "+e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}onCreateShift(){this.router.navigate(["/shifts/create"])}onEditShift(n){this.router.navigate(["/shifts",n.id,"edit"])}onDeleteShift(n){this.selectedShift.set(n),this.showDeleteModal.set(!0)}onSubmitCreate(){if(!this.isFormValid())return;this.submitting.set(!0);let n={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(e=>({periodOrder:e.periodOrder,startTime:e.startTime,endTime:e.endTime})):void 0};this.shiftsService.createShift(n).subscribe({next:()=>{this.showCreateModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:e=>{console.error("Failed to create shift:",e),this.submitting.set(!1)}})}onSubmitEdit(){if(!this.isFormValid()||!this.selectedShift())return;this.submitting.set(!0);let n={name:this.shiftForm.name.trim(),description:this.shiftForm.description.trim()||void 0,shiftType:this.shiftForm.shiftType,status:this.shiftForm.status,requiredHours:this.shiftForm.requiredHours,isCheckInRequired:this.shiftForm.isCheckInRequired,isAutoCheckOut:this.shiftForm.isAutoCheckOut,allowFlexibleHours:this.shiftForm.allowFlexibleHours,flexMinutesBefore:this.shiftForm.flexMinutesBefore,flexMinutesAfter:this.shiftForm.flexMinutesAfter,gracePeriodMinutes:this.shiftForm.gracePeriodMinutes,shiftPeriods:this.shiftForm.shiftPeriods.length>0?this.shiftForm.shiftPeriods.map(e=>({id:e.id,periodOrder:e.periodOrder,startTime:e.startTime,endTime:e.endTime})):void 0};this.shiftsService.updateShift(this.selectedShift().id,n).subscribe({next:()=>{this.showEditModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:e=>{console.error("Failed to update shift:",e),this.submitting.set(!1)}})}onConfirmDelete(){this.selectedShift()&&(this.submitting.set(!0),this.shiftsService.deleteShift(this.selectedShift().id).subscribe({next:()=>{this.showDeleteModal.set(!1),this.loadShifts(),this.submitting.set(!1)},error:n=>{console.error("Failed to delete shift:",n),this.submitting.set(!1)}}))}onCloseModal(){this.showCreateModal.set(!1),this.showEditModal.set(!1),this.showDeleteModal.set(!1),this.selectedShift.set(null),this.submitting.set(!1)}onShiftTypeChange(){this.shiftForm.shiftType===2?(this.shiftForm.allowFlexibleHours=!1,this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0,this.shiftForm.gracePeriodMinutes=void 0,this.shiftForm.shiftPeriods=[]):(this.shiftForm.requiredHours=void 0,this.shiftForm.shiftPeriods.length===0&&this.addShiftPeriod())}onFlexibleHoursChange(){this.shiftForm.allowFlexibleHours||(this.shiftForm.flexMinutesBefore=void 0,this.shiftForm.flexMinutesAfter=void 0)}calculatePeriodHours(n,e){if(!n||!e)return 0;let t=this.parseTime(n),o=this.parseTime(e);if(o>t)return(o-t)/(1e3*60*60);if(o<t){let l=(864e5-t)/36e5,T=o/(1e3*60*60);return l+T}else return 0}isNightShift(n,e){if(!n||!e)return!1;let t=this.parseTime(n);return this.parseTime(e)<t}getTotalShiftHours(){return this.shiftForm.shiftType===2?this.shiftForm.requiredHours||0:this.shiftForm.shiftPeriods.reduce((n,e)=>n+this.calculatePeriodHours(e.startTime,e.endTime),0)}parseTime(n){let[e,t]=n.split(":").map(Number);return(e*60+t)*60*1e3}validateBusinessRules(){let n=[];this.shiftForm.shiftType===1?(this.shiftForm.shiftPeriods.length===0&&n.push(this.t("shifts.validation.timeBased.periodsRequired")),this.shiftForm.requiredHours!==void 0&&n.push(this.t("shifts.validation.timeBased.noRequiredHours"))):this.shiftForm.shiftType===2&&(this.shiftForm.shiftPeriods.length>0&&n.push(this.t("shifts.validation.hoursOnly.noPeriods")),(!this.shiftForm.requiredHours||this.shiftForm.requiredHours<=0)&&n.push(this.t("shifts.validation.hoursOnly.requiredHours")),this.shiftForm.requiredHours&&this.shiftForm.requiredHours>24&&n.push(this.t("shifts.validation.hoursOnly.maxHours"))),this.shiftForm.shiftPeriods.length>2&&n.push(this.t("shifts.validation.periods.maxTwo"));for(let e=0;e<this.shiftForm.shiftPeriods.length;e++){let t=this.shiftForm.shiftPeriods[e];t.startTime===t.endTime&&n.push(this.t("shifts.validation.periods.sameTime").replace("{{period}}",(e+1).toString()));let o=this.calculatePeriodHours(t.startTime,t.endTime);o<=0&&n.push(this.t("shifts.validation.periods.positiveHours").replace("{{period}}",(e+1).toString())),o>24&&n.push(this.t("shifts.validation.periods.maxHours").replace("{{period}}",(e+1).toString()))}if(this.shiftForm.shiftType===2&&(this.shiftForm.allowFlexibleHours&&n.push(this.t("shifts.validation.hoursOnly.noFlexibleHours")),this.shiftForm.gracePeriodMinutes&&n.push(this.t("shifts.validation.hoursOnly.noGracePeriod"))),this.shiftForm.allowFlexibleHours&&(this.shiftForm.flexMinutesBefore&&this.shiftForm.flexMinutesBefore>480&&n.push(this.t("shifts.validation.flexible.maxBefore")),this.shiftForm.flexMinutesAfter&&this.shiftForm.flexMinutesAfter>480&&n.push(this.t("shifts.validation.flexible.maxAfter"))),this.shiftForm.gracePeriodMinutes&&this.shiftForm.gracePeriodMinutes>120&&n.push(this.t("shifts.validation.gracePeriod.max")),!this.shiftForm.isCheckInRequired&&!this.shiftForm.isAutoCheckOut&&n.push(this.t("shifts.validation.checkInOut.conflict")),this.shiftForm.shiftPeriods.length===2){let e=this.shiftForm.shiftPeriods.sort((M,k)=>M.periodOrder-k.periodOrder),t=e[0],o=e[1],l=this.isNightShift(t.startTime,t.endTime),T=this.isNightShift(o.startTime,o.endTime);if(l&&T&&n.push(this.t("shifts.validation.periods.multipleNight")),!l&&!T){let M=this.parseTime(t.endTime),k=this.parseTime(o.startTime);M>=k&&n.push(this.t("shifts.validation.periods.overlap"))}}return n}addShiftPeriod(){this.shiftForm.shiftPeriods.length<2&&this.shiftForm.shiftPeriods.push({periodOrder:this.shiftForm.shiftPeriods.length+1,startTime:"08:00",endTime:"17:00"})}removeShiftPeriod(n){this.shiftForm.shiftPeriods.splice(n,1),this.shiftForm.shiftPeriods.forEach((e,t)=>{e.periodOrder=t+1})}resetForm(){this.shiftForm={name:"",description:"",shiftType:1,status:1,requiredHours:void 0,isCheckInRequired:!0,isAutoCheckOut:!1,allowFlexibleHours:!1,flexMinutesBefore:void 0,flexMinutesAfter:void 0,gracePeriodMinutes:void 0,shiftPeriods:[{periodOrder:1,startTime:"08:00",endTime:"17:00"}]}}isFormValid(){return this.shiftForm.name.trim()?this.validateBusinessRules().length===0:!1}getFormErrors(){let n=[];return this.shiftForm.name.trim()||n.push(this.t("shifts.validation.name.required")),n.push(...this.validateBusinessRules()),n}getPaginationArray(){let n=this.totalPages(),e=this.currentPage(),t=2,o=Math.max(1,e-t),l=Math.min(n,e+t);l-o<4&&n>4&&(o===1?l=Math.min(n,o+4):l===n&&(o=Math.max(1,l-4)));let T=[];for(let M=o;M<=l;M++)T.push(M);return T}getEndCount(){return Math.min(this.currentPage()*this.pageSize(),this.totalCount())}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=q({type:a,selectors:[["app-shifts"]],decls:105,vars:66,consts:[[1,"container-fluid","p-4"],[1,"row","mb-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","btn btn-primary","type","button",3,"click",4,"appHasPermission"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[1,"input-group"],["type","text",1,"form-control",3,"ngModelChange","keyup.enter","ngModel","ngModelOptions","placeholder"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-search"],[1,"col-md-5"],[3,"selectionChange","options","ngModel","ngModelOptions","placeholder","searchable","clearable"],[1,"card"],["class","text-center py-4",4,"ngIf"],[4,"ngIf"],[1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"mb-3"],[1,"form-label","required"],["type","text","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],["rows","2","name","description",1,"form-control",3,"ngModelChange","ngModel"],["name","status",3,"ngModelChange","options","ngModel","placeholder","required","searchable","clearable"],[1,"row"],[1,"col-md-6"],[1,"form-check"],["type","radio","name","shiftType",1,"form-check-input",3,"ngModelChange","change","value","ngModel"],[1,"form-check-label"],[1,"form-text","text-muted","d-block"],["class","mb-3",4,"ngIf"],[1,"row","mb-3"],["type","checkbox","name","isCheckInRequired",1,"form-check-input",3,"ngModelChange","ngModel"],["type","checkbox","name","isAutoCheckOut",1,"form-check-input",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],["class","spinner-border spinner-border-sm me-2",4,"ngIf"],[1,"modal-dialog"],["type","button",1,"btn","btn-danger",3,"click","disabled"],["class","modal-backdrop fade show",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],[1,"text-center","py-4"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-between align-items-center mt-3",4,"ngIf"],["class","d-block text-muted",4,"ngIf"],[1,"badge"],[1,"small"],[1,"btn-group","btn-group-sm"],["class","btn btn-outline-primary",3,"title","click",4,"appHasPermission"],["class","btn btn-outline-danger",3,"title","click",4,"appHasPermission"],[1,"d-block","text-muted"],["class","small",4,"ngFor","ngForOf"],["class","badge bg-warning ms-1",4,"ngIf"],[1,"badge","bg-warning","ms-1"],[1,"fas","fa-check","text-success","me-1"],[1,"fas","fa-clock","text-info","me-1"],[1,"btn","btn-outline-primary",3,"click","title"],[1,"fas","fa-edit"],[1,"btn","btn-outline-danger",3,"click","title"],[1,"fas","fa-trash"],[1,"fas","fa-clock","fa-3x","text-muted","mb-3"],[1,"text-muted"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"pagination","mb-0"],[1,"page-item"],[1,"page-link",3,"click","disabled"],["class","page-item",3,"active",4,"ngFor","ngForOf"],[1,"page-link",3,"click"],["type","number","name","requiredHours","min","0.5","max","24","step","0.5",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-text"],[1,"d-flex","justify-content-between","align-items-center","mb-2"],["type","button",1,"btn","btn-sm","btn-outline-primary",3,"click","disabled"],[1,"fas","fa-plus","me-1"],["class","card mb-2",4,"ngFor","ngForOf"],[1,"form-check","mb-2"],["type","checkbox","name","allowFlexibleHours",1,"form-check-input",3,"ngModelChange","change","ngModel"],["class","row",4,"ngIf"],["type","number","name","gracePeriodMinutes","min","1","max","120",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text","text-muted"],["class","form-text text-info d-block",4,"ngIf"],[1,"card","mb-2"],[1,"card-body","p-3"],["type","button",1,"btn","btn-sm","btn-outline-danger",3,"click","disabled"],["type","time","required","",1,"form-control",3,"ngModelChange","ngModel","name"],["type","number","name","flexMinutesBefore","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","flexMinutesAfter","min","1","max","480",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-text","text-info","d-block"],[1,"fas","fa-info-circle","me-1"],[1,"spinner-border","spinner-border-sm","me-2"],[1,"modal-backdrop","fade","show",3,"click"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),d(5),s(),p(6,me,3,1,"button",5),s()()(),r(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"label",10),d(12),s(),r(13,"div",11)(14,"input",12),b("ngModelChange",function(l){return S(t.searchTerm,l)||(t.searchTerm=l),l}),c("keyup.enter",function(){return t.onSearch()}),s(),r(15,"button",13),c("click",function(){return t.onSearch()}),x(16,"i",14),s()()(),r(17,"div",15)(18,"label",10),d(19),s(),r(20,"app-searchable-select",16),c("selectionChange",function(l){return t.onPageSizeSelectionChange(l)}),s()()()()(),r(21,"div",17)(22,"div",7),p(23,he,4,1,"div",18)(24,Pe,21,9,"div",19),s()()(),r(25,"div",20)(26,"div",21)(27,"div",22)(28,"div",23)(29,"h5",24),d(30),s(),r(31,"button",25),c("click",function(){return t.onCloseModal()}),s()(),r(32,"div",26)(33,"form")(34,"div",27)(35,"label",28),d(36),s(),r(37,"input",29),b("ngModelChange",function(l){return S(t.shiftForm.name,l)||(t.shiftForm.name=l),l}),s()(),r(38,"div",27)(39,"label",10),d(40),s(),r(41,"textarea",30),b("ngModelChange",function(l){return S(t.shiftForm.description,l)||(t.shiftForm.description=l),l}),s()(),r(42,"div",27)(43,"label",28),d(44),s(),r(45,"app-searchable-select",31),b("ngModelChange",function(l){return S(t.shiftForm.status,l)||(t.shiftForm.status=l),l}),s()(),r(46,"div",27)(47,"label",28),d(48),s(),r(49,"div",32)(50,"div",33)(51,"div",34)(52,"input",35),b("ngModelChange",function(l){return S(t.shiftForm.shiftType,l)||(t.shiftForm.shiftType=l),l}),c("change",function(){return t.onShiftTypeChange()}),s(),r(53,"label",36),d(54),s(),r(55,"small",37),d(56),s()()(),r(57,"div",33)(58,"div",34)(59,"input",35),b("ngModelChange",function(l){return S(t.shiftForm.shiftType,l)||(t.shiftForm.shiftType=l),l}),c("change",function(){return t.onShiftTypeChange()}),s(),r(60,"label",36),d(61),s(),r(62,"small",37),d(63),s()()()()(),p(64,we,7,3,"div",38)(65,Oe,27,13,"div",19),r(66,"div",39)(67,"div",33)(68,"div",34)(69,"input",40),b("ngModelChange",function(l){return S(t.shiftForm.isCheckInRequired,l)||(t.shiftForm.isCheckInRequired=l),l}),s(),r(70,"label",36),d(71),s(),r(72,"small",37),d(73),s()()(),r(74,"div",33)(75,"div",34)(76,"input",41),b("ngModelChange",function(l){return S(t.shiftForm.isAutoCheckOut,l)||(t.shiftForm.isAutoCheckOut=l),l}),s(),r(77,"label",36),d(78),s(),r(79,"small",37),d(80),s()()()()()(),r(81,"div",42)(82,"button",43),c("click",function(){return t.onCloseModal()}),d(83),s(),r(84,"button",44),c("click",function(){return t.showCreateModal()?t.onSubmitCreate():t.onSubmitEdit()}),p(85,He,1,0,"span",45),d(86),s()()()()(),r(87,"div",20)(88,"div",46)(89,"div",22)(90,"div",23)(91,"h5",24),d(92),s(),r(93,"button",25),c("click",function(){return t.onCloseModal()}),s()(),r(94,"div",26)(95,"p"),d(96),s(),p(97,Ae,3,1,"p",19),s(),r(98,"div",42)(99,"button",43),c("click",function(){return t.onCloseModal()}),d(100),s(),r(101,"button",47),c("click",function(){return t.onConfirmDelete()}),p(102,qe,1,0,"span",45),d(103),s()()()()(),p(104,Ve,1,0,"div",48)),e&2&&(i(5),f(t.t("shifts.title")),i(),m("appHasPermission",t.PERMISSIONS.SHIFT_CREATE),i(6),f(t.t("common.search")),i(2),v("ngModel",t.searchTerm),m("ngModelOptions",A(64,le))("placeholder",t.t("shifts.searchPlaceholder")),i(5),f(t.t("common.pageSize")),i(),m("options",t.pageSizeSelectOptions)("ngModel",t.pageSize().toString())("ngModelOptions",A(65,le))("placeholder",t.t("common.select"))("searchable",!1)("clearable",!1),i(3),m("ngIf",t.loading()),i(),m("ngIf",!t.loading()),i(),O("display",t.showCreateModal()||t.showEditModal()?"block":"none"),P("show",t.showCreateModal()||t.showEditModal()),i(5),u(" ",t.showCreateModal()?t.t("shifts.actions.create"):t.t("shifts.actions.edit")," "),i(6),f(t.t("shifts.fields.name")),i(),v("ngModel",t.shiftForm.name),i(3),f(t.t("shifts.fields.description")),i(),v("ngModel",t.shiftForm.description),i(3),f(t.t("shifts.fields.status")),i(),m("options",t.statusSelectOptions),v("ngModel",t.shiftForm.status),m("placeholder",t.t("common.select"))("required",!0)("searchable",!0)("clearable",!1),i(3),f(t.t("shifts.fields.type")),i(4),m("value",t.ShiftType.TimeBased),v("ngModel",t.shiftForm.shiftType),i(2),u(" ",t.t("shifts.types.timeBased")," "),i(2),f(t.t("shifts.types.timeBasedDescription")),i(3),m("value",t.ShiftType.HoursOnly),v("ngModel",t.shiftForm.shiftType),i(2),u(" ",t.t("shifts.types.hoursOnly")," "),i(2),f(t.t("shifts.types.hoursOnlyDescription")),i(),m("ngIf",t.shiftForm.shiftType===t.ShiftType.HoursOnly),i(),m("ngIf",t.shiftForm.shiftType===t.ShiftType.TimeBased),i(4),v("ngModel",t.shiftForm.isCheckInRequired),i(2),u(" ",t.t("shifts.fields.checkInRequired")," "),i(2),f(t.t("shifts.checkInRequiredDescription")),i(3),v("ngModel",t.shiftForm.isAutoCheckOut),i(2),u(" ",t.t("shifts.fields.autoCheckOut")," "),i(2),f(t.t("shifts.autoCheckOutDescription")),i(3),u(" ",t.t("common.cancel")," "),i(),m("disabled",!t.isFormValid()||t.submitting()),i(),m("ngIf",t.submitting()),i(),u(" ",t.showCreateModal()?t.t("common.create"):t.t("common.update")," "),i(),O("display",t.showDeleteModal()?"block":"none"),P("show",t.showDeleteModal()),i(5),f(t.t("shifts.actions.delete")),i(4),f(t.t("shifts.deleteConfirmation")),i(),m("ngIf",t.selectedShift()),i(3),u(" ",t.t("common.cancel")," "),i(),m("disabled",t.submitting()),i(),m("ngIf",t.submitting()),i(),u(" ",t.t("common.delete")," "),i(),m("ngIf",t.showCreateModal()||t.showEditModal()||t.showDeleteModal()))},dependencies:[R,B,D,ee,K,z,Q,L,X,U,j,$,Z,Y,J,G,ie,ne],styles:['.required[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;border-top:none;font-weight:600}.badge[_ngcontent-%COMP%]{font-size:.75rem}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem}.modal-backdrop[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.form-text.text-muted[_ngcontent-%COMP%]{font-size:.8rem}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:1rem}.pagination[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{border-radius:.375rem;margin:0 .125rem}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem}.table-responsive[_ngcontent-%COMP%]{border-radius:.375rem}@media (max-width: 768px){.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.2rem .4rem;font-size:.75rem}.table-responsive[_ngcontent-%COMP%]{font-size:.9rem}}']})};export{de as ShiftsComponent};
