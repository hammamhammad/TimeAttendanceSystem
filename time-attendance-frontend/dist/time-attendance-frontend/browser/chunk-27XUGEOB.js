import{a as ce}from"./chunk-544KHMX2.js";import{a as le,b as re,c as de}from"./chunk-5KJOOWHZ.js";import{a as oe}from"./chunk-HBA4LCS7.js";import{a as ae}from"./chunk-RM7DPSQZ.js";import{a as ee}from"./chunk-LCQOFV6P.js";import{a as V,b as A}from"./chunk-5BLMYARA.js";import{a as ne}from"./chunk-CYQTDKAB.js";import"./chunk-SZUF4QIO.js";import{x as te}from"./chunk-7QCK55IR.js";import{b as ie}from"./chunk-AS5QRUY4.js";import{$ as i,E as t,J as q,N,Sa as C,U as v,V as _,Y as P,Z as O,_ as I,aa as n,ba as x,fb as K,ia as D,ka as b,ma as m,nb as Q,qb as X,rb as Z,sa as J,t as E,ta as M,u as y,v as f,va as h,wa as a,xa as d,ya as p,z as g,za as w}from"./chunk-LDUBOZPL.js";import"./chunk-DGAILPFQ.js";var me=(o,l)=>l.attendanceDate,pe=(o,l)=>l.transactionTimeLocal;function xe(o,l){if(o&1){let e=D();i(0,"button",14),b("click",function(){y(e);let s=m();return f(s.onEdit())}),x(1,"i",15),a(2),n()}if(o&2){let e=m();t(2),p(" ",e.t("employees.edit")," ")}}function ue(o,l){if(o&1&&(i(0,"div",12)(1,"div",16)(2,"span",17),a(3),n()()()),o&2){let e=m();t(3),d(e.t("common.loading"))}}function ve(o,l){if(o&1&&(i(0,"dt",30),a(1),n(),i(2,"dd",31),a(3),n()),o&2){let e=m(2);t(),p("",e.t("employees.date_of_birth"),":"),t(2),d(e.formatDate(e.employee().dateOfBirth))}}function _e(o,l){if(o&1&&(i(0,"span",35),a(1),n()),o&2){let e=m(2);t(),d(e.t("common.active"))}}function ge(o,l){if(o&1&&(i(0,"span",36),a(1),n()),o&2){let e=m(2);t(),d(e.t("common.inactive"))}}function be(o,l){if(o&1&&(i(0,"span",38),a(1),n()),o&2){let e,c=m(2);t(),d((e=c.employee())==null?null:e.currentShiftName)}}function ye(o,l){if(o&1&&(i(0,"span",27),a(1),n()),o&2){let e=m(2);t(),d(e.t("employees.no_shift_assigned"))}}function fe(o,l){if(o&1&&(i(0,"div",33)(1,"h6",34),a(2),n(),i(3,"span",85),a(4),n()()),o&2){let e=m(2);t(2),d(e.t("employees.gender.title")),t(2),d(e.getGenderLabel(e.employee().gender))}}function Ee(o,l){if(o&1&&(i(0,"div",86)(1,"small",27),a(2),n(),x(3,"br"),i(4,"span"),a(5),n()()),o&2){let e,c=m(3);t(2),d(c.t("employees.first_name_ar")),t(3),d((e=c.employee())==null?null:e.firstNameAr)}}function Ce(o,l){if(o&1&&(i(0,"div",86)(1,"small",27),a(2),n(),x(3,"br"),i(4,"span"),a(5),n()()),o&2){let e,c=m(3);t(2),d(c.t("employees.last_name_ar")),t(3),d((e=c.employee())==null?null:e.lastNameAr)}}function he(o,l){if(o&1&&(i(0,"div")(1,"small",27),a(2),n(),x(3,"br"),i(4,"span"),a(5),n()()),o&2){let e,c=m(3);t(2),d(c.t("employees.job_title_ar")),t(3),d((e=c.employee())==null?null:e.jobTitleAr)}}function Se(o,l){if(o&1&&(i(0,"div",39)(1,"div",21)(2,"h6",22),a(3),n()(),i(4,"div",28),v(5,Ee,6,2,"div",86),v(6,Ce,6,2,"div",86),v(7,he,6,2,"div"),n()()),o&2){let e,c,s,u=m(2);t(3),d(u.t("employees.arabic_names")),t(2),_((e=u.employee())!=null&&e.firstNameAr?5:-1),t(),_((c=u.employee())!=null&&c.lastNameAr?6:-1),t(),_((s=u.employee())!=null&&s.jobTitleAr?7:-1)}}function Ie(o,l){if(o&1){let e=D();i(0,"button",87),b("click",function(){y(e);let s=m(2);return f(s.onEdit())}),x(1,"i",15),a(2),n()}if(o&2){let e=m(2);t(2),p(" ",e.t("employees.edit")," ")}}function we(o,l){if(o&1&&(i(0,"button",42),x(1,"i",88),a(2),n()),o&2){let e=m(2);t(2),p(" ",e.t("employees.deactivate")," ")}}function Te(o,l){if(o&1&&(i(0,"button",43),x(1,"i",89),a(2),n()),o&2){let e=m(2);t(2),p(" ",e.t("employees.activate")," ")}}function ke(o,l){if(o&1&&(i(0,"div",90)(1,"div",91)(2,"span",17),a(3),n()(),i(4,"p",92),a(5),n()()),o&2){let e=m(3);t(3),d(e.t("common.loading")),t(2),d(e.t("attendance.messages.loading_data"))}}function De(o,l){if(o&1&&(i(0,"div",18)(1,"div",29)(2,"h6",93),a(3),n(),i(4,"div",94)(5,"div",95)(6,"span"),x(7,"i",96),a(8),n(),i(9,"span",97),a(10),n()(),i(11,"div",95)(12,"span"),x(13,"i",98),a(14),n(),i(15,"span",99),a(16),n()(),i(17,"div",95)(18,"span"),x(19,"i",100),a(20),n(),i(21,"span",101),a(22),n()()()(),i(23,"div",29)(24,"h6",93),a(25),n(),i(26,"div",94)(27,"div",95)(28,"span"),a(29),n(),i(30,"span",26),a(31),n()(),i(32,"div",95)(33,"span"),a(34),n(),i(35,"span",26),a(36),n()(),i(37,"div",95)(38,"span"),a(39),n(),i(40,"span",26),a(41),n()()()()()),o&2){let e=m(3);t(3),d(e.t("attendance.statistics.attendance_breakdown")),t(5),p(" ",e.t("attendance.status.present")," "),t(2),d(e.presentDays()),t(4),p(" ",e.t("attendance.status.absent")," "),t(2),d(e.absentDays()),t(4),p(" ",e.t("attendance.status.late")," "),t(2),d(e.lateDays()),t(3),d(e.t("attendance.statistics.time_summary")),t(4),d(e.t("attendance.stats.average_working_hours")),t(2),p("",e.averageWorkingHours(),"h"),t(3),d(e.t("attendance.stats.total_overtime_hours")),t(2),p("",e.totalOvertimeHours(),"h"),t(3),d(e.t("attendance.statistics.total_working_days")),t(2),d(e.totalWorkingDays())}}function Me(o,l){if(o&1&&(i(0,"div",84),v(1,ke,6,2,"div",90)(2,De,42,14,"div",18),n()),o&2){let e=m(2);t(),_(e.attendanceLoading()?1:2)}}function Ve(o,l){if(o&1&&(i(0,"div",90)(1,"div",91)(2,"span",17),a(3),n()()()),o&2){let e=m(3);t(3),d(e.t("common.loading"))}}function Ae(o,l){if(o&1&&(i(0,"tr")(1,"td")(2,"span",26),a(3),n()(),i(4,"td")(5,"span"),a(6),n()(),i(7,"td")(8,"span"),a(9),n()(),i(10,"td")(11,"span",26),a(12),n()(),i(13,"td")(14,"span"),a(15),n()(),i(16,"td")(17,"span",27),a(18),n()()()),o&2){let e=l.$implicit,c=m(4);t(3),d(c.formatDate(e.attendanceDate)),t(2),h(e.actualCheckInTime?"text-success fw-medium":"text-muted"),t(),p(" ",c.formatTime(e.actualCheckInTime)," "),t(2),h(e.actualCheckOutTime?"text-info fw-medium":"text-muted"),t(),p(" ",c.formatTime(e.actualCheckOutTime)," "),t(3),p(" ",c.calculateWorkDuration(e.actualCheckInTime,e.actualCheckOutTime)," "),t(2),h(c.getStatusBadgeClass(e.status)),t(),p(" ",c.t("attendance.status."+e.status.toString().toLowerCase())," "),t(3),d(e.notes||"--")}}function Ne(o,l){if(o&1&&(i(0,"div",102)(1,"table",103)(2,"thead",104)(3,"tr")(4,"th"),a(5),n(),i(6,"th"),a(7),n(),i(8,"th"),a(9),n(),i(10,"th"),a(11),n(),i(12,"th"),a(13),n(),i(14,"th"),a(15),n()()(),i(16,"tbody"),P(17,Ae,19,12,"tr",null,me),n()()()),o&2){let e=m(3);t(5),d(e.t("attendance.fields.attendance_date")),t(2),d(e.t("attendance.fields.check_in_time")),t(2),d(e.t("attendance.fields.check_out_time")),t(2),d(e.t("attendance.fields.work_duration")),t(2),d(e.t("attendance.fields.status")),t(2),d(e.t("attendance.fields.notes")),t(2),O(e.attendanceRecords())}}function Pe(o,l){if(o&1&&(i(0,"div",90),x(1,"i",105),i(2,"h6",27),a(3),n(),i(4,"p",27),a(5),n()()),o&2){let e=m(3);t(3),d(e.t("attendance.no_records")),t(2),d(e.t("attendance.no_records_description"))}}function Oe(o,l){if(o&1&&(i(0,"div",84),v(1,Ve,4,1,"div",90)(2,Ne,19,6,"div",102)(3,Pe,6,2,"div",90),n()),o&2){let e=m(2);t(),_(e.attendanceLoading()?1:e.attendanceRecords().length>0?2:3)}}function Re(o,l){if(o&1&&(i(0,"tr")(1,"td")(2,"div",26),a(3),n(),i(4,"small",27),a(5),n()(),i(6,"td")(7,"span"),a(8),n()(),i(9,"td")(10,"span",27),a(11),n()(),i(12,"td")(13,"span"),a(14),n()(),i(15,"td")(16,"span",27),a(17),n()()()),o&2){let e=l.$implicit,c=m(4);t(3),d(c.formatDate(e.transactionTimeLocal)),t(2),d(c.formatTime(e.transactionTimeLocal)),t(2),h(c.getTransactionTypeBadgeClass(e.transactionType)),t(),p(" ",e.transactionTypeText," "),t(3),d(e.location||"--"),t(2),h(e.isManual?"badge bg-warning":"badge bg-success"),t(),p(" ",e.isManual?c.t("app.yes"):c.t("app.no")," "),t(3),d(e.notes||"--")}}function Le(o,l){if(o&1&&(i(0,"div",102)(1,"table",103)(2,"thead",104)(3,"tr")(4,"th"),a(5),n(),i(6,"th"),a(7),n(),i(8,"th"),a(9),n(),i(10,"th"),a(11),n(),i(12,"th"),a(13),n()()(),i(14,"tbody"),P(15,Re,18,10,"tr",null,pe),n()()()),o&2){let e=m(3);t(5),d(e.t("attendance.fields.datetime")),t(2),d(e.t("attendance.fields.transaction_type")),t(2),d(e.t("attendance.fields.location")),t(2),d(e.t("attendance.fields.manual")),t(2),d(e.t("attendance.fields.notes")),t(2),O(e.recentTransactions())}}function He(o,l){if(o&1&&(i(0,"div",90),x(1,"i",106),i(2,"h6",27),a(3),n(),i(4,"p",27),a(5),n()()),o&2){let e=m(3);t(3),d(e.t("attendance.no_transactions")),t(2),d(e.t("attendance.no_transactions_description"))}}function $e(o,l){if(o&1&&(i(0,"div",84),v(1,Le,17,5,"div",102)(2,He,6,2,"div",90),n()),o&2){let e=m(2);t(),_(e.recentTransactions().length>0?1:2)}}function je(o,l){if(o&1){let e=D();i(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"h5",22)(5,"div",23)(6,"div",24)(7,"div",25),a(8),n()(),i(9,"div")(10,"div",26),a(11),n(),i(12,"small",27),a(13),n()()()()(),i(14,"div",28)(15,"div",18)(16,"div",29)(17,"dl",18)(18,"dt",30),a(19),n(),i(20,"dd",31),a(21),n(),i(22,"dt",30),a(23),n(),i(24,"dd",31),a(25),n(),i(26,"dt",30),a(27),n(),i(28,"dd",31),a(29),n(),i(30,"dt",30),a(31),n(),i(32,"dd",31),a(33),n(),i(34,"dt",30),a(35),n(),i(36,"dd",31),a(37),n(),i(38,"dt",30),a(39),n(),i(40,"dd",31),a(41),n()()(),i(42,"div",29)(43,"dl",18)(44,"dt",30),a(45),n(),i(46,"dd",31),a(47),n(),i(48,"dt",30),a(49),n(),i(50,"dd",31),a(51),n(),i(52,"dt",30),a(53),n(),i(54,"dd",31),a(55),n(),i(56,"dt",30),a(57),n(),i(58,"dd",31),a(59),n(),i(60,"dt",30),a(61),n(),i(62,"dd",31),a(63),n(),v(64,ve,4,2),n()()()()()(),i(65,"div",32)(66,"div",20)(67,"div",21)(68,"h6",22),a(69),n()(),i(70,"div",28)(71,"div",33)(72,"h6",34),a(73),n(),v(74,_e,2,1,"span",35)(75,ge,2,1,"span",36),n(),i(76,"div",33)(77,"h6",34),a(78),n(),i(79,"span",37),a(80),n()(),i(81,"div",33)(82,"h6",34),a(83),n(),i(84,"span",36),a(85),n()(),i(86,"div",33)(87,"h6",34),a(88),n(),v(89,be,2,1,"span",38)(90,ye,2,1,"span",27),n(),v(91,fe,5,2,"div",33),i(92,"div")(93,"h6",34),a(94),n(),i(95,"small",27),a(96),n()()()(),v(97,Se,8,4,"div",39),i(98,"div",39)(99,"div",21)(100,"h6",22),a(101),n()(),i(102,"div",28)(103,"div",40),N(104,Ie,3,1,"button",41),v(105,we,3,1,"button",42)(106,Te,3,1,"button",43),n()()()()(),i(107,"div",44)(108,"div",45)(109,"div",20)(110,"div",21)(111,"div",46)(112,"h5",22),x(113,"i",47),a(114),n(),i(115,"div",48)(116,"input",49),b("change",function(s){y(e);let u=m();return f(u.onDateRangeChange(s.target.value,u.selectedDateRange().end))}),n(),i(117,"span",50),a(118),n(),i(119,"input",49),b("change",function(s){y(e);let u=m();return f(u.onDateRangeChange(u.selectedDateRange().start,s.target.value))}),n(),i(120,"button",51),b("click",function(){y(e);let s=m();return f(s.exportAttendanceData())}),x(121,"i",52),a(122),n()()()(),i(123,"div",28)(124,"div",53)(125,"div",54)(126,"div",55)(127,"div",28)(128,"div",46)(129,"div")(130,"h6",56),a(131),n(),i(132,"h3",57),a(133),n()(),i(134,"div",58),x(135,"i",59),n()()()()(),i(136,"div",54)(137,"div",60)(138,"div",28)(139,"div",46)(140,"div")(141,"h6",56),a(142),n(),i(143,"h3",61),a(144),n(),i(145,"small",27),a(146),n()(),i(147,"div",62),x(148,"i",63),n()()()()(),i(149,"div",54)(150,"div",64)(151,"div",28)(152,"div",46)(153,"div")(154,"h6",56),a(155),n(),i(156,"h3",65),a(157),n(),i(158,"small",27),a(159),n()(),i(160,"div",66),x(161,"i",67),n()()()()(),i(162,"div",54)(163,"div",68)(164,"div",28)(165,"div",46)(166,"div")(167,"h6",56),a(168),n(),i(169,"h3",69),a(170),n(),i(171,"small",27),a(172),n()(),i(173,"div",70),x(174,"i",71),n()()()()()(),i(175,"div",53)(176,"div",45)(177,"div",20)(178,"div",72)(179,"h6",73),a(180),n(),i(181,"div",74)(182,"div",75)(183,"span",76),a(184),n()()(),i(185,"span"),a(186),n()()()()(),i(187,"ul",77)(188,"li",78)(189,"button",79),b("click",function(){y(e);let s=m();return f(s.setActiveTab("overview"))}),x(190,"i",80),a(191),n()(),i(192,"li",78)(193,"button",79),b("click",function(){y(e);let s=m();return f(s.setActiveTab("records"))}),x(194,"i",81),a(195),n()(),i(196,"li",78)(197,"button",79),b("click",function(){y(e);let s=m();return f(s.setActiveTab("transactions"))}),x(198,"i",82),a(199),n()()(),i(200,"div",83),v(201,Me,3,1,"div",84),v(202,Oe,4,1,"div",84),v(203,$e,3,1,"div",84),n()()()()()}if(o&2){let e,c,s,u,T,k,R,L,H,$,j,W,B,U,Y,G,z,S,F,r=m();t(8),w(" ",(((e=r.employee())==null||e.firstName==null?null:e.firstName.charAt(0))||"")==null?null:(((e=e)==null||e.firstName==null?null:e.firstName.charAt(0))||"").toUpperCase(),"",(((e=r.employee())==null||e.lastName==null?null:e.lastName.charAt(0))||"")==null?null:(((e=e)==null||e.lastName==null?null:e.lastName.charAt(0))||"").toUpperCase()," "),t(3),d((c=r.employee())==null?null:c.fullName),t(2),d((s=r.employee())==null?null:s.employeeNumber),t(6),p("",r.t("employees.employee_number"),":"),t(2),d((u=r.employee())==null?null:u.employeeNumber),t(2),p("",r.t("employees.first_name"),":"),t(2),d((T=r.employee())==null?null:T.firstName),t(2),p("",r.t("employees.last_name"),":"),t(2),d((k=r.employee())==null?null:k.lastName),t(2),p("",r.t("employees.email"),":"),t(2),d(((R=r.employee())==null?null:R.email)||"-"),t(2),p("",r.t("employees.phone"),":"),t(2),d(((L=r.employee())==null?null:L.phone)||"-"),t(2),p("",r.t("employees.national_id"),":"),t(2),d(((H=r.employee())==null?null:H.nationalId)||"-"),t(4),p("",r.t("employees.job_title"),":"),t(2),d(($=r.employee())==null?null:$.jobTitle),t(2),p("",r.t("employees.branch"),":"),t(2),d((j=r.employee())==null?null:j.branchName),t(2),p("",r.t("employees.department"),":"),t(2),d(((W=r.employee())==null?null:W.departmentName)||"-"),t(2),p("",r.t("employees.manager"),":"),t(2),d(((B=r.employee())==null?null:B.managerName)||"-"),t(2),p("",r.t("employees.hire_date"),":"),t(2),d(r.formatDate(r.employee().hireDate)),t(),_((U=r.employee())!=null&&U.dateOfBirth?64:-1),t(5),d(r.t("employees.employment_details")),t(4),d(r.t("common.status")),t(),_((Y=r.employee())!=null&&Y.isActive?74:75),t(4),d(r.t("employees.employment_status.title")),t(2),d(r.getEmploymentStatusLabel(r.employee().employmentStatus)),t(3),d(r.t("employees.work_location.title")),t(2),d(r.getWorkLocationTypeLabel(r.employee().workLocationType)),t(3),d(r.t("employees.current_shift")),t(),_((G=r.employee())!=null&&G.currentShiftName?89:90),t(2),_((z=r.employee())!=null&&z.gender?91:-1),t(3),d(r.t("employees.created_at")),t(2),d(r.formatDate(r.employee().createdAtUtc)),t(),_((S=r.employee())!=null&&S.firstNameAr||(S=r.employee())!=null&&S.lastNameAr||(S=r.employee())!=null&&S.jobTitleAr?97:-1),t(4),d(r.t("common.actions")),t(3),I("appHasPermission",r.PERMISSIONS.EMPLOYEE_UPDATE),t(),_((F=r.employee())!=null&&F.isActive?105:106),t(9),p(" ",r.t("attendance.employee_detail")," "),t(2),I("value",r.selectedDateRange().start),t(2),d(r.t("common.to")),t(),I("value",r.selectedDateRange().end),t(),I("disabled",r.attendanceRecords().length===0),t(2),p(" ",r.t("attendance.actions.export_data")," "),t(9),d(r.t("attendance.statistics.total_working_days")),t(2),d(r.totalWorkingDays()),t(9),d(r.t("attendance.stats.present_employees")),t(2),d(r.presentDays()),t(2),w("",r.attendanceRate(),"% ",r.t("attendance.statistics.attendance_rate_short")),t(9),d(r.t("attendance.stats.average_working_hours")),t(2),p("",r.averageWorkingHours(),"h"),t(2),w("",r.totalOvertimeHours(),"h ",r.t("attendance.statistics.total_overtime")),t(9),d(r.t("attendance.stats.absent_employees")),t(2),d(r.absentDays()),t(2),w("",r.lateDays()," ",r.t("attendance.statistics.late_days")),t(8),d(r.t("attendance.stats.attendance_rate")),t(2),J("--progress",r.attendanceRate()+"%"),t(2),p("",r.attendanceRate(),"%"),t(),h("badge bg-"+r.getPerformanceColor(r.attendanceRate())),t(),p(" ",r.attendanceRate()>=95?"Excellent":r.attendanceRate()>=90?"Good":r.attendanceRate()>=80?"Average":"Needs Improvement"," "),t(3),M("active",r.activeTab()==="overview"),t(2),p(" ",r.t("attendance.statistics.overview")," "),t(2),M("active",r.activeTab()==="records"),t(2),p(" ",r.t("attendance.statistics.records")," "),t(2),M("active",r.activeTab()==="transactions"),t(2),p(" ",r.t("attendance.statistics.transactions")," "),t(2),_(r.activeTab()==="overview"?201:-1),t(),_(r.activeTab()==="records"?202:-1),t(),_(r.activeTab()==="transactions"?203:-1)}}function We(o,l){if(o&1&&(i(0,"div",13),x(1,"i",107),a(2),n()),o&2){let e=m();t(2),p(" ",e.error()||e.t("employees.employee_not_found")," ")}}var se=class o{router=E(X);route=E(Q);employeesService=E(oe);attendanceService=E(ce);notificationService=E(ne);i18n=E(ie);permissionService=E(ee);loading=g(!1);error=g(null);employee=g(null);employeeId=0;attendanceLoading=g(!1);attendanceRecords=g([]);attendanceStatistics=g(null);recentTransactions=g([]);selectedDateRange=g({start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]});activeTab=g("overview");totalWorkingDays=C(()=>this.attendanceRecords().length);presentDays=C(()=>this.attendanceRecords().filter(e=>e.status===1).length);absentDays=C(()=>this.attendanceRecords().filter(e=>e.status===2).length);lateDays=C(()=>this.attendanceRecords().filter(e=>e.status===3).length);attendanceRate=C(()=>{let l=this.totalWorkingDays(),e=this.presentDays();return l>0?Math.round(e/l*100):0});averageWorkingHours=C(()=>{let e=this.attendanceRecords().filter(s=>s.workingHours>0);if(e.length===0)return 0;let c=e.reduce((s,u)=>s+u.workingHours,0);return Math.round(c/e.length*10)/10});totalOvertimeHours=C(()=>{let l=this.attendanceRecords();return Math.round(l.reduce((e,c)=>e+c.overtimeHours,0)*10)/10});PERMISSIONS={EMPLOYEE_UPDATE:`${A.EMPLOYEE}.${V.UPDATE}`,EMPLOYEE_DELETE:`${A.EMPLOYEE}.${V.DELETE}`,EMPLOYEE_MANAGE:`${A.EMPLOYEE}.${V.MANAGE}`};ngOnInit(){this.employeeId=+this.route.snapshot.params.id,this.employeeId?(this.loadEmployee(),this.loadAttendanceData()):this.router.navigate(["/employees"])}loadEmployee(){this.loading.set(!0),this.employeesService.getEmployeeById(this.employeeId).subscribe({next:l=>{this.employee.set(l),this.loading.set(!1)},error:l=>{this.error.set("Failed to load employee"),this.loading.set(!1),console.error("Error loading employee:",l)}})}loadAttendanceData(){this.attendanceLoading.set(!0);let l=this.selectedDateRange();this.attendanceService.getEmployeeAttendanceRecords(this.employeeId,l.start,l.end).subscribe({next:e=>{this.attendanceRecords.set(e),this.attendanceLoading.set(!1)},error:e=>{console.error("Error loading attendance records:",e),this.attendanceLoading.set(!1)}}),this.attendanceService.getEmployeeRecentTransactions(this.employeeId,10).subscribe({next:e=>{this.recentTransactions.set(e)},error:e=>{console.error("Error loading transactions:",e)}})}onDateRangeChange(l,e){this.selectedDateRange.set({start:l,end:e}),this.loadAttendanceData()}setActiveTab(l){this.activeTab.set(l)}getStatusBadgeClass(l){switch(l){case 1:return"badge bg-success";case 2:return"badge bg-danger";case 3:return"badge bg-warning";case 4:return"badge bg-warning";case 5:return"badge bg-info";case 6:return"badge bg-secondary";case 7:return"badge bg-primary";default:return"badge bg-secondary"}}getTransactionTypeBadgeClass(l){switch(l){case 0:return"badge bg-success";case 1:return"badge bg-danger";case 2:return"badge bg-warning";case 3:return"badge bg-info";case 4:return"badge bg-primary";default:return"badge bg-secondary"}}formatTime(l){if(!l)return"--:--";try{return new Date(`1970-01-01T${l}`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})}catch{return l}}calculateWorkDuration(l,e){if(!l||!e)return"--";try{let c=new Date(`1970-01-01T${l}`),u=new Date(`1970-01-01T${e}`).getTime()-c.getTime(),T=Math.floor(u/(1e3*60*60)),k=Math.floor(u%(1e3*60*60)/(1e3*60));return`${T}h ${k}m`}catch{return"--"}}getPerformanceColor(l){return l>=95?"success":l>=90?"primary":l>=80?"warning":"danger"}exportAttendanceData(){let l=this.attendanceRecords();if(l.length===0){this.notificationService.warning("No attendance data to export");return}let e=this.generateAttendanceCSV(l);this.downloadCSV(e,`employee-${this.employeeId}-attendance.csv`),this.notificationService.success("Attendance data exported successfully")}generateAttendanceCSV(l){let e=["Date","Status","Check In","Check Out","Working Hours","Break Hours","Overtime Hours","Notes"],c=l.map(s=>[s.attendanceDate,this.getStatusText(s.status),this.formatTime(s.actualCheckInTime||null),this.formatTime(s.actualCheckOutTime||null),s.workingHours.toString(),s.breakHours.toString(),s.overtimeHours.toString(),s.notes||""]);return[e,...c].map(s=>s.map(u=>`"${u}"`).join(",")).join(`
`)}downloadCSV(l,e){let c=new Blob([l],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");if(s.download!==void 0){let u=URL.createObjectURL(c);s.setAttribute("href",u),s.setAttribute("download",e),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s)}}getStatusText(l){return this.i18n.t(`attendance.status.${l.toString().toLowerCase()}`)}onEdit(){this.router.navigate(["/employees",this.employeeId,"edit"])}onBack(){this.router.navigate(["/employees"])}formatDate(l){return new Date(l).toLocaleDateString()}getEmploymentStatusLabel(l){return this.t(`employees.employment_status.${re[l].toLowerCase()}`)}getGenderLabel(l){return this.t(`employees.gender.${le[l].toLowerCase()}`)}getWorkLocationTypeLabel(l){return this.t(`employees.work_location.${de[l].toLowerCase()}`)}t(l){return this.i18n.t(l)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=q({type:o,selectors:[["app-view-employee"]],decls:23,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/employees"],[1,"breadcrumb-item","active"],[1,"btn-group"],["type","button","class","btn btn-primary",3,"click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"alert","alert-danger"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-edit","me-2"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-title","bg-primary-subtle","text-primary","rounded-circle"],[1,"fw-medium"],[1,"text-muted"],[1,"card-body"],[1,"col-md-6"],[1,"col-sm-5"],[1,"col-sm-7"],[1,"col-lg-4"],[1,"mb-3"],[1,"fw-semibold"],[1,"badge","bg-success"],[1,"badge","bg-light","text-dark","border"],[1,"badge","bg-info"],[1,"badge","bg-primary"],[1,"card","mt-3"],[1,"d-grid","gap-2"],["type","button","class","btn btn-outline-primary",3,"click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-warning"],["type","button",1,"btn","btn-outline-success"],[1,"row","mt-4"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-calendar-check","me-2"],[1,"d-flex","gap-2"],["type","date",1,"form-control","form-control-sm",2,"width","auto",3,"change","value"],[1,"align-self-center"],["type","button",1,"btn","btn-success","btn-sm",3,"click","disabled"],[1,"fa-solid","fa-download"],[1,"row","mb-4"],[1,"col-md-3","mb-3"],[1,"card","border-start","border-primary","border-4","h-100"],[1,"card-title","text-muted","small","mb-1"],[1,"text-primary","mb-0"],[1,"icon-circle","bg-primary","bg-opacity-10"],[1,"fa-solid","fa-calendar","text-primary"],[1,"card","border-start","border-success","border-4","h-100"],[1,"text-success","mb-0"],[1,"icon-circle","bg-success","bg-opacity-10"],[1,"fa-solid","fa-user-check","text-success"],[1,"card","border-start","border-warning","border-4","h-100"],[1,"text-warning","mb-0"],[1,"icon-circle","bg-warning","bg-opacity-10"],[1,"fa-solid","fa-business-time","text-warning"],[1,"card","border-start","border-danger","border-4","h-100"],[1,"text-danger","mb-0"],[1,"icon-circle","bg-danger","bg-opacity-10"],[1,"fa-solid","fa-user-times","text-danger"],[1,"card-body","text-center"],[1,"card-title"],[1,"performance-circle","mb-3"],[1,"circle-progress"],[1,"percentage"],["role","tablist",1,"nav","nav-tabs","mb-3"],["role","presentation",1,"nav-item"],["type","button",1,"nav-link",3,"click"],[1,"fa-solid","fa-chart-pie","me-2"],[1,"fa-solid","fa-table","me-2"],[1,"fa-solid","fa-list","me-2"],[1,"tab-content"],[1,"tab-pane","fade","show","active"],[1,"badge","bg-light","text-dark"],[1,"mb-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fa-solid","fa-user-slash","me-2"],[1,"fa-solid","fa-user-check","me-2"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"mt-2","text-muted"],[1,"fw-semibold","mb-3"],[1,"list-group","list-group-flush"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"fa-solid","fa-user-check","text-success","me-2"],[1,"badge","bg-success","rounded-pill"],[1,"fa-solid","fa-user-times","text-danger","me-2"],[1,"badge","bg-danger","rounded-pill"],[1,"fa-solid","fa-clock","text-warning","me-2"],[1,"badge","bg-warning","rounded-pill"],[1,"table-responsive"],[1,"table","table-hover"],[1,"table-light"],[1,"fa-solid","fa-calendar-xmark","fa-3x","text-muted","mb-3"],[1,"fa-solid","fa-list","fa-3x","text-muted","mb-3"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(e,c){e&1&&(i(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),a(4),n(),i(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),a(9),n()(),i(10,"li",4)(11,"a",6),a(12),n()(),i(13,"li",7),a(14),n()()()(),i(15,"div",8),N(16,xe,3,1,"button",9),i(17,"button",10),b("click",function(){return c.onBack()}),x(18,"i",11),a(19),n()()(),v(20,ue,4,1,"div",12)(21,je,204,82)(22,We,3,1,"div",13),n()),e&2&&(t(4),d(c.t("employees.view_details")),t(5),d(c.t("dashboard.title")),t(3),d(c.t("employees.title")),t(2),d(c.t("employees.view_details")),t(2),I("appHasPermission",c.PERMISSIONS.EMPLOYEE_UPDATE),t(3),p(" ",c.t("common.back")," "),t(),_(c.loading()?20:c.employee()?21:22))},dependencies:[K,te,Z,ae],styles:['.avatar-sm[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;display:flex;align-items:center;justify-content:center}.avatar-title[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:.875rem}.icon-circle[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center}.icon-circle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.performance-circle[_ngcontent-%COMP%]{position:relative;width:120px;height:120px;margin:0 auto}.circle-progress[_ngcontent-%COMP%]{position:relative;width:120px;height:120px;border-radius:50%;background:conic-gradient(#198754 0deg calc(var(--progress) * 3.6deg),#e9ecef calc(var(--progress) * 3.6deg) 360deg);display:flex;align-items:center;justify-content:center;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}.circle-progress[_ngcontent-%COMP%]:before{content:"";position:absolute;width:80px;height:80px;border-radius:50%;background:#fff}.percentage[_ngcontent-%COMP%]{position:relative;font-size:1.5rem;font-weight:700;color:#198754;z-index:1}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@media (max-width: 768px){.performance-circle[_ngcontent-%COMP%], .circle-progress[_ngcontent-%COMP%]{width:100px;height:100px}.circle-progress[_ngcontent-%COMP%]:before{width:70px;height:70px}.percentage[_ngcontent-%COMP%]{font-size:1.2rem}.icon-circle[_ngcontent-%COMP%]{width:40px;height:40px}.icon-circle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}}']})};export{se as ViewEmployeeComponent};
