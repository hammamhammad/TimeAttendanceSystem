import{a as H}from"./chunk-ZSNO2TG4.js";import{a as U}from"./chunk-ENA4VX6C.js";import{a as B}from"./chunk-XRDRTVSA.js";import{a as z}from"./chunk-SRPEDAT4.js";import"./chunk-YRY7UVWD.js";import"./chunk-Y62N6K5S.js";import{b as D,c as M,d as b,e as T,f as k,i as O,m as P,n as w,w as N,x as A,y as q}from"./chunk-VRETN7JA.js";import{a as j}from"./chunk-EYAJMHM7.js";import{a as G}from"./chunk-HHXRLUSQ.js";import"./chunk-WO762DVG.js";import{b as R}from"./chunk-7HHEMKQW.js";import{d as V,g as F}from"./chunk-TWXUAMJ4.js";import{Bb as r,Cb as S,Db as l,Ea as C,R as v,W as _,X as y,Xa as u,Ya as f,bb as d,cb as n,da as g,db as a,eb as c,lb as E,nb as h,pb as m,ta as i,wc as I,yb as x}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";function Y(o,t){if(o&1&&(n(0,"div",2),c(1,"app-loading-spinner",4),a()),o&2){let e=m();i(),d("message",e.i18n.t("employee_vacations.loading_details"))("variant","primary")("centered",!0)}}function J(o,t){if(o&1&&(n(0,"div",12),r(1),a()),o&2){let e=m(2);i(),l(" ",e.getErrorMessage("vacationTypeId")," ")}}function K(o,t){if(o&1&&(n(0,"div",19),r(1),a()),o&2){let e=m(2);i(),l(" ",e.getErrorMessage("startDate")," ")}}function Q(o,t){if(o&1&&(n(0,"div",19),r(1),a()),o&2){let e=m(2);i(),l(" ",e.getErrorMessage("endDate")," ")}}function W(o,t){if(o&1&&(c(0,"span",43),r(1)),o&2){let e=m(2);i(),l(" ",e.i18n.t("common.saving")," ")}}function X(o,t){if(o&1&&(c(0,"i",44),r(1)),o&2){let e=m(2);i(),l(" ",e.i18n.t("common.save")," ")}}function Z(o,t){if(o&1){let e=E();n(0,"div",3)(1,"div",5)(2,"form",6),h("ngSubmit",function(){_(e);let p=m();return y(p.onSubmit())}),n(3,"app-form-section",7)(4,"div",3)(5,"div",8)(6,"label",9),r(7),n(8,"span",10),r(9,"*"),a()(),c(10,"app-searchable-select",11),u(11,J,2,1,"div",12),a(),n(12,"div",8)(13,"label",13),r(14),a(),n(15,"div",14),c(16,"input",15),n(17,"label",16),r(18),a()()()(),n(19,"div",3)(20,"div",8)(21,"label",17),r(22),n(23,"span",10),r(24,"*"),a()(),c(25,"input",18),u(26,K,2,1,"div",19),a(),n(27,"div",8)(28,"label",20),r(29),n(30,"span",10),r(31,"*"),a()(),c(32,"input",21),u(33,Q,2,1,"div",19),a()()(),n(34,"app-form-section",7)(35,"div",22)(36,"label",23),r(37),a(),n(38,"textarea",24),r(39,"                  "),a()()(),n(40,"div",25)(41,"button",26),h("click",function(){_(e);let p=m();return y(p.onCancel())}),c(42,"i",27),r(43),a(),n(44,"button",28),h("click",function(){_(e);let p=m();return y(p.onReset())}),c(45,"i",29),r(46),a(),n(47,"button",30),u(48,W,2,1)(49,X,2,1),a()()()(),n(50,"div",31)(51,"div",32)(52,"div",33)(53,"h6",34),c(54,"i",35),r(55),a()(),n(56,"div",36)(57,"p",37),r(58),a(),n(59,"ul",38)(60,"li",39),c(61,"i",40),r(62),a(),n(63,"li",39),c(64,"i",41),r(65),a(),n(66,"li"),c(67,"i",42),r(68),a()()()()()()}if(o&2){let e=m();i(2),d("formGroup",e.vacationForm),i(),d("title",e.i18n.t("employee_vacations.required_information")),i(4),l(" ",e.i18n.t("fields.vacationType")," "),i(3),d("options",e.vacationTypeOptions)("placeholder",e.i18n.t("employee_vacations.placeholders.select_vacation_type"))("isInvalid",e.isFieldInvalid("vacationTypeId")),i(),f(e.hasError("vacationTypeId")?11:-1),i(3),S(e.i18n.t("employee_vacations.approval_status")),i(4),l(" ",e.i18n.t("employee_vacations.is_approved")," "),i(4),l(" ",e.i18n.t("fields.startDate")," "),i(3),x("is-invalid",e.isFieldInvalid("startDate")),d("disabled",e.saving())("placeholder",e.i18n.t("employee_vacations.placeholders.select_start_date")),i(),f(e.hasError("startDate")?26:-1),i(3),l(" ",e.i18n.t("fields.endDate")," "),i(3),x("is-invalid",e.isFieldInvalid("endDate")),d("disabled",e.saving())("placeholder",e.i18n.t("employee_vacations.placeholders.select_end_date")),i(),f(e.hasError("endDate")?33:-1),i(),d("title",e.i18n.t("employee_vacations.additional_information")),i(3),l(" ",e.i18n.t("fields.notes")," "),i(),d("disabled",e.saving())("placeholder",e.i18n.t("employee_vacations.placeholders.enter_notes")),i(3),d("disabled",e.saving()),i(2),l(" ",e.i18n.t("common.cancel")," "),i(),d("disabled",e.saving()),i(2),l(" ",e.i18n.t("common.reset")," "),i(),d("disabled",e.vacationForm.invalid||e.saving()),i(),f(e.saving()?48:49),i(7),l(" ",e.i18n.t("common.help")," "),i(3),l(" ",e.i18n.t("employee_vacations.help.edit_instructions")," "),i(4),l(" ",e.i18n.t("employee_vacations.help.required_fields")," "),i(3),l(" ",e.i18n.t("employee_vacations.help.date_validation")," "),i(3),l(" ",e.i18n.t("employee_vacations.help.approval_info")," ")}}var L=class o{fb=v(N);router=v(F);route=v(V);notificationService=v(G);employeeVacationsService=v(B);i18n=v(R);loading=g(!1);saving=g(!1);currentVacation=g(null);vacationId=null;vacationForm;vacationTypes=g([]);get vacationTypeOptions(){return this.vacationTypes().map(t=>({value:t.id,label:t.name}))}constructor(){this.vacationForm=this.createForm()}ngOnInit(){this.loadVacationTypes(),this.loadVacation()}createForm(){return this.fb.group({vacationTypeId:[null,[b.required]],startDate:["",[b.required]],endDate:["",[b.required]],isApproved:[!1],notes:[""]})}loadVacationTypes(){this.employeeVacationsService.getVacationTypes().subscribe({next:t=>{this.vacationTypes.set(t)},error:t=>{console.error("Failed to load vacation types:",t),this.notificationService.error(this.i18n.t("employee_vacations.errors.load_vacation_types_failed"))}})}loadVacation(){let t=this.route.snapshot.paramMap.get("id");if(!t){this.router.navigate(["/employee-vacations"]);return}this.vacationId=+t,this.loading.set(!0),this.employeeVacationsService.getVacationById(this.vacationId).subscribe({next:e=>{this.currentVacation.set(e),this.populateForm(e),this.loading.set(!1)},error:e=>{console.error("Failed to load vacation:",e),this.notificationService.error(this.i18n.t("employee_vacations.errors.load_failed")),this.loading.set(!1),this.router.navigate(["/employee-vacations"])}})}populateForm(t){this.vacationForm.patchValue({vacationTypeId:t.vacationTypeId,startDate:this.formatDateForInput(t.startDate),endDate:this.formatDateForInput(t.endDate),isApproved:t.isApproved,notes:t.notes||""})}formatDateForInput(t){if(!t)return"";let e=new Date(t);return e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0")}onSubmit(){if(this.vacationForm.invalid){this.markFormGroupTouched();return}let t=this.currentVacation();if(!t)return;this.saving.set(!0);let e=this.vacationForm.value,s={vacationTypeId:e.vacationTypeId,startDate:new Date(e.startDate),endDate:new Date(e.endDate),isApproved:e.isApproved,notes:e.notes||void 0};this.employeeVacationsService.updateVacation(t.id,s).subscribe({next:()=>{this.saving.set(!1),this.notificationService.success(this.i18n.t("employee_vacations.success.updated")),this.router.navigate(["/employee-vacations",t.id,"view"])},error:p=>{this.saving.set(!1),console.error("Failed to update vacation:",p),this.notificationService.error(this.i18n.t("employee_vacations.errors.update_failed"))}})}onCancel(){let t=this.currentVacation();t?this.router.navigate(["/employee-vacations",t.id,"view"]):this.router.navigate(["/employee-vacations"])}onReset(){let t=this.currentVacation();t&&this.populateForm(t)}markFormGroupTouched(){Object.keys(this.vacationForm.controls).forEach(t=>{let e=this.vacationForm.get(t);e&&e.markAsTouched()})}hasError(t){let e=this.vacationForm.get(t);return!!(e&&e.invalid&&(e.dirty||e.touched))}getErrorMessage(t){let e=this.vacationForm.get(t);return!e||!e.errors?"":e.errors.required?this.i18n.t("validation.required"):""}isFieldInvalid(t){return this.hasError(t)}getEmployeeName(){return this.currentVacation()?.employeeName||""}getFormMode(){return"edit"}getVacationId(){return this.vacationId||void 0}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=C({type:o,selectors:[["app-edit-employee-vacation"]],decls:4,vars:6,consts:[[1,"container-fluid"],["moduleName","employee-vacations","moduleRoute","employee-vacations",3,"mode","title","entityId","loading"],[1,"text-center","py-5"],[1,"row"],[3,"message","variant","centered"],[1,"col-lg-8"],[3,"ngSubmit","formGroup"],[3,"title"],[1,"col-md-6","mb-3"],["for","vacationTypeId",1,"form-label"],[1,"text-danger"],["id","vacationTypeId","formControlName","vacationTypeId",3,"options","placeholder","isInvalid"],[1,"invalid-feedback","d-block"],[1,"form-label"],[1,"form-check"],["type","checkbox","id","isApproved","formControlName","isApproved",1,"form-check-input"],["for","isApproved",1,"form-check-label"],["for","startDate",1,"form-label"],["type","date","id","startDate","formControlName","startDate",1,"form-control",3,"disabled","placeholder"],[1,"invalid-feedback"],["for","endDate",1,"form-label"],["type","date","id","endDate","formControlName","endDate",1,"form-control",3,"disabled","placeholder"],[1,"mb-3"],["for","notes",1,"form-label"],["id","notes","formControlName","notes","rows","4",1,"form-control",3,"disabled","placeholder"],[1,"d-flex","justify-content-end","gap-2","mt-4"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-times","me-2"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-undo","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"col-lg-4"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fas","fa-info-circle","me-2"],[1,"card-body"],[1,"card-text","small","text-muted","mb-2"],[1,"list-unstyled","small","text-muted","mb-0"],[1,"mb-1"],[1,"fas","fa-check-circle","text-success","me-1"],[1,"fas","fa-calendar","text-info","me-1"],[1,"fas","fa-shield-alt","text-warning","me-1"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"]],template:function(e,s){e&1&&(n(0,"div",0),c(1,"app-form-header",1),u(2,Y,2,3,"div",2),u(3,Z,69,36,"div",3),a()),e&2&&(i(),d("mode",s.getFormMode())("title",s.i18n.t("employee_vacations.edit_vacation"))("entityId",s.getVacationId())("loading",s.loading()),i(),f(s.loading()?2:-1),i(),f(!s.loading()&&s.currentVacation()?3:-1))},dependencies:[I,A,O,M,D,T,k,q,P,w,U,H,z,j],styles:[".form-label[_ngcontent-%COMP%]{font-weight:500;color:var(--bs-gray-700)}.form-control[_ngcontent-%COMP%]:disabled, .form-select[_ngcontent-%COMP%]:disabled{background-color:var(--bs-gray-100);opacity:.8}.invalid-feedback[_ngcontent-%COMP%]{font-size:.875rem}.form-check-label[_ngcontent-%COMP%]{font-weight:400;cursor:pointer}.form-check-input[_ngcontent-%COMP%]:checked{background-color:var(--bs-success);border-color:var(--bs-success)}.card-title[_ngcontent-%COMP%]{font-size:.95rem;font-weight:600}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:.375rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:not(:last-child){margin-right:.5rem}.help-card[_ngcontent-%COMP%]{position:sticky;top:1rem}.loading-container[_ngcontent-%COMP%]{min-height:200px;display:flex;align-items:center;justify-content:center;flex-direction:column}@media (max-width: 768px){.app-desktop-sidebar[_ngcontent-%COMP%]{flex-direction:column}.app-sidebar-content[_ngcontent-%COMP%]{margin-top:1rem}.help-card[_ngcontent-%COMP%]{position:static}.d-grid.gap-2[_ngcontent-%COMP%]{display:flex!important;flex-direction:column;gap:.5rem}.btn[_ngcontent-%COMP%]{margin-bottom:.5rem}.btn[_ngcontent-%COMP%]:last-child{margin-bottom:0}}"]})};export{L as EditEmployeeVacationComponent};
