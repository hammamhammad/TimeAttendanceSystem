import{a as s,b as t,c as i}from"./chunk-5BLMYARA.js";import{a as m}from"./chunk-SZUF4QIO.js";import{Sa as h,p as r,s as o}from"./chunk-LDUBOZPL.js";var d=class a{constructor(e){this.authService=e}userPermissions=h(()=>this.authService.currentUser()?.permissions||[]);has(e){let n=this.userPermissions();return n.includes(e)||n.includes("*")}hasAny(e){return e.some(n=>this.has(n))}hasAll(e){return e.every(n=>this.has(n))}hasRole(e){return this.authService.currentUser()?.roles?.includes(e)||!1}isAdmin(){return this.hasRole("Admin")}isSuperAdmin(){return this.hasRole("SuperAdmin")}canAccessBranch(e){let n=this.authService.currentUser();return!n?.branchIds||n.branchIds.length===0?!0:n.branchIds.includes(e)}canRead(e){return this.has(i.buildPermissionKey(e,s.READ))}canCreate(e){return this.has(i.buildPermissionKey(e,s.CREATE))}canUpdate(e){return this.has(i.buildPermissionKey(e,s.UPDATE))}canDelete(e){return this.has(i.buildPermissionKey(e,s.DELETE))}canExport(e){return this.has(i.buildPermissionKey(e,s.EXPORT))}canImport(e){return this.has(i.buildPermissionKey(e,s.IMPORT))}canManage(e){return this.has(i.buildPermissionKey(e,s.MANAGE))}canManageUsers(){return this.hasAny([i.buildPermissionKey(t.USER,s.CREATE),i.buildPermissionKey(t.USER,s.UPDATE),i.buildPermissionKey(t.USER,s.DELETE),i.buildPermissionKey(t.USER,s.MANAGE)])}canManageRoles(){return this.hasAny([i.buildPermissionKey(t.ROLE,s.CREATE),i.buildPermissionKey(t.ROLE,s.UPDATE),i.buildPermissionKey(t.ROLE,s.DELETE),i.buildPermissionKey(t.ROLE,s.MANAGE)])}canManageEmployees(){return this.hasAny([i.buildPermissionKey(t.EMPLOYEE,s.CREATE),i.buildPermissionKey(t.EMPLOYEE,s.UPDATE),i.buildPermissionKey(t.EMPLOYEE,s.DELETE),i.buildPermissionKey(t.EMPLOYEE,s.MANAGE)])}canAccessShifts(){return this.hasAny(["shift.read","shift.create","shift.update","shift.delete","shift.assign","shift.unassign","shift.export","shift.import"])}canAccessVacations(){return this.hasAny(["vacation.read","vacation.create","vacation.update","vacation.delete","vacation.manage","vacation.approve","vacation.reject","vacation.cancel"])}canReadEmployees(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("employee.read")}canManageEmployeesPolicy(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["employee.create","employee.update","employee.delete","employee.manage"])}canAssignEmployeeShifts(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("employee.assign")}canReadUsers(){return this.isSystemAdmin()||this.isAdmin()||this.has("user.read")}canManageUsersPolicy(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["user.create","user.update","user.delete","user.manage"])}canAssignUserRoles(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["user.assignRole","user.removeRole"])}canManageUserSessions(){return this.isSystemAdmin()||this.isAdmin()||this.has("user.session.manage")}canReadShifts(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("shift.read")}canManageShiftsPolicy(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["shift.create","shift.update","shift.delete","shift.manage"])}canReadBranches(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("branch.read")}canManageBranches(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["branch.create","branch.update","branch.delete","branch.manage"])}canReadDepartments(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("department.read")}canManageDepartments(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["department.create","department.update","department.delete","department.manage"])}canReadRoles(){return this.isSystemAdmin()||this.isAdmin()||this.has("role.read")}canManageRolesPolicy(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["role.create","role.update","role.delete","role.manage"])}canManagePermissions(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["permission.assign","permission.remove","permission.manage"])}canReadAttendance(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("attendance.read")}canManageAttendance(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["attendance.create","attendance.update","attendance.delete","attendance.manage"])}canReadSettings(){return this.isSystemAdmin()||this.isAdmin()||this.has("settings.read")}canManageSettings(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["settings.create","settings.update","settings.delete","settings.manage"])}canAccessReports(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.hasAny(["report.read","report.view","report.access"])}canAccessSecurityAudit(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["audit.read","audit.view","security.audit"])}canSystemAdministration(){return this.isSystemAdmin()||this.hasAny(["system.admin","system.configure","system.manage"])}canReadPublicHolidays(){return this.isSystemAdmin()||this.isAdmin()||this.has("publicHoliday.read")}canManagePublicHolidays(){return this.isSystemAdmin()||this.isAdmin()||this.hasAny(["publicHoliday.create","publicHoliday.update","publicHoliday.delete","publicHoliday.manage"])}canExportPublicHolidays(){return this.isSystemAdmin()||this.isAdmin()||this.has("publicHoliday.export")}canImportPublicHolidays(){return this.isSystemAdmin()||this.isAdmin()||this.has("publicHoliday.import")}canReadVacations(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.isEmployee()||this.has("vacation.read")}canManageVacations(){return this.isSystemAdmin()||this.isAdmin()||this.has("vacation.manage")}canCreateVacationRequests(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.isEmployee()||this.has("vacation.create")}canApproveVacations(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("vacation.approve")}canRejectVacations(){return this.isSystemAdmin()||this.isAdmin()||this.isManager()||this.has("vacation.reject")}isSystemAdmin(){return this.hasRole("SystemAdmin")}isManager(){return this.hasRole("Manager")}isEmployee(){return this.hasRole("Employee")}static \u0275fac=function(n){return new(n||a)(o(m))};static \u0275prov=r({token:a,factory:a.\u0275fac,providedIn:"root"})};export{d as a};
