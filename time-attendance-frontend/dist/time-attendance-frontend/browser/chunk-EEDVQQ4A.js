import{a as P}from"./chunk-6SPN6IP7.js";import{a as H}from"./chunk-IV5XH5NP.js";import{a as L}from"./chunk-6B6T6MZ3.js";import{c as T,e as F,h as N,z as O}from"./chunk-HF7V7ZC6.js";import"./chunk-A6EM5NV6.js";import{Bc as M,Eb as i,Fb as s,Gb as x,Ha as E,Hb as C,La as c,T as y,Xb as I,Yb as g,Zb as v,eb as d,fa as b,fb as e,gb as t,hb as m,qb as u,sb as f,uc as R,vc as A,wa as a,wc as w,yc as k,zc as D}from"./chunk-IGEIB4M6.js";import{a as S,b as h}from"./chunk-YMDWBF3A.js";var B=(r,o,n,l,p)=>({"bg-success-subtle text-success":r,"bg-danger-subtle text-danger":o,"bg-warning-subtle text-warning":n,"bg-info-subtle text-info":l,"bg-secondary-subtle text-secondary":p});function U(r,o){r&1&&(e(0,"div",17)(1,"div",18)(2,"span",19),i(3,"Loading..."),t()(),e(4,"p",20),i(5,"Loading report data..."),t()())}function j(r,o){if(r&1&&(e(0,"span",49),i(1),t()),r&2){let n=f().$implicit;a(),s(n.lateMinutes)}}function G(r,o){r&1&&(e(0,"span",40),i(1,"-"),t())}function W(r,o){if(r&1&&(e(0,"span",50),i(1),g(2,"number"),t()),r&2){let n=f().$implicit;a(),C(" ",v(2,2,n.weeklyTotalHours,"1.1-1")," / ",n.weeklyRequiredHours," ")}}function q(r,o){if(r&1&&(e(0,"span",51),i(1),g(2,"number"),t()),r&2){let n=f().$implicit;a(),x(" +",v(2,1,n.weeklyOvertimeHours,"1.1-1")," ")}}function V(r,o){if(r&1&&(e(0,"span",49),i(1),g(2,"number"),t()),r&2){let n=f().$implicit;a(),x(" -",v(2,1,n.weeklyShortageHours,"1.1-1")," ")}}function z(r,o){if(r&1&&(e(0,"tr")(1,"td"),i(2),g(3,"date"),t(),e(4,"td")(5,"div",38)(6,"span",39),i(7),t(),e(8,"small",40),i(9),t()()(),e(10,"td"),i(11),t(),e(12,"td",41),i(13),t(),e(14,"td",41),i(15),t(),e(16,"td",42),i(17),g(18,"number"),t(),e(19,"td",43),c(20,j,2,1,"span",44)(21,G,2,0,"span",45),t(),e(22,"td",43),c(23,W,3,5,"span",46),t(),e(24,"td",43),c(25,q,3,4,"span",47)(26,V,3,4,"span",44),t(),e(27,"td")(28,"span",48),i(29),t()()()),r&2){let n=o.$implicit;a(2),s(v(3,14,n.date,"mediumDate")),a(5),s(n.employeeName),a(2),s(n.departmentName),a(2),s(n.shiftName),a(2),s(n.checkIn||"-"),a(2),s(n.checkOut||"-"),a(2),s(v(18,17,n.workedHours,"1.2-2")),a(3),d("ngIf",n.lateMinutes>0),a(),d("ngIf",n.lateMinutes===0),a(2),d("ngIf",n.weeklyRequiredHours),a(2),d("ngIf",(n.weeklyOvertimeHours??0)>0),a(),d("ngIf",(n.weeklyShortageHours??0)>0),a(2),d("ngClass",I(20,B,n.status==="Present",n.status==="Absent",n.status==="Late",n.status==="OnLeave",n.status==="Holiday")),a(),x(" ",n.status," ")}}function J(r,o){r&1&&(e(0,"tr")(1,"td",52),m(2,"i",53),i(3," No attendance records found for this period. "),t()())}function K(r,o){if(r&1&&(e(0,"div",21)(1,"div",22)(2,"div",23),m(3,"app-stat-card",24),t(),e(4,"div",23),m(5,"app-stat-card",25),t(),e(6,"div",23),m(7,"app-stat-card",26),t(),e(8,"div",23),m(9,"app-stat-card",27),t()(),e(10,"div",28)(11,"div",29)(12,"h5",30),i(13,"Attendance Records"),t()(),e(14,"div",31)(15,"table",32)(16,"thead",33)(17,"tr")(18,"th",34),i(19,"Date"),t(),e(20,"th",34),i(21,"Employee"),t(),e(22,"th",34),i(23,"Shift"),t(),e(24,"th",34),i(25,"Check In"),t(),e(26,"th",34),i(27,"Check Out"),t(),e(28,"th",35),i(29,"Worked (Hrs)"),t(),e(30,"th",35),i(31,"Late (Min)"),t(),e(32,"th",35),i(33,"Weekly Hrs"),t(),e(34,"th",35),i(35,"Weekly OT"),t(),e(36,"th",34),i(37,"Status"),t()()(),e(38,"tbody"),c(39,z,30,26,"tr",36)(40,J,4,0,"tr",37),t()()()()()),r&2){let n,l,p=f();a(3),d("value",p.report().totalDays)("borderAccent",!0),a(2),d("value",p.report().totalPresent)("borderAccent",!0),a(2),d("value",p.report().totalLate)("borderAccent",!0),a(2),d("value",p.report().totalAbsent)("borderAccent",!0),a(30),d("ngForOf",(n=p.report())==null?null:n.items),a(),d("ngIf",((l=p.report())==null||l.items==null?null:l.items.length)===0)}}function Q(r,o){r&1&&(e(0,"div",54)(1,"div",55),m(2,"i",56),t(),e(3,"h5"),i(4,"No Report Generated"),t(),e(5,"p"),i(6,'Select a date range and click "Generate Report" to view data.'),t()())}var $=class r{reportsService=y(P);filter=b({fromDate:new Date().toISOString().split("T")[0],toDate:new Date().toISOString().split("T")[0]});report=b(null);loading=b(!1);updateFilter(o,n){this.filter.update(l=>h(S({},l),{[o]:n}))}loadReport(){this.loading.set(!0),this.reportsService.getAttendanceReport(this.filter()).subscribe({next:o=>{this.report.set(o),this.loading.set(!1)},error:o=>{console.error(o),this.loading.set(!1)}})}exportReport(){this.loading.set(!0),this.reportsService.exportAttendanceReport(this.filter()).subscribe({next:o=>{let n=window.URL.createObjectURL(o),l=document.createElement("a");l.href=n,l.download=`attendance-report-${this.filter().fromDate}-${this.filter().toDate}.csv`,l.click(),window.URL.revokeObjectURL(n),this.loading.set(!1)},error:o=>{console.error(o),this.loading.set(!1)}})}getStatusClass(o){switch(o){case"Present":return"badge-success";case"Absent":return"badge-error";case"Late":return"badge-warning";case"OnLeave":return"badge-info";default:return"badge-ghost"}}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=E({type:r,selectors:[["app-attendance-report"]],decls:27,vars:8,consts:[[1,"container-fluid","px-4","py-4"],["title","Attendance Report","subtitle","Daily attendance records and summaries"],[1,"card","border-0","shadow-sm","mb-4"],[1,"card-body"],[1,"row","g-3","align-items-end"],[1,"col-md-3"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],["type","text","placeholder","Optional",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","gap-2"],[1,"btn","btn-primary","flex-grow-1",3,"click","disabled"],[1,"fas","fa-search","me-1"],[1,"btn","btn-outline-success",3,"click","disabled"],[1,"fas","fa-file-csv"],["class","text-center py-5",4,"ngIf"],["class","animate__animated animate__fadeIn",4,"ngIf"],["class","text-center py-5 text-muted",4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"text-muted","mt-2"],[1,"animate__animated","animate__fadeIn"],[1,"row","g-4","mb-4"],[1,"col-md-6","col-lg-3"],["label","Total Days","icon","fas fa-calendar-day","variant","primary",3,"value","borderAccent"],["label","Present","icon","fas fa-user-check","variant","success",3,"value","borderAccent"],["label","Late","icon","fas fa-clock","variant","warning",3,"value","borderAccent"],["label","Absent","icon","fas fa-user-times","variant","danger",3,"value","borderAccent"],[1,"card","border-0","shadow-sm"],[1,"card-header","bg-transparent","py-3"],[1,"mb-0"],[1,"table-responsive"],[1,"table","table-hover","align-middle","mb-0"],[1,"bg-light"],[1,"border-0"],[1,"border-0","text-center"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"d-flex","flex-column"],[1,"fw-medium"],[1,"text-muted"],[1,"text-nowrap"],[1,"text-center","font-monospace"],[1,"text-center"],["class","text-danger fw-bold",4,"ngIf"],["class","text-muted",4,"ngIf"],["class","badge bg-light text-dark border",4,"ngIf"],["class","text-success fw-bold",4,"ngIf"],[1,"badge","rounded-pill",3,"ngClass"],[1,"text-danger","fw-bold"],[1,"badge","bg-light","text-dark","border"],[1,"text-success","fw-bold"],["colspan","8",1,"text-center","py-5","text-muted"],[1,"fas","fa-inbox","fa-2x","mb-3","d-block"],[1,"text-center","py-5","text-muted"],[1,"mb-3"],[1,"fas","fa-chart-bar","fa-3x","text-light-emphasis"]],template:function(n,l){n&1&&(e(0,"div",0),m(1,"app-page-header",1),e(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"label",6),i(7,"From Date"),t(),e(8,"input",7),u("ngModelChange",function(_){return l.updateFilter("fromDate",_)}),t()(),e(9,"div",5)(10,"label",6),i(11,"To Date"),t(),e(12,"input",7),u("ngModelChange",function(_){return l.updateFilter("toDate",_)}),t()(),e(13,"div",5)(14,"label",6),i(15,"Employee ID"),t(),e(16,"input",8),u("ngModelChange",function(_){return l.updateFilter("employeeId",_)}),t()(),e(17,"div",5)(18,"div",9)(19,"button",10),u("click",function(){return l.loadReport()}),m(20,"i",11),i(21," Generate "),t(),e(22,"button",12),u("click",function(){return l.exportReport()}),m(23,"i",13),t()()()()()(),c(24,U,6,0,"div",14)(25,K,41,10,"div",15)(26,Q,7,0,"div",16),t()),n&2&&(a(8),d("ngModel",l.filter().fromDate),a(4),d("ngModel",l.filter().toDate),a(4),d("ngModel",l.filter().employeeId),a(3),d("disabled",l.loading()),a(3),d("disabled",l.loading()||!l.report()),a(2),d("ngIf",l.loading()),a(),d("ngIf",l.report()&&!l.loading()),a(),d("ngIf",!l.report()&&!l.loading()))},dependencies:[M,R,A,w,O,T,F,N,L,H,D,k],encapsulation:2})};export{$ as AttendanceReportComponent};
