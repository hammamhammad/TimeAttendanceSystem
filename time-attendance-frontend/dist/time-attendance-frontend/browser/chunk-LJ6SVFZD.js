import{a as ae}from"./chunk-635VP34W.js";import{a as B}from"./chunk-5RFSWC3I.js";import{a as re}from"./chunk-ASABUVRV.js";import{a as R}from"./chunk-JTZMRZUG.js";import{a as oe}from"./chunk-O25DOBT4.js";import{a as A}from"./chunk-GC2ZOSF6.js";import{a as M,b as T}from"./chunk-5BLMYARA.js";import"./chunk-O7VLIHRG.js";import{p as ne,q as ie,w as N}from"./chunk-UWMUXUZF.js";import{b as I}from"./chunk-MCSGSJCX.js";import{C as o,H as E,L as f,M as D,R as F,S as L,Va as H,Wa as V,X as d,Y as a,Z as c,_ as p,ab as y,fa as x,ha as u,ja as l,lb as te,pa as S,qa as Z,ra as k,s as w,sa as m,t as _,ta as C,u as g,ua as b,va as z,y as h,ya as ee,z as X}from"./chunk-H3A4D7EH.js";import{a as K,b as Q,d as $}from"./chunk-DGAILPFQ.js";function de(n,t){if(n&1){let e=x();a(0,"button",24),u("click",function(){_(e);let r=l(3);return g(r.onAddDepartment())}),p(1,"i",25),c()}if(n&2){let e=l(3);d("title",e.i18n.t("department.addDepartment"))}}function me(n,t){if(n&1&&f(0,de,2,1,"button",23),n&2){let e=l(2);d("appHasPermission",e.PERMISSIONS.DEPARTMENT_CREATE)}}function se(n,t){if(n&1){let e=x();a(0,"button",35),u("click",function(){_(e);let r=l(4);return g(r.onBulkDelete())}),p(1,"i",36),m(2),c()}if(n&2){let e=l(4);o(2),b(" ",e.i18n.t("common.deleteSelected")," ")}}function pe(n,t){if(n&1&&f(0,se,3,1,"button",34),n&2){let e=l(3);d("appHasPermission",e.PERMISSIONS.DEPARTMENT_DELETE)}}function _e(n,t){if(n&1){let e=x();a(0,"div",26)(1,"div",27)(2,"div",28)(3,"span",29),p(4,"i",30),m(5),c(),a(6,"div",18),F(7,pe,1,1,"button",31),a(8,"button",32),u("click",function(){_(e);let r=l(2);return g(r.clearSelection())}),p(9,"i",33),m(10),c()()()()()}if(n&2){let e=l(2);o(5),z(" ",e.selectedDepartments().size," ",e.i18n.t("common.selected")," "),o(2),L(e.allowDelete?7:-1),o(3),b(" ",e.i18n.t("common.clearSelection")," ")}}function ge(n,t){if(n&1){let e=x();a(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"span",8),p(5,"i",9),c(),a(6,"input",10),u("input",function(r){_(e);let s=l();return g(s.onSearchChange(r.target.value))}),c()()(),a(7,"div",11)(8,"div",12)(9,"input",13),u("change",function(r){_(e);let s=l();return g(s.onShowInactiveChange(r.target.checked))}),c(),a(10,"label",14),m(11),c()()(),a(12,"div",11)(13,"div",12)(14,"input",15),u("change",function(r){_(e);let s=l();return g(s.showHierarchy.set(r.target.checked))}),c(),a(15,"label",16),m(16),c()()(),a(17,"div",17)(18,"div",18)(19,"button",19),u("click",function(){_(e);let r=l();return g(r.refresh())}),p(20,"i",20),c(),F(21,me,1,1,"button",21),c()()(),f(22,_e,11,4,"div",22),c()}if(n&2){let e=l();o(6),d("placeholder",e.i18n.t("common.search")+"...")("value",e.searchTerm()),o(3),d("checked",e.showInactive()),o(2),b(" ",e.i18n.t("common.showInactive")," "),o(3),d("checked",e.showHierarchy()),o(2),b(" ",e.i18n.t("department.showHierarchy")," "),o(3),d("title",e.i18n.t("common.refresh")),o(2),L(e.allowEdit?21:-1),o(),d("ngIf",e.selectedDepartments().size>0&&e.allowSelection)}}function ue(n,t){if(n&1&&(a(0,"div",37)(1,"div",38)(2,"span",39),m(3),c()()()),n&2){let e=l();o(3),b("",e.i18n.t("common.loading"),"...")}}function fe(n,t){if(n&1){let e=x();a(0,"th",55)(1,"div",12)(2,"input",56),u("change",function(){_(e);let r=l(2);return g(r.toggleAllSelection())}),c()()()}if(n&2){let e=l(2);o(2),d("checked",e.isAllPageSelected())("indeterminate",e.isSomePageSelected())}}function be(n,t){if(n&1&&(a(0,"th"),m(1),c()),n&2){let e=l(2);o(),C(e.i18n.t("department.path"))}}function xe(n,t){if(n&1&&(a(0,"th",57),m(1),c()),n&2){let e=l(2);o(),C(e.i18n.t("common.actions"))}}function Ce(n,t){if(n&1){let e=x();a(0,"td",55)(1,"div",12)(2,"input",68),u("change",function(r){_(e);let s=l().$implicit;return l(2).toggleSelection(s.id),g(r.stopPropagation())}),c()()()}if(n&2){let e=l().$implicit,i=l(2);o(2),d("checked",i.isSelected(e.id))}}function ve(n,t){if(n&1&&p(0,"div"),n&2){let e=l().$implicit,i=l(2);k(i.getIndentClass(e.level))}}function he(n,t){if(n&1&&(a(0,"div",69),m(1),c()),n&2){let e=l().$implicit;o(),C(e.nameAr)}}function De(n,t){if(n&1&&(a(0,"div",69),m(1),c()),n&2){let e=l().$implicit;o(),C(e.description)}}function we(n,t){if(n&1&&(a(0,"td")(1,"small",70),m(2),c()()),n&2){let e=l().$implicit;o(2),C(e.path)}}function Pe(n,t){if(n&1&&(a(0,"div",46),p(1,"i",71),m(2),c()),n&2){let e=l().$implicit;o(2),b(" ",e.managerName," ")}}function Me(n,t){n&1&&(a(0,"span",70),m(1,"-"),c())}function Te(n,t){if(n&1&&(a(0,"div",46),p(1,"i",72),m(2),c()),n&2){let e=l().$implicit;o(2),b(" ",e.location," ")}}function Se(n,t){n&1&&(a(0,"span",70),m(1,"-"),c())}function Ee(n,t){if(n&1){let e=x();a(0,"button",76),u("click",function(r){_(e);let s=l(2).$implicit;return l(2).onViewDepartment(s),g(r.stopPropagation())}),p(1,"i",77),c()}if(n&2){let e=l(4);d("title",e.i18n.t("common.view"))}}function ye(n,t){if(n&1){let e=x();a(0,"button",19),u("click",function(r){_(e);let s=l(3).$implicit;return l(2).onEditDepartment(s),g(r.stopPropagation())}),p(1,"i",79),c()}if(n&2){let e=l(5);d("title",e.i18n.t("common.edit"))}}function Ie(n,t){if(n&1&&f(0,ye,2,1,"button",78),n&2){let e=l(4);d("appHasPermission",e.PERMISSIONS.DEPARTMENT_UPDATE)}}function Oe(n,t){if(n&1){let e=x();a(0,"button",81),u("click",function(r){_(e);let s=l(3).$implicit;return l(2).onDeleteDepartment(s),g(r.stopPropagation())}),p(1,"i",82),c()}if(n&2){let e=l(5);d("title",e.i18n.t("common.delete"))}}function ke(n,t){if(n&1&&f(0,Oe,2,1,"button",80),n&2){let e=l(4);d("appHasPermission",e.PERMISSIONS.DEPARTMENT_DELETE)}}function Ve(n,t){if(n&1&&(a(0,"td",57)(1,"div",18),f(2,Ee,2,1,"button",73),F(3,Ie,1,1,"button",74),F(4,ke,1,1,"button",75),c()()),n&2){let e=l().$implicit,i=l(2);o(2),d("appHasPermission",i.PERMISSIONS.DEPARTMENT_READ),o(),L(i.allowEdit?3:-1),o(),L(i.allowDelete&&e.employeeCount===0?4:-1)}}function Ae(n,t){if(n&1){let e=x();a(0,"tr",58),u("click",function(){let r=_(e).$implicit,s=l(2);return g(s.selectDepartment(r))}),f(1,Ce,3,1,"td",44),a(2,"td")(3,"div",46),f(4,ve,1,2,"div",59),p(5,"i",60),a(6,"div")(7,"div",61),m(8),c(),f(9,he,2,1,"div",62)(10,De,2,1,"div",62),c()()(),a(11,"td")(12,"span",63),m(13),c()(),f(14,we,3,1,"td",48),a(15,"td"),f(16,Pe,3,1,"div",64)(17,Me,2,0,"span",65),c(),a(18,"td",66)(19,"span",67),m(20),c()(),a(21,"td"),f(22,Te,3,1,"div",64)(23,Se,2,0,"span",65),c(),a(24,"td",66)(25,"span",67),m(26),c()(),f(27,Ve,5,3,"td",51),c()}if(n&2){let e=t.$implicit,i=l(2);S("table-warning",!e.isActive)("selected-row",i.isSelected(e.id)),o(),d("ngIf",i.allowSelection),o(3),d("ngIf",i.showHierarchy()),o(4),C(e.name),o(),d("ngIf",e.nameAr),o(),d("ngIf",e.description),o(3),C(e.code),o(),d("ngIf",i.showHierarchy()),o(2),d("ngIf",e.managerName),o(),d("ngIf",!e.managerName),o(2),S("bg-success",e.employeeCount>0)("bg-secondary",e.employeeCount===0),o(),b(" ",e.employeeCount," "),o(2),d("ngIf",e.location),o(),d("ngIf",!e.location),o(2),S("bg-success",e.isActive)("bg-secondary",!e.isActive),o(),b(" ",e.isActive?i.i18n.t("common.active"):i.i18n.t("common.inactive")," "),o(),d("ngIf",i.showControls)}}function Ne(n,t){if(n&1){let e=x();a(0,"button",86),u("click",function(){_(e);let r=l(3);return g(r.onAddDepartment())}),p(1,"i",87),m(2),c()}if(n&2){let e=l(3);o(2),b(" ",e.i18n.t("department.addFirstDepartment")," ")}}function Re(n,t){if(n&1&&(a(0,"div",83),p(1,"i",84),a(2,"h5"),m(3),c(),a(4,"p"),m(5),c(),f(6,Ne,3,1,"button",85),c()),n&2){let e=l(2);o(3),C(e.i18n.t("department.noDepartments")),o(2),C(e.i18n.t("department.noDepartmentsDescription")),o(),d("ngIf",e.allowEdit)}}function Be(n,t){if(n&1&&(a(0,"option",101),m(1),c()),n&2){let e=t.$implicit;d("value",e),o(),C(e)}}function $e(n,t){if(n&1){let e=x();a(0,"button",104),u("click",function(){_(e);let r=l().$implicit,s=l(3);return g(s.onPageChange(r))}),m(1),c()}if(n&2){let e=l().$implicit;o(),b(" ",e," ")}}function Fe(n,t){n&1&&(a(0,"span",105),m(1,"..."),c())}function Le(n,t){if(n&1&&(a(0,"li",96),f(1,$e,2,1,"button",102)(2,Fe,2,0,"span",103),c()),n&2){let e=t.$implicit,i=l(3);S("active",e===i.currentPage())("disabled",e===-1),o(),d("ngIf",e!==-1),o(),d("ngIf",e===-1)}}function ze(n,t){if(n&1){let e=x();a(0,"nav",88)(1,"div",89)(2,"div",90)(3,"div",46)(4,"label",91),m(5),c(),a(6,"select",92),u("change",function(r){_(e);let s=l(2);return g(s.onPageSizeChange(+r.target.value))}),f(7,Be,2,2,"option",93),c(),a(8,"span",94),m(9),c()()(),a(10,"div",90)(11,"ul",95)(12,"li",96)(13,"button",97),u("click",function(){_(e);let r=l(2);return g(r.onPageChange(r.currentPage()-1))}),p(14,"i",98),c()(),f(15,Le,3,6,"li",99),a(16,"li",96)(17,"button",97),u("click",function(){_(e);let r=l(2);return g(r.onPageChange(r.currentPage()+1))}),p(18,"i",100),c()()()()()()}if(n&2){let e=l(2);o(5),b("",e.i18n.t("common.pageSize"),":"),o(),d("value",e.pageSize()),o(),d("ngForOf",e.pageSizeOptions),o(2),ee(" ",e.i18n.t("common.showing")," ",(e.currentPage()-1)*e.pageSize()+1,"-",e.Math.min(e.currentPage()*e.pageSize(),e.filteredDepartments().length)," ",e.i18n.t("common.of")," ",e.filteredDepartments().length," "),o(3),S("disabled",e.currentPage()===1),o(),d("disabled",e.currentPage()===1),o(2),d("ngForOf",e.getPageNumbers()),o(),S("disabled",e.currentPage()===e.totalPages()),o(),d("disabled",e.currentPage()===e.totalPages())}}function He(n,t){if(n&1){let e=x();a(0,"div",40)(1,"div",41)(2,"table",42)(3,"thead",43)(4,"tr"),f(5,fe,3,2,"th",44),a(6,"th",45),u("click",function(){_(e);let r=l();return g(r.onSort("name"))}),a(7,"div",46),m(8),p(9,"i",47),c()(),a(10,"th",45),u("click",function(){_(e);let r=l();return g(r.onSort("code"))}),a(11,"div",46),m(12),p(13,"i",47),c()(),f(14,be,2,1,"th",48),a(15,"th",45),u("click",function(){_(e);let r=l();return g(r.onSort("managerName"))}),a(16,"div",46),m(17),p(18,"i",47),c()(),a(19,"th",49),u("click",function(){_(e);let r=l();return g(r.onSort("employeeCount"))}),a(20,"div",50),m(21),p(22,"i",47),c()(),a(23,"th",45),u("click",function(){_(e);let r=l();return g(r.onSort("location"))}),a(24,"div",46),m(25),p(26,"i",47),c()(),a(27,"th",49),u("click",function(){_(e);let r=l();return g(r.onSort("isActive"))}),a(28,"div",50),m(29),p(30,"i",47),c()(),f(31,xe,2,1,"th",51),c()(),a(32,"tbody"),f(33,Ae,28,26,"tr",52),c()()(),f(34,Re,7,3,"div",53)(35,ze,19,15,"nav",54),c()}if(n&2){let e=l();o(5),d("ngIf",e.allowSelection),o(3),b(" ",e.i18n.t("department.name")," "),o(),k(e.getSortIcon("name")),o(3),b(" ",e.i18n.t("department.code")," "),o(),k(e.getSortIcon("code")),o(),d("ngIf",e.showHierarchy()),o(3),b(" ",e.i18n.t("department.manager")," "),o(),k(e.getSortIcon("managerName")),o(3),b(" ",e.i18n.t("common.employees")," "),o(),k(e.getSortIcon("employeeCount")),o(3),b(" ",e.i18n.t("department.location")," "),o(),k(e.getSortIcon("location")),o(3),b(" ",e.i18n.t("common.status")," "),o(),k(e.getSortIcon("isActive")),o(),d("ngIf",e.showControls),o(2),d("ngForOf",e.getPaginatedDepartments())("ngForTrackBy",e.trackByDeptId),o(),d("ngIf",e.getPaginatedDepartments().length===0),o(),d("ngIf",e.totalPages()>1)}}var j=class n{selectedBranchId;allowSelection=!0;allowEdit=!0;allowDelete=!0;showControls=!0;departmentSelected=new D;departmentView=new D;departmentEdit=new D;departmentDelete=new D;departmentAdd=new D;i18n=w(I);departmentsService=w(B);permissionService=w(A);PERMISSIONS={DEPARTMENT_CREATE:`${T.DEPARTMENT}.${M.CREATE}`,DEPARTMENT_READ:`${T.DEPARTMENT}.${M.READ}`,DEPARTMENT_UPDATE:`${T.DEPARTMENT}.${M.UPDATE}`,DEPARTMENT_DELETE:`${T.DEPARTMENT}.${M.DELETE}`};loading=h(!1);departments=h([]);filteredDepartments=h([]);selectedDepartments=h(new Set);sortConfig=h({column:"name",direction:"asc"});searchTerm=h("");showInactive=h(!1);currentPage=h(1);pageSize=h(10);totalPages=h(0);showHierarchy=h(!1);pageSizeOptions=[5,10,25,50,100];ngOnInit(){console.log("DepartmentTableComponent ngOnInit - selectedBranchId:",this.selectedBranchId),this.loadDepartments()}ngOnChanges(t){console.log("DepartmentTableComponent ngOnChanges:",t),t.selectedBranchId&&(console.log("selectedBranchId changed from",t.selectedBranchId.previousValue,"to",t.selectedBranchId.currentValue),this.loadDepartments())}loadDepartments(){console.log("loadDepartments called - selectedBranchId:",this.selectedBranchId),this.loading.set(!0),console.log("Making departments API call with params:",{branchId:this.selectedBranchId,includeTree:!1,includeInactive:this.showInactive()}),this.departmentsService.getDepartments({branchId:this.selectedBranchId,includeTree:!1,includeInactive:this.showInactive()}).subscribe({next:t=>{console.log("Departments API response:",t),t&&(this.departments.set(t),this.applyFiltersAndSort()),this.loading.set(!1)},error:t=>{console.error("Failed to load departments:",t),this.loading.set(!1)}})}applyFiltersAndSort(){let t=[...this.departments()],e=this.searchTerm().toLowerCase();e&&(t=t.filter(r=>r.name.toLowerCase().includes(e)||r.code.toLowerCase().includes(e)||r.nameAr&&r.nameAr.toLowerCase().includes(e)||r.description&&r.description.toLowerCase().includes(e)||r.costCenter&&r.costCenter.toLowerCase().includes(e)||r.path.toLowerCase().includes(e))),this.showInactive()||(t=t.filter(r=>r.isActive));let i=this.sortConfig();t.sort((r,s)=>{let v=r[i.column],P=s[i.column];if(v==null&&P==null)return 0;if(v==null)return i.direction==="asc"?1:-1;if(P==null)return i.direction==="asc"?-1:1;let O=0;return typeof v=="string"&&typeof P=="string"?O=v.localeCompare(P):typeof v=="number"&&typeof P=="number"?O=v-P:O=String(v).localeCompare(String(P)),i.direction==="asc"?O:-O}),this.filteredDepartments.set(t),this.updatePagination()}updatePagination(){let t=this.filteredDepartments().length,e=Math.ceil(t/this.pageSize());this.totalPages.set(e),this.currentPage()>e&&e>0&&this.currentPage.set(e)}getPaginatedDepartments(){let t=(this.currentPage()-1)*this.pageSize(),e=t+this.pageSize();return this.filteredDepartments().slice(t,e)}onSort(t){let e=this.sortConfig(),i=e.column===t&&e.direction==="asc"?"desc":"asc";this.sortConfig.set({column:t,direction:i}),this.applyFiltersAndSort()}getSortIcon(t){let e=this.sortConfig();return e.column!==t?"fas fa-sort":e.direction==="asc"?"fas fa-sort-up":"fas fa-sort-down"}onSearchChange(t){this.searchTerm.set(t),this.currentPage.set(1),this.applyFiltersAndSort()}onShowInactiveChange(t){this.showInactive.set(t),this.currentPage.set(1),this.loadDepartments()}onPageSizeChange(t){this.pageSize.set(t),this.currentPage.set(1),this.updatePagination()}onPageChange(t){this.currentPage.set(t)}getPageNumbers(){let t=this.totalPages(),e=this.currentPage(),i=[];if(t<=7)for(let r=1;r<=t;r++)i.push(r);else e<=4?i.push(1,2,3,4,5,-1,t):e>=t-3?i.push(1,-1,t-4,t-3,t-2,t-1,t):i.push(1,-1,e-1,e,e+1,-1,t);return i}selectDepartment(t){this.allowSelection&&this.departmentSelected.emit(t)}toggleSelection(t){let e=this.selectedDepartments();e.has(t)?e.delete(t):e.add(t),this.selectedDepartments.set(new Set(e))}toggleAllSelection(){let t=this.selectedDepartments(),e=this.getPaginatedDepartments();this.isAllPageSelected()?e.forEach(i=>t.delete(i.id)):e.forEach(i=>t.add(i.id)),this.selectedDepartments.set(new Set(t))}isSelected(t){return this.selectedDepartments().has(t)}isAllPageSelected(){let t=this.getPaginatedDepartments();return t.length>0&&t.every(e=>this.isSelected(e.id))}isSomePageSelected(){return this.getPaginatedDepartments().some(e=>this.isSelected(e.id))&&!this.isAllPageSelected()}onAddDepartment(){this.departmentAdd.emit()}onViewDepartment(t){this.departmentView.emit(t)}onEditDepartment(t){this.departmentEdit.emit(t)}onDeleteDepartment(t){this.departmentDelete.emit(t)}onBulkDelete(){let t=this.selectedDepartments();this.departments().filter(i=>t.has(i.id)).forEach(i=>this.departmentDelete.emit(i))}clearSelection(){this.selectedDepartments.set(new Set)}refresh(){this.loadDepartments()}getIndentClass(t){return`indent-${Math.min(t,5)}`}trackByDeptId(t,e){return e.id}Math=Math;static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-department-table"]],inputs:{selectedBranchId:"selectedBranchId",allowSelection:"allowSelection",allowEdit:"allowEdit",allowDelete:"allowDelete",showControls:"showControls"},outputs:{departmentSelected:"departmentSelected",departmentView:"departmentView",departmentEdit:"departmentEdit",departmentDelete:"departmentDelete",departmentAdd:"departmentAdd"},features:[X],decls:4,vars:3,consts:[[1,"department-table"],["class","table-controls mb-3",4,"ngIf"],["class","text-center p-4",4,"ngIf"],["class","table-container",4,"ngIf"],[1,"table-controls","mb-3"],[1,"row","g-2","align-items-center"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"input","placeholder","value"],[1,"col-md-3"],[1,"form-check"],["type","checkbox","id","showInactiveTable",1,"form-check-input",3,"change","checked"],["for","showInactiveTable",1,"form-check-label"],["type","checkbox","id","showHierarchy",1,"form-check-input",3,"change","checked"],["for","showHierarchy",1,"form-check-label"],[1,"col-md-2"],[1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-sync"],["type","button",1,"btn","btn-primary",3,"title"],["class","row mt-2",4,"ngIf"],["type","button","class","btn btn-primary",3,"title","click",4,"appHasPermission"],["type","button",1,"btn","btn-primary",3,"click","title"],[1,"fas","fa-plus"],[1,"row","mt-2"],[1,"col-12"],[1,"alert","alert-info","d-flex","align-items-center"],[1,"flex-grow-1"],[1,"fas","fa-info-circle","me-2"],["type","button",1,"btn","btn-outline-danger"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-times","me-1"],["type","button","class","btn btn-outline-danger",3,"click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash","me-1"],[1,"text-center","p-4"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"table-container"],[1,"table-responsive"],[1,"table","table-hover"],[1,"table-light","sticky-top"],["class","selection-column",4,"ngIf"],[1,"sortable",3,"click"],[1,"d-flex","align-items-center"],[1,"ms-2"],[4,"ngIf"],[1,"sortable","text-center",3,"click"],[1,"d-flex","align-items-center","justify-content-center"],["class","actions-column",4,"ngIf"],[3,"table-warning","selected-row","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center p-4 text-muted",4,"ngIf"],["aria-label","Department pagination","class","mt-3",4,"ngIf"],[1,"selection-column"],["type","checkbox",1,"form-check-input",3,"change","checked","indeterminate"],[1,"actions-column"],[3,"click"],[3,"class",4,"ngIf"],[1,"fas","fa-building","text-primary","me-2"],[1,"fw-medium"],["class","text-muted small",4,"ngIf"],[1,"badge","bg-light","text-dark","border"],["class","d-flex align-items-center",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"text-center"],[1,"badge"],["type","checkbox",1,"form-check-input",3,"change","checked"],[1,"text-muted","small"],[1,"text-muted"],[1,"fas","fa-user-tie","text-secondary","me-2"],[1,"fas","fa-map-marker-alt","text-secondary","me-2"],["type","button","class","btn btn-outline-primary",3,"title","click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-secondary",3,"title"],["type","button",1,"btn","btn-outline-danger",3,"title"],["type","button",1,"btn","btn-outline-primary",3,"click","title"],[1,"fas","fa-eye"],["type","button","class","btn btn-outline-secondary",3,"title","click",4,"appHasPermission"],[1,"fas","fa-edit"],["type","button","class","btn btn-outline-danger",3,"title","click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-danger",3,"click","title"],[1,"fas","fa-trash"],[1,"text-center","p-4","text-muted"],[1,"fas","fa-building","fa-3x","mb-3"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"],["aria-label","Department pagination",1,"mt-3"],[1,"row","align-items-center"],[1,"col-md-6"],[1,"form-label","me-2","mb-0"],[1,"form-select","form-select-sm",2,"width","auto",3,"change","value"],[3,"value",4,"ngFor","ngForOf"],[1,"text-muted","ms-3"],[1,"pagination","pagination-sm","justify-content-end","mb-0"],[1,"page-item"],[1,"page-link",3,"click","disabled"],[1,"fas","fa-chevron-left"],["class","page-item",3,"active","disabled",4,"ngFor","ngForOf"],[1,"fas","fa-chevron-right"],[3,"value"],["class","page-link",3,"click",4,"ngIf"],["class","page-link",4,"ngIf"],[1,"page-link",3,"click"],[1,"page-link"]],template:function(e,i){e&1&&(a(0,"div",0),f(1,ge,23,9,"div",1)(2,ue,4,1,"div",2)(3,He,36,25,"div",3),c()),e&2&&(o(),d("ngIf",i.showControls),o(),d("ngIf",i.loading()),o(),d("ngIf",!i.loading()))},dependencies:[y,H,V,N,ne,ie,R],styles:[".department-table[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.table-controls[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e9ecef;background-color:#f8f9fa;border-radius:8px 8px 0 0}.table-container[_ngcontent-%COMP%]{max-height:70vh;overflow-y:auto}.table[_ngcontent-%COMP%]{margin-bottom:0}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:2px solid #dee2e6;background-color:#f8f9fa;font-weight:600;color:#495057;position:sticky;top:0;z-index:10}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:all .2s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;cursor:pointer}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected-row[_ngcontent-%COMP%]{background-color:#e3f2fd;border-left:4px solid #2196f3}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-warning[_ngcontent-%COMP%]{background-color:#fff3cd}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.table-warning[_ngcontent-%COMP%]:hover{background-color:#ffeaa7}.selection-column[_ngcontent-%COMP%]{width:50px;text-align:center}.actions-column[_ngcontent-%COMP%]{width:100px;text-align:center}.sortable[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none;transition:color .2s ease}.sortable[_ngcontent-%COMP%]:hover{color:#2196f3;background-color:#f0f7ff}.sortable[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%]{font-size:.75rem;opacity:.6;transition:opacity .2s ease}.sortable[_ngcontent-%COMP%]:hover   .fas[_ngcontent-%COMP%]{opacity:1}.indent-0[_ngcontent-%COMP%]{margin-left:0}.indent-1[_ngcontent-%COMP%]{margin-left:20px}.indent-2[_ngcontent-%COMP%]{margin-left:40px}.indent-3[_ngcontent-%COMP%]{margin-left:60px}.indent-4[_ngcontent-%COMP%]{margin-left:80px}.indent-5[_ngcontent-%COMP%]{margin-left:100px}.badge[_ngcontent-%COMP%]{font-size:.7rem;padding:.35rem .6rem;font-weight:500}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border:none;box-shadow:0 1px 3px #0000001a;transition:all .2s ease}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 6px #00000026}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#2196f3;border-color:#2196f3}.btn-outline-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;border-color:#dc3545}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;border-color:#6c757d}.form-check-input[_ngcontent-%COMP%]{cursor:pointer;transition:all .2s ease}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#2196f3;border-color:#2196f3}.form-check-input[_ngcontent-%COMP%]:indeterminate{background-color:#ffc107;border-color:#ffc107}.form-select[_ngcontent-%COMP%]{cursor:pointer;transition:border-color .2s ease}.form-select[_ngcontent-%COMP%]:focus{border-color:#2196f3;box-shadow:0 0 0 .2rem #2196f340}.pagination[_ngcontent-%COMP%]{margin-bottom:0}.page-link[_ngcontent-%COMP%]{color:#6c757d;border:1px solid #dee2e6;transition:all .2s ease}.page-link[_ngcontent-%COMP%]:hover{color:#2196f3;background-color:#f8f9fa;border-color:#dee2e6}.page-item.active[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{background-color:#2196f3;border-color:#2196f3;color:#fff}.page-item.disabled[_ngcontent-%COMP%]   .page-link[_ngcontent-%COMP%]{color:#adb5bd;background-color:#fff;border-color:#dee2e6;cursor:not-allowed}.alert[_ngcontent-%COMP%]{border:none;border-radius:6px;box-shadow:0 1px 3px #0000001a}.alert-info[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#0277bd;border-left:4px solid #2196f3}.spinner-border[_ngcontent-%COMP%]{color:#2196f3;width:3rem;height:3rem}.text-muted[_ngcontent-%COMP%]   i.fa-3x[_ngcontent-%COMP%]{color:#adb5bd!important;margin-bottom:1rem}[dir=rtl][_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected-row[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #2196f3}[dir=rtl][_ngcontent-%COMP%]   .indent-1[_ngcontent-%COMP%]{margin-right:20px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-2[_ngcontent-%COMP%]{margin-right:40px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-3[_ngcontent-%COMP%]{margin-right:60px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-4[_ngcontent-%COMP%]{margin-right:80px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .indent-5[_ngcontent-%COMP%]{margin-right:100px;margin-left:0}[dir=rtl][_ngcontent-%COMP%]   .alert-info[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #2196f3}@media (max-width: 768px){.table-controls[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:.5rem}.table-responsive[_ngcontent-%COMP%]{font-size:.875rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.25rem .5rem;font-size:.75rem}.badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .4rem}.pagination[_ngcontent-%COMP%]{justify-content:center;margin-top:1rem}.d-flex.align-items-center[_ngcontent-%COMP%]   span.text-muted[_ngcontent-%COMP%]{display:none}}@media (max-width: 576px){.table-container[_ngcontent-%COMP%]{max-height:60vh}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem .25rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .25rem}.btn-group[_ngcontent-%COMP%]{flex-direction:column}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:2px;border-radius:4px!important}.actions-column[_ngcontent-%COMP%]{width:80px}}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px;height:8px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.table-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.badge.bg-success[_ngcontent-%COMP%]{background-color:#198754!important}.badge.bg-secondary[_ngcontent-%COMP%]{background-color:#6c757d!important}.badge.bg-light[_ngcontent-%COMP%]{background-color:#f8f9fa!important;border:1px solid #dee2e6}.text-primary[_ngcontent-%COMP%]{color:#2196f3!important}.text-secondary[_ngcontent-%COMP%], .text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.sortable[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .2s ease}.sortable[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transition:transform .2s ease}.btn-outline-primary[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%], .btn-outline-danger[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%], .btn-outline-secondary[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:focus-within{outline:2px solid #2196f3;outline-offset:-2px}.btn[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #2196f340}@media print{.table-controls[_ngcontent-%COMP%], .actions-column[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]{display:none!important}.table[_ngcontent-%COMP%]{font-size:.8rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected-row[_ngcontent-%COMP%]{background-color:transparent!important;border-left:none!important}}"]})};function je(n,t){if(n&1){let e=x();a(0,"button",22),u("click",function(){_(e);let r=l(2);return g(r.onAddDepartment())}),p(1,"i",23),c()}if(n&2){let e=l(2);d("title",e.i18n.t("department.addDepartment"))}}function Ue(n,t){if(n&1){let e=x();a(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7)(4,"span",8),p(5,"i",9),c(),a(6,"input",10),u("input",function(r){_(e);let s=l();return g(s.onSearchChange(r.target.value))}),c()()(),a(7,"div",11)(8,"div",12)(9,"input",13),u("change",function(r){_(e);let s=l();return g(s.onShowInactiveChange(r.target.checked))}),c(),a(10,"label",14),m(11),c()()(),a(12,"div",15)(13,"div",16)(14,"button",17),u("click",function(){_(e);let r=l();return g(r.expandAll())}),p(15,"i",18),c(),a(16,"button",17),u("click",function(){_(e);let r=l();return g(r.collapseAll())}),p(17,"i",19),c(),a(18,"button",17),u("click",function(){_(e);let r=l();return g(r.refresh())}),p(19,"i",20),c(),f(20,je,2,1,"button",21),c()()()()}if(n&2){let e=l();o(6),d("placeholder",e.i18n.t("common.search")+"...")("value",e.searchTerm()),o(3),d("checked",e.showInactive()),o(2),b(" ",e.i18n.t("common.showInactive")," "),o(3),d("title",e.i18n.t("common.expandAll")),o(2),d("title",e.i18n.t("common.collapseAll")),o(2),d("title",e.i18n.t("common.refresh")),o(2),d("ngIf",e.allowEdit)}}function Ye(n,t){if(n&1&&(a(0,"div",24)(1,"div",25)(2,"span",26),m(3),c()()()),n&2){let e=l();o(3),b("",e.i18n.t("common.loading"),"...")}}function Ge(n,t){if(n&1){let e=x();a(0,"button",44),u("click",function(r){_(e);let s=l().$implicit;return l(2).toggleNode(s.id),g(r.stopPropagation())}),p(1,"i",45),c()}if(n&2){let e=l().$implicit,i=l(2);o(),S("fa-chevron-right",!i.isExpanded(e.id))("fa-chevron-down",i.isExpanded(e.id))}}function qe(n,t){n&1&&p(0,"div",46)}function Je(n,t){if(n&1&&(a(0,"span",47),m(1),c()),n&2){let e=l(3);o(),b(" ",e.i18n.t("common.inactive")," ")}}function Ke(n,t){if(n&1&&(a(0,"div",48),m(1),c()),n&2){let e=l().$implicit;o(),b(" ",e.description," ")}}function Qe(n,t){if(n&1&&(a(0,"span"),p(1,"i",49),m(2),c()),n&2){let e=l().$implicit;o(2),b(" ",e.managerName," ")}}function We(n,t){if(n&1&&(a(0,"span",50),p(1,"i",51),m(2),c()),n&2){let e=l().$implicit,i=l(2);o(2),z(" ",e.employeeCount," ",i.i18n.t("common.employees")," ")}}function Xe(n,t){if(n&1&&(a(0,"span",50),p(1,"i",52),m(2),c()),n&2){let e=l().$implicit;o(2),b(" ",e.location," ")}}function Ze(n,t){if(n&1){let e=x();a(0,"button",59),u("click",function(r){_(e);let s=l(2).$implicit;return l(2).onAddDepartment(s),g(r.stopPropagation())}),p(1,"i",23),c()}if(n&2){let e=l(4);d("title",e.i18n.t("department.addSubDepartment"))}}function et(n,t){if(n&1){let e=x();a(0,"button",17),u("click",function(r){_(e);let s=l(2).$implicit;return l(2).onEditDepartment(s),g(r.stopPropagation())}),p(1,"i",60),c()}if(n&2){let e=l(4);d("title",e.i18n.t("common.edit"))}}function tt(n,t){if(n&1){let e=x();a(0,"button",61),u("click",function(r){_(e);let s=l(2).$implicit;return l(2).onDeleteDepartment(s),g(r.stopPropagation())}),p(1,"i",62),c()}if(n&2){let e=l(4);d("title",e.i18n.t("common.delete"))}}function nt(n,t){if(n&1){let e=x();a(0,"div",53)(1,"div",16)(2,"button",54),u("click",function(r){_(e);let s=l().$implicit;return l(2).onViewDepartment(s),g(r.stopPropagation())}),p(3,"i",55),c(),f(4,Ze,2,1,"button",56)(5,et,2,1,"button",57)(6,tt,2,1,"button",58),c()()}if(n&2){let e=l().$implicit,i=l(2);o(2),d("title",i.i18n.t("common.view")),o(2),d("ngIf",i.allowEdit),o(),d("ngIf",i.allowEdit),o(),d("ngIf",i.allowDelete&&e.employeeCount===0)}}function it(n,t){if(n&1){let e=x();a(0,"div",30)(1,"div",31),u("click",function(){let r=_(e).$implicit,s=l(2);return g(s.selectNode(r))}),f(2,Ge,2,4,"button",32)(3,qe,1,0,"div",33),p(4,"i",34),a(5,"div",35)(6,"div",36)(7,"strong"),m(8),c(),a(9,"span",37),m(10),c(),f(11,Je,2,1,"span",38),c(),f(12,Ke,2,1,"div",39),a(13,"div",40),f(14,Qe,3,1,"span",41)(15,We,3,2,"span",42)(16,Xe,3,1,"span",42),c()(),f(17,nt,7,4,"div",43),c()()}if(n&2){let e=t.$implicit,i=l(2);S("selected",i.isSelected(e.id))("inactive",!e.isActive),o(),Z(i.getIndentStyle(e.indentLevel)),o(),d("ngIf",e.hasChildren),o(),d("ngIf",!e.hasChildren),o(5),C(e.name),o(2),b("(",e.code,")"),o(),d("ngIf",!e.isActive),o(),d("ngIf",e.description),o(2),d("ngIf",e.managerName),o(),d("ngIf",e.employeeCount>0),o(),d("ngIf",e.location),o(),d("ngIf",i.showControls)}}function ot(n,t){if(n&1){let e=x();a(0,"button",66),u("click",function(){_(e);let r=l(3);return g(r.onAddDepartment())}),p(1,"i",67),m(2),c()}if(n&2){let e=l(3);o(2),b(" ",e.i18n.t("department.addFirstDepartment")," ")}}function rt(n,t){if(n&1&&(a(0,"div",63),p(1,"i",64),a(2,"h5"),m(3),c(),a(4,"p"),m(5),c(),f(6,ot,3,1,"button",65),c()),n&2){let e=l(2);o(3),C(e.i18n.t("department.noDepartments")),o(2),C(e.i18n.t("department.noDepartmentsDescription")),o(),d("ngIf",e.allowEdit)}}function at(n,t){if(n&1&&(a(0,"div",27),f(1,it,18,16,"div",28)(2,rt,7,3,"div",29),c()),n&2){let e=l();o(),d("ngForOf",e.getVisibleNodes())("ngForTrackBy",e.trackByNodeId),o(),d("ngIf",e.getVisibleNodes().length===0)}}var G=class n{selectedBranchId;allowSelection=!0;allowEdit=!0;allowDelete=!0;showControls=!0;departmentSelected=new D;departmentView=new D;departmentEdit=new D;departmentDelete=new D;departmentAdd=new D;i18n=w(I);departmentsService=w(B);loading=h(!1);departments=h([]);expandedNodes=h(new Set);selectedNode=h(null);searchTerm=h("");showInactive=h(!1);ngOnInit(){this.loadDepartments()}loadDepartments(){return $(this,null,function*(){this.loading.set(!0);try{let t=yield this.departmentsService.getDepartmentTree(this.selectedBranchId).toPromise();t&&this.departments.set(this.convertToTreeNodes(t))}catch(t){console.error("Failed to load departments:",t)}finally{this.loading.set(!1)}})}convertToTreeNodes(t){return t.map(e=>Q(K({},e),{expanded:!1,selected:!1,indentLevel:e.level,children:e.children?this.convertToTreeNodes(e.children):[]}))}toggleNode(t){let e=this.expandedNodes();e.has(t)?e.delete(t):e.add(t),this.expandedNodes.set(new Set(e))}selectNode(t){this.allowSelection&&(this.selectedNode.set(t.id),this.departmentSelected.emit(t))}isExpanded(t){return this.expandedNodes().has(t)}isSelected(t){return this.selectedNode()===t}getVisibleNodes(){let t=[],e=this.searchTerm().toLowerCase(),i=this.showInactive(),r=(s,v=0)=>{for(let P of s){let O=!e||P.name.toLowerCase().includes(e)||P.code.toLowerCase().includes(e)||P.nameAr&&P.nameAr.toLowerCase().includes(e),le=i||P.isActive;O&&le&&t.push(Q(K({},P),{indentLevel:v})),P.children&&this.isExpanded(P.id)&&r(P.children,v+1)}};return r(this.departments()),t}expandAll(){let t=this.getAllNodeIds(this.departments());this.expandedNodes.set(new Set(t))}collapseAll(){this.expandedNodes.set(new Set)}getAllNodeIds(t){let e=[];for(let i of t)e.push(i.id),i.children&&e.push(...this.getAllNodeIds(i.children));return e}onAddDepartment(t){this.departmentAdd.emit({parentId:t?.id})}onViewDepartment(t){this.departmentView.emit(t)}onEditDepartment(t){this.departmentEdit.emit(t)}onDeleteDepartment(t){this.departmentDelete.emit(t)}getIndentStyle(t){return`margin-left: ${(t||0)*20}px`}onSearchChange(t){this.searchTerm.set(t),t&&this.expandMatchingNodes()}expandMatchingNodes(){let t=this.searchTerm().toLowerCase(),e=new Set,i=(r,s=[])=>{for(let v of r)(v.name.toLowerCase().includes(t)||v.code.toLowerCase().includes(t)||v.nameAr&&v.nameAr.toLowerCase().includes(t))&&s.forEach(O=>e.add(O)),v.children&&i(v.children,[...s,v.id])};i(this.departments()),this.expandedNodes.set(e)}onShowInactiveChange(t){this.showInactive.set(t)}refresh(){this.loadDepartments()}trackByNodeId(t,e){return e.id}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-department-tree"]],inputs:{selectedBranchId:"selectedBranchId",allowSelection:"allowSelection",allowEdit:"allowEdit",allowDelete:"allowDelete",showControls:"showControls"},outputs:{departmentSelected:"departmentSelected",departmentView:"departmentView",departmentEdit:"departmentEdit",departmentDelete:"departmentDelete",departmentAdd:"departmentAdd"},decls:4,vars:3,consts:[[1,"department-tree"],["class","tree-controls mb-3",4,"ngIf"],["class","text-center p-4",4,"ngIf"],["class","tree-container",4,"ngIf"],[1,"tree-controls","mb-3"],[1,"row","g-2","align-items-center"],[1,"col-md-4"],[1,"input-group"],[1,"input-group-text"],[1,"fas","fa-search"],["type","text",1,"form-control",3,"input","placeholder","value"],[1,"col-md-3"],[1,"form-check"],["type","checkbox","id","showInactive",1,"form-check-input",3,"change","checked"],["for","showInactive",1,"form-check-label"],[1,"col-md-5"],[1,"btn-group","btn-group-sm"],["type","button",1,"btn","btn-outline-secondary",3,"click","title"],[1,"fas","fa-expand-arrows-alt"],[1,"fas","fa-compress-arrows-alt"],[1,"fas","fa-sync"],["type","button","class","btn btn-primary",3,"title","click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click","title"],[1,"fas","fa-plus"],[1,"text-center","p-4"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"tree-container"],["class","tree-node",3,"selected","inactive",4,"ngFor","ngForOf","ngForTrackBy"],["class","text-center p-4 text-muted",4,"ngIf"],[1,"tree-node"],[1,"node-content","d-flex","align-items-center","p-2",3,"click"],["type","button","class","btn btn-sm btn-link expand-btn p-0 me-2",3,"click",4,"ngIf"],["class","expand-spacer me-2",4,"ngIf"],[1,"fas","fa-building","me-2","text-primary"],[1,"node-info","flex-grow-1"],[1,"node-title"],[1,"text-muted","ms-1"],["class","badge bg-secondary ms-2",4,"ngIf"],["class","node-subtitle text-muted small",4,"ngIf"],[1,"node-meta","text-muted","small"],[4,"ngIf"],["class","ms-2",4,"ngIf"],["class","node-actions",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-link","expand-btn","p-0","me-2",3,"click"],[1,"fas"],[1,"expand-spacer","me-2"],[1,"badge","bg-secondary","ms-2"],[1,"node-subtitle","text-muted","small"],[1,"fas","fa-user-tie","me-1"],[1,"ms-2"],[1,"fas","fa-users","me-1"],[1,"fas","fa-map-marker-alt","me-1"],[1,"node-actions"],["type","button",1,"btn","btn-outline-primary",3,"click","title"],[1,"fas","fa-eye"],["type","button","class","btn btn-outline-success",3,"title","click",4,"ngIf"],["type","button","class","btn btn-outline-secondary",3,"title","click",4,"ngIf"],["type","button","class","btn btn-outline-danger",3,"title","click",4,"ngIf"],["type","button",1,"btn","btn-outline-success",3,"click","title"],[1,"fas","fa-edit"],["type","button",1,"btn","btn-outline-danger",3,"click","title"],[1,"fas","fa-trash"],[1,"text-center","p-4","text-muted"],[1,"fas","fa-building","fa-3x","mb-3"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus","me-2"]],template:function(e,i){e&1&&(a(0,"div",0),f(1,Ue,21,8,"div",1)(2,Ye,4,1,"div",2)(3,at,3,3,"div",3),c()),e&2&&(o(),d("ngIf",i.showControls),o(),d("ngIf",i.loading()),o(),d("ngIf",!i.loading()))},dependencies:[y,H,V,N],styles:[".department-tree[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.tree-controls[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e9ecef;background-color:#f8f9fa;border-radius:8px 8px 0 0}.tree-container[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto}.tree-node[_ngcontent-%COMP%]{border-bottom:1px solid #f8f9fa;transition:all .2s ease}.tree-node[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.tree-node.selected[_ngcontent-%COMP%]{background-color:#e3f2fd;border-left:4px solid #2196f3}.tree-node.inactive[_ngcontent-%COMP%]{opacity:.6}.node-content[_ngcontent-%COMP%]{cursor:pointer;position:relative;min-height:48px}.expand-btn[_ngcontent-%COMP%]{width:24px;height:24px;border:none!important;color:#6c757d;display:flex;align-items:center;justify-content:center}.expand-btn[_ngcontent-%COMP%]:hover{color:#495057;background-color:#e9ecef;border-radius:4px}.expand-spacer[_ngcontent-%COMP%]{width:24px;height:24px}.node-info[_ngcontent-%COMP%]{min-height:36px;display:flex;flex-direction:column;justify-content:center}.node-title[_ngcontent-%COMP%]{font-weight:500;color:#212529;line-height:1.2}.node-subtitle[_ngcontent-%COMP%]{margin-top:2px;font-size:.875rem;line-height:1.2}.node-meta[_ngcontent-%COMP%]{margin-top:2px;font-size:.75rem;line-height:1.2}.node-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-flex;align-items:center}.node-actions[_ngcontent-%COMP%]{opacity:0;transition:opacity .2s ease}.tree-node[_ngcontent-%COMP%]:hover   .node-actions[_ngcontent-%COMP%]{opacity:1}.node-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border:none;box-shadow:0 1px 3px #0000001a}.node-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 6px #00000026}[dir=rtl][_ngcontent-%COMP%]   .tree-node.selected[_ngcontent-%COMP%]{border-left:none;border-right:4px solid #2196f3}[dir=rtl][_ngcontent-%COMP%]   .node-content[_ngcontent-%COMP%]{flex-direction:row-reverse}@media (max-width: 768px){.tree-controls[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-bottom:.5rem}.node-actions[_ngcontent-%COMP%]{opacity:1}.node-actions[_ngcontent-%COMP%]   .btn-group[_ngcontent-%COMP%]{flex-direction:column}.node-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-left:0!important;margin-top:2px}}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.tree-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.tree-node[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.spinner-border[_ngcontent-%COMP%]{color:#2196f3}.text-muted[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#adb5bd!important}.badge[_ngcontent-%COMP%]{font-size:.65rem;padding:.25rem .5rem}.btn-outline-success[_ngcontent-%COMP%]:hover, .btn-outline-primary[_ngcontent-%COMP%]:hover, .btn-outline-danger[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}"]})};function ct(n,t){if(n&1){let e=x();a(0,"button",16),u("click",function(){_(e);let r=l();return g(r.onDepartmentAdd())}),p(1,"i",17),m(2),c()}if(n&2){let e=l();d("disabled",e.branchesLoading),o(2),b(" ",e.i18n.t("department.addDepartment")," ")}}var q=class n{i18n=w(I);branchesService=w(ae);permissionService=w(A);viewMode="table";selectedBranch=null;branchesLoading=!1;viewModeChange=new D;branchSelectionChange=new D;departmentAdd=new D;branches=h([]);PERMISSIONS={DEPARTMENT_CREATE:`${T.DEPARTMENT}.${M.CREATE}`};get branchSelectOptions(){let t=[{value:"",label:this.i18n.t("common.selectBranch")}];return this.branches().forEach(e=>{t.push({value:e.id.toString(),label:`${e.name} (${e.code})`})}),t}ngOnInit(){this.loadBranches()}loadBranches(){this.branchesService.getBranchesForDropdown().subscribe({next:t=>{let e=t.map(i=>({id:i.id,name:i.name,code:i.code,location:void 0,isActive:i.isActive}));this.branches.set(e)},error:t=>{console.error("Failed to load branches:",t)}})}onViewModeChange(t){this.viewModeChange.emit(t)}onBranchSelectionChange(t){this.branchSelectionChange.emit(t)}onDepartmentAdd(){this.departmentAdd.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-department-filters"]],inputs:{viewMode:"viewMode",selectedBranch:"selectedBranch",branchesLoading:"branchesLoading"},outputs:{viewModeChange:"viewModeChange",branchSelectionChange:"branchSelectionChange",departmentAdd:"departmentAdd"},decls:21,vars:13,consts:[[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3"],[1,"col-md-4"],[1,"form-label"],[3,"selectionChange","options","value","placeholder","searchable","clearable","loading"],[1,"col-md-3"],["role","group",1,"btn-group","w-100"],["type","radio","name","viewMode","id","tableView",1,"btn-check",3,"change","checked"],["for","tableView",1,"btn","btn-outline-primary"],[1,"fas","fa-table","me-2"],["type","radio","name","viewMode","id","treeView",1,"btn-check",3,"change","checked"],["for","treeView",1,"btn","btn-outline-primary"],[1,"fas","fa-sitemap","me-2"],[1,"col-md-3","d-flex","align-items-end"],["type","button","class","btn btn-primary",3,"disabled","click",4,"appHasPermission"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"fas","fa-plus","me-2"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),m(5),c(),a(6,"app-searchable-select",5),u("selectionChange",function(s){return i.onBranchSelectionChange(s)}),c()(),a(7,"div",6)(8,"label",4),m(9),c(),a(10,"div",7)(11,"input",8),u("change",function(){return i.onViewModeChange("table")}),c(),a(12,"label",9),p(13,"i",10),m(14),c(),a(15,"input",11),u("change",function(){return i.onViewModeChange("tree")}),c(),a(16,"label",12),p(17,"i",13),m(18),c()()(),a(19,"div",14),f(20,ct,3,2,"button",15),c()()()()),e&2&&(o(5),C(i.i18n.t("common.branch")),o(),d("options",i.branchSelectOptions)("value",(i.selectedBranch==null||i.selectedBranch.id==null?null:i.selectedBranch.id.toString())||"")("placeholder",i.i18n.t("common.selectBranch"))("searchable",!0)("clearable",!1)("loading",i.branchesLoading),o(3),C(i.i18n.t("common.view")),o(2),d("checked",i.viewMode==="table"),o(3),b(" ",i.i18n.t("common.table")," "),o(),d("checked",i.viewMode==="tree"),o(3),b(" ",i.i18n.t("common.tree")," "),o(2),d("appHasPermission",i.PERMISSIONS.DEPARTMENT_CREATE))},dependencies:[y,R,re],styles:[".card[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 2px 4px #0000001a}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#333;margin-bottom:.5rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:0}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:first-child{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.btn-outline-primary[_ngcontent-%COMP%]:checked + .btn[_ngcontent-%COMP%], .btn-check[_ngcontent-%COMP%]:checked + .btn-outline-primary[_ngcontent-%COMP%]{background-color:#0d6efd;border-color:#0d6efd;color:#fff}@media (max-width: 768px){.col-md-3.d-flex[_ngcontent-%COMP%]{margin-top:1rem}.btn-group[_ngcontent-%COMP%]{flex-direction:column}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:.375rem!important;margin-bottom:.25rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-bottom:0}}"]})};function lt(n,t){if(n&1&&(a(0,"p",24),m(1),c()),n&2){let e=l(2);o(),b(" ",e.selectedDepartment.description," ")}}function dt(n,t){if(n&1&&(a(0,"div",16)(1,"small",17),m(2),c(),p(3,"br"),a(4,"strong"),m(5),c()()),n&2){let e=l(2);o(2),C(e.i18n.t("department.manager")),o(3),C(e.selectedDepartment.managerName)}}function mt(n,t){if(n&1&&(a(0,"div",16)(1,"small",17),m(2),c(),p(3,"br"),a(4,"strong"),m(5),c()()),n&2){let e=l(2);o(2),C(e.i18n.t("department.location")),o(3),C(e.selectedDepartment.location)}}function st(n,t){if(n&1){let e=x();a(0,"button",25),u("click",function(){_(e);let r=l(2);return g(r.onDepartmentView())}),p(1,"i",26),m(2),c()}if(n&2){let e=l(2);o(2),b(" ",e.i18n.t("common.view")," ")}}function pt(n,t){if(n&1){let e=x();a(0,"button",27),u("click",function(){_(e);let r=l(2);return g(r.onDepartmentEdit())}),p(1,"i",28),m(2),c()}if(n&2){let e=l(2);o(2),b(" ",e.i18n.t("common.edit")," ")}}function _t(n,t){if(n&1){let e=x();a(0,"button",29),u("click",function(){_(e);let r=l(2);return g(r.onDepartmentDelete())}),p(1,"i",30),m(2),c()}if(n&2){let e=l(2);d("disabled",e.selectedDepartment.employeeCount>0),o(2),b(" ",e.i18n.t("common.delete")," ")}}function gt(n,t){if(n&1){let e=x();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div"),p(5,"i",5),m(6),c(),a(7,"button",6),u("click",function(){_(e);let r=l();return g(r.onClosePanel())}),p(8,"i",7),c()()(),a(9,"div",8)(10,"div",9)(11,"div",10)(12,"h6",11),m(13),c(),a(14,"p",12),m(15),c(),f(16,lt,2,1,"p",13),c(),a(17,"div",10)(18,"div",14),f(19,dt,6,2,"div",15),a(20,"div",16)(21,"small",17),m(22),c(),p(23,"br"),a(24,"strong"),m(25),c()(),f(26,mt,6,2,"div",15),a(27,"div",16)(28,"small",17),m(29),c(),p(30,"br"),a(31,"span",18),m(32),c()()()()(),a(33,"div",19)(34,"div",20),f(35,st,3,1,"button",21)(36,pt,3,1,"button",22)(37,_t,3,2,"button",23),c()()()()()}if(n&2){let e=l();o(6),b(" ",e.i18n.t("department.selectedDepartment")," "),o(7),C(e.selectedDepartment.name),o(2),C(e.selectedDepartment.code),o(),d("ngIf",e.selectedDepartment.description),o(3),d("ngIf",e.selectedDepartment.managerName),o(3),C(e.i18n.t("common.employees")),o(3),C(e.selectedDepartment.employeeCount||0),o(),d("ngIf",e.selectedDepartment.location),o(3),C(e.i18n.t("common.status")),o(2),S("bg-success",e.selectedDepartment.isActive)("bg-secondary",!e.selectedDepartment.isActive),o(),b(" ",e.selectedDepartment.isActive?e.i18n.t("common.active"):e.i18n.t("common.inactive")," "),o(3),d("appHasPermission",e.PERMISSIONS.DEPARTMENT_READ),o(),d("appHasPermission",e.PERMISSIONS.DEPARTMENT_UPDATE),o(),d("appHasPermission",e.PERMISSIONS.DEPARTMENT_DELETE)}}var J=class n{i18n=w(I);permissionService=w(A);selectedDepartment=null;departmentView=new D;departmentEdit=new D;departmentDelete=new D;closePanel=new D;PERMISSIONS={DEPARTMENT_READ:`${T.DEPARTMENT}.${M.READ}`,DEPARTMENT_UPDATE:`${T.DEPARTMENT}.${M.UPDATE}`,DEPARTMENT_DELETE:`${T.DEPARTMENT}.${M.DELETE}`};onDepartmentView(){this.selectedDepartment&&this.departmentView.emit(this.selectedDepartment)}onDepartmentEdit(){this.selectedDepartment&&this.departmentEdit.emit(this.selectedDepartment)}onDepartmentDelete(){this.selectedDepartment&&this.departmentDelete.emit(this.selectedDepartment)}onClosePanel(){this.closePanel.emit()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-department-info-panel"]],inputs:{selectedDepartment:"selectedDepartment"},outputs:{departmentView:"departmentView",departmentEdit:"departmentEdit",departmentDelete:"departmentDelete",closePanel:"closePanel"},decls:1,vars:1,consts:[["class","selected-info",4,"ngIf"],[1,"selected-info"],[1,"card","border-primary"],[1,"card-header","bg-primary","text-white"],[1,"d-flex","align-items-center","justify-content-between"],[1,"fas","fa-info-circle","me-2"],["type","button",1,"btn","btn-sm","btn-outline-light",3,"click"],[1,"fas","fa-times"],[1,"card-body"],[1,"row"],[1,"col-md-6"],[1,"fw-bold"],[1,"text-muted","mb-2"],["class","small mb-2",4,"ngIf"],[1,"row","g-2"],["class","col-6",4,"ngIf"],[1,"col-6"],[1,"text-muted"],[1,"badge"],[1,"mt-3"],[1,"btn-group","btn-group-sm"],["type","button","class","btn btn-outline-primary",3,"click",4,"appHasPermission"],["type","button","class","btn btn-outline-secondary",3,"click",4,"appHasPermission"],["type","button","class","btn btn-outline-danger",3,"disabled","click",4,"appHasPermission"],[1,"small","mb-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-eye","me-1"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-edit","me-1"],["type","button",1,"btn","btn-outline-danger",3,"click","disabled"],[1,"fas","fa-trash","me-1"]],template:function(e,i){e&1&&f(0,gt,38,17,"div",0),e&2&&d("ngIf",i.selectedDepartment)},dependencies:[y,V,R],styles:[".selected-info[_ngcontent-%COMP%]{margin-top:1.5rem}.card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 4px 6px #0000001a;overflow:hidden}.card-header[_ngcontent-%COMP%]{border-bottom:1px solid rgba(255,255,255,.2);padding:1rem 1.25rem}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.fw-bold[_ngcontent-%COMP%]{font-weight:600;color:#333;margin-bottom:.5rem}.text-muted[_ngcontent-%COMP%]{color:#6c757d!important}.small[_ngcontent-%COMP%]{font-size:.875rem;line-height:1.4}.badge[_ngcontent-%COMP%]{font-size:.75rem;padding:.375rem .75rem;border-radius:.375rem}.badge.bg-success[_ngcontent-%COMP%]{background-color:#198754!important}.badge.bg-secondary[_ngcontent-%COMP%]{background-color:#6c757d!important}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.875rem;border-radius:.25rem}.btn-outline-primary[_ngcontent-%COMP%]{color:#0d6efd;border-color:#0d6efd}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#0d6efd;border-color:#0d6efd;color:#fff}.btn-outline-secondary[_ngcontent-%COMP%]{color:#6c757d;border-color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;border-color:#6c757d;color:#fff}.btn-outline-danger[_ngcontent-%COMP%]{color:#dc3545;border-color:#dc3545}.btn-outline-danger[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#dc3545;border-color:#dc3545;color:#fff}.btn-outline-danger[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-outline-light[_ngcontent-%COMP%]{border:1px solid rgba(255,255,255,.5);color:#fff}.btn-outline-light[_ngcontent-%COMP%]:hover{background-color:#ffffff1a;border-color:#fff;color:#fff}@media (max-width: 768px){.card-body[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .col-md-6[_ngcontent-%COMP%]{margin-bottom:1rem}.btn-group-sm[_ngcontent-%COMP%]{flex-direction:column;width:100%}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:.375rem!important;margin-bottom:.25rem;width:100%}.btn-group-sm[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{margin-bottom:0}}"]})};function ut(n,t){if(n&1&&(a(0,"div",8)(1,"div",9),p(2,"i",10),a(3,"div")(4,"strong"),m(5),c(),p(6,"br"),a(7,"small"),m(8),c()()()()),n&2){let e=l();o(5),C(e.i18n.t("department.allDepartments")||"All Departments"),o(3),C(e.i18n.t("department.showingAllDepartments")||"Showing departments from all branches. Select a specific branch to filter.")}}function ft(n,t){if(n&1){let e=x();a(0,"app-department-table",11),u("departmentSelected",function(r){_(e);let s=l();return g(s.onDepartmentSelected(r))})("departmentView",function(r){_(e);let s=l();return g(s.onDepartmentView(r))})("departmentEdit",function(r){_(e);let s=l();return g(s.onDepartmentEdit(r))})("departmentDelete",function(r){_(e);let s=l();return g(s.onDepartmentDelete(r))})("departmentAdd",function(){_(e);let r=l();return g(r.onDepartmentAdd())}),c()}if(n&2){let e,i=l();d("selectedBranchId",(e=i.selectedBranch())==null?null:e.id)("allowSelection",!0)("allowEdit",!0)("allowDelete",!0)("showControls",!0)}}function bt(n,t){if(n&1){let e=x();a(0,"app-department-tree",11),u("departmentSelected",function(r){_(e);let s=l();return g(s.onDepartmentSelected(r))})("departmentView",function(r){_(e);let s=l();return g(s.onDepartmentView(r))})("departmentEdit",function(r){_(e);let s=l();return g(s.onDepartmentEdit(r))})("departmentDelete",function(r){_(e);let s=l();return g(s.onDepartmentDelete(r))})("departmentAdd",function(r){_(e);let s=l();return g(s.onDepartmentAdd(r))}),c()}if(n&2){let e,i=l();d("selectedBranchId",(e=i.selectedBranch())==null?null:e.id)("allowSelection",!0)("allowEdit",!0)("allowDelete",!0)("showControls",!0)}}var ce=class n{i18n=w(I);departmentsService=w(B);confirmationService=w(oe);permissionService=w(A);router=w(te);PERMISSIONS={DEPARTMENT_CREATE:`${T.DEPARTMENT}.${M.CREATE}`,DEPARTMENT_READ:`${T.DEPARTMENT}.${M.READ}`,DEPARTMENT_UPDATE:`${T.DEPARTMENT}.${M.UPDATE}`,DEPARTMENT_DELETE:`${T.DEPARTMENT}.${M.DELETE}`,DEPARTMENT_MANAGE:`${T.DEPARTMENT}.${M.MANAGE}`};viewMode=h("table");selectedBranch=h(null);selectedDepartment=h(null);branchesLoading=h(!1);branches=h([]);ngOnInit(){}onViewModeChange(t){this.viewMode.set(t)}onBranchChange(t){if(!t||t===0){this.selectedBranch.set(null);return}let e=this.branches().find(i=>i.id===t);this.selectedBranch.set(e||null)}onBranchSelectionChange(t){let e=t?parseInt(t):0;this.onBranchChange(e)}onCloseInfoPanel(){this.selectedDepartment.set(null)}onDepartmentSelected(t){this.selectedDepartment.set(t)}onDepartmentView(t){this.router.navigate(["/departments",t.id,"view"])}onDepartmentEdit(t){this.router.navigate(["/departments",t.id,"edit"])}onDepartmentDelete(t){return $(this,null,function*(){(yield this.confirmationService.confirm({title:"Delete Department",message:`Are you sure you want to delete "${t.name}"? This action cannot be undone.`,confirmText:this.i18n.t("common.delete"),cancelText:this.i18n.t("common.cancel"),confirmButtonClass:"btn-danger",icon:"fa-trash",iconClass:"text-danger"})).confirmed&&this.deleteDepartment(t.id)})}onDepartmentAdd(t){t?.parentId?this.router.navigate(["/departments/create"],{queryParams:{parentId:t.parentId}}):this.router.navigate(["/departments/create"])}deleteDepartment(t){return $(this,null,function*(){try{yield this.departmentsService.deleteDepartment(t).toPromise(),this.refreshData()}catch(e){console.error("Failed to delete department:",e)}})}refreshData(){window.location.reload()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=E({type:n,selectors:[["app-departments"]],decls:11,vars:8,consts:[[1,"departments-page"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],[3,"viewModeChange","branchSelectionChange","departmentAdd","viewMode","selectedBranch","branchesLoading"],[1,"card"],[1,"card-body"],["class","alert alert-info",4,"ngIf"],[3,"selectedBranchId","allowSelection","allowEdit","allowDelete","showControls","departmentSelected","departmentView","departmentEdit","departmentDelete","departmentAdd",4,"ngIf"],[3,"departmentView","departmentEdit","departmentDelete","closePanel","selectedDepartment"],[1,"alert","alert-info"],[1,"d-flex","align-items-center"],[1,"fas","fa-info-circle","me-3"],[3,"departmentSelected","departmentView","departmentEdit","departmentDelete","departmentAdd","selectedBranchId","allowSelection","allowEdit","allowDelete","showControls"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"h2"),m(3),c()(),a(4,"app-department-filters",2),u("viewModeChange",function(s){return i.onViewModeChange(s)})("branchSelectionChange",function(s){return i.onBranchSelectionChange(s)})("departmentAdd",function(){return i.onDepartmentAdd()}),c(),a(5,"div",3)(6,"div",4),f(7,ut,9,2,"div",5)(8,ft,1,5,"app-department-table",6)(9,bt,1,5,"app-department-tree",6),c()(),a(10,"app-department-info-panel",7),u("departmentView",function(s){return i.onDepartmentView(s)})("departmentEdit",function(s){return i.onDepartmentEdit(s)})("departmentDelete",function(s){return i.onDepartmentDelete(s)})("closePanel",function(){return i.onCloseInfoPanel()}),c()()),e&2&&(o(3),C(i.i18n.t("department.departments")),o(),d("viewMode",i.viewMode())("selectedBranch",i.selectedBranch())("branchesLoading",i.branchesLoading()),o(3),d("ngIf",!i.selectedBranch()&&!i.branchesLoading()),o(),d("ngIf",i.viewMode()==="table"),o(),d("ngIf",i.viewMode()==="tree"),o(),d("selectedDepartment",i.selectedDepartment()))},dependencies:[y,V,N,j,G,q,J],styles:[".selected-info[_ngcontent-%COMP%]{position:fixed;top:50%;right:2rem;transform:translateY(-50%);width:350px;z-index:1000}@media (max-width: 1200px){.selected-info[_ngcontent-%COMP%]{position:relative;top:auto;right:auto;transform:none;width:100%;margin-top:2rem}}"]})};export{ce as DepartmentsComponent};
