import{a as s,b as n,c as i}from"./chunk-5BLMYARA.js";import{a as h}from"./chunk-O7VLIHRG.js";import{Pa as u,o,r as a}from"./chunk-H3A4D7EH.js";var l=class t{constructor(e){this.authService=e}userPermissions=u(()=>this.authService.currentUser()?.permissions||[]);has(e){let r=this.userPermissions();return r.includes(e)||r.includes("*")}hasAny(e){return e.some(r=>this.has(r))}hasAll(e){return e.every(r=>this.has(r))}hasRole(e){return this.authService.currentUser()?.roles?.includes(e)||!1}isAdmin(){return this.hasRole("Admin")}isSuperAdmin(){return this.hasRole("SuperAdmin")}canAccessBranch(e){let r=this.authService.currentUser();return!r?.branchIds||r.branchIds.length===0?!0:r.branchIds.includes(e)}canRead(e){return this.has(i.buildPermissionKey(e,s.READ))}canCreate(e){return this.has(i.buildPermissionKey(e,s.CREATE))}canUpdate(e){return this.has(i.buildPermissionKey(e,s.UPDATE))}canDelete(e){return this.has(i.buildPermissionKey(e,s.DELETE))}canExport(e){return this.has(i.buildPermissionKey(e,s.EXPORT))}canImport(e){return this.has(i.buildPermissionKey(e,s.IMPORT))}canManage(e){return this.has(i.buildPermissionKey(e,s.MANAGE))}canManageUsers(){return this.hasAny([i.buildPermissionKey(n.USER,s.CREATE),i.buildPermissionKey(n.USER,s.UPDATE),i.buildPermissionKey(n.USER,s.DELETE),i.buildPermissionKey(n.USER,s.MANAGE)])}canManageRoles(){return this.hasAny([i.buildPermissionKey(n.ROLE,s.CREATE),i.buildPermissionKey(n.ROLE,s.UPDATE),i.buildPermissionKey(n.ROLE,s.DELETE),i.buildPermissionKey(n.ROLE,s.MANAGE)])}canManageEmployees(){return this.hasAny([i.buildPermissionKey(n.EMPLOYEE,s.CREATE),i.buildPermissionKey(n.EMPLOYEE,s.UPDATE),i.buildPermissionKey(n.EMPLOYEE,s.DELETE),i.buildPermissionKey(n.EMPLOYEE,s.MANAGE)])}canAccessShifts(){return this.hasAny(["shift.read","shift.create","shift.update","shift.delete","shift.assign","shift.unassign","shift.export","shift.import"])}static \u0275fac=function(r){return new(r||t)(a(h))};static \u0275prov=o({token:t,factory:t.\u0275fac,providedIn:"root"})};export{l as a};
