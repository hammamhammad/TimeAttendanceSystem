import{a as F}from"./chunk-EOM5ILZ7.js";import{a as G}from"./chunk-JTZMRZUG.js";import{a as $}from"./chunk-GC2ZOSF6.js";import{a as R,b as y}from"./chunk-5BLMYARA.js";import"./chunk-O7VLIHRG.js";import{b as j}from"./chunk-MCSGSJCX.js";import{C as i,H as T,L as w,R as v,S as f,Ua as N,V as M,W as D,X as _,Y as o,Z as r,_ as p,ab as A,fa as E,ha as g,ib as L,ja as d,lb as H,mb as B,rb as U,s as x,sa as l,t as b,ta as m,u as C,ua as c,va as O,y as S}from"./chunk-H3A4D7EH.js";import"./chunk-DGAILPFQ.js";var z=(n,t)=>t.key||t.id;function J(n,t){if(n&1){let e=E();o(0,"button",14),g("click",function(){b(e);let u=d();return C(u.onEdit())}),p(1,"i",15),l(2),r()}if(n&2){let e=d();i(2),c(" ",e.i18n.t("roles.edit")," ")}}function K(n,t){if(n&1&&(o(0,"div",12)(1,"div",16)(2,"span",17),l(3),r()()()),n&2){let e=d();i(3),m(e.i18n.t("common.loading"))}}function Q(n,t){if(n&1&&p(0,"i",28),n&2){let e=d(2);_("title",e.i18n.t("roles.system_role"))}}function W(n,t){if(n&1&&(o(0,"span",34),l(1),r()),n&2){let e=d(2);i(),m(e.i18n.t("roles.system"))}}function X(n,t){if(n&1&&(o(0,"span",35),l(1),r()),n&2){let e=d(2);i(),m(e.i18n.t("roles.custom"))}}function Y(n,t){if(n&1){let e=E();o(0,"button",45),g("click",function(){b(e);let u=d(2);return C(u.onEdit())}),p(1,"i",15),l(2),r()}if(n&2){let e=d(2);i(2),c(" ",e.i18n.t("roles.edit")," ")}}function Z(n,t){if(n&1){let e=E();o(0,"button",46),g("click",function(){b(e);let u=d(2);return C(u.onManagePermissions())}),p(1,"i",42),l(2),r()}if(n&2){let e=d(2);i(2),c(" ",e.i18n.t("roles.manage_permissions")," ")}}function ee(n,t){if(n&1&&(o(0,"div",47)(1,"div",48)(2,"div",49),p(3,"i",50),o(4,"div",51)(5,"div",52)(6,"small",53),l(7),r(),o(8,"span",54),l(9),r()(),o(10,"p",55),l(11),r()()()()()),n&2){let e=t.$implicit,a=d(3);i(3),_("ngClass",a.getPermissionIcon(e.key)),i(4),m(a.getPermissionResource(e.key)),i(),_("ngClass",a.getActionBadgeClass(e.key)),i(),c(" ",a.getPermissionAction(e.key)," "),i(2),c(" ",a.getPermissionDescription(e)," ")}}function te(n,t){if(n&1&&(o(0,"div",43),M(1,ee,12,5,"div",47,z),r()),n&2){let e,a=d(2);i(),D((e=a.role())==null?null:e.permissions)}}function ie(n,t){if(n&1&&(o(0,"div",44),p(1,"i",56),o(2,"p",57),l(3),r()()),n&2){let e=d(2);i(3),m(e.i18n.t("roles.no_permissions"))}}function ne(n,t){if(n&1&&(o(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"h5",22)(5,"div",23)(6,"div",24)(7,"div",25),p(8,"i",26),r()(),o(9,"div")(10,"div",27),l(11),v(12,Q,1,1,"i",28),r(),o(13,"small",29),l(14),r()()()()(),o(15,"div",30)(16,"div",18)(17,"div",31)(18,"dl",18)(19,"dt",32),l(20),r(),o(21,"dd",33),l(22),r(),o(23,"dt",32),l(24),r(),o(25,"dd",33),v(26,W,2,1,"span",34)(27,X,2,1,"span",35),r(),o(28,"dt",32),l(29),r(),o(30,"dd",33)(31,"span",36),l(32),r()()()(),o(33,"div",31)(34,"dl",18)(35,"dt",32),l(36),r(),o(37,"dd",33),l(38),r(),o(39,"dt",32),l(40),r(),o(41,"dd",33),l(42),r()()()()()()(),o(43,"div",37)(44,"div",20)(45,"div",21)(46,"h6",22),l(47),r()(),o(48,"div",30)(49,"div",38),w(50,Y,3,1,"button",39)(51,Z,3,1,"button",40),r()()()()(),o(52,"div",41)(53,"div",21)(54,"h6",22),p(55,"i",42),l(56),r()(),o(57,"div",30),v(58,te,3,0,"div",43)(59,ie,4,1,"div",44),r()()),n&2){let e,a,u,h,P,V,I,k,s=d();i(11),c(" ",(e=s.role())==null?null:e.name," "),i(),f((a=s.role())!=null&&a.isSystem?12:-1),i(2),O("",((u=s.role())==null||u.permissions==null?null:u.permissions.length)||0," ",s.i18n.t("roles.permissions_assigned")),i(6),c("",s.i18n.t("roles.name"),":"),i(2),m((h=s.role())==null?null:h.name),i(2),c("",s.i18n.t("roles.type"),":"),i(2),f((P=s.role())!=null&&P.isSystem?26:27),i(3),c("",s.i18n.t("roles.user_count"),":"),i(3),m(((V=s.role())==null?null:V.userCount)||0),i(4),c("",s.i18n.t("roles.created_at"),":"),i(2),m(s.formatDate(s.role().createdAtUtc)),i(2),c("",s.i18n.t("roles.permissions"),":"),i(2),m(((I=s.role())==null||I.permissions==null?null:I.permissions.length)||0),i(5),m(s.i18n.t("common.actions")),i(3),_("appHasPermission",s.PERMISSIONS.ROLE_UPDATE),i(),_("appHasPermission",s.PERMISSIONS.ROLE_ASSIGN_PERMISSIONS),i(5),c(" ",s.i18n.t("roles.permissions")," "),i(2),f((k=s.role())!=null&&k.permissions&&s.role().permissions.length>0?58:59)}}function oe(n,t){if(n&1&&(o(0,"div",13),p(1,"i",58),l(2),r()),n&2){let e=d();i(2),c(" ",e.error()||e.i18n.t("roles.role_not_found")," ")}}var q=class n{route=x(L);router=x(H);rolesService=x(F);i18n=x(j);permissionService=x($);PERMISSIONS={ROLE_UPDATE:`${y.ROLE}.${R.UPDATE}`,ROLE_ASSIGN_PERMISSIONS:`${y.ROLE}.${R.ASSIGN_PERMISSION}`};role=S(null);loading=S(!0);error=S("");ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?this.loadRole(t):(this.error.set(this.i18n.t("roles.invalid_role_id")),this.loading.set(!1))}loadRole(t){this.rolesService.getRoleById(+t).subscribe({next:e=>{this.role.set(e),this.loading.set(!1)},error:e=>{this.error.set(this.getErrorMessage(e)),this.loading.set(!1)}})}onEdit(){this.role()&&this.router.navigate(["/roles",this.role().id,"edit"])}onManagePermissions(){this.role()&&this.router.navigate(["/roles",this.role().id,"edit"])}onBack(){this.router.navigate(["/roles"])}formatDate(t){return new Date(t).toLocaleDateString()}getPermissionIcon(t){return t.includes("read")?"fa-eye":t.includes("create")?"fa-plus":t.includes("update")?"fa-edit":t.includes("delete")?"fa-trash":"fa-key"}getPermissionResource(t){return t.split(".")[0]||t}getPermissionAction(t){return t.split(".")[1]||"unknown"}getActionBadgeClass(t){return t.includes("read")?"bg-info-subtle text-info":t.includes("create")?"bg-success-subtle text-success":t.includes("update")?"bg-warning-subtle text-warning":t.includes("delete")?"bg-danger-subtle text-danger":"bg-secondary-subtle text-secondary"}getPermissionDescription(t){return t.description||this.i18n.t("roles.no_description")}getErrorMessage(t){return t?.error?.error?t.error.error:this.i18n.t("errors.unknown")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=T({type:n,selectors:[["app-view-role"]],decls:23,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/roles"],[1,"breadcrumb-item","active"],[1,"btn-group"],["type","button","class","btn btn-primary",3,"click",4,"appHasPermission"],["type","button",1,"btn","btn-outline-secondary",3,"click"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"alert","alert-danger"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fa-solid","fa-edit","me-2"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"row"],[1,"col-lg-8"],[1,"card"],[1,"card-header"],[1,"card-title","mb-0"],[1,"d-flex","align-items-center"],[1,"avatar-sm","me-3"],[1,"avatar-title","bg-info-subtle","text-info","rounded-circle"],[1,"fa-solid","fa-user-shield"],[1,"fw-medium"],[1,"fa-solid","fa-shield-alt","text-primary","ms-2",3,"title"],[1,"text-muted"],[1,"card-body"],[1,"col-md-6"],[1,"col-sm-5"],[1,"col-sm-7"],[1,"badge","bg-warning-subtle","text-warning"],[1,"badge","bg-success-subtle","text-success"],[1,"badge","bg-primary-subtle","text-primary"],[1,"col-lg-4"],[1,"d-grid","gap-2"],["type","button","class","btn btn-outline-primary",3,"click",4,"appHasPermission"],["type","button","class","btn btn-outline-info",3,"click",4,"appHasPermission"],[1,"card","mt-4"],[1,"fa-solid","fa-key","me-2"],[1,"row","g-2"],[1,"text-center","py-4"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-outline-info",3,"click"],[1,"col-md-6","col-lg-4"],[1,"permission-item","border","rounded","p-2"],[1,"d-flex","align-items-start"],[1,"fas","me-2","text-muted","mt-1",3,"ngClass"],[1,"flex-grow-1"],[1,"d-flex","align-items-center","mb-1"],[1,"fw-medium","me-2"],[1,"badge",3,"ngClass"],[1,"text-muted","small","mb-0"],[1,"fa-solid","fa-key","fa-2x","text-muted","mb-2"],[1,"text-muted","mb-0"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(e,a){e&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),l(4),r(),o(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),l(9),r()(),o(10,"li",4)(11,"a",6),l(12),r()(),o(13,"li",7),l(14),r()()()(),o(15,"div",8),w(16,J,3,1,"button",9),o(17,"button",10),g("click",function(){return a.onBack()}),p(18,"i",11),l(19),r()()(),v(20,K,4,1,"div",12)(21,ne,60,19)(22,oe,3,1,"div",13),r()),e&2&&(i(4),m(a.i18n.t("roles.view_details")),i(5),m(a.i18n.t("dashboard.title")),i(3),m(a.i18n.t("roles.title")),i(2),m(a.i18n.t("roles.view_details")),i(2),_("appHasPermission",a.PERMISSIONS.ROLE_UPDATE),i(3),c(" ",a.i18n.t("common.back")," "),i(),f(a.loading()?20:a.role()?21:22))},dependencies:[A,N,U,B,G],encapsulation:2})};export{q as ViewRoleComponent};
