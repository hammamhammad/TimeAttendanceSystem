import{a as Z}from"./chunk-2VZGIQVB.js";import{a as K}from"./chunk-FOHY6BYJ.js";import{a as J}from"./chunk-3OLRZNFC.js";import{a as X}from"./chunk-46YUKDEL.js";import"./chunk-LPMX3N5X.js";import"./chunk-LDWMK676.js";import{a as H}from"./chunk-IE5XUEO5.js";import{b as N,c as R,e as V,f as q,g as O,h as T,i as Y,j as B,u as L,v as j,w as U,z as Q}from"./chunk-YQIE4CGE.js";import{a as z}from"./chunk-JNFDDMIM.js";import"./chunk-ZURD34HZ.js";import{a as G}from"./chunk-GEGVYT7O.js";import"./chunk-A6EM5NV6.js";import{A as u,Ba as E,Cb as I,E as g,Fb as A,Ga as l,Ha as b,Ia as c,L as t,Oa as f,Pa as v,Q as F,Qa as _,aa as k,b as D,ba as C,ga as h,h as M,ha as n,ia as r,ja as p,p as w,q as S,qa as W,sa as P,ua as s,y as x,z as y}from"./chunk-5OFYUWMA.js";import"./chunk-YMDWBF3A.js";function ee(d,o){if(d&1&&(n(0,"div",3),p(1,"app-loading-spinner",4),r()),d&2){let i=s();t(),h("message",i.i18n.t("common.loading"))("variant","primary")("centered",!0)}}function te(d,o){if(d&1&&(n(0,"div",14)(1,"span",46),p(2,"i",47),l(3),r(),n(4,"small",48),l(5),r()()),d&2){let i=s(2);t(3),c(" ",i.i18n.t("remoteWork.policy.company_wide")," "),t(2),c(" ",i.i18n.t("remoteWork.policy.company_wide_help")," ")}}function ie(d,o){if(d&1){let i=W();n(0,"app-searchable-select",49),_("ngModelChange",function(a){y(i);let m=s(2);return v(m.policyForm.branchId,a)||(m.policyForm.branchId=a),u(a)}),r()}if(d&2){let i=s(2);f("ngModel",i.policyForm.branchId),h("options",i.branches())("placeholder",i.i18n.t("remoteWork.policy.select_branch"))("required",!0)}}function oe(d,o){d&1&&p(0,"span",44)}function ne(d,o){d&1&&p(0,"i",45)}function re(d,o){if(d&1){let i=W();n(0,"form",5,0),P("ngSubmit",function(){y(i);let a=s();return u(a.onSubmit())}),n(2,"div",6)(3,"div",7)(4,"h5",8),p(5,"i",9),l(6),r()(),n(7,"div",10)(8,"div",11)(9,"div",12)(10,"label",13),l(11),r(),k(12,te,6,2,"div",14)(13,ie,1,4,"app-searchable-select",15),r(),n(14,"div",12)(15,"label",16),l(16),r(),n(17,"div",17)(18,"input",18),_("ngModelChange",function(a){y(i);let m=s();return v(m.policyForm.isActive,a)||(m.policyForm.isActive=a),u(a)}),r(),n(19,"label",19),l(20),r()()()()()(),n(21,"div",6)(22,"div",7)(23,"h5",8),p(24,"i",20),l(25),r()(),n(26,"div",10)(27,"p",21),p(28,"i",22),l(29),r(),n(30,"div",11)(31,"div",23)(32,"label",24),l(33),r(),n(34,"input",25),_("ngModelChange",function(a){y(i);let m=s();return v(m.policyForm.maxDaysPerWeek,a)||(m.policyForm.maxDaysPerWeek=a),u(a)}),r(),n(35,"div",26),l(36),r()(),n(37,"div",23)(38,"label",27),l(39),r(),n(40,"input",28),_("ngModelChange",function(a){y(i);let m=s();return v(m.policyForm.maxDaysPerMonth,a)||(m.policyForm.maxDaysPerMonth=a),u(a)}),r(),n(41,"div",26),l(42),r()(),n(43,"div",23)(44,"label",29),l(45),r(),n(46,"input",30),_("ngModelChange",function(a){y(i);let m=s();return v(m.policyForm.maxDaysPerYear,a)||(m.policyForm.maxDaysPerYear=a),u(a)}),r(),n(47,"div",26),l(48),r()()()()(),n(49,"div",6)(50,"div",7)(51,"h5",8),p(52,"i",31),l(53),r()(),n(54,"div",10)(55,"div",11)(56,"div",32)(57,"div",33)(58,"input",34),_("ngModelChange",function(a){y(i);let m=s();return v(m.policyForm.requiresManagerApproval,a)||(m.policyForm.requiresManagerApproval=a),u(a)}),r(),n(59,"label",35),l(60),r()(),n(61,"div",26),l(62),r()()()()(),n(63,"div",6)(64,"div",7)(65,"h5",8),p(66,"i",36),l(67),r()(),n(68,"div",10)(69,"div",11)(70,"div",12)(71,"label",37),l(72),r(),n(73,"input",38),_("ngModelChange",function(a){y(i);let m=s();return v(m.policyForm.minAdvanceNoticeDays,a)||(m.policyForm.minAdvanceNoticeDays=a),u(a)}),r(),n(74,"div",26),l(75),r()()()()(),n(76,"div",39)(77,"div",10)(78,"div",40)(79,"button",41),P("click",function(){y(i);let a=s();return u(a.onCancel())}),p(80,"i",42),l(81),r(),n(82,"button",43),k(83,oe,1,0,"span",44)(84,ne,1,0,"i",45),l(85),r()()()()()}if(d&2){let i=E(1),e=s();t(6),c(" ",e.i18n.t("common.basic_information")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.policy_scope")," "),t(),C(e.isCompanyWide()?12:13),t(4),c(" ",e.i18n.t("common.status")," "),t(2),f("ngModel",e.policyForm.isActive),t(2),c(" ",e.policyForm.isActive?e.i18n.t("common.active"):e.i18n.t("common.inactive")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.quota_settings")," "),t(4),c(" ",e.i18n.t("remoteWork.policy.quota_settings_help")," "),t(4),c(" ",e.i18n.t("remoteWork.policy.max_days_per_week")," "),t(),f("ngModel",e.policyForm.maxDaysPerWeek),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),t(2),b(e.i18n.t("remoteWork.policy.max_7_days")),t(3),c(" ",e.i18n.t("remoteWork.policy.max_days_per_month")," "),t(),f("ngModel",e.policyForm.maxDaysPerMonth),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),t(2),b(e.i18n.t("remoteWork.policy.max_31_days")),t(3),c(" ",e.i18n.t("remoteWork.policy.max_days_per_year")," "),t(),f("ngModel",e.policyForm.maxDaysPerYear),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),t(2),b(e.i18n.t("remoteWork.policy.max_365_days")),t(5),c(" ",e.i18n.t("remoteWork.policy.approval_settings")," "),t(5),f("ngModel",e.policyForm.requiresManagerApproval),t(2),c(" ",e.i18n.t("remoteWork.policy.requires_manager_approval")," "),t(2),c(" ",e.policyForm.requiresManagerApproval?e.i18n.t("remoteWork.policy.approval_required_help"):e.i18n.t("remoteWork.policy.approval_automatic_help")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.advance_notice")," "),t(5),c(" ",e.i18n.t("remoteWork.policy.min_advance_notice_days")," "),t(),f("ngModel",e.policyForm.minAdvanceNoticeDays),h("placeholder",e.i18n.t("remoteWork.policy.no_advance_notice")),t(2),b(e.i18n.t("remoteWork.policy.advance_notice_help")),t(4),h("disabled",e.submitting()),t(2),c(" ",e.i18n.t("common.cancel")," "),t(),h("disabled",e.submitting()||!i.form.valid),t(),C(e.submitting()?83:84),t(2),c(" ",e.i18n.t("common.save")," ")}}var $=class d{service=x(Z);branchesService=x(X);router=x(A);route=x(I);notificationService=x(z);destroy$=new D;i18n=x(G);loading=g(!1);submitting=g(!1);branches=g([]);policyId=g(null);isCompanyWide=g(!1);policyForm={branchId:void 0,maxDaysPerWeek:void 0,maxDaysPerMonth:void 0,maxDaysPerYear:void 0,requiresManagerApproval:!0,allowConsecutiveDays:!1,maxConsecutiveDays:void 0,minAdvanceNoticeDays:void 0,blackoutPeriods:void 0,countForOvertime:!0,enforceShiftTimes:!0,isActive:!0};ngOnInit(){this.loadData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadData(){this.loading.set(!0),this.route.paramMap.pipe(S(this.destroy$),w(o=>{let i=Number(o.get("id"));if(!i||i<=0)throw this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_id")),this.router.navigate(["/settings/remote-work-policy"]),new Error("Invalid policy ID");return this.policyId.set(i),M({branches:this.branchesService.getBranchesForDropdown(),policy:this.service.getById(i)})})).subscribe({next:({branches:o,policy:i})=>{this.branches.set(o.map(e=>({value:e.id,label:e.name}))),this.populateForm(i),this.loading.set(!1)},error:o=>{this.loading.set(!1),console.error("Failed to load data:",o),o.status===404?this.notificationService.error(this.i18n.t("remoteWork.policy.errors.not_found")):this.notificationService.error(this.i18n.t("remoteWork.policy.errors.load_failed")),this.router.navigate(["/settings/remote-work-policy"])}})}populateForm(o){this.isCompanyWide.set(!o.branchId),this.policyForm={branchId:o.branchId,maxDaysPerWeek:o.maxDaysPerWeek??void 0,maxDaysPerMonth:o.maxDaysPerMonth??void 0,maxDaysPerYear:o.maxDaysPerYear??void 0,requiresManagerApproval:o.requiresManagerApproval,allowConsecutiveDays:o.allowConsecutiveDays,maxConsecutiveDays:o.maxConsecutiveDays??void 0,minAdvanceNoticeDays:o.minAdvanceNoticeDays??void 0,blackoutPeriods:o.blackoutPeriods??void 0,countForOvertime:o.countForOvertime,enforceShiftTimes:o.enforceShiftTimes,isActive:o.isActive}}onSubmit(){if(!this.validateForm())return;let o=this.policyId();if(!o){this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_id"));return}this.submitting.set(!0);let i={id:o,maxDaysPerWeek:this.policyForm.maxDaysPerWeek,maxDaysPerMonth:this.policyForm.maxDaysPerMonth,maxDaysPerYear:this.policyForm.maxDaysPerYear,requiresManagerApproval:this.policyForm.requiresManagerApproval,allowConsecutiveDays:this.policyForm.allowConsecutiveDays,maxConsecutiveDays:this.policyForm.maxConsecutiveDays,minAdvanceNoticeDays:this.policyForm.minAdvanceNoticeDays,blackoutPeriods:this.policyForm.blackoutPeriods,countForOvertime:this.policyForm.countForOvertime,enforceShiftTimes:this.policyForm.enforceShiftTimes};this.service.update(o,i).subscribe({next:()=>{this.submitting.set(!1),this.notificationService.success(this.i18n.t("remoteWork.policy.success.updated")),this.router.navigate(["/settings/remote-work-policy"])},error:e=>{this.submitting.set(!1),console.error("Failed to update policy:",e),this.notificationService.error(this.i18n.t("remoteWork.policy.errors.update_failed"))}})}validateForm(){return!this.isCompanyWide()&&!this.policyForm.branchId?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.branch_required")),!1):(this.policyForm.maxDaysPerWeek!==void 0&&this.policyForm.maxDaysPerWeek!==null||this.policyForm.maxDaysPerMonth!==void 0&&this.policyForm.maxDaysPerMonth!==null||this.policyForm.maxDaysPerYear!==void 0&&this.policyForm.maxDaysPerYear!==null||this.notificationService.warning(this.i18n.t("remoteWork.policy.warnings.no_quotas")),this.policyForm.maxDaysPerWeek!==void 0&&this.policyForm.maxDaysPerWeek!==null&&(this.policyForm.maxDaysPerWeek<0||this.policyForm.maxDaysPerWeek>7)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_week")),!1):this.policyForm.maxDaysPerMonth!==void 0&&this.policyForm.maxDaysPerMonth!==null&&(this.policyForm.maxDaysPerMonth<0||this.policyForm.maxDaysPerMonth>31)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_month")),!1):this.policyForm.maxDaysPerYear!==void 0&&this.policyForm.maxDaysPerYear!==null&&(this.policyForm.maxDaysPerYear<0||this.policyForm.maxDaysPerYear>365)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_year")),!1):this.policyForm.minAdvanceNoticeDays!==void 0&&this.policyForm.minAdvanceNoticeDays!==null&&this.policyForm.minAdvanceNoticeDays<0?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_advance_notice")),!1):!0)}onCancel(){this.router.navigate(["/settings/remote-work-policy"])}static \u0275fac=function(i){return new(i||d)};static \u0275cmp=F({type:d,selectors:[["app-edit-remote-work-policy"]],decls:4,vars:4,consts:[["policyFormElement","ngForm"],[1,"edit-remote-work-policy-page"],["mode","edit","moduleName","remote-work-policy","moduleRoute","settings/remote-work-policy",3,"title","entityId","loading"],[1,"d-flex","justify-content-center","align-items-center","py-5"],[3,"message","variant","centered"],[3,"ngSubmit"],[1,"card","mb-4"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fas","fa-info-circle","text-info","me-2"],[1,"card-body"],[1,"row"],[1,"col-md-6","mb-3"],[1,"form-label"],[1,"form-control-plaintext"],["name","branchId",3,"ngModel","options","placeholder","required"],["for","isActive",1,"form-label"],[1,"form-check","form-switch","mt-2"],["type","checkbox","id","isActive","name","isActive",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isActive",1,"form-check-label"],[1,"fas","fa-calendar-check","text-success","me-2"],[1,"text-muted","mb-3"],[1,"fas","fa-info-circle","me-1"],[1,"col-md-4","mb-3"],["for","maxDaysPerWeek",1,"form-label"],["type","number","id","maxDaysPerWeek","name","maxDaysPerWeek","min","0","max","7",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"form-text"],["for","maxDaysPerMonth",1,"form-label"],["type","number","id","maxDaysPerMonth","name","maxDaysPerMonth","min","0","max","31",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["for","maxDaysPerYear",1,"form-label"],["type","number","id","maxDaysPerYear","name","maxDaysPerYear","min","0","max","365",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"fas","fa-user-check","text-warning","me-2"],[1,"col-md-12","mb-3"],[1,"form-check","form-switch"],["type","checkbox","id","requiresManagerApproval","name","requiresManagerApproval",1,"form-check-input",3,"ngModelChange","ngModel"],["for","requiresManagerApproval",1,"form-check-label"],[1,"fas","fa-bell","text-primary","me-2"],["for","minAdvanceNoticeDays",1,"form-label"],["type","number","id","minAdvanceNoticeDays","name","minAdvanceNoticeDays","min","0",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"card"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"],[1,"badge","bg-info"],[1,"fas","fa-building","me-1"],[1,"text-muted","d-block","mt-1"],["name","branchId",3,"ngModelChange","ngModel","options","placeholder","required"]],template:function(i,e){i&1&&(n(0,"div",1),p(1,"app-form-header",2),k(2,ee,2,3,"div",3)(3,re,86,34,"form"),r()),i&2&&(t(),h("title",e.i18n.t("remoteWork.policy.edit_policy"))("entityId",e.policyId()||void 0)("loading",e.submitting()),t(),C(e.loading()?2:3))},dependencies:[Q,Y,R,B,N,V,q,U,j,L,T,O,K,J,H],styles:['.edit-remote-work-policy-page[_ngcontent-%COMP%]{padding:1.5rem}.card[_ngcontent-%COMP%]{border:1px solid #e9ecef;border-radius:.5rem;box-shadow:0 1px 3px #0000000d;transition:box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:1rem 1.5rem}.card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#495057}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.required[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#198754;border-color:#198754}.gap-2[_ngcontent-%COMP%]{gap:.5rem}@media (max-width: 768px){.edit-remote-work-policy-page[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}}']})};export{$ as EditRemoteWorkPolicyComponent};
