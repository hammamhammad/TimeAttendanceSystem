import{a as Z}from"./chunk-GU3M6ZHF.js";import{a as K}from"./chunk-7NQIBQVK.js";import{a as J}from"./chunk-HLRJHZ6V.js";import{a as X}from"./chunk-XU52F2ZD.js";import"./chunk-N7S3JMGU.js";import"./chunk-Y62N6K5S.js";import{b as N,c as R,e as V,f as q,g as O,h as T,i as Y,j as B,s as L,t as j,u as U,x as Q}from"./chunk-VRETN7JA.js";import{a as H}from"./chunk-EYAJMHM7.js";import{a as z}from"./chunk-HHXRLUSQ.js";import"./chunk-UWVH5K3J.js";import{b as G}from"./chunk-RUY4WPQA.js";import{d as I,g as A}from"./chunk-TWXUAMJ4.js";import{Bb as l,Cb as b,Db as c,Ea as w,H as D,I as M,Ib as v,Jb as f,Kb as x,R as g,W as y,X as u,Xa as k,Ya as C,bb as h,cb as n,da as _,db as r,eb as p,f as W,lb as F,nb as P,pb as s,ta as i,wb as S,wc as E}from"./chunk-JSQL33QG.js";import"./chunk-DGAILPFQ.js";function ee(d,t){if(d&1&&(n(0,"div",3),p(1,"app-loading-spinner",4),r()),d&2){let a=s();i(),h("message",a.i18n.t("common.loading"))("variant","primary")("centered",!0)}}function te(d,t){d&1&&p(0,"span",43)}function ie(d,t){d&1&&p(0,"i",44)}function oe(d,t){if(d&1){let a=F();n(0,"form",5,0),P("ngSubmit",function(){y(a);let o=s();return u(o.onSubmit())}),n(2,"div",6)(3,"div",7)(4,"h5",8),p(5,"i",9),l(6),r()(),n(7,"div",10)(8,"div",11)(9,"div",12)(10,"label",13),l(11),r(),n(12,"app-searchable-select",14),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.branchId,o)||(m.policyForm.branchId=o),u(o)}),r()(),n(13,"div",12)(14,"label",15),l(15),r(),n(16,"div",16)(17,"input",17),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.isActive,o)||(m.policyForm.isActive=o),u(o)}),r(),n(18,"label",18),l(19),r()()()()()(),n(20,"div",6)(21,"div",7)(22,"h5",8),p(23,"i",19),l(24),r()(),n(25,"div",10)(26,"p",20),p(27,"i",21),l(28),r(),n(29,"div",11)(30,"div",22)(31,"label",23),l(32),r(),n(33,"input",24),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.maxDaysPerWeek,o)||(m.policyForm.maxDaysPerWeek=o),u(o)}),r(),n(34,"div",25),l(35),r()(),n(36,"div",22)(37,"label",26),l(38),r(),n(39,"input",27),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.maxDaysPerMonth,o)||(m.policyForm.maxDaysPerMonth=o),u(o)}),r(),n(40,"div",25),l(41),r()(),n(42,"div",22)(43,"label",28),l(44),r(),n(45,"input",29),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.maxDaysPerYear,o)||(m.policyForm.maxDaysPerYear=o),u(o)}),r(),n(46,"div",25),l(47),r()()()()(),n(48,"div",6)(49,"div",7)(50,"h5",8),p(51,"i",30),l(52),r()(),n(53,"div",10)(54,"div",11)(55,"div",31)(56,"div",32)(57,"input",33),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.requiresManagerApproval,o)||(m.policyForm.requiresManagerApproval=o),u(o)}),r(),n(58,"label",34),l(59),r()(),n(60,"div",25),l(61),r()()()()(),n(62,"div",6)(63,"div",7)(64,"h5",8),p(65,"i",35),l(66),r()(),n(67,"div",10)(68,"div",11)(69,"div",12)(70,"label",36),l(71),r(),n(72,"input",37),x("ngModelChange",function(o){y(a);let m=s();return f(m.policyForm.minAdvanceNoticeDays,o)||(m.policyForm.minAdvanceNoticeDays=o),u(o)}),r(),n(73,"div",25),l(74),r()()()()(),n(75,"div",38)(76,"div",10)(77,"div",39)(78,"button",40),P("click",function(){y(a);let o=s();return u(o.onCancel())}),p(79,"i",41),l(80),r(),n(81,"button",42),k(82,te,1,0,"span",43)(83,ie,1,0,"i",44),l(84),r()()()()()}if(d&2){let a=S(1),e=s();i(6),c(" ",e.i18n.t("common.basic_information")," "),i(5),c(" ",e.i18n.t("remoteWork.policy.branch")," "),i(),v("ngModel",e.policyForm.branchId),h("options",e.branches())("placeholder",e.i18n.t("remoteWork.policy.select_branch"))("required",!0),i(3),c(" ",e.i18n.t("common.status")," "),i(2),v("ngModel",e.policyForm.isActive),i(2),c(" ",e.policyForm.isActive?e.i18n.t("common.active"):e.i18n.t("common.inactive")," "),i(5),c(" ",e.i18n.t("remoteWork.policy.quota_settings")," "),i(4),c(" ",e.i18n.t("remoteWork.policy.quota_settings_help")," "),i(4),c(" ",e.i18n.t("remoteWork.policy.max_days_per_week")," "),i(),v("ngModel",e.policyForm.maxDaysPerWeek),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),i(2),b(e.i18n.t("remoteWork.policy.max_7_days")),i(3),c(" ",e.i18n.t("remoteWork.policy.max_days_per_month")," "),i(),v("ngModel",e.policyForm.maxDaysPerMonth),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),i(2),b(e.i18n.t("remoteWork.policy.max_31_days")),i(3),c(" ",e.i18n.t("remoteWork.policy.max_days_per_year")," "),i(),v("ngModel",e.policyForm.maxDaysPerYear),h("placeholder",e.i18n.t("remoteWork.policy.no_limit")),i(2),b(e.i18n.t("remoteWork.policy.max_365_days")),i(5),c(" ",e.i18n.t("remoteWork.policy.approval_settings")," "),i(5),v("ngModel",e.policyForm.requiresManagerApproval),i(2),c(" ",e.i18n.t("remoteWork.policy.requires_manager_approval")," "),i(2),c(" ",e.policyForm.requiresManagerApproval?e.i18n.t("remoteWork.policy.approval_required_help"):e.i18n.t("remoteWork.policy.approval_automatic_help")," "),i(5),c(" ",e.i18n.t("remoteWork.policy.advance_notice")," "),i(5),c(" ",e.i18n.t("remoteWork.policy.min_advance_notice_days")," "),i(),v("ngModel",e.policyForm.minAdvanceNoticeDays),h("placeholder",e.i18n.t("remoteWork.policy.no_advance_notice")),i(2),b(e.i18n.t("remoteWork.policy.advance_notice_help")),i(4),h("disabled",e.submitting()),i(2),c(" ",e.i18n.t("common.cancel")," "),i(),h("disabled",e.submitting()||!a.form.valid),i(),C(e.submitting()?82:83),i(2),c(" ",e.i18n.t("common.save")," ")}}var $=class d{service=g(Z);branchesService=g(X);router=g(A);route=g(I);notificationService=g(z);destroy$=new W;i18n=g(G);loading=_(!1);submitting=_(!1);branches=_([]);policyId=_(null);policyForm={branchId:void 0,maxDaysPerWeek:void 0,maxDaysPerMonth:void 0,maxDaysPerYear:void 0,requiresManagerApproval:!0,allowConsecutiveDays:!1,maxConsecutiveDays:void 0,minAdvanceNoticeDays:void 0,blackoutPeriods:void 0,countForOvertime:!0,enforceShiftTimes:!0,isActive:!0};ngOnInit(){this.loadBranches(),this.loadPolicy()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadBranches(){this.branchesService.getBranchesForDropdown().subscribe({next:t=>{this.branches.set(t.map(a=>({value:a.id,label:a.name})))},error:t=>{console.error("Failed to load branches:",t),this.notificationService.error(this.i18n.t("branches.errors.load_failed"))}})}loadPolicy(){this.loading.set(!0),this.route.paramMap.pipe(M(this.destroy$),D(t=>{let a=Number(t.get("id"));if(!a||a<=0)throw this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_id")),this.router.navigate(["/settings/remote-work-policy"]),new Error("Invalid policy ID");return this.policyId.set(a),this.service.getById(a)})).subscribe({next:t=>{this.populateForm(t),this.loading.set(!1)},error:t=>{this.loading.set(!1),console.error("Failed to load policy:",t),t.status===404?this.notificationService.error(this.i18n.t("remoteWork.policy.errors.not_found")):this.notificationService.error(this.i18n.t("remoteWork.policy.errors.load_failed")),this.router.navigate(["/settings/remote-work-policy"])}})}populateForm(t){this.policyForm={branchId:t.branchId,maxDaysPerWeek:t.maxDaysPerWeek??void 0,maxDaysPerMonth:t.maxDaysPerMonth??void 0,maxDaysPerYear:t.maxDaysPerYear??void 0,requiresManagerApproval:t.requiresManagerApproval,allowConsecutiveDays:t.allowConsecutiveDays,maxConsecutiveDays:t.maxConsecutiveDays??void 0,minAdvanceNoticeDays:t.minAdvanceNoticeDays??void 0,blackoutPeriods:t.blackoutPeriods??void 0,countForOvertime:t.countForOvertime,enforceShiftTimes:t.enforceShiftTimes,isActive:t.isActive}}onSubmit(){if(!this.validateForm())return;let t=this.policyId();if(!t){this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_id"));return}this.submitting.set(!0);let a={id:t,maxDaysPerWeek:this.policyForm.maxDaysPerWeek,maxDaysPerMonth:this.policyForm.maxDaysPerMonth,maxDaysPerYear:this.policyForm.maxDaysPerYear,requiresManagerApproval:this.policyForm.requiresManagerApproval,allowConsecutiveDays:this.policyForm.allowConsecutiveDays,maxConsecutiveDays:this.policyForm.maxConsecutiveDays,minAdvanceNoticeDays:this.policyForm.minAdvanceNoticeDays,blackoutPeriods:this.policyForm.blackoutPeriods,countForOvertime:this.policyForm.countForOvertime,enforceShiftTimes:this.policyForm.enforceShiftTimes};this.service.update(t,a).subscribe({next:()=>{this.submitting.set(!1),this.notificationService.success(this.i18n.t("remoteWork.policy.success.updated")),this.router.navigate(["/settings/remote-work-policy"])},error:e=>{this.submitting.set(!1),console.error("Failed to update policy:",e),this.notificationService.error(this.i18n.t("remoteWork.policy.errors.update_failed"))}})}validateForm(){return this.policyForm.branchId?(this.policyForm.maxDaysPerWeek!==void 0&&this.policyForm.maxDaysPerWeek!==null||this.policyForm.maxDaysPerMonth!==void 0&&this.policyForm.maxDaysPerMonth!==null||this.policyForm.maxDaysPerYear!==void 0&&this.policyForm.maxDaysPerYear!==null||this.notificationService.warning(this.i18n.t("remoteWork.policy.warnings.no_quotas")),this.policyForm.maxDaysPerWeek!==void 0&&this.policyForm.maxDaysPerWeek!==null&&(this.policyForm.maxDaysPerWeek<0||this.policyForm.maxDaysPerWeek>7)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_week")),!1):this.policyForm.maxDaysPerMonth!==void 0&&this.policyForm.maxDaysPerMonth!==null&&(this.policyForm.maxDaysPerMonth<0||this.policyForm.maxDaysPerMonth>31)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_month")),!1):this.policyForm.maxDaysPerYear!==void 0&&this.policyForm.maxDaysPerYear!==null&&(this.policyForm.maxDaysPerYear<0||this.policyForm.maxDaysPerYear>365)?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_max_days_per_year")),!1):this.policyForm.minAdvanceNoticeDays!==void 0&&this.policyForm.minAdvanceNoticeDays!==null&&this.policyForm.minAdvanceNoticeDays<0?(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.invalid_advance_notice")),!1):!0):(this.notificationService.error(this.i18n.t("remoteWork.policy.errors.branch_required")),!1)}onCancel(){this.router.navigate(["/settings/remote-work-policy"])}static \u0275fac=function(a){return new(a||d)};static \u0275cmp=w({type:d,selectors:[["app-edit-remote-work-policy"]],decls:4,vars:4,consts:[["policyFormElement","ngForm"],[1,"edit-remote-work-policy-page"],["mode","edit","moduleName","remote-work-policy","moduleRoute","settings/remote-work-policy",3,"title","entityId","loading"],[1,"d-flex","justify-content-center","align-items-center","py-5"],[3,"message","variant","centered"],[3,"ngSubmit"],[1,"card","mb-4"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fas","fa-info-circle","text-info","me-2"],[1,"card-body"],[1,"row"],[1,"col-md-6","mb-3"],["for","branchId",1,"form-label","required"],["name","branchId","valueField","id","labelField","name",3,"ngModelChange","ngModel","options","placeholder","required"],["for","isActive",1,"form-label"],[1,"form-check","form-switch","mt-2"],["type","checkbox","id","isActive","name","isActive",1,"form-check-input",3,"ngModelChange","ngModel"],["for","isActive",1,"form-check-label"],[1,"fas","fa-calendar-check","text-success","me-2"],[1,"text-muted","mb-3"],[1,"fas","fa-info-circle","me-1"],[1,"col-md-4","mb-3"],["for","maxDaysPerWeek",1,"form-label"],["type","number","id","maxDaysPerWeek","name","maxDaysPerWeek","min","0","max","7",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"form-text"],["for","maxDaysPerMonth",1,"form-label"],["type","number","id","maxDaysPerMonth","name","maxDaysPerMonth","min","0","max","31",1,"form-control",3,"ngModelChange","ngModel","placeholder"],["for","maxDaysPerYear",1,"form-label"],["type","number","id","maxDaysPerYear","name","maxDaysPerYear","min","0","max","365",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"fas","fa-user-check","text-warning","me-2"],[1,"col-md-12","mb-3"],[1,"form-check","form-switch"],["type","checkbox","id","requiresManagerApproval","name","requiresManagerApproval",1,"form-check-input",3,"ngModelChange","ngModel"],["for","requiresManagerApproval",1,"form-check-label"],[1,"fas","fa-bell","text-primary","me-2"],["for","minAdvanceNoticeDays",1,"form-label"],["type","number","id","minAdvanceNoticeDays","name","minAdvanceNoticeDays","min","0",1,"form-control",3,"ngModelChange","ngModel","placeholder"],[1,"card"],[1,"d-flex","justify-content-end","gap-2"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-times","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fas","fa-save","me-2"]],template:function(a,e){a&1&&(n(0,"div",1),p(1,"app-form-header",2),k(2,ee,2,3,"div",3)(3,oe,85,37,"form"),r()),a&2&&(i(),h("title",e.i18n.t("remoteWork.policy.edit_policy"))("entityId",e.policyId()||void 0)("loading",e.submitting()),i(),C(e.loading()?2:3))},dependencies:[E,Q,Y,R,B,N,V,q,U,j,L,T,O,K,J,H],styles:['.edit-remote-work-policy-page[_ngcontent-%COMP%]{padding:1.5rem}.card[_ngcontent-%COMP%]{border:1px solid #e9ecef;border-radius:.5rem;box-shadow:0 1px 3px #0000000d;transition:box-shadow .3s ease}.card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px #0000001a}.card-header[_ngcontent-%COMP%]{background-color:#f8f9fa;border-bottom:1px solid #e9ecef;padding:1rem 1.5rem}.card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:600;color:#495057}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.required[_ngcontent-%COMP%]:after{content:" *";color:#dc3545}.form-check-input[_ngcontent-%COMP%]:checked{background-color:#198754;border-color:#198754}.gap-2[_ngcontent-%COMP%]{gap:.5rem}@media (max-width: 768px){.edit-remote-work-policy-page[_ngcontent-%COMP%], .card-body[_ngcontent-%COMP%]{padding:1rem}}']})};export{$ as EditRemoteWorkPolicyComponent};
