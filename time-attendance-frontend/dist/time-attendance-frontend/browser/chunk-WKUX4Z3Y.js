import{a as J}from"./chunk-GC4SRGYM.js";import{a as H}from"./chunk-ASABUVRV.js";import{c as k,d as y,e as j,f as M,i as D,m as L,n as V,o as P,p as B,q,v as R,x as G}from"./chunk-UWMUXUZF.js";import{b as z}from"./chunk-MCSGSJCX.js";import{C as e,H as S,R as s,S as c,X as _,Y as o,Z as a,_ as p,ab as N,fa as F,ha as C,ib as T,ja as m,lb as A,mb as w,pa as u,rb as O,s as g,sa as l,t as b,ta as d,u as I,ua as x,y as h}from"./chunk-H3A4D7EH.js";import"./chunk-DGAILPFQ.js";function Q(r,i){if(r&1&&(o(0,"div",10)(1,"div",13)(2,"span",14),l(3),a()()()),r&2){let n=m();e(3),d(n.i18n.t("common.loading"))}}function U(r,i){if(r&1&&(o(0,"div",20),p(1,"i",63),l(2),a()),r&2){let n=m(2);e(2),x(" ",n.error()," ")}}function W(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("firstName"))}}function X(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("lastName"))}}function Y(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("jobTitle"))}}function Z(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("employmentStatus"))}}function $(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("workLocationType"))}}function ee(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("firstNameAr"))}}function te(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("lastNameAr"))}}function ie(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("jobTitleAr"))}}function ne(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("email"))}}function ae(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("phone"))}}function oe(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("nationalId"))}}function le(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("dateOfBirth"))}}function re(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("gender"))}}function de(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("departmentId"))}}function me(r,i){if(r&1&&(o(0,"div",31),l(1),a()),r&2){let n=m(2);e(),d(n.getFieldError("managerEmployeeId"))}}function pe(r,i){r&1&&p(0,"span",61)}function se(r,i){r&1&&p(0,"i",62)}function ce(r,i){if(r&1){let n=F();o(0,"div",11)(1,"div",15)(2,"h5",16),p(3,"i",17),l(4),a()(),o(5,"div",18)(6,"form",19),C("ngSubmit",function(){b(n);let f=m();return I(f.onSubmit())}),s(7,U,3,1,"div",20),o(8,"div",21)(9,"h6",22),p(10,"i",23),l(11),a(),o(12,"div",24)(13,"div",25)(14,"label",26),l(15),a(),p(16,"input",27),o(17,"div",28),l(18),a()(),o(19,"div",25)(20,"label",26),l(21),a(),p(22,"input",27),o(23,"div",28),l(24),a()(),o(25,"div",25)(26,"label",26),l(27),o(28,"span",29),l(29,"*"),a()(),p(30,"input",30),s(31,W,2,1,"div",31),a(),o(32,"div",25)(33,"label",26),l(34),o(35,"span",29),l(36,"*"),a()(),p(37,"input",32),s(38,X,2,1,"div",31),a(),o(39,"div",25)(40,"label",26),l(41),o(42,"span",29),l(43,"*"),a()(),p(44,"input",33),s(45,Y,2,1,"div",31),a(),o(46,"div",25)(47,"label",26),l(48),o(49,"span",29),l(50,"*"),a()(),o(51,"select",34)(52,"option",35),l(53),a(),o(54,"option",36),l(55),a(),o(56,"option",37),l(57),a(),o(58,"option",38),l(59),a()(),s(60,Z,2,1,"div",31),a(),o(61,"div",25)(62,"label",26),l(63),o(64,"span",29),l(65,"*"),a()(),o(66,"select",39)(67,"option",40),l(68),a(),o(69,"option",41),l(70),a(),o(71,"option",42),l(72),a(),o(73,"option",43),l(74),a()(),s(75,$,2,1,"div",31),a()()(),p(76,"hr"),o(77,"div",21)(78,"h6",44),p(79,"i",45),l(80),a(),o(81,"div",24)(82,"div",25)(83,"label",26),l(84),a(),p(85,"input",46),s(86,ee,2,1,"div",31),a(),o(87,"div",25)(88,"label",26),l(89),a(),p(90,"input",47),s(91,te,2,1,"div",31),a(),o(92,"div",25)(93,"label",26),l(94),a(),p(95,"input",48),s(96,ie,2,1,"div",31),a(),o(97,"div",25)(98,"label",26),l(99),a(),p(100,"input",49),s(101,ne,2,1,"div",31),a(),o(102,"div",25)(103,"label",26),l(104),a(),p(105,"input",50),s(106,ae,2,1,"div",31),a(),o(107,"div",25)(108,"label",26),l(109),a(),p(110,"input",51),s(111,oe,2,1,"div",31),a(),o(112,"div",25)(113,"label",26),l(114),a(),p(115,"input",52),s(116,le,2,1,"div",31),a(),o(117,"div",25)(118,"label",26),l(119),a(),o(120,"select",53)(121,"option",54),l(122),a(),o(123,"option",55),l(124),a(),o(125,"option",56),l(126),a()(),s(127,re,2,1,"div",31),a(),o(128,"div",25)(129,"label",26),l(130),a(),o(131,"app-searchable-select",57),C("selectionChange",function(f){b(n);let E=m();return I(E.onDepartmentSelectionChange(f))}),a(),s(132,de,2,1,"div",31),a(),o(133,"div",25)(134,"label",26),l(135),a(),o(136,"app-searchable-select",57),C("selectionChange",function(f){b(n);let E=m();return I(E.onManagerSelectionChange(f))}),a(),s(137,me,2,1,"div",31),a()()(),o(138,"div",58)(139,"button",8),C("click",function(){b(n);let f=m();return I(f.onCancel())}),p(140,"i",59),l(141),a(),o(142,"button",60),s(143,pe,1,0,"span",61)(144,se,1,0,"i",62),l(145),a()()()()()}if(r&2){let n,v,f,E,t=m();e(4),x(" ",t.i18n.t("employees.employee_information")," "),e(2),_("formGroup",t.employeeForm),e(),c(t.error()?7:-1),e(4),x(" ",t.i18n.t("employees.required_information")," "),e(4),d(t.i18n.t("employees.employee_number")),e(),_("value",(n=t.employee())==null?null:n.employeeNumber),e(2),d(t.i18n.t("employees.employee_number_readonly")),e(3),d(t.i18n.t("employees.branch")),e(),_("value",(v=t.employee())==null?null:v.branchName),e(2),d(t.i18n.t("employees.branch_readonly")),e(3),x(" ",t.i18n.t("employees.first_name")," "),e(3),u("is-invalid",t.isFieldInvalid("firstName")),_("placeholder",t.i18n.t("employees.first_name_placeholder")),e(),c(t.isFieldInvalid("firstName")?31:-1),e(3),x(" ",t.i18n.t("employees.last_name")," "),e(3),u("is-invalid",t.isFieldInvalid("lastName")),_("placeholder",t.i18n.t("employees.last_name_placeholder")),e(),c(t.isFieldInvalid("lastName")?38:-1),e(3),x(" ",t.i18n.t("employees.job_title")," "),e(3),u("is-invalid",t.isFieldInvalid("jobTitle")),_("placeholder",t.i18n.t("employees.job_title_placeholder")),e(),c(t.isFieldInvalid("jobTitle")?45:-1),e(3),x(" ",t.i18n.t("employees.employment_status.title")," "),e(3),u("is-invalid",t.isFieldInvalid("employmentStatus")),e(2),d(t.i18n.t("employees.employment_status.active")),e(2),d(t.i18n.t("employees.employment_status.inactive")),e(2),d(t.i18n.t("employees.employment_status.on_leave")),e(2),d(t.i18n.t("employees.employment_status.terminated")),e(),c(t.isFieldInvalid("employmentStatus")?60:-1),e(3),x(" ",t.i18n.t("employees.work_location.title")," "),e(3),u("is-invalid",t.isFieldInvalid("workLocationType")),e(2),d(t.i18n.t("employees.work_location.onsite")),e(2),d(t.i18n.t("employees.work_location.remote")),e(2),d(t.i18n.t("employees.work_location.hybrid")),e(2),d(t.i18n.t("employees.work_location.field")),e(),c(t.isFieldInvalid("workLocationType")?75:-1),e(5),x(" ",t.i18n.t("employees.additional_information")," "),e(4),d(t.i18n.t("employees.first_name_ar")),e(),u("is-invalid",t.isFieldInvalid("firstNameAr")),_("placeholder",t.i18n.t("employees.first_name_ar_placeholder")),e(),c(t.isFieldInvalid("firstNameAr")?86:-1),e(3),d(t.i18n.t("employees.last_name_ar")),e(),u("is-invalid",t.isFieldInvalid("lastNameAr")),_("placeholder",t.i18n.t("employees.last_name_ar_placeholder")),e(),c(t.isFieldInvalid("lastNameAr")?91:-1),e(3),d(t.i18n.t("employees.job_title_ar")),e(),u("is-invalid",t.isFieldInvalid("jobTitleAr")),_("placeholder",t.i18n.t("employees.job_title_ar_placeholder")),e(),c(t.isFieldInvalid("jobTitleAr")?96:-1),e(3),d(t.i18n.t("employees.email")),e(),u("is-invalid",t.isFieldInvalid("email")),_("placeholder",t.i18n.t("employees.email_placeholder")),e(),c(t.isFieldInvalid("email")?101:-1),e(3),d(t.i18n.t("employees.phone")),e(),u("is-invalid",t.isFieldInvalid("phone")),_("placeholder",t.i18n.t("employees.phone_placeholder")),e(),c(t.isFieldInvalid("phone")?106:-1),e(3),d(t.i18n.t("employees.national_id")),e(),u("is-invalid",t.isFieldInvalid("nationalId")),_("placeholder",t.i18n.t("employees.national_id_placeholder")),e(),c(t.isFieldInvalid("nationalId")?111:-1),e(3),d(t.i18n.t("employees.date_of_birth")),e(),u("is-invalid",t.isFieldInvalid("dateOfBirth")),e(),c(t.isFieldInvalid("dateOfBirth")?116:-1),e(3),d(t.i18n.t("employees.gender.title")),e(),u("is-invalid",t.isFieldInvalid("gender")),e(2),d(t.i18n.t("common.select")),e(2),d(t.i18n.t("employees.gender.male")),e(2),d(t.i18n.t("employees.gender.female")),e(),c(t.isFieldInvalid("gender")?127:-1),e(3),d(t.i18n.t("employees.department")),e(),u("is-invalid",t.isFieldInvalid("departmentId")),_("options",t.departmentSelectOptions)("value",((f=t.employeeForm.get("departmentId"))==null||f.value==null?null:f.value.toString())||"")("placeholder",t.i18n.t("common.select_department"))("searchable",!0)("clearable",!1),e(),c(t.isFieldInvalid("departmentId")?132:-1),e(3),d(t.i18n.t("employees.manager")),e(),u("is-invalid",t.isFieldInvalid("managerEmployeeId")),_("options",t.managerSelectOptions)("value",((E=t.employeeForm.get("managerEmployeeId"))==null||E.value==null?null:E.value.toString())||"")("placeholder",t.i18n.t("common.select_manager"))("searchable",!0)("clearable",!1),e(),c(t.isFieldInvalid("managerEmployeeId")?137:-1),e(2),_("disabled",t.saving()),e(2),x(" ",t.i18n.t("common.cancel")," "),e(),_("disabled",t.employeeForm.invalid||t.saving()),e(),c(t.saving()?143:144),e(2),x(" ",t.saving()?t.i18n.t("common.saving"):t.i18n.t("employees.update_employee")," ")}}function ve(r,i){if(r&1&&(o(0,"div",12),p(1,"i",63),l(2),a()),r&2){let n=m();e(2),x(" ",n.error()||n.i18n.t("employees.employee_not_found")," ")}}var K=class r{route=g(T);router=g(A);employeesService=g(J);fb=g(R);i18n=g(z);employee=h(null);departments=h([]);managers=h([]);loading=h(!0);saving=h(!1);error=h("");employeeForm;ngOnInit(){this.initializeForm();let i=this.route.snapshot.paramMap.get("id");i?this.loadEmployee(i):(this.error.set(this.i18n.t("employees.invalid_employee_id")),this.loading.set(!1))}initializeForm(){this.employeeForm=this.fb.group({firstName:["",[y.required,y.minLength(2)]],lastName:["",[y.required,y.minLength(2)]],firstNameAr:[""],lastNameAr:[""],jobTitle:["",y.required],jobTitleAr:[""],email:["",y.email],phone:[""],nationalId:[""],dateOfBirth:[""],gender:[""],employmentStatus:["Active",y.required],workLocationType:["OnSite",y.required],departmentId:[""],managerEmployeeId:[""]})}loadEmployee(i){this.employeesService.getEmployeeById(+i).subscribe({next:n=>{this.employee.set(n),this.populateForm(n),this.loadDepartments(n.branchId.toString()),this.loadManagers(n.branchId.toString()),this.loading.set(!1)},error:n=>{this.error.set(this.getErrorMessage(n)),this.loading.set(!1)}})}loadDepartments(i){this.departments.set([])}loadManagers(i){this.managers.set([])}populateForm(i){this.employeeForm.patchValue({firstName:i.firstName,lastName:i.lastName,firstNameAr:i.firstNameAr||"",lastNameAr:i.lastNameAr||"",jobTitle:i.jobTitle,jobTitleAr:i.jobTitleAr||"",email:i.email||"",phone:i.phone||"",nationalId:i.nationalId||"",dateOfBirth:i.dateOfBirth?new Date(i.dateOfBirth).toISOString().split("T")[0]:"",gender:i.gender||"",employmentStatus:i.employmentStatus,workLocationType:i.workLocationType,departmentId:i.departmentId||"",managerEmployeeId:i.managerEmployeeId||""})}onSubmit(){if(this.employeeForm.invalid){this.employeeForm.markAllAsTouched();return}this.saving.set(!0),this.error.set("");let i=this.employeeForm.value,n={firstName:i.firstName,lastName:i.lastName,firstNameAr:i.firstNameAr||void 0,lastNameAr:i.lastNameAr||void 0,jobTitle:i.jobTitle,jobTitleAr:i.jobTitleAr||void 0,email:i.email||void 0,phone:i.phone||void 0,nationalId:i.nationalId||void 0,dateOfBirth:i.dateOfBirth||void 0,gender:i.gender?+i.gender:void 0,employmentStatus:i.employmentStatus,workLocationType:i.workLocationType,departmentId:i.departmentId||void 0,managerEmployeeId:i.managerEmployeeId||void 0};this.employeesService.updateEmployee(this.employee().id,n).subscribe({next:()=>{this.saving.set(!1),this.router.navigate(["/employees",this.employee().id,"view"])},error:v=>{this.saving.set(!1),this.error.set(this.getErrorMessage(v))}})}onCancel(){this.employee()?this.router.navigate(["/employees",this.employee().id,"view"]):this.router.navigate(["/employees"])}getFieldError(i){let n=this.employeeForm.get(i);if(n?.errors&&n.touched){if(n.errors.required)return this.i18n.t("validation.required");if(n.errors.email)return this.i18n.t("validation.email");if(n.errors.minlength)return this.i18n.t("validation.minlength").replace("{{min}}",n.errors.minlength.requiredLength)}return""}isFieldInvalid(i){let n=this.employeeForm.get(i);return!!(n?.errors&&n.touched)}get departmentSelectOptions(){let i=[{value:"",label:this.i18n.t("common.select_department")}];return this.departments().forEach(n=>{i.push({value:n.id.toString(),label:n.name,subLabel:n.code})}),i}get managerSelectOptions(){let i=[{value:"",label:this.i18n.t("common.select_manager")}];return this.managers().forEach(n=>{i.push({value:n.id.toString(),label:n.name,subLabel:n.employeeNumber})}),i}onDepartmentSelectionChange(i){let n=i?parseInt(i):0;this.employeeForm.patchValue({departmentId:n||""})}onManagerSelectionChange(i){let n=i?parseInt(i):0;this.employeeForm.patchValue({managerEmployeeId:n||""})}getErrorMessage(i){return i?.error?.error?i.error.error:this.i18n.t("errors.unknown")}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=S({type:r,selectors:[["app-edit-employee"]],decls:21,vars:7,consts:[[1,"container-fluid"],[1,"d-flex","justify-content-between","align-items-center","mb-4"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],["routerLink","/dashboard"],["routerLink","/employees"],[1,"breadcrumb-item","active"],["type","button",1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fa-solid","fa-arrow-left","me-2"],[1,"d-flex","justify-content-center","py-5"],[1,"card"],[1,"alert","alert-danger"],["role","status",1,"spinner-border"],[1,"visually-hidden"],[1,"card-header"],[1,"card-title","mb-0"],[1,"fa-solid","fa-user","me-2"],[1,"card-body"],[3,"ngSubmit","formGroup"],["role","alert",1,"alert","alert-danger"],[1,"mb-4"],[1,"text-primary","mb-3"],[1,"fa-solid","fa-asterisk","me-2"],[1,"row","g-3"],[1,"col-md-6"],[1,"form-label"],["type","text","readonly","",1,"form-control-plaintext",3,"value"],[1,"form-text"],[1,"text-danger"],["type","text","formControlName","firstName",1,"form-control",3,"placeholder"],[1,"invalid-feedback"],["type","text","formControlName","lastName",1,"form-control",3,"placeholder"],["type","text","formControlName","jobTitle",1,"form-control",3,"placeholder"],["formControlName","employmentStatus",1,"form-select"],["value","Active"],["value","Inactive"],["value","OnLeave"],["value","Terminated"],["formControlName","workLocationType",1,"form-select"],["value","OnSite"],["value","Remote"],["value","Hybrid"],["value","Field"],[1,"text-secondary","mb-3"],[1,"fa-solid","fa-info-circle","me-2"],["type","text","formControlName","firstNameAr",1,"form-control",3,"placeholder"],["type","text","formControlName","lastNameAr",1,"form-control",3,"placeholder"],["type","text","formControlName","jobTitleAr",1,"form-control",3,"placeholder"],["type","email","formControlName","email",1,"form-control",3,"placeholder"],["type","tel","formControlName","phone",1,"form-control",3,"placeholder"],["type","text","formControlName","nationalId",1,"form-control",3,"placeholder"],["type","date","formControlName","dateOfBirth",1,"form-control"],["formControlName","gender",1,"form-select"],["value",""],["value","Male"],["value","Female"],[3,"selectionChange","options","value","placeholder","searchable","clearable"],[1,"d-flex","justify-content-end","gap-2","mt-4"],[1,"fa-solid","fa-times","me-2"],["type","submit",1,"btn","btn-primary",3,"disabled"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-2"],[1,"fa-solid","fa-save","me-2"],[1,"fa-solid","fa-exclamation-triangle","me-2"]],template:function(n,v){n&1&&(o(0,"div",0)(1,"div",1)(2,"div")(3,"h2"),l(4),a(),o(5,"nav",2)(6,"ol",3)(7,"li",4)(8,"a",5),l(9),a()(),o(10,"li",4)(11,"a",6),l(12),a()(),o(13,"li",7),l(14),a()()()(),o(15,"button",8),C("click",function(){return v.onCancel()}),p(16,"i",9),l(17),a()(),s(18,Q,4,1,"div",10)(19,ce,146,106,"div",11)(20,ve,3,1,"div",12),a()),n&2&&(e(4),d(v.i18n.t("employees.edit_employee")),e(5),d(v.i18n.t("dashboard.title")),e(3),d(v.i18n.t("employees.title")),e(2),d(v.i18n.t("employees.edit_employee")),e(),_("disabled",v.saving()),e(2),x(" ",v.i18n.t("common.back")," "),e(),c(v.loading()?18:v.employee()?19:20))},dependencies:[N,O,w,G,D,B,q,k,P,j,M,L,V,H],encapsulation:2})};export{K as EditEmployeeComponent};
